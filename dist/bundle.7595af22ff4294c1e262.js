/*! For license information please see bundle.7595af22ff4294c1e262.js.LICENSE.txt */
(()=>{var t={8978:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Aggregation=void 0,function(t){t[t.none=0]="none",t[t.minimum=1]="minimum",t[t.maximum=2]="maximum",t[t.mean=3]="mean",t[t.p10=4]="p10",t[t.p25=5]="p25",t[t.median=6]="median",t[t.p75=7]="p75",t[t.p90=8]="p90",t[t.dominant=9]="dominant",t[t.sum=10]="sum"}(n||(e.Aggregation=n={}))},5289:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0,function(t){t[t[void 0]=0]="undefined",t[t.best_match=1]="best_match",t[t.gfs_seamless=2]="gfs_seamless",t[t.gfs_global=3]="gfs_global",t[t.gfs_hrrr=4]="gfs_hrrr",t[t.meteofrance_seamless=5]="meteofrance_seamless",t[t.meteofrance_arpege_seamless=6]="meteofrance_arpege_seamless",t[t.meteofrance_arpege_world=7]="meteofrance_arpege_world",t[t.meteofrance_arpege_europe=8]="meteofrance_arpege_europe",t[t.meteofrance_arome_seamless=9]="meteofrance_arome_seamless",t[t.meteofrance_arome_france=10]="meteofrance_arome_france",t[t.meteofrance_arome_france_hd=11]="meteofrance_arome_france_hd",t[t.jma_seamless=12]="jma_seamless",t[t.jma_msm=13]="jma_msm",t[t.jms_gsm=14]="jms_gsm",t[t.jma_gsm=15]="jma_gsm",t[t.gem_seamless=16]="gem_seamless",t[t.gem_global=17]="gem_global",t[t.gem_regional=18]="gem_regional",t[t.gem_hrdps_continental=19]="gem_hrdps_continental",t[t.icon_seamless=20]="icon_seamless",t[t.icon_global=21]="icon_global",t[t.icon_eu=22]="icon_eu",t[t.icon_d2=23]="icon_d2",t[t.ecmwf_ifs04=24]="ecmwf_ifs04",t[t.metno_nordic=25]="metno_nordic",t[t.era5_seamless=26]="era5_seamless",t[t.era5=27]="era5",t[t.cerra=28]="cerra",t[t.era5_land=29]="era5_land",t[t.ecmwf_ifs=30]="ecmwf_ifs",t[t.gwam=31]="gwam",t[t.ewam=32]="ewam",t[t.glofas_seamless_v3=33]="glofas_seamless_v3",t[t.glofas_forecast_v3=34]="glofas_forecast_v3",t[t.glofas_consolidated_v3=35]="glofas_consolidated_v3",t[t.glofas_seamless_v4=36]="glofas_seamless_v4",t[t.glofas_forecast_v4=37]="glofas_forecast_v4",t[t.glofas_consolidated_v4=38]="glofas_consolidated_v4",t[t.gfs025=39]="gfs025",t[t.gfs05=40]="gfs05",t[t.CMCC_CM2_VHR4=41]="CMCC_CM2_VHR4",t[t.FGOALS_f3_H_highresSST=42]="FGOALS_f3_H_highresSST",t[t.FGOALS_f3_H=43]="FGOALS_f3_H",t[t.HiRAM_SIT_HR=44]="HiRAM_SIT_HR",t[t.MRI_AGCM3_2_S=45]="MRI_AGCM3_2_S",t[t.EC_Earth3P_HR=46]="EC_Earth3P_HR",t[t.MPI_ESM1_2_XR=47]="MPI_ESM1_2_XR",t[t.NICAM16_8S=48]="NICAM16_8S",t[t.cams_europe=49]="cams_europe",t[t.cams_global=50]="cams_global",t[t.cfsv2=51]="cfsv2",t[t.era5_ocean=52]="era5_ocean",t[t.cma_grapes_global=53]="cma_grapes_global",t[t.bom_access_global=54]="bom_access_global",t[t.bom_access_global_ensemble=55]="bom_access_global_ensemble",t[t.arpae_cosmo_seamless=56]="arpae_cosmo_seamless",t[t.arpae_cosmo_2i=57]="arpae_cosmo_2i",t[t.arpae_cosmo_2i_ruc=58]="arpae_cosmo_2i_ruc",t[t.arpae_cosmo_5m=59]="arpae_cosmo_5m",t[t.ecmwf_ifs025=60]="ecmwf_ifs025",t[t.ecmwf_aifs025=61]="ecmwf_aifs025",t[t.gfs013=62]="gfs013",t[t.gfs_graphcast025=63]="gfs_graphcast025",t[t.ecmwf_wam025=64]="ecmwf_wam025",t[t.meteofrance_wave=65]="meteofrance_wave",t[t.meteofrance_currents=66]="meteofrance_currents"}(n||(e.Model=n={}))},2675:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Unit=void 0,function(t){t[t[void 0]=0]="undefined",t[t.celsius=1]="celsius",t[t.centimetre=2]="centimetre",t[t.cubic_metre_per_cubic_metre=3]="cubic_metre_per_cubic_metre",t[t.cubic_metre_per_second=4]="cubic_metre_per_second",t[t.degree_direction=5]="degree_direction",t[t.dimensionless_integer=6]="dimensionless_integer",t[t.dimensionless=7]="dimensionless",t[t.european_air_quality_index=8]="european_air_quality_index",t[t.fahrenheit=9]="fahrenheit",t[t.feet=10]="feet",t[t.fraction=11]="fraction",t[t.gdd_celsius=12]="gdd_celsius",t[t.geopotential_metre=13]="geopotential_metre",t[t.grains_per_cubic_metre=14]="grains_per_cubic_metre",t[t.gram_per_kilogram=15]="gram_per_kilogram",t[t.hectopascal=16]="hectopascal",t[t.hours=17]="hours",t[t.inch=18]="inch",t[t.iso8601=19]="iso8601",t[t.joule_per_kilogram=20]="joule_per_kilogram",t[t.kelvin=21]="kelvin",t[t.kilopascal=22]="kilopascal",t[t.kilogram_per_square_metre=23]="kilogram_per_square_metre",t[t.kilometres_per_hour=24]="kilometres_per_hour",t[t.knots=25]="knots",t[t.megajoule_per_square_metre=26]="megajoule_per_square_metre",t[t.metre_per_second_not_unit_converted=27]="metre_per_second_not_unit_converted",t[t.metre_per_second=28]="metre_per_second",t[t.metre=29]="metre",t[t.micrograms_per_cubic_metre=30]="micrograms_per_cubic_metre",t[t.miles_per_hour=31]="miles_per_hour",t[t.millimetre=32]="millimetre",t[t.pascal=33]="pascal",t[t.per_second=34]="per_second",t[t.percentage=35]="percentage",t[t.seconds=36]="seconds",t[t.unix_time=37]="unix_time",t[t.us_air_quality_index=38]="us_air_quality_index",t[t.watt_per_square_metre=39]="watt_per_square_metre",t[t.wmo_code=40]="wmo_code"}(n||(e.Unit=n={}))},666:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.VariableWithValues=void 0;const o=a(n(2162)),s=n(8978),l=n(2675),c=n(1458);class u{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsVariableWithValues(t,e){return(e||new u).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsVariableWithValues(t,e){return t.setPosition(t.position()+o.SIZE_PREFIX_LENGTH),(e||new u).__init(t.readInt32(t.position())+t.position(),t)}variable(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readUint8(this.bb_pos+t):c.Variable.undefined}unit(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):l.Unit.undefined}value(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb_pos+t):0}values(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readFloat32(this.bb.__vector(this.bb_pos+e)+4*t):0}valuesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}valuesArray(){const t=this.bb.__offset(this.bb_pos,10);return t?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}valuesInt64(t){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):BigInt(0)}valuesInt64Length(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}altitude(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readInt16(this.bb_pos+t):0}aggregation(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readUint8(this.bb_pos+t):s.Aggregation.none}pressureLevel(){const t=this.bb.__offset(this.bb_pos,18);return t?this.bb.readInt16(this.bb_pos+t):0}depth(){const t=this.bb.__offset(this.bb_pos,20);return t?this.bb.readInt16(this.bb_pos+t):0}depthTo(){const t=this.bb.__offset(this.bb_pos,22);return t?this.bb.readInt16(this.bb_pos+t):0}ensembleMember(){const t=this.bb.__offset(this.bb_pos,24);return t?this.bb.readInt16(this.bb_pos+t):0}previousDay(){const t=this.bb.__offset(this.bb_pos,26);return t?this.bb.readInt16(this.bb_pos+t):0}}e.VariableWithValues=u},1458:(t,e)=>{"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Variable=void 0,function(t){t[t[void 0]=0]="undefined",t[t.apparent_temperature=1]="apparent_temperature",t[t.cape=2]="cape",t[t.cloud_cover=3]="cloud_cover",t[t.cloud_cover_high=4]="cloud_cover_high",t[t.cloud_cover_low=5]="cloud_cover_low",t[t.cloud_cover_mid=6]="cloud_cover_mid",t[t.daylight_duration=7]="daylight_duration",t[t.dew_point=8]="dew_point",t[t.diffuse_radiation=9]="diffuse_radiation",t[t.diffuse_radiation_instant=10]="diffuse_radiation_instant",t[t.direct_normal_irradiance=11]="direct_normal_irradiance",t[t.direct_normal_irradiance_instant=12]="direct_normal_irradiance_instant",t[t.direct_radiation=13]="direct_radiation",t[t.direct_radiation_instant=14]="direct_radiation_instant",t[t.et0_fao_evapotranspiration=15]="et0_fao_evapotranspiration",t[t.evapotranspiration=16]="evapotranspiration",t[t.freezing_level_height=17]="freezing_level_height",t[t.growing_degree_days=18]="growing_degree_days",t[t.is_day=19]="is_day",t[t.latent_heat_flux=20]="latent_heat_flux",t[t.leaf_wetness_probability=21]="leaf_wetness_probability",t[t.lifted_index=22]="lifted_index",t[t.lightning_potential=23]="lightning_potential",t[t.precipitation=24]="precipitation",t[t.precipitation_hours=25]="precipitation_hours",t[t.precipitation_probability=26]="precipitation_probability",t[t.pressure_msl=27]="pressure_msl",t[t.rain=28]="rain",t[t.relative_humidity=29]="relative_humidity",t[t.runoff=30]="runoff",t[t.sensible_heat_flux=31]="sensible_heat_flux",t[t.shortwave_radiation=32]="shortwave_radiation",t[t.shortwave_radiation_instant=33]="shortwave_radiation_instant",t[t.showers=34]="showers",t[t.snow_depth=35]="snow_depth",t[t.snow_height=36]="snow_height",t[t.snowfall=37]="snowfall",t[t.snowfall_height=38]="snowfall_height",t[t.snowfall_water_equivalent=39]="snowfall_water_equivalent",t[t.sunrise=40]="sunrise",t[t.sunset=41]="sunset",t[t.soil_moisture=42]="soil_moisture",t[t.soil_moisture_index=43]="soil_moisture_index",t[t.soil_temperature=44]="soil_temperature",t[t.surface_pressure=45]="surface_pressure",t[t.surface_temperature=46]="surface_temperature",t[t.temperature=47]="temperature",t[t.terrestrial_radiation=48]="terrestrial_radiation",t[t.terrestrial_radiation_instant=49]="terrestrial_radiation_instant",t[t.total_column_integrated_water_vapour=50]="total_column_integrated_water_vapour",t[t.updraft=51]="updraft",t[t.uv_index=52]="uv_index",t[t.uv_index_clear_sky=53]="uv_index_clear_sky",t[t.vapour_pressure_deficit=54]="vapour_pressure_deficit",t[t.visibility=55]="visibility",t[t.weather_code=56]="weather_code",t[t.wind_direction=57]="wind_direction",t[t.wind_gusts=58]="wind_gusts",t[t.wind_speed=59]="wind_speed",t[t.vertical_velocity=60]="vertical_velocity",t[t.geopotential_height=61]="geopotential_height",t[t.wet_bulb_temperature=62]="wet_bulb_temperature",t[t.river_discharge=63]="river_discharge",t[t.wave_height=64]="wave_height",t[t.wave_period=65]="wave_period",t[t.wave_direction=66]="wave_direction",t[t.wind_wave_height=67]="wind_wave_height",t[t.wind_wave_period=68]="wind_wave_period",t[t.wind_wave_peak_period=69]="wind_wave_peak_period",t[t.wind_wave_direction=70]="wind_wave_direction",t[t.swell_wave_height=71]="swell_wave_height",t[t.swell_wave_period=72]="swell_wave_period",t[t.swell_wave_peak_period=73]="swell_wave_peak_period",t[t.swell_wave_direction=74]="swell_wave_direction",t[t.pm10=75]="pm10",t[t.pm2p5=76]="pm2p5",t[t.dust=77]="dust",t[t.aerosol_optical_depth=78]="aerosol_optical_depth",t[t.carbon_monoxide=79]="carbon_monoxide",t[t.nitrogen_dioxide=80]="nitrogen_dioxide",t[t.ammonia=81]="ammonia",t[t.ozone=82]="ozone",t[t.sulphur_dioxide=83]="sulphur_dioxide",t[t.alder_pollen=84]="alder_pollen",t[t.birch_pollen=85]="birch_pollen",t[t.grass_pollen=86]="grass_pollen",t[t.mugwort_pollen=87]="mugwort_pollen",t[t.olive_pollen=88]="olive_pollen",t[t.ragweed_pollen=89]="ragweed_pollen",t[t.european_aqi=90]="european_aqi",t[t.european_aqi_pm2p5=91]="european_aqi_pm2p5",t[t.european_aqi_pm10=92]="european_aqi_pm10",t[t.european_aqi_nitrogen_dioxide=93]="european_aqi_nitrogen_dioxide",t[t.european_aqi_ozone=94]="european_aqi_ozone",t[t.european_aqi_sulphur_dioxide=95]="european_aqi_sulphur_dioxide",t[t.us_aqi=96]="us_aqi",t[t.us_aqi_pm2p5=97]="us_aqi_pm2p5",t[t.us_aqi_pm10=98]="us_aqi_pm10",t[t.us_aqi_nitrogen_dioxide=99]="us_aqi_nitrogen_dioxide",t[t.us_aqi_ozone=100]="us_aqi_ozone",t[t.us_aqi_sulphur_dioxide=101]="us_aqi_sulphur_dioxide",t[t.us_aqi_carbon_monoxide=102]="us_aqi_carbon_monoxide",t[t.sunshine_duration=103]="sunshine_duration",t[t.convective_inhibition=104]="convective_inhibition",t[t.shortwave_radiation_clear_sky=105]="shortwave_radiation_clear_sky",t[t.global_tilted_irradiance=106]="global_tilted_irradiance",t[t.global_tilted_irradiance_instant=107]="global_tilted_irradiance_instant",t[t.ocean_current_velocity=108]="ocean_current_velocity",t[t.ocean_current_direction=109]="ocean_current_direction"}(n||(e.Variable=n={}))},7714:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.VariablesWithTime=void 0;const o=a(n(2162)),s=n(666);class l{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsVariablesWithTime(t,e){return(e||new l).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsVariablesWithTime(t,e){return t.setPosition(t.position()+o.SIZE_PREFIX_LENGTH),(e||new l).__init(t.readInt32(t.position())+t.position(),t)}time(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}timeEnd(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}interval(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):0}variables(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new s.VariableWithValues).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}variablesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}}e.VariablesWithTime=l},8513:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return r(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.WeatherApiResponse=void 0;const o=a(n(2162)),s=n(5289),l=n(7714);class c{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsWeatherApiResponse(t,e){return(e||new c).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsWeatherApiResponse(t,e){return t.setPosition(t.position()+o.SIZE_PREFIX_LENGTH),(e||new c).__init(t.readInt32(t.position())+t.position(),t)}latitude(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readFloat32(this.bb_pos+t):0}longitude(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readFloat32(this.bb_pos+t):0}elevation(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readFloat32(this.bb_pos+t):0}generationTimeMilliseconds(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readFloat32(this.bb_pos+t):0}locationId(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}model(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.readUint8(this.bb_pos+t):s.Model.undefined}utcOffsetSeconds(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.readInt32(this.bb_pos+t):0}timezone(t){const e=this.bb.__offset(this.bb_pos,18);return e?this.bb.__string(this.bb_pos+e,t):null}timezoneAbbreviation(t){const e=this.bb.__offset(this.bb_pos,20);return e?this.bb.__string(this.bb_pos+e,t):null}current(t){const e=this.bb.__offset(this.bb_pos,22);return e?(t||new l.VariablesWithTime).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}daily(t){const e=this.bb.__offset(this.bb_pos,24);return e?(t||new l.VariablesWithTime).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}hourly(t){const e=this.bb.__offset(this.bb_pos,26);return e?(t||new l.VariablesWithTime).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}minutely15(t){const e=this.bb.__offset(this.bb_pos,28);return e?(t||new l.VariablesWithTime).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}sixHourly(t){const e=this.bb.__offset(this.bb_pos,30);return e?(t||new l.VariablesWithTime).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}}e.WeatherApiResponse=c},2589:(t,e,n)=>{"use strict";n.d(e,{A:()=>Ot});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a),s=n(4417),l=n.n(s),c=new URL(n(7035),n.b),u=new URL(n(3470),n.b),h=new URL(n(8164),n.b),d=new URL(n(4665),n.b),p=new URL(n(4890),n.b),m=new URL(n(3363),n.b),f=new URL(n(3490),n.b),g=new URL(n(7603),n.b),v=new URL(n(3913),n.b),y=new URL(n(1413),n.b),_=new URL(n(4643),n.b),x=new URL(n(216),n.b),b=new URL(n(1907),n.b),A=new URL(n(8605),n.b),w=new URL(n(5446),n.b),C=new URL(n(6694),n.b),E=new URL(n(4420),n.b),S=new URL(n(5796),n.b),M=new URL(n(2228),n.b),T=new URL(n(9819),n.b),I=new URL(n(7695),n.b),B=new URL(n(8869),n.b),L=new URL(n(557),n.b),D=new URL(n(8460),n.b),P=new URL(n(6539),n.b),R=new URL(n(3737),n.b),k=new URL(n(7914),n.b),z=new URL(n(6117),n.b),F=new URL(n(6311),n.b),O=new URL(n(3754),n.b),N=new URL(n(8994),n.b),U=new URL(n(433),n.b),V=new URL(n(1323),n.b),G=new URL(n(3155),n.b),H=new URL(n(4170),n.b),j=new URL(n(1872),n.b),W=new URL(n(374),n.b),q=new URL(n(6054),n.b),Z=new URL(n(7528),n.b),$=new URL(n(7664),n.b),Y=new URL(n(3051),n.b),X=o()(r()),Q=l()(c),J=l()(u),K=l()(h),tt=l()(d),et=l()(p),nt=l()(m),it=l()(f),rt=l()(g),at=l()(v),ot=l()(y),st=l()(_),lt=l()(x),ct=l()(b),ut=l()(A),ht=l()(w),dt=l()(C),pt=l()(E),mt=l()(S),ft=l()(M),gt=l()(T),vt=l()(I),yt=l()(B),_t=l()(L),xt=l()(D),bt=l()(P),At=l()(R),wt=l()(k),Ct=l()(z),Et=l()(F),St=l()(O),Mt=l()(N),Tt=l()(U),It=l()(V),Bt=l()(G),Lt=l()(H),Dt=l()(j),Pt=l()(W),Rt=l()(q),kt=l()(Z),zt=l()($),Ft=l()(Y);X.push([t.id,`.maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${Q})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${J})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${K})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${tt})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(${et})}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(${nt})}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${it})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${rt})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${at})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${ot})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(${st})}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(${rt})}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${lt})}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${ct})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(${ut})}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(${ht})}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(${dt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${pt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${mt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${ft})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${gt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${vt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${yt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${_t})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${xt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(${ft})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(${gt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(${vt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(${yt})}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(${bt})}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(${At})}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(${wt});background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(${wt})}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url(${wt})}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(${Ct});border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${Et})}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(${Ct})}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:"";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}\n\n.mapboxgl-ctrl-group:not(:empty), .maplibregl-ctrl-group:not(:empty) {\n  box-shadow: 0 0 6px 2px rgb(0 0 0 / 8%);\n}\n\n\n.mapboxgl-ctrl-group, .maplibregl-ctrl-group {\n  background: #fff;\n  border-radius: 3px;\n}\n\n\n.mapboxgl-ctrl-group button:focus:first-child,.maplibregl-ctrl-group button:focus:first-child {\n  border-radius: 3px 3px 0 0;\n}\n\n.mapboxgl-ctrl-group button:focus:last-child,.maplibregl-ctrl-group button:focus:last-child {\n  border-radius: 0 0 3px 3px;\n}\n\n/* We do not want opacity to be lowered when buttons are disabled */\n.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {\n  opacity: 1;\n}\n\n/* Hovering adds a blue hue */\n.mapboxgl-ctrl .mapboxgl-ctrl-icon:hover,.maplibregl-ctrl .maplibregl-ctrl-icon:hover\n{\n  filter: invert(39%) sepia(77%) saturate(909%) hue-rotate(182deg) brightness(89%) contrast(85%);\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon\n{\n  background-image: url(${St});\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon\n{\n  background-image: url(${Mt});\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon\n{\n  /* Custom based on Google compass icon but without the circle */\n  background-image: url(${Tt});\n}\n\n\n.mapboxgl-ctrl-group button,.maplibregl-ctrl-group button\n{\n  height: 33px;\n  width: 33px;\n}\n\n\n.mapboxgl-ctrl-group button+button,.maplibregl-ctrl-group button+button\n{\n  border-top: 1px solid #0000001c;\n}\n\n\n@keyframes blinker {\n  50% {\n    opacity: 0.3;\n  }\n}\n\n/* Geolocate button: default button state before being clicked */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon\n{\n  background-image: url(${It});\n}\n\n\n/* Geolocate button: searching for location */\n.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {\n  animation: blinker 1s linear infinite;\n}\n\n/* Geolocate button: permission was not granted */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon\n{\n  background-image: url(${Bt});\n}\n\n/* Geolocate button: location is active */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon\n{\n  background-image: url(${Lt});\n}\n\n/* Geolocate button: an error occured */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon\n{\n  background-image: url(${Dt});\n}\n\n/* Geolocate button: searching location */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon\n{\n  background-image: url(${Pt});\n}\n\n/* Geolocate button: an error occured while searching */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon\n{\n  background-image: url(${Dt});\n}\n\n/* Terrain control icon (disabled, to enable) */\n.mapboxgl-ctrl button.mapboxgl-ctrl-terrain .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon\n{\n  background-image: url(${Rt});\n}\n\n/* Terrain control icon (enabled, to disable) */\n.mapboxgl-ctrl button.mapboxgl-ctrl-terrain-enabled .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon\n{\n  background-image: url(${kt});\n}\n\n/* Fullscreen control icon (disabled, to enable) */\n.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon \n{\n  background-image: url(${zt});\n}\n\n/* Fullscreen control icon (enabled, to disable) */\n.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {\n  background-image: url(${Ft});\n}\n\n.maplibregl-ctrl-scale {\n  background-color: hsla(0,0%,100%,.75);\n  border: 1px solid #444952;\n  border-top: #444952;\n  box-sizing: border-box;\n  color: #444952;\n  font-size: 10px;\n  padding: 0 5px;\n  text-align: right;\n  line-height: 14px;\n}`,"",{version:3,sources:["webpack://./node_modules/@maptiler/sdk/dist/maptiler-sdk.css"],names:[],mappings:"AAAA,gBAAgB,wDAAwD,CAAC,eAAe,CAAC,iBAAiB,CAAC,wCAAwC,CAAC,mBAAmB,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,2BAA2B,WAAW,CAAC,UAAU,CAAC,sDAAsD,iBAAiB,CAAC,0GAA0G,WAAW,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,6EAA6E,cAAc,CAAC,wHAAwH,eAAe,CAAC,uIAAuI,wBAAwB,CAAC,iIAAiI,uBAAuB,CAAC,2LAA2L,iBAAiB,CAAC,iMAAiM,wBAAwB,CAAC,gHAAgH,mBAAmB,CAAC,iBAAiB,CAAC,SAAS,CAAC,0BAA0B,MAAM,CAAC,KAAK,CAAC,2BAA2B,OAAO,CAAC,KAAK,CAAC,6BAA6B,QAAQ,CAAC,MAAM,CAAC,8BAA8B,QAAQ,CAAC,OAAO,CAAC,iBAAiB,UAAU,CAAC,mBAAmB,CAAC,sBAAsB,CAAC,2CAA2C,UAAU,CAAC,oBAAoB,CAAC,4CAA4C,WAAW,CAAC,oBAAoB,CAAC,8CAA8C,UAAU,CAAC,oBAAoB,CAAC,+CAA+C,WAAW,CAAC,oBAAoB,CAAC,uBAAuB,eAAe,CAAC,iBAAiB,CAAC,mCAAmC,mCAAmC,CAAC,8BAA8B,mCAAmC,+BAA+B,CAAC,CAAC,8BAA8B,4BAA4B,CAAC,QAAQ,CAAC,qBAAqB,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU,CAAC,qCAAqC,yBAAyB,CAAC,8CAA8C,uBAAuB,CAAC,2BAA2B,CAAC,aAAa,CAAC,WAAW,CAAC,UAAU,CAAC,8BAA8B,sBAAsB,4BAA4B,CAAC,qCAAqC,+BAA+B,CAAC,CAAC,0CAA0C,QAAQ,CAAC,SAAS,CAAC,yEAAyE,8BAA8B,CAAC,iCAAiC,kBAAkB,CAAC,uDAAuD,WAAW,CAAC,6CAA6C,8BAA8B,CAAC,kDAAkD,8BAA8B,CAAC,wDAAwD,eAAe,CAAC,gDAAgD,yBAAyB,CAAC,+CAA+C,yBAAyB,CAAC,+CAA+C,qBAAqB,CAAC,uEAAuE,wDAA0Q,CAAC,sEAAsE,wDAA8W,CAAC,8BAA8B,uEAAuE,wDAA0Q,CAAC,sEAAsE,wDAA8W,CAAC,CAAC,+DAA+D,uEAAuE,wDAA4P,CAAC,sEAAsE,wDAAgW,CAAC,CAAC,yEAAyE,wDAA8b,CAAC,qEAAqE,wDAAgb,CAAC,8BAA8B,yEAAyE,wDAA8b,CAAC,qEAAqE,wDAA8b,CAAC,CAAC,+DAA+D,yEAAyE,yDAAgb,CAAC,qEAAqE,wDAAgb,CAAC,CAAC,sEAAsE,yDAAwP,CAAC,8BAA8B,sEAAsE,yDAAwP,CAAC,CAAC,+DAA+D,sEAAsE,yDAA0O,CAAC,CAAC,sEAAsE,yDAAuX,CAAC,8EAA8E,yDAA0X,CAAC,wEAAwE,yDAA2a,CAAC,iFAAiF,yDAAwd,CAAC,yGAAyG,yDAA8a,CAAC,+GAA+G,yDAA8a,CAAC,6GAA6G,yDAA2Y,CAAC,mHAAmH,yDAA2Y,CAAC,0GAA0G,4CAA4C,CAAC,8BAA8B,wEAAwE,yDAA2a,CAAC,iFAAiF,yDAAwd,CAAC,yGAAyG,yDAA8a,CAAC,+GAA+G,yDAA8a,CAAC,6GAA6G,yDAA2Y,CAAC,mHAAmH,yDAA2Y,CAAC,CAAC,+DAA+D,wEAAwE,yDAA6Z,CAAC,iFAAiF,yDAAwd,CAAC,CAAC,2BAA2B,GAAG,sBAAsB,CAAC,GAAG,uBAAuB,CAAC,CAAC,uBAAuB,yDAAkiZ,CAAC,2BAA2B,CAAC,cAAc,CAAC,aAAa,CAAC,WAAW,CAAC,oBAAoB,CAAC,eAAe,CAAC,UAAU,CAAC,0CAA0C,UAAU,CAAC,8BAA8B,uBAAuB,4BAA4B,CAAC,yDAAkiZ,CAAC,CAAC,+DAA+D,uBAAuB,yDAAkiZ,CAAC,CAAC,wCAAwC,mCAAmC,CAAC,QAAQ,CAAC,aAAa,CAAC,cAAc,2CAA2C,qBAAqB,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,UAAU,CAAC,WAAW,CAAC,eAAe,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,gDAAgD,wBAAwB,CAAC,kBAAkB,CAAC,uJAAuJ,kBAAkB,CAAC,wBAAwB,CAAC,yEAAyE,YAAY,CAAC,+BAA+B,mCAAmC,CAAC,yDAAmS,CAAC,QAAQ,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,cAAc,CAAC,YAAY,CAAC,WAAW,CAAC,YAAY,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,8DAA8D,uBAAuB,CAAC,oBAAoB,CAAC,eAAe,CAAC,eAAe,CAAC,sFAAsF,YAAY,CAAC,qHAAqH,MAAM,CAAC,wJAAwJ,aAAa,CAAC,+EAA+E,8BAA8B,CAAC,+EAA+E,QAAQ,CAAC,OAAO,CAAC,4EAA4E,OAAO,CAAC,KAAK,CAAC,2EAA2E,MAAM,CAAC,KAAK,CAAC,8EAA8E,QAAQ,CAAC,MAAM,CAAC,CAAC,yCAAyC,iDAAiD,yDAAiT,CAAC,CAAC,0EAA0E,iDAAiD,yDAAmS,CAAC,CAAC,0BAA0B,qBAAqB,CAAC,oBAAoB,CAAC,gCAAgC,aAAa,CAAC,yBAAyB,CAAC,yBAAyB,YAAY,CAAC,uBAAuB,oCAAoC,CAAC,qBAAqB,CAAC,eAAe,CAAC,qBAAqB,CAAC,UAAU,CAAC,cAAc,CAAC,aAAa,CAAC,kBAAkB,YAAY,CAAC,MAAM,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,qBAAqB,CAAC,kGAAkG,qBAAqB,CAAC,2GAA2G,6BAA6B,CAAC,8BAA8B,kBAAkB,CAAC,+BAA+B,0BAA0B,CAAC,sBAAsB,6BAA6B,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,mDAAmD,iBAAiB,CAAC,wBAAwB,CAAC,eAAe,CAAC,wDAAwD,qBAAqB,CAAC,wBAAwB,CAAC,gBAAgB,CAAC,eAAe,CAAC,yDAAyD,mBAAmB,CAAC,wBAAwB,CAAC,iBAAiB,CAAC,eAAe,CAAC,sDAAsD,iBAAiB,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,2DAA2D,qBAAqB,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,4DAA4D,mBAAmB,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,qBAAqB,CAAC,oDAAoD,iBAAiB,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,qDAAqD,iBAAiB,CAAC,sBAAsB,CAAC,iBAAiB,CAAC,+BAA+B,4BAA4B,CAAC,QAAQ,CAAC,uBAAuB,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,KAAK,CAAC,qCAAqC,8BAA8B,CAAC,0BAA0B,eAAe,CAAC,iBAAiB,CAAC,mCAAmC,CAAC,iBAAiB,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,4DAA4D,wBAAwB,CAAC,6DAA6D,yBAAyB,CAAC,+DAA+D,2BAA2B,CAAC,gEAAgE,4BAA4B,CAAC,gCAAgC,YAAY,CAAC,kCAAkC,mBAAmB,CAAC,wBAAwB,CAAC,qBAAqB,CAAC,gBAAgB,CAAC,sDAAsD,YAAY,CAAC,uDAAuD,YAAY,CAAC,mBAAmB,MAAM,CAAC,iBAAiB,CAAC,KAAK,CAAC,sBAAsB,CAAC,qBAAqB,CAAC,mEAAmE,wBAAwB,CAAC,iBAAiB,CAAC,WAAW,CAAC,UAAU,CAAC,qCAAqC,wDAAwD,CAAC,UAAU,CAAC,iBAAiB,CAAC,oCAAoC,qBAAqB,CAAC,iBAAiB,CAAC,kCAAkC,CAAC,qBAAqB,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,QAAQ,CAAC,UAAU,CAAC,8CAA8C,GAAG,SAAS,CAAC,kBAAkB,CAAC,IAAI,SAAS,CAAC,kBAAkB,CAAC,GAAG,SAAS,CAAC,kBAAkB,CAAC,CAAC,oCAAoC,qBAAqB,CAAC,0CAA0C,YAAY,CAAC,0CAA0C,0BAA0B,CAAC,kBAAkB,CAAC,UAAU,CAAC,SAAS,CAAC,yHAAyH,gBAAgB,CAAC,oBAAoB,eAAe,CAAC,yBAAyB,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,uCAAuC,kBAAkB,CAAC,yBAAyB,CAAC,UAAU,CAAC,YAAY,CAAC,eAAe,CAAC,OAAO,CAAC,sBAAsB,CAAC,eAAe,CAAC,SAAS,CAAC,YAAY,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,6BAA6B,CAAC,aAAa,CAAC,uDAAuD,SAAS,CAAC,uBAAuB,CAAC,kEAAkE,YAAY,CAAC,qCAAqC,mEAAmE,YAAY,CAAC,kEAAkE,aAAa,CAAC,CAAC,8BAA8B,qBAAqB,CAAC,gBAAgB,CAAC,wBAAwB,CAAC,eAAe,CAAC,oBAAoB,CAAC,aAAa;;AAE7//D;EACE,uCAAuC;AACzC;;;AAGA;EACE,gBAAgB;EAChB,kBAAkB;AACpB;;;AAGA;EACE,0BAA0B;AAC5B;;AAEA;EACE,0BAA0B;AAC5B;;AAEA,mEAAmE;AACnE;EACE,UAAU;AACZ;;AAEA,6BAA6B;AAC7B;;EAEE,8FAA8F;AAChG;;;AAGA;;EAEE,0DAAoxD;AACtxD;;;AAGA;;EAEE,0DAA01C;AAC51C;;;AAGA;;EAEE,+DAA+D;EAC/D,0DAAspD;AACxpD;;;AAGA;;EAEE,YAAY;EACZ,WAAW;AACb;;;AAGA;;EAEE,+BAA+B;AACjC;;;AAGA;EACE;IACE,YAAY;EACd;AACF;;AAEA,gEAAgE;AAChE;;EAEE,0DAA4nD;AAC9nD;;;AAGA,6CAA6C;AAC7C;EACE,qCAAqC;AACvC;;AAEA,iDAAiD;AACjD;;EAEE,0DAAy6D;AAC36D;;AAEA,yCAAyC;AACzC;;EAEE,0DAAgkD;AAClkD;;AAEA,uCAAuC;AACvC;;EAEE,0DAA62D;AAC/2D;;AAEA,yCAAyC;AACzC;;EAEE,0DAAuzD;AACzzD;;AAEA,uDAAuD;AACvD;;EAEE,0DAA62D;AAC/2D;;AAEA,+CAA+C;AAC/C;;EAEE,0DAAkjD;AACpjD;;AAEA,+CAA+C;AAC/C;;EAEE,0DAAslD;AACxlD;;AAEA,kDAAkD;AAClD;;EAEE,0DAA8zH;AACh0H;;AAEA,kDAAkD;AAClD;EACE,0DAAg+H;AACl+H;;AAEA;EACE,qCAAqC;EACrC,yBAAyB;EACzB,mBAAmB;EACnB,sBAAsB;EACtB,cAAc;EACd,eAAe;EACf,cAAc;EACd,iBAAiB;EACjB,iBAAiB;AACnB",sourcesContent:[".maplibregl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgb(0 0 0/0)}.maplibregl-canvas{left:0;position:absolute;top:0}.maplibregl-map:fullscreen{height:100%;width:100%}.maplibregl-ctrl-group button.maplibregl-ctrl-compass{touch-action:none}.maplibregl-canvas-container.maplibregl-interactive,.maplibregl-ctrl-group button.maplibregl-ctrl-compass{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-canvas-container.maplibregl-interactive.maplibregl-track-pointer{cursor:pointer}.maplibregl-canvas-container.maplibregl-interactive:active,.maplibregl-ctrl-group button.maplibregl-ctrl-compass:active{cursor:grabbing}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-canvas-container.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:pinch-zoom}.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan,.maplibregl-canvas-container.maplibregl-touch-zoom-rotate.maplibregl-touch-drag-pan .maplibregl-canvas{touch-action:none}.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures,.maplibregl-canvas-container.maplibregl-touch-drag-pan.maplibregl-cooperative-gestures .maplibregl-canvas{touch-action:pan-x pan-y}.maplibregl-ctrl-bottom-left,.maplibregl-ctrl-bottom-right,.maplibregl-ctrl-top-left,.maplibregl-ctrl-top-right{pointer-events:none;position:absolute;z-index:2}.maplibregl-ctrl-top-left{left:0;top:0}.maplibregl-ctrl-top-right{right:0;top:0}.maplibregl-ctrl-bottom-left{bottom:0;left:0}.maplibregl-ctrl-bottom-right{bottom:0;right:0}.maplibregl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.maplibregl-ctrl-top-left .maplibregl-ctrl{float:left;margin:10px 0 0 10px}.maplibregl-ctrl-top-right .maplibregl-ctrl{float:right;margin:10px 10px 0 0}.maplibregl-ctrl-bottom-left .maplibregl-ctrl{float:left;margin:0 0 10px 10px}.maplibregl-ctrl-bottom-right .maplibregl-ctrl{float:right;margin:0 10px 10px 0}.maplibregl-ctrl-group{background:#fff;border-radius:4px}.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (forced-colors:active){.maplibregl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.maplibregl-ctrl-group button{background-color:transparent;border:0;box-sizing:border-box;cursor:pointer;display:block;height:29px;outline:none;padding:0;width:29px}.maplibregl-ctrl-group button+button{border-top:1px solid #ddd}.maplibregl-ctrl button .maplibregl-ctrl-icon{background-position:50%;background-repeat:no-repeat;display:block;height:100%;width:100%}@media (forced-colors:active){.maplibregl-ctrl-icon{background-color:transparent}.maplibregl-ctrl-group button+button{border-top:1px solid ButtonText}}.maplibregl-ctrl button::-moz-focus-inner{border:0;padding:0}.maplibregl-ctrl-attrib-button:focus,.maplibregl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl button:disabled{cursor:not-allowed}.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon{opacity:.25}.maplibregl-ctrl button:not(:disabled):hover{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.maplibregl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.maplibregl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.maplibregl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.maplibregl-ctrl-group button:focus:only-child{border-radius:inherit}.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 29 29'%3E%3Cpath d='m10.5 14 4-8 4 8z'/%3E%3Cpath fill='%23ccc' d='m10.5 16 4 8 4-8z'/%3E%3C/svg%3E\")}}.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%23333' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' fill='%2333b5e5' viewBox='0 0 22 22'%3E%3Cpath d='m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23333' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23aaa' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon{animation:maplibregl-spin 2s linear infinite}@media (forced-colors:active){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23fff' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23999' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e58978' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%2333b5e5' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23e54e33' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='29' height='29' fill='%23666' viewBox='0 0 20 20'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath fill='red' d='m14 5 1 1-9 9-1-1z'/%3E%3C/svg%3E\")}}@keyframes maplibregl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\");background-repeat:no-repeat;cursor:pointer;display:block;height:23px;margin:0 0 -4px -4px;overflow:hidden;width:88px}a.maplibregl-ctrl-logo.maplibregl-compact{width:14px}@media (forced-colors:active){a.maplibregl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}@media (forced-colors:active) and (prefers-color-scheme:light){a.maplibregl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='88' height='23' fill='none'%3E%3Cpath fill='%23000' fill-opacity='.4' fill-rule='evenodd' d='M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z'/%3E%3Cpath fill='%23fff' d='m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z'/%3E%3Cpath fill='%23e1e3e9' d='M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z'/%3E%3Cpath d='M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z' style='fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001'/%3E%3Cg style='stroke-width:1.12603545'%3E%3Cpath d='M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668' style='color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3' style='clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3Cpath d='M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z' style='clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4' transform='translate(15.553 2.85)scale(.88807)'/%3E%3C/g%3E%3C/svg%3E\")}}.maplibregl-ctrl.maplibregl-ctrl-attrib{background-color:hsla(0,0%,100%,.5);margin:0;padding:0 5px}@media screen{.maplibregl-ctrl-attrib.maplibregl-compact{background-color:#fff;border-radius:12px;box-sizing:content-box;color:#000;margin:10px;min-height:20px;padding:2px 24px 2px 0;position:relative}.maplibregl-ctrl-attrib.maplibregl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact-show,.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact-show{border-radius:12px;padding:2px 8px 2px 28px}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-inner{display:none}.maplibregl-ctrl-attrib-button{background-color:hsla(0,0%,100%,.5);background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\");border:0;border-radius:12px;box-sizing:border-box;cursor:pointer;display:none;height:24px;outline:none;position:absolute;right:0;top:0;width:24px}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;list-style:none}.maplibregl-ctrl-attrib summary.maplibregl-ctrl-attrib-button::-webkit-details-marker{display:none}.maplibregl-ctrl-bottom-left .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-top-left .maplibregl-ctrl-attrib-button{left:0}.maplibregl-ctrl-attrib.maplibregl-compact .maplibregl-ctrl-attrib-button,.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-inner{display:block}.maplibregl-ctrl-attrib.maplibregl-compact-show .maplibregl-ctrl-attrib-button{background-color:rgb(0 0 0/5%)}.maplibregl-ctrl-bottom-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;right:0}.maplibregl-ctrl-top-right>.maplibregl-ctrl-attrib.maplibregl-compact:after{right:0;top:0}.maplibregl-ctrl-top-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{left:0;top:0}.maplibregl-ctrl-bottom-left>.maplibregl-ctrl-attrib.maplibregl-compact:after{bottom:0;left:0}}@media screen and (forced-colors:active){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23fff' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}@media screen and (forced-colors:active) and (prefers-color-scheme:light){.maplibregl-ctrl-attrib.maplibregl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill-rule='evenodd' viewBox='0 0 20 20'%3E%3Cpath d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/%3E%3C/svg%3E\")}}.maplibregl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.maplibregl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.maplibregl-attrib-empty{display:none}.maplibregl-ctrl-scale{background-color:hsla(0,0%,100%,.75);border:2px solid #333;border-top:#333;box-sizing:border-box;color:#333;font-size:10px;padding:0 5px}.maplibregl-popup{display:flex;left:0;pointer-events:none;position:absolute;top:0;will-change:transform}.maplibregl-popup-anchor-top,.maplibregl-popup-anchor-top-left,.maplibregl-popup-anchor-top-right{flex-direction:column}.maplibregl-popup-anchor-bottom,.maplibregl-popup-anchor-bottom-left,.maplibregl-popup-anchor-bottom-right{flex-direction:column-reverse}.maplibregl-popup-anchor-left{flex-direction:row}.maplibregl-popup-anchor-right{flex-direction:row-reverse}.maplibregl-popup-tip{border:10px solid transparent;height:0;width:0;z-index:1}.maplibregl-popup-anchor-top .maplibregl-popup-tip{align-self:center;border-bottom-color:#fff;border-top:none}.maplibregl-popup-anchor-top-left .maplibregl-popup-tip{align-self:flex-start;border-bottom-color:#fff;border-left:none;border-top:none}.maplibregl-popup-anchor-top-right .maplibregl-popup-tip{align-self:flex-end;border-bottom-color:#fff;border-right:none;border-top:none}.maplibregl-popup-anchor-bottom .maplibregl-popup-tip{align-self:center;border-bottom:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-tip{align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-tip{align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.maplibregl-popup-anchor-left .maplibregl-popup-tip{align-self:center;border-left:none;border-right-color:#fff}.maplibregl-popup-anchor-right .maplibregl-popup-tip{align-self:center;border-left-color:#fff;border-right:none}.maplibregl-popup-close-button{background-color:transparent;border:0;border-radius:0 3px 0 0;cursor:pointer;position:absolute;right:0;top:0}.maplibregl-popup-close-button:hover{background-color:rgb(0 0 0/5%)}.maplibregl-popup-content{background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:15px 10px;pointer-events:auto;position:relative}.maplibregl-popup-anchor-top-left .maplibregl-popup-content{border-top-left-radius:0}.maplibregl-popup-anchor-top-right .maplibregl-popup-content{border-top-right-radius:0}.maplibregl-popup-anchor-bottom-left .maplibregl-popup-content{border-bottom-left-radius:0}.maplibregl-popup-anchor-bottom-right .maplibregl-popup-content{border-bottom-right-radius:0}.maplibregl-popup-track-pointer{display:none}.maplibregl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.maplibregl-map:hover .maplibregl-popup-track-pointer{display:flex}.maplibregl-map:active .maplibregl-popup-track-pointer{display:none}.maplibregl-marker{left:0;position:absolute;top:0;transition:opacity .2s;will-change:transform}.maplibregl-user-location-dot,.maplibregl-user-location-dot:before{background-color:#1da1f2;border-radius:50%;height:15px;width:15px}.maplibregl-user-location-dot:before{animation:maplibregl-user-location-dot-pulse 2s infinite;content:\"\";position:absolute}.maplibregl-user-location-dot:after{border:2px solid #fff;border-radius:50%;box-shadow:0 0 3px rgba(0,0,0,.35);box-sizing:border-box;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px}@keyframes maplibregl-user-location-dot-pulse{0%{opacity:1;transform:scale(1)}70%{opacity:0;transform:scale(3)}to{opacity:0;transform:scale(1)}}.maplibregl-user-location-dot-stale{background-color:#aaa}.maplibregl-user-location-dot-stale:after{display:none}.maplibregl-user-location-accuracy-circle{background-color:#1da1f233;border-radius:100%;height:1px;width:1px}.maplibregl-crosshair,.maplibregl-crosshair .maplibregl-interactive,.maplibregl-crosshair .maplibregl-interactive:active{cursor:crosshair}.maplibregl-boxzoom{background:#fff;border:2px dotted #202020;height:0;left:0;opacity:.5;position:absolute;top:0;width:0}.maplibregl-cooperative-gesture-screen{align-items:center;background:rgba(0,0,0,.4);color:#fff;display:flex;font-size:1.4em;inset:0;justify-content:center;line-height:1.2;opacity:0;padding:1rem;pointer-events:none;position:absolute;transition:opacity 1s ease 1s;z-index:99999}.maplibregl-cooperative-gesture-screen.maplibregl-show{opacity:1;transition:opacity .05s}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:none}@media (hover:none),(width <= 480px){.maplibregl-cooperative-gesture-screen .maplibregl-desktop-message{display:none}.maplibregl-cooperative-gesture-screen .maplibregl-mobile-message{display:block}}.maplibregl-pseudo-fullscreen{height:100%!important;left:0!important;position:fixed!important;top:0!important;width:100%!important;z-index:99999}\n\n.mapboxgl-ctrl-group:not(:empty), .maplibregl-ctrl-group:not(:empty) {\n  box-shadow: 0 0 6px 2px rgb(0 0 0 / 8%);\n}\n\n\n.mapboxgl-ctrl-group, .maplibregl-ctrl-group {\n  background: #fff;\n  border-radius: 3px;\n}\n\n\n.mapboxgl-ctrl-group button:focus:first-child,.maplibregl-ctrl-group button:focus:first-child {\n  border-radius: 3px 3px 0 0;\n}\n\n.mapboxgl-ctrl-group button:focus:last-child,.maplibregl-ctrl-group button:focus:last-child {\n  border-radius: 0 0 3px 3px;\n}\n\n/* We do not want opacity to be lowered when buttons are disabled */\n.maplibregl-ctrl button:disabled .maplibregl-ctrl-icon {\n  opacity: 1;\n}\n\n/* Hovering adds a blue hue */\n.mapboxgl-ctrl .mapboxgl-ctrl-icon:hover,.maplibregl-ctrl .maplibregl-ctrl-icon:hover\n{\n  filter: invert(39%) sepia(77%) saturate(909%) hue-rotate(182deg) brightness(89%) contrast(85%);\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-zoom-in .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.5%2C9.25)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M7%2C13.75C6.737%2C13.75%206.509%2C13.653%206.315%2C13.46C6.122%2C13.266%206.025%2C13.038%206.025%2C12.775L6.025%2C8.225L1.475%2C8.225C1.212%2C8.225%200.984%2C8.128%200.79%2C7.935C0.597%2C7.741%200.5%2C7.513%200.5%2C7.25C0.5%2C6.987%200.597%2C6.759%200.79%2C6.565C0.984%2C6.372%201.212%2C6.275%201.475%2C6.275L6.025%2C6.275L6.025%2C1.725C6.025%2C1.462%206.122%2C1.234%206.315%2C1.04C6.509%2C0.847%206.737%2C0.75%207%2C0.75C7.263%2C0.75%207.491%2C0.847%207.685%2C1.04C7.878%2C1.234%207.975%2C1.462%207.975%2C1.725L7.975%2C6.275L12.525%2C6.275C12.788%2C6.275%2013.016%2C6.372%2013.21%2C6.565C13.403%2C6.759%2013.5%2C6.987%2013.5%2C7.25C13.5%2C7.513%2013.403%2C7.741%2013.21%2C7.935C13.016%2C8.128%2012.788%2C8.225%2012.525%2C8.225L7.975%2C8.225L7.975%2C12.775C7.975%2C13.038%207.878%2C13.266%207.685%2C13.46C7.491%2C13.653%207.263%2C13.75%207%2C13.75Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-zoom-out .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.5%2C15.25)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.475%2C2.225C1.212%2C2.225%200.984%2C2.128%200.79%2C1.935C0.597%2C1.741%200.5%2C1.513%200.5%2C1.25C0.5%2C0.987%200.597%2C0.759%200.79%2C0.566C0.984%2C0.372%201.212%2C0.275%201.475%2C0.275L12.525%2C0.275C12.788%2C0.275%2013.016%2C0.372%2013.21%2C0.566C13.403%2C0.759%2013.5%2C0.987%2013.5%2C1.25C13.5%2C1.513%2013.403%2C1.741%2013.21%2C1.935C13.016%2C2.128%2012.788%2C2.225%2012.525%2C2.225L1.475%2C2.225Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n\n.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon\n{\n  /* Custom based on Google compass icon but without the circle */\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C-3.24298%2C2.63257)%22%3E%0A%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22matrix(1.20712%2C0%2C0%2C1.20712%2C14.9145%2C2.51292)%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M2.5%2C9.406L0%2C9.406L4%2C17.875L8%2C9.406L5.5%2C9.406C5.483%2C10.22%204.818%2C10.875%204%2C10.875C3.182%2C10.875%202.517%2C10.22%202.5%2C9.406Z%22%20style%3D%22fill%3Argb(29%2C50%2C98)%3Bfill-opacity%3A0.35%3B%22%2F%3E%0A%20%20%20%20%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22matrix(1.20712%2C0%2C0%2C1.20712%2C14.9145%2C2.51292)%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M4%2C0.938L0%2C9.406L2.5%2C9.406L2.5%2C9.375C2.5%2C8.547%203.172%2C7.875%204%2C7.875C4.828%2C7.875%205.5%2C8.547%205.5%2C9.375L5.5%2C9.406L8%2C9.406L4%2C0.938Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3B%22%2F%3E%0A%20%20%20%20%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n\n.mapboxgl-ctrl-group button,.maplibregl-ctrl-group button\n{\n  height: 33px;\n  width: 33px;\n}\n\n\n.mapboxgl-ctrl-group button+button,.maplibregl-ctrl-group button+button\n{\n  border-top: 1px solid #0000001c;\n}\n\n\n@keyframes blinker {\n  50% {\n    opacity: 0.3;\n  }\n}\n\n/* Geolocate button: default button state before being clicked */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C9.25)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n\n/* Geolocate button: searching for location */\n.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-waiting .maplibregl-ctrl-icon {\n  animation: blinker 1s linear infinite;\n}\n\n/* Geolocate button: permission was not granted */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate:disabled .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C9.25)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(0.598546%2C0.598546%2C-0.707107%2C0.707107%2C11.7313%2C1.9674)%22%3E%0A%20%20%20%20%20%20%20%20%3Crect%20x%3D%226.516%22%20y%3D%223.78%22%20width%3D%2219.271%22%20height%3D%220.716%22%20style%3D%22fill%3Argb(229%2C0%2C0)%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Geolocate button: location is active */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C8.89492)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.932L0.567%2C6.865C0.391%2C6.798%200.253%2C6.69%200.152%2C6.541C0.051%2C6.392%200%2C6.223%200%2C6.035C0%2C5.846%200.051%2C5.68%200.152%2C5.538C0.253%2C5.396%200.391%2C5.291%200.567%2C5.224L12.846%2C0.665C13.021%2C0.597%2013.187%2C0.587%2013.343%2C0.634C13.498%2C0.682%2013.629%2C0.759%2013.738%2C0.868C13.846%2C0.976%2013.924%2C1.107%2013.971%2C1.262C14.018%2C1.418%2014.008%2C1.584%2013.94%2C1.759L9.381%2C14.059C9.3%2C14.247%209.186%2C14.386%209.037%2C14.474C8.888%2C14.561%208.732%2C14.605%208.57%2C14.605C8.408%2C14.605%208.253%2C14.558%208.104%2C14.463C7.956%2C14.368%207.841%2C14.233%207.76%2C14.059L5.673%2C8.932Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Geolocate button: an error occured */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-active-error .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C8.89492)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.932L0.567%2C6.865C0.391%2C6.798%200.253%2C6.69%200.152%2C6.541C0.051%2C6.392%200%2C6.223%200%2C6.035C0%2C5.846%200.051%2C5.68%200.152%2C5.538C0.253%2C5.396%200.391%2C5.291%200.567%2C5.224L12.846%2C0.665C13.021%2C0.597%2013.187%2C0.587%2013.343%2C0.634C13.498%2C0.682%2013.629%2C0.759%2013.738%2C0.868C13.846%2C0.976%2013.924%2C1.107%2013.971%2C1.262C14.018%2C1.418%2014.008%2C1.584%2013.94%2C1.759L9.381%2C14.059C9.3%2C14.247%209.186%2C14.386%209.037%2C14.474C8.888%2C14.561%208.732%2C14.605%208.57%2C14.605C8.408%2C14.605%208.253%2C14.558%208.104%2C14.463C7.956%2C14.368%207.841%2C14.233%207.76%2C14.059L5.673%2C8.932Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(0.598546%2C0.598546%2C-0.707107%2C0.707107%2C11.7313%2C1.9674)%22%3E%0A%20%20%20%20%20%20%20%20%3Crect%20x%3D%226.516%22%20y%3D%223.78%22%20width%3D%2219.271%22%20height%3D%220.716%22%20style%3D%22fill%3Argb(229%2C0%2C0)%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Geolocate button: searching location */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M10.685%2C14.817L22.511%2C10.669L18.217%2C22.082L15.824%2C17.233L10.685%2C14.817Z%22%20style%3D%22fill%3Argb(29%2C50%2C98)%3Bfill-opacity%3A0.2%3B%22%2F%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C9.25)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Geolocate button: an error occured while searching */\n.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-geolocate.maplibregl-ctrl-geolocate-background-error .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9.50001%2C8.89492)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.932L0.567%2C6.865C0.391%2C6.798%200.253%2C6.69%200.152%2C6.541C0.051%2C6.392%200%2C6.223%200%2C6.035C0%2C5.846%200.051%2C5.68%200.152%2C5.538C0.253%2C5.396%200.391%2C5.291%200.567%2C5.224L12.846%2C0.665C13.021%2C0.597%2013.187%2C0.587%2013.343%2C0.634C13.498%2C0.682%2013.629%2C0.759%2013.738%2C0.868C13.846%2C0.976%2013.924%2C1.107%2013.971%2C1.262C14.018%2C1.418%2014.008%2C1.584%2013.94%2C1.759L9.381%2C14.059C9.3%2C14.247%209.186%2C14.386%209.037%2C14.474C8.888%2C14.561%208.732%2C14.605%208.57%2C14.605C8.408%2C14.605%208.253%2C14.558%208.104%2C14.463C7.956%2C14.368%207.841%2C14.233%207.76%2C14.059L5.673%2C8.932Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(0.598546%2C0.598546%2C-0.707107%2C0.707107%2C11.7313%2C1.9674)%22%3E%0A%20%20%20%20%20%20%20%20%3Crect%20x%3D%226.516%22%20y%3D%223.78%22%20width%3D%2219.271%22%20height%3D%220.716%22%20style%3D%22fill%3Argb(229%2C0%2C0)%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Terrain control icon (disabled, to enable) */\n.mapboxgl-ctrl button.mapboxgl-ctrl-terrain .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C8.00023%2C11)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.083%2C10.209C0.722%2C10.209%200.458%2C10.049%200.292%2C9.73C0.125%2C9.41%200.153%2C9.105%200.375%2C8.813L3.625%2C4.48C3.805%2C4.244%204.041%2C4.126%204.333%2C4.126C4.625%2C4.126%204.861%2C4.244%205.042%2C4.48L8.021%2C8.459L14.167%2C8.459L10.167%2C3.147L8.188%2C5.751L7.104%2C4.313L9.458%2C1.147C9.638%2C0.91%209.875%2C0.792%2010.167%2C0.792C10.458%2C0.792%2010.694%2C0.91%2010.875%2C1.147L16.625%2C8.813C16.847%2C9.105%2016.874%2C9.41%2016.708%2C9.73C16.541%2C10.049%2016.277%2C10.209%2015.917%2C10.209L1.083%2C10.209ZM2.833%2C8.459L5.833%2C8.459L4.333%2C6.459L2.833%2C8.459ZM2.833%2C8.459L5.833%2C8.459L2.833%2C8.459Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Terrain control icon (enabled, to disable) */\n.mapboxgl-ctrl button.mapboxgl-ctrl-terrain-enabled .mapboxgl-ctrl-icon,.maplibregl-ctrl button.maplibregl-ctrl-terrain-enabled .maplibregl-ctrl-icon\n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C7.99998%2C11)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.083%2C10.209C0.722%2C10.209%200.459%2C10.049%200.292%2C9.73C0.125%2C9.41%200.153%2C9.105%200.375%2C8.813L3.625%2C4.48C3.806%2C4.244%204.042%2C4.126%204.333%2C4.126C4.625%2C4.126%204.861%2C4.244%205.042%2C4.48L7.5%2C7.751C7.653%2C7.944%207.847%2C8.063%208.083%2C8.105C8.32%2C8.146%208.535%2C8.09%208.729%2C7.938C8.924%2C7.799%209.038%2C7.619%209.073%2C7.396C9.108%2C7.174%209.069%2C6.965%208.958%2C6.771L7.104%2C4.313L9.458%2C1.147C9.639%2C0.91%209.875%2C0.792%2010.167%2C0.792C10.458%2C0.792%2010.694%2C0.91%2010.875%2C1.147L16.625%2C8.813C16.847%2C9.105%2016.875%2C9.41%2016.708%2C9.73C16.541%2C10.049%2016.278%2C10.209%2015.917%2C10.209L1.083%2C10.209Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Fullscreen control icon (disabled, to enable) */\n.maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon \n{\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C9%2C9)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M0.875%2C5.042C0.639%2C5.042%200.434%2C4.955%200.26%2C4.781C0.087%2C4.608%200%2C4.403%200%2C4.167L0%2C0.875C0%2C0.639%200.087%2C0.434%200.26%2C0.26C0.434%2C0.087%200.639%2C0%200.875%2C0L4.167%2C0C4.403%2C0%204.608%2C0.087%204.781%2C0.26C4.955%2C0.434%205.042%2C0.639%205.042%2C0.875C5.042%2C1.111%204.955%2C1.316%204.781%2C1.49C4.608%2C1.663%204.403%2C1.75%204.167%2C1.75L2.958%2C1.75L4.875%2C3.667C5.042%2C3.834%205.122%2C4.031%205.115%2C4.26C5.108%2C4.489%205.021%2C4.687%204.854%2C4.854C4.687%2C5.021%204.486%2C5.104%204.25%2C5.104C4.014%2C5.104%203.813%2C5.021%203.646%2C4.854L1.75%2C2.958L1.75%2C4.167C1.75%2C4.403%201.663%2C4.608%201.49%2C4.781C1.316%2C4.955%201.111%2C5.042%200.875%2C5.042ZM10.146%2C4.854C9.979%2C4.687%209.896%2C4.486%209.896%2C4.25C9.896%2C4.014%209.979%2C3.813%2010.146%2C3.646L12.042%2C1.75L10.833%2C1.75C10.597%2C1.75%2010.392%2C1.663%2010.219%2C1.49C10.045%2C1.316%209.958%2C1.111%209.958%2C0.875C9.958%2C0.639%2010.045%2C0.434%2010.219%2C0.26C10.392%2C0.087%2010.597%2C0%2010.833%2C0L14.125%2C0C14.361%2C0%2014.566%2C0.087%2014.74%2C0.26C14.913%2C0.434%2015%2C0.639%2015%2C0.875L15%2C4.167C15%2C4.403%2014.913%2C4.608%2014.74%2C4.781C14.566%2C4.955%2014.361%2C5.042%2014.125%2C5.042C13.889%2C5.042%2013.684%2C4.955%2013.51%2C4.781C13.337%2C4.608%2013.25%2C4.403%2013.25%2C4.167L13.25%2C2.958L11.333%2C4.875C11.166%2C5.042%2010.969%2C5.122%2010.74%2C5.115C10.511%2C5.108%2010.313%2C5.021%2010.146%2C4.854ZM10.833%2C15C10.597%2C15%2010.392%2C14.913%2010.219%2C14.74C10.045%2C14.566%209.958%2C14.361%209.958%2C14.125C9.958%2C13.889%2010.045%2C13.684%2010.219%2C13.51C10.392%2C13.337%2010.597%2C13.25%2010.833%2C13.25L12.021%2C13.25L10.125%2C11.354C9.958%2C11.187%209.875%2C10.986%209.875%2C10.75C9.875%2C10.514%209.965%2C10.306%2010.146%2C10.125C10.313%2C9.958%2010.517%2C9.875%2010.76%2C9.875C11.003%2C9.875%2011.208%2C9.958%2011.375%2C10.125L13.25%2C12.021L13.25%2C10.833C13.25%2C10.597%2013.337%2C10.392%2013.51%2C10.219C13.684%2C10.045%2013.889%2C9.958%2014.125%2C9.958C14.361%2C9.958%2014.566%2C10.045%2014.74%2C10.219C14.913%2C10.392%2015%2C10.597%2015%2C10.833L15%2C14.125C15%2C14.361%2014.913%2C14.566%2014.74%2C14.74C14.566%2C14.913%2014.361%2C15%2014.125%2C15L10.833%2C15ZM0.875%2C15C0.639%2C15%200.434%2C14.913%200.26%2C14.74C0.087%2C14.566%200%2C14.361%200%2C14.125L0%2C10.833C0%2C10.597%200.087%2C10.392%200.26%2C10.219C0.434%2C10.045%200.639%2C9.958%200.875%2C9.958C1.111%2C9.958%201.316%2C10.045%201.49%2C10.219C1.663%2C10.392%201.75%2C10.597%201.75%2C10.833L1.75%2C12.021L3.646%2C10.125C3.813%2C9.958%204.014%2C9.872%204.25%2C9.865C4.486%2C9.858%204.694%2C9.944%204.875%2C10.125C5.042%2C10.292%205.125%2C10.497%205.125%2C10.74C5.125%2C10.983%205.042%2C11.187%204.875%2C11.354L2.979%2C13.25L4.167%2C13.25C4.403%2C13.25%204.608%2C13.337%204.781%2C13.51C4.955%2C13.684%205.042%2C13.889%205.042%2C14.125C5.042%2C14.361%204.955%2C14.566%204.781%2C14.74C4.608%2C14.913%204.403%2C15%204.167%2C15L0.875%2C15Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n/* Fullscreen control icon (enabled, to disable) */\n.maplibregl-ctrl button.maplibregl-ctrl-shrink .maplibregl-ctrl-icon {\n  background-image: url(\"data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C!DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix(1%2C0%2C0%2C1%2C8.49996%2C8.5)%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.434%2C5.576C1.2%2C5.576%200.997%2C5.49%200.825%2C5.317C0.653%2C5.146%200.567%2C4.943%200.567%2C4.709C0.567%2C4.475%200.653%2C4.272%200.825%2C4.1C0.997%2C3.929%201.2%2C3.843%201.434%2C3.843L2.609%2C3.843L0.732%2C1.965C0.567%2C1.8%200.488%2C1.597%200.495%2C1.356C0.502%2C1.115%200.588%2C0.913%200.753%2C0.748C0.918%2C0.583%201.121%2C0.5%201.361%2C0.5C1.602%2C0.5%201.805%2C0.583%201.97%2C0.748L3.828%2C2.624L3.828%2C1.449C3.828%2C1.215%203.913%2C1.012%204.085%2C0.84C4.257%2C0.668%204.46%2C0.582%204.694%2C0.582C4.928%2C0.582%205.131%2C0.668%205.302%2C0.84C5.475%2C1.012%205.561%2C1.215%205.561%2C1.449L5.561%2C4.709C5.561%2C4.943%205.475%2C5.146%205.302%2C5.317C5.131%2C5.49%204.928%2C5.576%204.694%2C5.576L1.434%2C5.576ZM14.557%2C5.576L11.296%2C5.576C11.063%2C5.576%2010.86%2C5.49%2010.688%2C5.317C10.516%2C5.146%2010.43%2C4.943%2010.43%2C4.709L10.43%2C1.449C10.43%2C1.215%2010.516%2C1.012%2010.688%2C0.84C10.86%2C0.668%2011.063%2C0.582%2011.296%2C0.582C11.531%2C0.582%2011.734%2C0.668%2011.906%2C0.84C12.077%2C1.012%2012.163%2C1.215%2012.163%2C1.449L12.163%2C2.624L14.041%2C0.748C14.206%2C0.583%2014.409%2C0.5%2014.65%2C0.5C14.89%2C0.5%2015.093%2C0.583%2015.258%2C0.748C15.423%2C0.913%2015.506%2C1.115%2015.506%2C1.356C15.506%2C1.597%2015.423%2C1.8%2015.258%2C1.965L13.381%2C3.843L14.557%2C3.843C14.791%2C3.843%2014.994%2C3.929%2015.166%2C4.1C15.338%2C4.272%2015.424%2C4.475%2015.424%2C4.709C15.424%2C4.943%2015.338%2C5.146%2015.166%2C5.317C14.994%2C5.49%2014.791%2C5.576%2014.557%2C5.576ZM0.753%2C15.252C0.588%2C15.087%200.506%2C14.888%200.506%2C14.654C0.506%2C14.42%200.588%2C14.221%200.753%2C14.056L2.63%2C12.178L1.434%2C12.178C1.2%2C12.178%200.997%2C12.092%200.825%2C11.921C0.653%2C11.749%200.567%2C11.546%200.567%2C11.312C0.567%2C11.078%200.653%2C10.875%200.825%2C10.703C0.997%2C10.531%201.2%2C10.445%201.434%2C10.445L4.694%2C10.445C4.928%2C10.445%205.131%2C10.531%205.302%2C10.703C5.475%2C10.875%205.561%2C11.078%205.561%2C11.312L5.561%2C14.572C5.561%2C14.806%205.475%2C15.009%205.302%2C15.181C5.131%2C15.353%204.928%2C15.439%204.694%2C15.439C4.46%2C15.439%204.257%2C15.353%204.085%2C15.181C3.913%2C15.009%203.828%2C14.806%203.828%2C14.572L3.828%2C13.376L1.95%2C15.252C1.785%2C15.418%201.585%2C15.5%201.351%2C15.5C1.118%2C15.5%200.918%2C15.418%200.753%2C15.252ZM11.296%2C15.439C11.063%2C15.439%2010.86%2C15.353%2010.688%2C15.181C10.516%2C15.009%2010.43%2C14.806%2010.43%2C14.572L10.43%2C11.312C10.43%2C11.078%2010.516%2C10.875%2010.688%2C10.703C10.86%2C10.531%2011.063%2C10.445%2011.296%2C10.445L14.557%2C10.445C14.791%2C10.445%2014.994%2C10.531%2015.166%2C10.703C15.338%2C10.875%2015.424%2C11.078%2015.424%2C11.312C15.424%2C11.546%2015.338%2C11.749%2015.166%2C11.921C14.994%2C12.092%2014.791%2C12.178%2014.557%2C12.178L13.36%2C12.178L15.237%2C14.056C15.402%2C14.221%2015.485%2C14.42%2015.485%2C14.654C15.485%2C14.888%2015.402%2C15.087%2015.237%2C15.252C15.072%2C15.418%2014.873%2C15.5%2014.639%2C15.5C14.405%2C15.5%2014.206%2C15.418%2014.041%2C15.252L12.163%2C13.376L12.163%2C14.572C12.163%2C14.806%2012.077%2C15.009%2011.906%2C15.181C11.734%2C15.353%2011.531%2C15.439%2011.296%2C15.439Z%22%20style%3D%22fill%3Argb(68%2C73%2C82)%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A\");\n}\n\n.maplibregl-ctrl-scale {\n  background-color: hsla(0,0%,100%,.75);\n  border: 1px solid #444952;\n  border-top: #444952;\n  box-sizing: border-box;\n  color: #444952;\n  font-size: 10px;\n  padding: 0 5px;\n  text-align: right;\n  line-height: 14px;\n}"],sourceRoot:""}]);const Ot=X},1719:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,'/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n/* Document\n   ========================================================================== */\n\n/**\n * 1. Correct the line height in all browsers.\n * 2. Prevent adjustments of font size after orientation changes in iOS.\n */\n\nhtml {\n  line-height: 1.15; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers.\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Render the `main` element consistently in IE.\n */\n\nmain {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Remove the gray background on active links in IE 10.\n */\n\na {\n  background-color: transparent;\n}\n\n/**\n * 1. Remove the bottom border in Chrome 57-\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n  text-decoration: underline dotted; /* 2 */\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove the border on images inside links in IE 10.\n */\n\nimg {\n  border-style: none;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers.\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\n[type="button"],\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button;\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Correct the padding in Firefox.\n */\n\nfieldset {\n  padding: 0.35em 0.75em 0.625em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  vertical-align: baseline;\n}\n\n/**\n * Remove the default vertical scrollbar in IE 10+.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10.\n * 2. Remove the padding in IE 10.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in Edge, IE 10+, and Firefox.\n */\n\ndetails {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Misc\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10+.\n */\n\ntemplate {\n  display: none;\n}\n\n/**\n * Add the correct display in IE 10.\n */\n\n[hidden] {\n  display: none;\n}\n',"",{version:3,sources:["webpack://./node_modules/normalize.css/normalize.css"],names:[],mappings:"AAAA,2EAA2E;;AAE3E;+EAC+E;;AAE/E;;;EAGE;;AAEF;EACE,iBAAiB,EAAE,MAAM;EACzB,8BAA8B,EAAE,MAAM;AACxC;;AAEA;+EAC+E;;AAE/E;;EAEE;;AAEF;EACE,SAAS;AACX;;AAEA;;EAEE;;AAEF;EACE,cAAc;AAChB;;AAEA;;;EAGE;;AAEF;EACE,cAAc;EACd,gBAAgB;AAClB;;AAEA;+EAC+E;;AAE/E;;;EAGE;;AAEF;EACE,uBAAuB,EAAE,MAAM;EAC/B,SAAS,EAAE,MAAM;EACjB,iBAAiB,EAAE,MAAM;AAC3B;;AAEA;;;EAGE;;AAEF;EACE,iCAAiC,EAAE,MAAM;EACzC,cAAc,EAAE,MAAM;AACxB;;AAEA;+EAC+E;;AAE/E;;EAEE;;AAEF;EACE,6BAA6B;AAC/B;;AAEA;;;EAGE;;AAEF;EACE,mBAAmB,EAAE,MAAM;EAC3B,0BAA0B,EAAE,MAAM;EAClC,iCAAiC,EAAE,MAAM;AAC3C;;AAEA;;EAEE;;AAEF;;EAEE,mBAAmB;AACrB;;AAEA;;;EAGE;;AAEF;;;EAGE,iCAAiC,EAAE,MAAM;EACzC,cAAc,EAAE,MAAM;AACxB;;AAEA;;EAEE;;AAEF;EACE,cAAc;AAChB;;AAEA;;;EAGE;;AAEF;;EAEE,cAAc;EACd,cAAc;EACd,kBAAkB;EAClB,wBAAwB;AAC1B;;AAEA;EACE,eAAe;AACjB;;AAEA;EACE,WAAW;AACb;;AAEA;+EAC+E;;AAE/E;;EAEE;;AAEF;EACE,kBAAkB;AACpB;;AAEA;+EAC+E;;AAE/E;;;EAGE;;AAEF;;;;;EAKE,oBAAoB,EAAE,MAAM;EAC5B,eAAe,EAAE,MAAM;EACvB,iBAAiB,EAAE,MAAM;EACzB,SAAS,EAAE,MAAM;AACnB;;AAEA;;;EAGE;;AAEF;QACQ,MAAM;EACZ,iBAAiB;AACnB;;AAEA;;;EAGE;;AAEF;SACS,MAAM;EACb,oBAAoB;AACtB;;AAEA;;EAEE;;AAEF;;;;EAIE,0BAA0B;AAC5B;;AAEA;;EAEE;;AAEF;;;;EAIE,kBAAkB;EAClB,UAAU;AACZ;;AAEA;;EAEE;;AAEF;;;;EAIE,8BAA8B;AAChC;;AAEA;;EAEE;;AAEF;EACE,8BAA8B;AAChC;;AAEA;;;;;EAKE;;AAEF;EACE,sBAAsB,EAAE,MAAM;EAC9B,cAAc,EAAE,MAAM;EACtB,cAAc,EAAE,MAAM;EACtB,eAAe,EAAE,MAAM;EACvB,UAAU,EAAE,MAAM;EAClB,mBAAmB,EAAE,MAAM;AAC7B;;AAEA;;EAEE;;AAEF;EACE,wBAAwB;AAC1B;;AAEA;;EAEE;;AAEF;EACE,cAAc;AAChB;;AAEA;;;EAGE;;AAEF;;EAEE,sBAAsB,EAAE,MAAM;EAC9B,UAAU,EAAE,MAAM;AACpB;;AAEA;;EAEE;;AAEF;;EAEE,YAAY;AACd;;AAEA;;;EAGE;;AAEF;EACE,6BAA6B,EAAE,MAAM;EACrC,oBAAoB,EAAE,MAAM;AAC9B;;AAEA;;EAEE;;AAEF;EACE,wBAAwB;AAC1B;;AAEA;;;EAGE;;AAEF;EACE,0BAA0B,EAAE,MAAM;EAClC,aAAa,EAAE,MAAM;AACvB;;AAEA;+EAC+E;;AAE/E;;EAEE;;AAEF;EACE,cAAc;AAChB;;AAEA;;EAEE;;AAEF;EACE,kBAAkB;AACpB;;AAEA;+EAC+E;;AAE/E;;EAEE;;AAEF;EACE,aAAa;AACf;;AAEA;;EAEE;;AAEF;EACE,aAAa;AACf",sourcesContent:['/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n/* Document\n   ========================================================================== */\n\n/**\n * 1. Correct the line height in all browsers.\n * 2. Prevent adjustments of font size after orientation changes in iOS.\n */\n\nhtml {\n  line-height: 1.15; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n}\n\n/* Sections\n   ========================================================================== */\n\n/**\n * Remove the margin in all browsers.\n */\n\nbody {\n  margin: 0;\n}\n\n/**\n * Render the `main` element consistently in IE.\n */\n\nmain {\n  display: block;\n}\n\n/**\n * Correct the font size and margin on `h1` elements within `section` and\n * `article` contexts in Chrome, Firefox, and Safari.\n */\n\nh1 {\n  font-size: 2em;\n  margin: 0.67em 0;\n}\n\n/* Grouping content\n   ========================================================================== */\n\n/**\n * 1. Add the correct box sizing in Firefox.\n * 2. Show the overflow in Edge and IE.\n */\n\nhr {\n  box-sizing: content-box; /* 1 */\n  height: 0; /* 1 */\n  overflow: visible; /* 2 */\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\npre {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/* Text-level semantics\n   ========================================================================== */\n\n/**\n * Remove the gray background on active links in IE 10.\n */\n\na {\n  background-color: transparent;\n}\n\n/**\n * 1. Remove the bottom border in Chrome 57-\n * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n */\n\nabbr[title] {\n  border-bottom: none; /* 1 */\n  text-decoration: underline; /* 2 */\n  text-decoration: underline dotted; /* 2 */\n}\n\n/**\n * Add the correct font weight in Chrome, Edge, and Safari.\n */\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/**\n * 1. Correct the inheritance and scaling of font size in all browsers.\n * 2. Correct the odd `em` font sizing in all browsers.\n */\n\ncode,\nkbd,\nsamp {\n  font-family: monospace, monospace; /* 1 */\n  font-size: 1em; /* 2 */\n}\n\n/**\n * Add the correct font size in all browsers.\n */\n\nsmall {\n  font-size: 80%;\n}\n\n/**\n * Prevent `sub` and `sup` elements from affecting the line height in\n * all browsers.\n */\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/* Embedded content\n   ========================================================================== */\n\n/**\n * Remove the border on images inside links in IE 10.\n */\n\nimg {\n  border-style: none;\n}\n\n/* Forms\n   ========================================================================== */\n\n/**\n * 1. Change the font styles in all browsers.\n * 2. Remove the margin in Firefox and Safari.\n */\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  line-height: 1.15; /* 1 */\n  margin: 0; /* 2 */\n}\n\n/**\n * Show the overflow in IE.\n * 1. Show the overflow in Edge.\n */\n\nbutton,\ninput { /* 1 */\n  overflow: visible;\n}\n\n/**\n * Remove the inheritance of text transform in Edge, Firefox, and IE.\n * 1. Remove the inheritance of text transform in Firefox.\n */\n\nbutton,\nselect { /* 1 */\n  text-transform: none;\n}\n\n/**\n * Correct the inability to style clickable types in iOS and Safari.\n */\n\nbutton,\n[type="button"],\n[type="reset"],\n[type="submit"] {\n  -webkit-appearance: button;\n}\n\n/**\n * Remove the inner border and padding in Firefox.\n */\n\nbutton::-moz-focus-inner,\n[type="button"]::-moz-focus-inner,\n[type="reset"]::-moz-focus-inner,\n[type="submit"]::-moz-focus-inner {\n  border-style: none;\n  padding: 0;\n}\n\n/**\n * Restore the focus styles unset by the previous rule.\n */\n\nbutton:-moz-focusring,\n[type="button"]:-moz-focusring,\n[type="reset"]:-moz-focusring,\n[type="submit"]:-moz-focusring {\n  outline: 1px dotted ButtonText;\n}\n\n/**\n * Correct the padding in Firefox.\n */\n\nfieldset {\n  padding: 0.35em 0.75em 0.625em;\n}\n\n/**\n * 1. Correct the text wrapping in Edge and IE.\n * 2. Correct the color inheritance from `fieldset` elements in IE.\n * 3. Remove the padding so developers are not caught out when they zero out\n *    `fieldset` elements in all browsers.\n */\n\nlegend {\n  box-sizing: border-box; /* 1 */\n  color: inherit; /* 2 */\n  display: table; /* 1 */\n  max-width: 100%; /* 1 */\n  padding: 0; /* 3 */\n  white-space: normal; /* 1 */\n}\n\n/**\n * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n */\n\nprogress {\n  vertical-align: baseline;\n}\n\n/**\n * Remove the default vertical scrollbar in IE 10+.\n */\n\ntextarea {\n  overflow: auto;\n}\n\n/**\n * 1. Add the correct box sizing in IE 10.\n * 2. Remove the padding in IE 10.\n */\n\n[type="checkbox"],\n[type="radio"] {\n  box-sizing: border-box; /* 1 */\n  padding: 0; /* 2 */\n}\n\n/**\n * Correct the cursor style of increment and decrement buttons in Chrome.\n */\n\n[type="number"]::-webkit-inner-spin-button,\n[type="number"]::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/**\n * 1. Correct the odd appearance in Chrome and Safari.\n * 2. Correct the outline style in Safari.\n */\n\n[type="search"] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/**\n * Remove the inner padding in Chrome and Safari on macOS.\n */\n\n[type="search"]::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/**\n * 1. Correct the inability to style clickable types in iOS and Safari.\n * 2. Change font properties to `inherit` in Safari.\n */\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/* Interactive\n   ========================================================================== */\n\n/*\n * Add the correct display in Edge, IE 10+, and Firefox.\n */\n\ndetails {\n  display: block;\n}\n\n/*\n * Add the correct display in all browsers.\n */\n\nsummary {\n  display: list-item;\n}\n\n/* Misc\n   ========================================================================== */\n\n/**\n * Add the correct display in IE 10+.\n */\n\ntemplate {\n  display: none;\n}\n\n/**\n * Add the correct display in IE 10.\n */\n\n[hidden] {\n  display: none;\n}\n'],sourceRoot:""}]);const s=o},1123:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,"* {\n    padding: 0;\n    margin: 0;\n    font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    font-size: 15px;\n    font-weight: 500;\n    outline: none;\n    /* VARS */\n\n    --radius: 10px;\n    --light-grey: #ddddddad;\n\n    --main-bg-position-clear-night: 65%;\n    --main-bg-position-cloudy-night: 65%;\n    --main-bg-position-very-cloudy-night: 90%;\n    --main-bg-position-fog-night: 90%;\n    --main-bg-position-light-rain-night: 50%;\n    --main-bg-position-rain-night: 50%;\n    --main-bg-position-heavy-rain-night: 50%;\n    --main-bg-position-light-snow-night: 50%;\n    --main-bg-position-snow-night: 50%;\n    --main-bg-position-thunderstorm-night: 50%;\n    --main-bg-position-heavy-snow-night: 60%;\n\n    --main-bg-position-sunny-day: 60%;\n    --main-bg-position-cloudy-day: 60%;\n    --main-bg-position-very-cloudy-day: 90%;\n    --main-bg-position-fog-day: 80%;\n    --main-bg-position-light-rain-day: 50%;\n    --main-bg-position-rain-day: 60%;\n    --main-bg-position-heavy-rain-day: 90%;\n    --main-bg-position-light-snow-day: 50%;\n    --main-bg-position-snow-day: 50%;\n    --main-bg-position-thunderstorm-day: 50%;\n    --main-bg-position-heavy-snow-day: 80%;\n}\n\nbody {\n    background-color: black;\n}\n\n#location, #saved-locations {\n    min-height: 100vh;\n    max-width: 100%;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 3vh;\n    padding: 20px;\n    background-size: cover;\n    background-attachment: fixed;\n    color: white;\n}\n\n.header-buttons {\n    margin: 10px;\n    height: 24px;\n    width: 100%;\n    display: flex;\n}\n\nbutton {\n    background-color: transparent;\n    border: 0;\n    color: white;\n}\n\n.header-buttons button.btn-hidden {\n    display: none;\n}\n\nbutton#saved-locations-btn, button#cancel-btn {\n    margin-right: auto;\n}\n\nbutton#save-btn {\n    margin-left: auto;\n}\n\n/* LOCATION CARDS */\n\n.location-info-cards {\n    width: 100%;\n    box-sizing: border-box;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 10px;\n    position: relative;\n}\n\n.location-info-cards .card {\n    min-height: 12vh;\n    border-radius: var(--radius);\n    padding: 15px;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    backdrop-filter: blur(100px);\n    -webkit-backdrop-filter: blur(100px);\n    /* background-color: rgba(132, 132, 132, 0.213); */\n    background-repeat: no-repeat;\n}\n\nhr {\n    border: none;\n    height: 1px;\n    width: 100%;\n    /* Set the hr color */\n    color: var(--light-grey);\n    /* old IE */\n    background-color: var(--light-grey);\n    /* Modern Browsers */\n}\n\n.card.hourly-forecast {\n    grid-column: span 2;\n}\n\n.card.daily-forecast {\n    grid-column: span 2;\n    grid-row: span 3;\n}\n\n.card.precipitation {\n    grid-column: span 2;\n    grid-row: span 2;\n}\n\n.card.wind {\n    grid-column: span 2;\n}\n\n.card.report-issue {\n    display: none;\n}\n\n.card-title {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n}\n\nimg.card-title-icon {\n    width: 15px;\n    height: 15px;\n}\n\np.card-title-text {\n    color: var(--light-grey);\n    text-transform: uppercase;\n    font-size: 0.75rem;\n    letter-spacing: 0.5px;\n    line-height: 0;\n}\n\nbutton#saved-locations-btn,\nbutton#cancel-btn,\nbutton#save-btn,\nbutton.settings-btn,\nbutton.remove-card-btn,\ndiv.location-card,\ndiv.settings-option {\n    cursor: pointer;\n}\n\n.header-buttons button {\n    text-shadow: 2px 2px 5px rgba(62, 61, 61, 0.8), 0px 0px 2px rgba(104, 104, 104, 0.8);\n}\n\n\n/* MEDIA QUERIES */\n/* TABLET */\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    * {\n        font-size: 20px;\n    }\n\n    .location-info-cards {\n        display: grid;\n        grid-template-columns: 1fr 1fr 1fr;\n        gap: 10px;\n        position: relative;\n    }\n    \n    .location-info-cards .card {\n        border-radius: var(--radius);\n        min-height: fit-content;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.hourly-forecast {\n        grid-column: span 3;\n        order: 0;\n    }\n\n    .location-info-cards .card.daily-forecast {\n        grid-column: span 2;\n        order: 1;\n    }\n\n    .location-info-cards .card.uv-index {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 2;\n    }\n\n    .location-info-cards .card.feels-like {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .location-info-cards .card.precipitation {\n        grid-column: span 2;\n        order: 4;\n    }\n\n    .location-info-cards .card.report-issue {\n        grid-column: span 1;\n        grid-row: span 2;\n        order: 8;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 20px;\n        gap: 20px;\n        text-align: center;\n    }\n\n    .location-info-cards .card.report-issue .card-content {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.report-issue img {\n        margin: auto;\n        transform: scale(3);\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n\n@media (min-width: 800px) and (max-width: 1499px) {\n    * {\n        font-size: 25px;\n    }\n\n    .location-info-cards {\n        display: grid;\n        grid-template-columns: 1fr 1fr 1fr 1fr;\n        gap: 10px;\n        position: relative;\n    }\n    \n    .location-info-cards .card {\n        border-radius: var(--radius);\n        min-height: fit-content;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.hourly-forecast {\n        grid-column: span 4;\n        order: 0;\n    }\n\n    .location-info-cards .card.daily-forecast {\n        grid-column: span 3;\n        order: 1;\n    }\n\n    .location-info-cards .card.feels-like {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .location-info-cards .card.pressure {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 4;\n    }\n\n    .location-info-cards .card.sunrise-sunset {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 5;\n    }\n\n    .location-info-cards .card.wind {\n        grid-column: span 3;\n        grid-row: span 1;\n        order: 6;\n    }\n\n    .location-info-cards .card.uv-index {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 7;\n    }\n\n    .location-info-cards .card.precipitation {\n        grid-column: span 3;\n        order: 9;\n    }\n\n    .location-info-cards .card.report-issue {\n        grid-column: span 1;\n        grid-row: span 2;\n        order: 8;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 20px;\n        gap: 20px;\n        text-align: center;\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n\n@media (min-width: 1100px) and (max-width: 1499px) {\n    * {\n        font-size: 23px;\n    }\n}\n\n/* DESKTOP */\n\n@media (min-width: 1500px) {\n    * {\n        font-size: 18px;\n    }\n\n    #location {\n        background-position: 0 !important;\n        background-attachment: unset;\n    }\n\n    .location-info-cards {\n        max-width: 1300px;\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 1vh;\n        position: relative;\n    }\n\n    .location-info-cards .card {\n        min-height: 17vh;\n        border-radius: var(--radius);\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .card.hourly-forecast {\n        grid-column: span 4;\n        order: 0;\n    }\n\n    .card.precipitation {\n        grid-column: span 2;\n        grid-row: span 3;\n        order: 1;\n    }\n\n    .card.daily-forecast {\n        grid-column: span 2;\n        grid-row: span 3;\n        order: 2;\n    }\n\n    .card.wind {\n        grid-column: span 2;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .card.feels-like {\n        order: 5;\n    }\n\n    .card.uv-index {\n        order: 6;\n    }\n\n    .card.humidity {\n        order: 7;\n    }\n\n    .card.sunset {\n        order: 8;\n    }\n\n    .card.report-issue {\n        grid-column: span 2;\n        grid-row: span 1;\n        order: 9;\n        min-height: 0;\n        display: grid;\n        grid-template-columns: 1fr auto;\n        gap: 15px;\n        cursor: pointer;\n        padding: 20px;\n    }\n\n    .card.report-issue img {\n        align-self: center;\n        transform: scale(2);\n        width: 50px;\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n","",{version:3,sources:["webpack://./src/index-style.css"],names:[],mappings:"AAAA;IACI,UAAU;IACV,SAAS;IACT,4JAA4J;IAC5J,eAAe;IACf,gBAAgB;IAChB,aAAa;IACb,SAAS;;IAET,cAAc;IACd,uBAAuB;;IAEvB,mCAAmC;IACnC,oCAAoC;IACpC,yCAAyC;IACzC,iCAAiC;IACjC,wCAAwC;IACxC,kCAAkC;IAClC,wCAAwC;IACxC,wCAAwC;IACxC,kCAAkC;IAClC,0CAA0C;IAC1C,wCAAwC;;IAExC,iCAAiC;IACjC,kCAAkC;IAClC,uCAAuC;IACvC,+BAA+B;IAC/B,sCAAsC;IACtC,gCAAgC;IAChC,sCAAsC;IACtC,sCAAsC;IACtC,gCAAgC;IAChC,wCAAwC;IACxC,sCAAsC;AAC1C;;AAEA;IACI,uBAAuB;AAC3B;;AAEA;IACI,iBAAiB;IACjB,eAAe;IACf,sBAAsB;IACtB,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,QAAQ;IACR,aAAa;IACb,sBAAsB;IACtB,4BAA4B;IAC5B,YAAY;AAChB;;AAEA;IACI,YAAY;IACZ,YAAY;IACZ,WAAW;IACX,aAAa;AACjB;;AAEA;IACI,6BAA6B;IAC7B,SAAS;IACT,YAAY;AAChB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,iBAAiB;AACrB;;AAEA,mBAAmB;;AAEnB;IACI,WAAW;IACX,sBAAsB;IACtB,aAAa;IACb,8BAA8B;IAC9B,SAAS;IACT,kBAAkB;AACtB;;AAEA;IACI,gBAAgB;IAChB,4BAA4B;IAC5B,aAAa;IACb,aAAa;IACb,sBAAsB;IACtB,SAAS;IACT,4BAA4B;IAC5B,oCAAoC;IACpC,kDAAkD;IAClD,4BAA4B;AAChC;;AAEA;IACI,YAAY;IACZ,WAAW;IACX,WAAW;IACX,qBAAqB;IACrB,wBAAwB;IACxB,WAAW;IACX,mCAAmC;IACnC,oBAAoB;AACxB;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,mBAAmB;IACnB,gBAAgB;AACpB;;AAEA;IACI,mBAAmB;IACnB,gBAAgB;AACpB;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;AACZ;;AAEA;IACI,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,wBAAwB;IACxB,yBAAyB;IACzB,kBAAkB;IAClB,qBAAqB;IACrB,cAAc;AAClB;;AAEA;;;;;;;IAOI,eAAe;AACnB;;AAEA;IACI,oFAAoF;AACxF;;;AAGA,kBAAkB;AAClB,WAAW;;AAEX;IACI;QACI,eAAe;IACnB;;IAEA;QACI,aAAa;QACb,kCAAkC;QAClC,SAAS;QACT,kBAAkB;IACtB;;IAEA;QACI,4BAA4B;QAC5B,uBAAuB;QACvB,aAAa;QACb,aAAa;QACb,sBAAsB;QACtB,SAAS;IACb;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;QACR,aAAa;QACb,0BAA0B;QAC1B,aAAa;QACb,SAAS;QACT,kBAAkB;IACtB;;IAEA;QACI,aAAa;QACb,sBAAsB;QACtB,SAAS;IACb;;IAEA;QACI,YAAY;QACZ,mBAAmB;IACvB;;IAEA;QACI,YAAY;QACZ,eAAe;QACf,oBAAoB;QACpB,gBAAgB;IACpB;;IAEA;QACI,WAAW;QACX,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;IACpB;AACJ;;AAEA;IACI;QACI,eAAe;IACnB;;IAEA;QACI,aAAa;QACb,sCAAsC;QACtC,SAAS;QACT,kBAAkB;IACtB;;IAEA;QACI,4BAA4B;QAC5B,uBAAuB;QACvB,aAAa;QACb,aAAa;QACb,sBAAsB;QACtB,SAAS;IACb;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;QACR,aAAa;QACb,0BAA0B;QAC1B,aAAa;QACb,SAAS;QACT,kBAAkB;IACtB;;IAEA;QACI,YAAY;QACZ,eAAe;QACf,oBAAoB;QACpB,gBAAgB;IACpB;;IAEA;QACI,WAAW;QACX,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;IACpB;AACJ;;AAEA;IACI;QACI,eAAe;IACnB;AACJ;;AAEA,YAAY;;AAEZ;IACI;QACI,eAAe;IACnB;;IAEA;QACI,iCAAiC;QACjC,4BAA4B;IAChC;;IAEA;QACI,iBAAiB;QACjB,aAAa;QACb,qCAAqC;QACrC,QAAQ;QACR,kBAAkB;IACtB;;IAEA;QACI,gBAAgB;QAChB,4BAA4B;QAC5B,aAAa;QACb,aAAa;QACb,sBAAsB;QACtB,SAAS;IACb;;IAEA;QACI,mBAAmB;QACnB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;IACZ;;IAEA;QACI,QAAQ;IACZ;;IAEA;QACI,QAAQ;IACZ;;IAEA;QACI,QAAQ;IACZ;;IAEA;QACI,QAAQ;IACZ;;IAEA;QACI,mBAAmB;QACnB,gBAAgB;QAChB,QAAQ;QACR,aAAa;QACb,aAAa;QACb,+BAA+B;QAC/B,SAAS;QACT,eAAe;QACf,aAAa;IACjB;;IAEA;QACI,kBAAkB;QAClB,mBAAmB;QACnB,WAAW;IACf;;IAEA;QACI,YAAY;QACZ,eAAe;QACf,oBAAoB;QACpB,gBAAgB;IACpB;;IAEA;QACI,WAAW;QACX,iBAAiB;QACjB,oBAAoB;QACpB,gBAAgB;IACpB;AACJ",sourcesContent:["* {\n    padding: 0;\n    margin: 0;\n    font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n    font-size: 15px;\n    font-weight: 500;\n    outline: none;\n    /* VARS */\n\n    --radius: 10px;\n    --light-grey: #ddddddad;\n\n    --main-bg-position-clear-night: 65%;\n    --main-bg-position-cloudy-night: 65%;\n    --main-bg-position-very-cloudy-night: 90%;\n    --main-bg-position-fog-night: 90%;\n    --main-bg-position-light-rain-night: 50%;\n    --main-bg-position-rain-night: 50%;\n    --main-bg-position-heavy-rain-night: 50%;\n    --main-bg-position-light-snow-night: 50%;\n    --main-bg-position-snow-night: 50%;\n    --main-bg-position-thunderstorm-night: 50%;\n    --main-bg-position-heavy-snow-night: 60%;\n\n    --main-bg-position-sunny-day: 60%;\n    --main-bg-position-cloudy-day: 60%;\n    --main-bg-position-very-cloudy-day: 90%;\n    --main-bg-position-fog-day: 80%;\n    --main-bg-position-light-rain-day: 50%;\n    --main-bg-position-rain-day: 60%;\n    --main-bg-position-heavy-rain-day: 90%;\n    --main-bg-position-light-snow-day: 50%;\n    --main-bg-position-snow-day: 50%;\n    --main-bg-position-thunderstorm-day: 50%;\n    --main-bg-position-heavy-snow-day: 80%;\n}\n\nbody {\n    background-color: black;\n}\n\n#location, #saved-locations {\n    min-height: 100vh;\n    max-width: 100%;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 3vh;\n    padding: 20px;\n    background-size: cover;\n    background-attachment: fixed;\n    color: white;\n}\n\n.header-buttons {\n    margin: 10px;\n    height: 24px;\n    width: 100%;\n    display: flex;\n}\n\nbutton {\n    background-color: transparent;\n    border: 0;\n    color: white;\n}\n\n.header-buttons button.btn-hidden {\n    display: none;\n}\n\nbutton#saved-locations-btn, button#cancel-btn {\n    margin-right: auto;\n}\n\nbutton#save-btn {\n    margin-left: auto;\n}\n\n/* LOCATION CARDS */\n\n.location-info-cards {\n    width: 100%;\n    box-sizing: border-box;\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 10px;\n    position: relative;\n}\n\n.location-info-cards .card {\n    min-height: 12vh;\n    border-radius: var(--radius);\n    padding: 15px;\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    backdrop-filter: blur(100px);\n    -webkit-backdrop-filter: blur(100px);\n    /* background-color: rgba(132, 132, 132, 0.213); */\n    background-repeat: no-repeat;\n}\n\nhr {\n    border: none;\n    height: 1px;\n    width: 100%;\n    /* Set the hr color */\n    color: var(--light-grey);\n    /* old IE */\n    background-color: var(--light-grey);\n    /* Modern Browsers */\n}\n\n.card.hourly-forecast {\n    grid-column: span 2;\n}\n\n.card.daily-forecast {\n    grid-column: span 2;\n    grid-row: span 3;\n}\n\n.card.precipitation {\n    grid-column: span 2;\n    grid-row: span 2;\n}\n\n.card.wind {\n    grid-column: span 2;\n}\n\n.card.report-issue {\n    display: none;\n}\n\n.card-title {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n}\n\nimg.card-title-icon {\n    width: 15px;\n    height: 15px;\n}\n\np.card-title-text {\n    color: var(--light-grey);\n    text-transform: uppercase;\n    font-size: 0.75rem;\n    letter-spacing: 0.5px;\n    line-height: 0;\n}\n\nbutton#saved-locations-btn,\nbutton#cancel-btn,\nbutton#save-btn,\nbutton.settings-btn,\nbutton.remove-card-btn,\ndiv.location-card,\ndiv.settings-option {\n    cursor: pointer;\n}\n\n.header-buttons button {\n    text-shadow: 2px 2px 5px rgba(62, 61, 61, 0.8), 0px 0px 2px rgba(104, 104, 104, 0.8);\n}\n\n\n/* MEDIA QUERIES */\n/* TABLET */\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    * {\n        font-size: 20px;\n    }\n\n    .location-info-cards {\n        display: grid;\n        grid-template-columns: 1fr 1fr 1fr;\n        gap: 10px;\n        position: relative;\n    }\n    \n    .location-info-cards .card {\n        border-radius: var(--radius);\n        min-height: fit-content;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.hourly-forecast {\n        grid-column: span 3;\n        order: 0;\n    }\n\n    .location-info-cards .card.daily-forecast {\n        grid-column: span 2;\n        order: 1;\n    }\n\n    .location-info-cards .card.uv-index {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 2;\n    }\n\n    .location-info-cards .card.feels-like {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .location-info-cards .card.precipitation {\n        grid-column: span 2;\n        order: 4;\n    }\n\n    .location-info-cards .card.report-issue {\n        grid-column: span 1;\n        grid-row: span 2;\n        order: 8;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 20px;\n        gap: 20px;\n        text-align: center;\n    }\n\n    .location-info-cards .card.report-issue .card-content {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.report-issue img {\n        margin: auto;\n        transform: scale(3);\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n\n@media (min-width: 800px) and (max-width: 1499px) {\n    * {\n        font-size: 25px;\n    }\n\n    .location-info-cards {\n        display: grid;\n        grid-template-columns: 1fr 1fr 1fr 1fr;\n        gap: 10px;\n        position: relative;\n    }\n    \n    .location-info-cards .card {\n        border-radius: var(--radius);\n        min-height: fit-content;\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .location-info-cards .card.hourly-forecast {\n        grid-column: span 4;\n        order: 0;\n    }\n\n    .location-info-cards .card.daily-forecast {\n        grid-column: span 3;\n        order: 1;\n    }\n\n    .location-info-cards .card.feels-like {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .location-info-cards .card.pressure {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 4;\n    }\n\n    .location-info-cards .card.sunrise-sunset {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 5;\n    }\n\n    .location-info-cards .card.wind {\n        grid-column: span 3;\n        grid-row: span 1;\n        order: 6;\n    }\n\n    .location-info-cards .card.uv-index {\n        grid-column: span 1;\n        grid-row: span 1;\n        order: 7;\n    }\n\n    .location-info-cards .card.precipitation {\n        grid-column: span 3;\n        order: 9;\n    }\n\n    .location-info-cards .card.report-issue {\n        grid-column: span 1;\n        grid-row: span 2;\n        order: 8;\n        display: grid;\n        grid-template-columns: 1fr;\n        padding: 20px;\n        gap: 20px;\n        text-align: center;\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n\n@media (min-width: 1100px) and (max-width: 1499px) {\n    * {\n        font-size: 23px;\n    }\n}\n\n/* DESKTOP */\n\n@media (min-width: 1500px) {\n    * {\n        font-size: 18px;\n    }\n\n    #location {\n        background-position: 0 !important;\n        background-attachment: unset;\n    }\n\n    .location-info-cards {\n        max-width: 1300px;\n        display: grid;\n        grid-template-columns: repeat(6, 1fr);\n        gap: 1vh;\n        position: relative;\n    }\n\n    .location-info-cards .card {\n        min-height: 17vh;\n        border-radius: var(--radius);\n        padding: 15px;\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .card.hourly-forecast {\n        grid-column: span 4;\n        order: 0;\n    }\n\n    .card.precipitation {\n        grid-column: span 2;\n        grid-row: span 3;\n        order: 1;\n    }\n\n    .card.daily-forecast {\n        grid-column: span 2;\n        grid-row: span 3;\n        order: 2;\n    }\n\n    .card.wind {\n        grid-column: span 2;\n        grid-row: span 1;\n        order: 3;\n    }\n\n    .card.feels-like {\n        order: 5;\n    }\n\n    .card.uv-index {\n        order: 6;\n    }\n\n    .card.humidity {\n        order: 7;\n    }\n\n    .card.sunset {\n        order: 8;\n    }\n\n    .card.report-issue {\n        grid-column: span 2;\n        grid-row: span 1;\n        order: 9;\n        min-height: 0;\n        display: grid;\n        grid-template-columns: 1fr auto;\n        gap: 15px;\n        cursor: pointer;\n        padding: 20px;\n    }\n\n    .card.report-issue img {\n        align-self: center;\n        transform: scale(2);\n        width: 50px;\n    }\n\n    p.issue-title {\n        color: white;\n        font-size: 1rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n\n    p.issue-desc {\n        color: #ddd;\n        font-size: 0.9rem;\n        text-transform: none;\n        margin-top: 10px;\n    }\n}\n"],sourceRoot:""}]);const s=o},3927:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".location-brief-info {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    text-shadow: 2px 2px 5px rgba(160, 160, 160, 0.8), 0px 0px 2px rgba(160, 160, 160, 0.8);\n    margin-bottom: 6vh;\n}\n\n.location-brief-info p.city {\n    font-size: 1.6rem;\n    font-weight: 500;\n}\n\n.location-brief-info .temp {\n    position: relative;\n    display: flex;\n}\n\n.location-brief-info .temp-number {\n    font-size: 4.5rem;\n    font-weight: 200;\n}\n\n.location-brief-info .temp-icon {\n    position: absolute;\n    top: 5%;\n    left: 100%;\n    font-size: 3rem;\n    font-weight: 200;\n}\n\n.location-brief-info .type {\n    font-weight: 400;\n    margin-top: -5px;\n}\n\n.location-brief-info .temp-high-low {\n    display: flex;\n    gap: 20px;\n}\n\n.location-brief-info .temp-high-low p {\n    font-weight: 400;\n}","",{version:3,sources:["webpack://./src/styles/brief-info-style.css"],names:[],mappings:"AAAA;IACI,WAAW;IACX,aAAa;IACb,sBAAsB;IACtB,uBAAuB;IACvB,mBAAmB;IACnB,uFAAuF;IACvF,kBAAkB;AACtB;;AAEA;IACI,iBAAiB;IACjB,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,aAAa;AACjB;;AAEA;IACI,iBAAiB;IACjB,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,UAAU;IACV,eAAe;IACf,gBAAgB;AACpB;;AAEA;IACI,gBAAgB;IAChB,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,SAAS;AACb;;AAEA;IACI,gBAAgB;AACpB",sourcesContent:[".location-brief-info {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    text-shadow: 2px 2px 5px rgba(160, 160, 160, 0.8), 0px 0px 2px rgba(160, 160, 160, 0.8);\n    margin-bottom: 6vh;\n}\n\n.location-brief-info p.city {\n    font-size: 1.6rem;\n    font-weight: 500;\n}\n\n.location-brief-info .temp {\n    position: relative;\n    display: flex;\n}\n\n.location-brief-info .temp-number {\n    font-size: 4.5rem;\n    font-weight: 200;\n}\n\n.location-brief-info .temp-icon {\n    position: absolute;\n    top: 5%;\n    left: 100%;\n    font-size: 3rem;\n    font-weight: 200;\n}\n\n.location-brief-info .type {\n    font-weight: 400;\n    margin-top: -5px;\n}\n\n.location-brief-info .temp-high-low {\n    display: flex;\n    gap: 20px;\n}\n\n.location-brief-info .temp-high-low p {\n    font-weight: 400;\n}"],sourceRoot:""}]);const s=o},6745:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,"\n:root {\n    --0-perc: rgba(0, 123, 252, 1);\n    --10-perc: rgba(34, 176, 219, 1);\n    --20-perc: rgba(61, 219, 192, 1);\n    --30-perc: rgba(84, 210, 169, 1);\n    --40-perc: rgba(102, 203, 151, 1);\n    --50-perc: rgba(128, 194, 126, 1);\n    --60-perc: rgba(153, 184, 101, 1);\n    --70-perc: rgba(179, 175, 76, 1);\n    --80-perc: rgba(204, 165, 51, 1);\n    --90-perc: rgba(232, 74, 23, 1);\n    --100-perc: rgba(255, 0, 0, 1);\n}\n\n.card.daily-forecast .card-content {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n}\n\n.card.daily-forecast .card-content .js-daily-item {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 20px;\n    box-sizing: border-box;\n}\n\n.js-day-name {\n    min-width: 50px;\n}\n\n.js-temp-bar {\n    width: 30%;\n    height: 5px;\n    position: relative;\n    border-radius: 5px;\n    background: #2e2e2e1a;\n}\n\n.js-temp-bar .js-bar {\n    height: 100%;\n    left: 0%;\n    right: 0%;\n    position: absolute;\n    border-radius: 5px;\n    background: rgb(0, 243, 252);\n    background: linear-gradient(90deg, var(--mild), var(--warm));\n}\n.card.daily-forecast .card-content .js-daily-item .js-daily-weather-type {\n    filter: contrast(200%);\n}\n\n@media (min-width: 1025px) {\n    .card.daily-forecast {\n    }\n}","",{version:3,sources:["webpack://./src/styles/daily-forecast-style.css"],names:[],mappings:";AACA;IACI,8BAA8B;IAC9B,gCAAgC;IAChC,gCAAgC;IAChC,gCAAgC;IAChC,iCAAiC;IACjC,iCAAiC;IACjC,iCAAiC;IACjC,gCAAgC;IAChC,gCAAgC;IAChC,+BAA+B;IAC/B,8BAA8B;AAClC;;AAEA;IACI,YAAY;IACZ,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,WAAW;IACX,aAAa;IACb,8BAA8B;IAC9B,mBAAmB;IACnB,SAAS;IACT,sBAAsB;AAC1B;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,UAAU;IACV,WAAW;IACX,kBAAkB;IAClB,kBAAkB;IAClB,qBAAqB;AACzB;;AAEA;IACI,YAAY;IACZ,QAAQ;IACR,SAAS;IACT,kBAAkB;IAClB,kBAAkB;IAClB,4BAA4B;IAC5B,4DAA4D;AAChE;AACA;IACI,sBAAsB;AAC1B;;AAEA;IACI;IACA;AACJ",sourcesContent:["\n:root {\n    --0-perc: rgba(0, 123, 252, 1);\n    --10-perc: rgba(34, 176, 219, 1);\n    --20-perc: rgba(61, 219, 192, 1);\n    --30-perc: rgba(84, 210, 169, 1);\n    --40-perc: rgba(102, 203, 151, 1);\n    --50-perc: rgba(128, 194, 126, 1);\n    --60-perc: rgba(153, 184, 101, 1);\n    --70-perc: rgba(179, 175, 76, 1);\n    --80-perc: rgba(204, 165, 51, 1);\n    --90-perc: rgba(232, 74, 23, 1);\n    --100-perc: rgba(255, 0, 0, 1);\n}\n\n.card.daily-forecast .card-content {\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n}\n\n.card.daily-forecast .card-content .js-daily-item {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: 20px;\n    box-sizing: border-box;\n}\n\n.js-day-name {\n    min-width: 50px;\n}\n\n.js-temp-bar {\n    width: 30%;\n    height: 5px;\n    position: relative;\n    border-radius: 5px;\n    background: #2e2e2e1a;\n}\n\n.js-temp-bar .js-bar {\n    height: 100%;\n    left: 0%;\n    right: 0%;\n    position: absolute;\n    border-radius: 5px;\n    background: rgb(0, 243, 252);\n    background: linear-gradient(90deg, var(--mild), var(--warm));\n}\n.card.daily-forecast .card-content .js-daily-item .js-daily-weather-type {\n    filter: contrast(200%);\n}\n\n@media (min-width: 1025px) {\n    .card.daily-forecast {\n    }\n}"],sourceRoot:""}]);const s=o},6403:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.feels-like .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.js-feels-temp {\n    font-size: 2.5rem;\n}\n\n.js-feels-desc {\n    margin-top: auto;\n    font-size: 0.95rem;\n}","",{version:3,sources:["webpack://./src/styles/feels-like-style.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,WAAW;IACX,aAAa;IACb,sBAAsB;AAC1B;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,gBAAgB;IAChB,kBAAkB;AACtB",sourcesContent:[".card.feels-like .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.js-feels-temp {\n    font-size: 2.5rem;\n}\n\n.js-feels-desc {\n    margin-top: auto;\n    font-size: 0.95rem;\n}"],sourceRoot:""}]);const s=o},9863:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.hourly-forecast {\n    height: fit-content;\n}\n\n.card.hourly-forecast .card-content {\n    height: fit-content;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: 20px;\n    overflow-x: scroll;\n    scrollbar-width: none\n}\n\n.card.hourly-forecast .card-content .js-hour-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n}\n\n.card.hourly-forecast .card-content .js-hour-item .js-hour-weather-type {\n    filter: contrast(200%);\n}\n\n@media (min-width: 1025px) {\n    .card.hourly-forecast .card-content {\n            height: fit-content;\n            display: flex;\n            justify-content: flex-start;\n            align-items: center;\n            gap: 20px;\n            overflow-x: scroll;\n            scrollbar-width: none;\n            margin-bottom: auto;\n            margin-top: auto;\n        }\n}","",{version:3,sources:["webpack://./src/styles/hourly-forecast-style.css"],names:[],mappings:"AAAA;IACI,mBAAmB;AACvB;;AAEA;IACI,mBAAmB;IACnB,aAAa;IACb,2BAA2B;IAC3B,mBAAmB;IACnB,SAAS;IACT,kBAAkB;IAClB;AACJ;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,sBAAsB;AAC1B;;AAEA;IACI;YACQ,mBAAmB;YACnB,aAAa;YACb,2BAA2B;YAC3B,mBAAmB;YACnB,SAAS;YACT,kBAAkB;YAClB,qBAAqB;YACrB,mBAAmB;YACnB,gBAAgB;QACpB;AACR",sourcesContent:[".card.hourly-forecast {\n    height: fit-content;\n}\n\n.card.hourly-forecast .card-content {\n    height: fit-content;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: 20px;\n    overflow-x: scroll;\n    scrollbar-width: none\n}\n\n.card.hourly-forecast .card-content .js-hour-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n}\n\n.card.hourly-forecast .card-content .js-hour-item .js-hour-weather-type {\n    filter: contrast(200%);\n}\n\n@media (min-width: 1025px) {\n    .card.hourly-forecast .card-content {\n            height: fit-content;\n            display: flex;\n            justify-content: flex-start;\n            align-items: center;\n            gap: 20px;\n            overflow-x: scroll;\n            scrollbar-width: none;\n            margin-bottom: auto;\n            margin-top: auto;\n        }\n}"],sourceRoot:""}]);const s=o},8896:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.precipitation {\n    min-height: 400px;\n}\n\n.card.precipitation .card-content {\n    width: 100%;\n    height: 100%;\n    position: relative;\n}\n\n#map {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border-radius: 10px;\n}","",{version:3,sources:["webpack://./src/styles/precipitation-map-style.css"],names:[],mappings:"AAAA;IACI,iBAAiB;AACrB;;AAEA;IACI,WAAW;IACX,YAAY;IACZ,kBAAkB;AACtB;;AAEA;IACI,kBAAkB;IAClB,MAAM;IACN,SAAS;IACT,QAAQ;IACR,OAAO;IACP,WAAW;IACX,YAAY;IACZ,mBAAmB;AACvB",sourcesContent:[".card.precipitation {\n    min-height: 400px;\n}\n\n.card.precipitation .card-content {\n    width: 100%;\n    height: 100%;\n    position: relative;\n}\n\n#map {\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border-radius: 10px;\n}"],sourceRoot:""}]);const s=o},3643:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.pressure .card-content {\n    min-height: 12vh;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n    margin-top: auto;\n}\n\np.pressure-unit {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: flex-end;\n    z-index: 100;\n    bottom: 10px;\n    font-size: 1.15rem;\n    font-weight: 500;\n}\n\n.pressure-low-high {\n    margin-top: auto;\n    width: 100%;\n    display: flex;\n    justify-content: space-evenly;\n}\n\n/* ------- Alternate Style ------- */\n\n.gauge-container.three {\n    position: relative;\n    margin: auto;\n    height: 90px;\n}\n\n.gauge-container>.gauge .dial {\n    stroke: #eee;\n    stroke-width: 2;\n    fill: rgba(0, 0, 0, 0);\n}\n\n.gauge-container>.gauge .value {\n    stroke: rgb(47, 227, 255);\n    stroke-width: 2;\n    fill: rgba(0, 0, 0, 0);\n}\n\n.gauge-container>.gauge .value-text {\n    fill: rgb(47, 227, 255);\n    font-family: sans-serif;\n    font-weight: bold;\n    font-size: 1em;\n}\n\n.gauge-container.three svg {\n    height: 100px;\n    transform: scale(1.3);\n}\n\n.gauge-container.three>.gauge .dial {\n    stroke: #ddddddad;\n    stroke-width: 3;\n    stroke-linecap: round;\n    stroke-dasharray: 1 5;\n}\n\n.gauge-container.three>.gauge .value {\n    stroke: white;\n    stroke-width: 3;\n    stroke-linecap: round;\n    stroke-dasharray: 1 5;\n}\n\n.gauge-container.three>.gauge .value-text {\n    fill: white;\n    font-size: 1.2rem;\n}\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    p.pressure-unit {\n        bottom: 0px;\n    }\n}","",{version:3,sources:["webpack://./src/styles/pressure-style.css"],names:[],mappings:"AAAA;IACI,gBAAgB;IAChB,aAAa;IACb,sBAAsB;IACtB,QAAQ;IACR,gBAAgB;AACpB;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,iBAAiB;IACjB,kBAAkB;IAClB,YAAY;IACZ,aAAa;IACb,uBAAuB;IACvB,qBAAqB;IACrB,YAAY;IACZ,YAAY;IACZ,kBAAkB;IAClB,gBAAgB;AACpB;;AAEA;IACI,gBAAgB;IAChB,WAAW;IACX,aAAa;IACb,6BAA6B;AACjC;;AAEA,oCAAoC;;AAEpC;IACI,kBAAkB;IAClB,YAAY;IACZ,YAAY;AAChB;;AAEA;IACI,YAAY;IACZ,eAAe;IACf,sBAAsB;AAC1B;;AAEA;IACI,yBAAyB;IACzB,eAAe;IACf,sBAAsB;AAC1B;;AAEA;IACI,uBAAuB;IACvB,uBAAuB;IACvB,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,aAAa;IACb,qBAAqB;AACzB;;AAEA;IACI,iBAAiB;IACjB,eAAe;IACf,qBAAqB;IACrB,qBAAqB;AACzB;;AAEA;IACI,aAAa;IACb,eAAe;IACf,qBAAqB;IACrB,qBAAqB;AACzB;;AAEA;IACI,WAAW;IACX,iBAAiB;AACrB;;AAEA;IACI;QACI,WAAW;IACf;AACJ",sourcesContent:[".card.pressure .card-content {\n    min-height: 12vh;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n    margin-top: auto;\n}\n\np.pressure-unit {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: flex-end;\n    z-index: 100;\n    bottom: 10px;\n    font-size: 1.15rem;\n    font-weight: 500;\n}\n\n.pressure-low-high {\n    margin-top: auto;\n    width: 100%;\n    display: flex;\n    justify-content: space-evenly;\n}\n\n/* ------- Alternate Style ------- */\n\n.gauge-container.three {\n    position: relative;\n    margin: auto;\n    height: 90px;\n}\n\n.gauge-container>.gauge .dial {\n    stroke: #eee;\n    stroke-width: 2;\n    fill: rgba(0, 0, 0, 0);\n}\n\n.gauge-container>.gauge .value {\n    stroke: rgb(47, 227, 255);\n    stroke-width: 2;\n    fill: rgba(0, 0, 0, 0);\n}\n\n.gauge-container>.gauge .value-text {\n    fill: rgb(47, 227, 255);\n    font-family: sans-serif;\n    font-weight: bold;\n    font-size: 1em;\n}\n\n.gauge-container.three svg {\n    height: 100px;\n    transform: scale(1.3);\n}\n\n.gauge-container.three>.gauge .dial {\n    stroke: #ddddddad;\n    stroke-width: 3;\n    stroke-linecap: round;\n    stroke-dasharray: 1 5;\n}\n\n.gauge-container.three>.gauge .value {\n    stroke: white;\n    stroke-width: 3;\n    stroke-linecap: round;\n    stroke-dasharray: 1 5;\n}\n\n.gauge-container.three>.gauge .value-text {\n    fill: white;\n    font-size: 1.2rem;\n}\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    p.pressure-unit {\n        bottom: 0px;\n    }\n}"],sourceRoot:""}]);const s=o},7458:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,' :root {\n    --gmpx-color-surface: #242424;\n    --gmpx-color-on-surface: #ffffff;\n\n    /* CARD NIGHT POSITIONING */\n\n    --card-bg-top-position-clear-night: -20%;\n    --card-bg-top-position-cloudy-night: -50%;\n    --card-bg-top-position-very-cloudy-night: -40%;\n    --card-bg-top-position-fog-night: -100%;\n    --card-bg-top-position-light-rain-night: -80%;\n    --card-bg-top-position-rain-night: -80%;\n    --card-bg-top-position-heavy-rain-night: -80%;\n    --card-bg-top-position-light-snow-night: -80%;\n    --card-bg-top-position-snow-night: -80%;\n    --card-bg-top-position-thunderstorm-night: -150%;\n    --card-bg-top-position-heavy-snow-night: -80%;\n\n    --card-bg-left-position-clear-night: -130%;\n    --card-bg-left-position-cloudy-night: -120%;\n    --card-bg-left-position-very-cloudy-night: -60%;\n    --card-bg-left-position-fog-night: -100%;\n    --card-bg-left-position-light-rain-night: -60%;\n    --card-bg-left-position-rain-night: -60%;\n    --card-bg-left-position-heavy-rain-night: -60%;\n    --card-bg-left-position-light-snow-night: -60%;\n    --card-bg-left-position-snow-night: -60%;\n    --card-bg-left-position-thunderstorm-night: -20%;\n    --card-bg-left-position-heavy-snow-night: -60%;\n\n    /* CARD DAY POSITIONING */\n    --card-bg-top-position-sunny-day: 0%;\n    --card-bg-top-position-cloudy-day: 0%;\n    --card-bg-top-position-very-cloudy-day: -50%;\n    --card-bg-top-position-fog-day: -100%;\n    --card-bg-top-position-light-rain-day: -80%;\n    --card-bg-top-position-rain-day: -80%;\n    --card-bg-top-position-heavy-rain-day: -80%;\n    --card-bg-top-position-light-snow-day: -80%;\n    --card-bg-top-position-snow-day: -80%;\n    --card-bg-top-position-thunderstorm-day: -150%;\n    --card-bg-top-position-heavy-snow-day: -80%;\n\n    --card-bg-left-position-sunny-day: -130%;\n    --card-bg-left-position-cloudy-day: -130%;\n    --card-bg-left-position-very-cloudy-day: -60%;\n    --card-bg-left-position-fog-day: -100%;\n    --card-bg-left-position-light-rain-day: -60%;\n    --card-bg-left-position-rain-day: -60%;\n    --card-bg-left-position-heavy-rain-day: -60%;\n    --card-bg-left-position-light-snow-day: -60%;\n    --card-bg-left-position-snow-day: -60%;\n    --card-bg-left-position-thunderstorm-day: -20%;\n    --card-bg-left-position-heavy-snow-day: -60%;\n }\n \n #saved-locations {\n    gap: 12px;\n    max-width: 1000px;\n    margin-left: auto;\n    margin-right: auto;\n }\n\n .settings {\n    position: relative;\n    width: 100%;\n    display: flex;\n    justify-content: flex-end;\n }\n\n .search {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n }\n\n .search p {\n    font-size: 2rem;\n    font-weight: 600;\n }\n\n .search gmpx-place-picker {\n    width: 100%;\n }\n\n .search input:focus {\n    border: 0;\n }\n\n .search input::placeholder {\n    color: #757575;\n }\n\n #place-picker-box {\n     width: 100%;\n }\n\n #place-picker-container {\n     text-align: left;\n }\n \n .pac-container {\n    margin-top: 10px;\n    background-color: #000000;\n    border: 0;\n    text-align: left;\n    border: 0;\n }\n\n .pac-item {\n    border: 0;\n    margin-bottom: 5px;\n    cursor: pointer;\n }\n\n .pac-item span, span.pac-matched {\n    font-weight: 400;\n    font-size: 1rem;\n }\n\n .pac-item .pac-matched {\n    color: white;\n }\n\n .pac-item span {\n    color: #949494;\n }\n\n .pac-icon {\n    display: none;\n }\n\n .pac-item:hover {\n    background-color: #141414 !important;\n }\n\n /* location cards */\n\n .saved-locations-cards {\n    width: 100%;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n    position: relative;\n    z-index: 0;\n }\n\n .saved-locations-cards p {\n    text-shadow: 2px 2px 5px rgba(160, 160, 160, 0.8), 0px 0px 2px rgba(160, 160, 160, 0.8);\n }\n\n .location-container,\n .current-location-container {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    gap: 10px;\n }\n\n .location-card {\n    width: 100%;\n    height: 100px;\n    min-height: fit-content;\n    box-sizing: border-box;\n    padding: 15px;\n    border-radius: 15px;\n\n    display: grid;\n    grid-template-columns: 4fr 1fr;\n    grid-template-rows: 1fr;\n\n    position: relative;\n    overflow: hidden;\n}\n\n.location-card::before {\n    content: "";\n    position: absolute;\n    width: 300%;\n    height: 300%;\n    top: var(--top-position);\n    left: var(--left-position);\n    z-index: -1;\n    background: var(--background);\n    background-size: cover;\n}\n\n.location-card-left {\n    margin-right: auto;\n}\n\n.location-card-left, .location-card-right {\n    display: flex;\n    flex-direction: column;\n}\n\n.location-card-left p, .location-card-right p{\n    font-size: 0.8rem;\n    font-weight: 600;\n}\n\n.location-card-right {\n    align-items: center;\n}\n\np.city {\n    font-size: 1.2rem;\n}\n\np.current-temp {\n    font-size: 2.5rem;\n}\n\np.weather, .high-min-temp {\n    margin-top: auto;\n}\n\n.high-min-temp {\n    display: flex;\n    gap: 5px;\n}\n\n@media (min-width: 480px) and (max-width: 1499px) {\n    #location,\n    #saved-locations {\n        padding: 25px;\n    }\n\n    .location-card {\n        width: 100%;\n        height: 150px;\n    }\n\n    .location-card::before {\n        left: 0;\n        background-size: initial;\n    }\n}\n\n@media (min-width: 800px) and (max-width: 1499px) {\n    .location-card {\n        height: 150px;\n    }\n\n    #location,\n    #saved-locations {\n        padding: 40px;\n    }\n}\n\n@media (min-width: 1100px) and (max-width: 1499px) {\n    .location-card {\n        height: 15vh;\n    }\n}\n\n@media (min-width: 1500px) {\n    :root {\n        /* CARD NIGHT POSITIONING */\n        \n        --card-bg-top-position-clear-night: -20%;\n        --card-bg-top-position-cloudy-night: -50%;\n        --card-bg-top-position-very-cloudy-night: -50%;\n        --card-bg-top-position-fog-night: 0%;\n        --card-bg-top-position-light-rain-night: -100%;\n        --card-bg-top-position-rain-night: -100%;\n        --card-bg-top-position-heavy-rain-night: -100%;\n        --card-bg-top-position-light-snow-night: -100%;\n        --card-bg-top-position-snow-night: -100%;\n        --card-bg-top-position-thunderstorm-night: -100%;\n        --card-bg-top-position-heavy-snow-night: -100%;\n    \n        /* CARD DAY POSITIONING */\n        --card-bg-top-position-sunny-day: 0%;\n        --card-bg-top-position-cloudy-day: -30%;\n        --card-bg-top-position-very-cloudy-day: -100%;\n        --card-bg-top-position-fog-day: 0%;\n        --card-bg-top-position-light-rain-day: -100%;\n        --card-bg-top-position-rain-day: -100%;\n        --card-bg-top-position-heavy-rain-day: -100%;\n        --card-bg-top-position-light-snow-day: -100%;\n        --card-bg-top-position-snow-day: -100%;\n        --card-bg-top-position-thunderstorm-day: -100%;\n        --card-bg-top-position-heavy-snow-day: -100%;\n\n    }\n\n    #saved-locations {\n        width: 50vw;\n    }\n\n    .location-card::before {\n        left: 0;\n        background-size: initial;\n    }\n\n}',"",{version:3,sources:["webpack://./src/styles/saved-locations-style.css"],names:[],mappings:"CAAC;IACG,6BAA6B;IAC7B,gCAAgC;;IAEhC,2BAA2B;;IAE3B,wCAAwC;IACxC,yCAAyC;IACzC,8CAA8C;IAC9C,uCAAuC;IACvC,6CAA6C;IAC7C,uCAAuC;IACvC,6CAA6C;IAC7C,6CAA6C;IAC7C,uCAAuC;IACvC,gDAAgD;IAChD,6CAA6C;;IAE7C,0CAA0C;IAC1C,2CAA2C;IAC3C,+CAA+C;IAC/C,wCAAwC;IACxC,8CAA8C;IAC9C,wCAAwC;IACxC,8CAA8C;IAC9C,8CAA8C;IAC9C,wCAAwC;IACxC,gDAAgD;IAChD,8CAA8C;;IAE9C,yBAAyB;IACzB,oCAAoC;IACpC,qCAAqC;IACrC,4CAA4C;IAC5C,qCAAqC;IACrC,2CAA2C;IAC3C,qCAAqC;IACrC,2CAA2C;IAC3C,2CAA2C;IAC3C,qCAAqC;IACrC,8CAA8C;IAC9C,2CAA2C;;IAE3C,wCAAwC;IACxC,yCAAyC;IACzC,6CAA6C;IAC7C,sCAAsC;IACtC,4CAA4C;IAC5C,sCAAsC;IACtC,4CAA4C;IAC5C,4CAA4C;IAC5C,sCAAsC;IACtC,8CAA8C;IAC9C,4CAA4C;CAC/C;;CAEA;IACG,SAAS;IACT,iBAAiB;IACjB,iBAAiB;IACjB,kBAAkB;CACrB;;CAEA;IACG,kBAAkB;IAClB,WAAW;IACX,aAAa;IACb,yBAAyB;CAC5B;;CAEA;IACG,WAAW;IACX,aAAa;IACb,sBAAsB;IACtB,QAAQ;CACX;;CAEA;IACG,eAAe;IACf,gBAAgB;CACnB;;CAEA;IACG,WAAW;CACd;;CAEA;IACG,SAAS;CACZ;;CAEA;IACG,cAAc;CACjB;;CAEA;KACI,WAAW;CACf;;CAEA;KACI,gBAAgB;CACpB;;CAEA;IACG,gBAAgB;IAChB,yBAAyB;IACzB,SAAS;IACT,gBAAgB;IAChB,SAAS;CACZ;;CAEA;IACG,SAAS;IACT,kBAAkB;IAClB,eAAe;CAClB;;CAEA;IACG,gBAAgB;IAChB,eAAe;CAClB;;CAEA;IACG,YAAY;CACf;;CAEA;IACG,cAAc;CACjB;;CAEA;IACG,aAAa;CAChB;;CAEA;IACG,oCAAoC;CACvC;;CAEA,mBAAmB;;CAEnB;IACG,WAAW;IACX,sBAAsB;IACtB,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,SAAS;IACT,kBAAkB;IAClB,UAAU;CACb;;CAEA;IACG,uFAAuF;CAC1F;;CAEA;;IAEG,WAAW;IACX,aAAa;IACb,uBAAuB;IACvB,SAAS;CACZ;;CAEA;IACG,WAAW;IACX,aAAa;IACb,uBAAuB;IACvB,sBAAsB;IACtB,aAAa;IACb,mBAAmB;;IAEnB,aAAa;IACb,8BAA8B;IAC9B,uBAAuB;;IAEvB,kBAAkB;IAClB,gBAAgB;AACpB;;AAEA;IACI,WAAW;IACX,kBAAkB;IAClB,WAAW;IACX,YAAY;IACZ,wBAAwB;IACxB,0BAA0B;IAC1B,WAAW;IACX,6BAA6B;IAC7B,sBAAsB;AAC1B;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI,aAAa;IACb,sBAAsB;AAC1B;;AAEA;IACI,iBAAiB;IACjB,gBAAgB;AACpB;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,QAAQ;AACZ;;AAEA;IACI;;QAEI,aAAa;IACjB;;IAEA;QACI,WAAW;QACX,aAAa;IACjB;;IAEA;QACI,OAAO;QACP,wBAAwB;IAC5B;AACJ;;AAEA;IACI;QACI,aAAa;IACjB;;IAEA;;QAEI,aAAa;IACjB;AACJ;;AAEA;IACI;QACI,YAAY;IAChB;AACJ;;AAEA;IACI;QACI,2BAA2B;;QAE3B,wCAAwC;QACxC,yCAAyC;QACzC,8CAA8C;QAC9C,oCAAoC;QACpC,8CAA8C;QAC9C,wCAAwC;QACxC,8CAA8C;QAC9C,8CAA8C;QAC9C,wCAAwC;QACxC,gDAAgD;QAChD,8CAA8C;;QAE9C,yBAAyB;QACzB,oCAAoC;QACpC,uCAAuC;QACvC,6CAA6C;QAC7C,kCAAkC;QAClC,4CAA4C;QAC5C,sCAAsC;QACtC,4CAA4C;QAC5C,4CAA4C;QAC5C,sCAAsC;QACtC,8CAA8C;QAC9C,4CAA4C;;IAEhD;;IAEA;QACI,WAAW;IACf;;IAEA;QACI,OAAO;QACP,wBAAwB;IAC5B;;AAEJ",sourcesContent:[' :root {\n    --gmpx-color-surface: #242424;\n    --gmpx-color-on-surface: #ffffff;\n\n    /* CARD NIGHT POSITIONING */\n\n    --card-bg-top-position-clear-night: -20%;\n    --card-bg-top-position-cloudy-night: -50%;\n    --card-bg-top-position-very-cloudy-night: -40%;\n    --card-bg-top-position-fog-night: -100%;\n    --card-bg-top-position-light-rain-night: -80%;\n    --card-bg-top-position-rain-night: -80%;\n    --card-bg-top-position-heavy-rain-night: -80%;\n    --card-bg-top-position-light-snow-night: -80%;\n    --card-bg-top-position-snow-night: -80%;\n    --card-bg-top-position-thunderstorm-night: -150%;\n    --card-bg-top-position-heavy-snow-night: -80%;\n\n    --card-bg-left-position-clear-night: -130%;\n    --card-bg-left-position-cloudy-night: -120%;\n    --card-bg-left-position-very-cloudy-night: -60%;\n    --card-bg-left-position-fog-night: -100%;\n    --card-bg-left-position-light-rain-night: -60%;\n    --card-bg-left-position-rain-night: -60%;\n    --card-bg-left-position-heavy-rain-night: -60%;\n    --card-bg-left-position-light-snow-night: -60%;\n    --card-bg-left-position-snow-night: -60%;\n    --card-bg-left-position-thunderstorm-night: -20%;\n    --card-bg-left-position-heavy-snow-night: -60%;\n\n    /* CARD DAY POSITIONING */\n    --card-bg-top-position-sunny-day: 0%;\n    --card-bg-top-position-cloudy-day: 0%;\n    --card-bg-top-position-very-cloudy-day: -50%;\n    --card-bg-top-position-fog-day: -100%;\n    --card-bg-top-position-light-rain-day: -80%;\n    --card-bg-top-position-rain-day: -80%;\n    --card-bg-top-position-heavy-rain-day: -80%;\n    --card-bg-top-position-light-snow-day: -80%;\n    --card-bg-top-position-snow-day: -80%;\n    --card-bg-top-position-thunderstorm-day: -150%;\n    --card-bg-top-position-heavy-snow-day: -80%;\n\n    --card-bg-left-position-sunny-day: -130%;\n    --card-bg-left-position-cloudy-day: -130%;\n    --card-bg-left-position-very-cloudy-day: -60%;\n    --card-bg-left-position-fog-day: -100%;\n    --card-bg-left-position-light-rain-day: -60%;\n    --card-bg-left-position-rain-day: -60%;\n    --card-bg-left-position-heavy-rain-day: -60%;\n    --card-bg-left-position-light-snow-day: -60%;\n    --card-bg-left-position-snow-day: -60%;\n    --card-bg-left-position-thunderstorm-day: -20%;\n    --card-bg-left-position-heavy-snow-day: -60%;\n }\n \n #saved-locations {\n    gap: 12px;\n    max-width: 1000px;\n    margin-left: auto;\n    margin-right: auto;\n }\n\n .settings {\n    position: relative;\n    width: 100%;\n    display: flex;\n    justify-content: flex-end;\n }\n\n .search {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n }\n\n .search p {\n    font-size: 2rem;\n    font-weight: 600;\n }\n\n .search gmpx-place-picker {\n    width: 100%;\n }\n\n .search input:focus {\n    border: 0;\n }\n\n .search input::placeholder {\n    color: #757575;\n }\n\n #place-picker-box {\n     width: 100%;\n }\n\n #place-picker-container {\n     text-align: left;\n }\n \n .pac-container {\n    margin-top: 10px;\n    background-color: #000000;\n    border: 0;\n    text-align: left;\n    border: 0;\n }\n\n .pac-item {\n    border: 0;\n    margin-bottom: 5px;\n    cursor: pointer;\n }\n\n .pac-item span, span.pac-matched {\n    font-weight: 400;\n    font-size: 1rem;\n }\n\n .pac-item .pac-matched {\n    color: white;\n }\n\n .pac-item span {\n    color: #949494;\n }\n\n .pac-icon {\n    display: none;\n }\n\n .pac-item:hover {\n    background-color: #141414 !important;\n }\n\n /* location cards */\n\n .saved-locations-cards {\n    width: 100%;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n    position: relative;\n    z-index: 0;\n }\n\n .saved-locations-cards p {\n    text-shadow: 2px 2px 5px rgba(160, 160, 160, 0.8), 0px 0px 2px rgba(160, 160, 160, 0.8);\n }\n\n .location-container,\n .current-location-container {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    gap: 10px;\n }\n\n .location-card {\n    width: 100%;\n    height: 100px;\n    min-height: fit-content;\n    box-sizing: border-box;\n    padding: 15px;\n    border-radius: 15px;\n\n    display: grid;\n    grid-template-columns: 4fr 1fr;\n    grid-template-rows: 1fr;\n\n    position: relative;\n    overflow: hidden;\n}\n\n.location-card::before {\n    content: "";\n    position: absolute;\n    width: 300%;\n    height: 300%;\n    top: var(--top-position);\n    left: var(--left-position);\n    z-index: -1;\n    background: var(--background);\n    background-size: cover;\n}\n\n.location-card-left {\n    margin-right: auto;\n}\n\n.location-card-left, .location-card-right {\n    display: flex;\n    flex-direction: column;\n}\n\n.location-card-left p, .location-card-right p{\n    font-size: 0.8rem;\n    font-weight: 600;\n}\n\n.location-card-right {\n    align-items: center;\n}\n\np.city {\n    font-size: 1.2rem;\n}\n\np.current-temp {\n    font-size: 2.5rem;\n}\n\np.weather, .high-min-temp {\n    margin-top: auto;\n}\n\n.high-min-temp {\n    display: flex;\n    gap: 5px;\n}\n\n@media (min-width: 480px) and (max-width: 1499px) {\n    #location,\n    #saved-locations {\n        padding: 25px;\n    }\n\n    .location-card {\n        width: 100%;\n        height: 150px;\n    }\n\n    .location-card::before {\n        left: 0;\n        background-size: initial;\n    }\n}\n\n@media (min-width: 800px) and (max-width: 1499px) {\n    .location-card {\n        height: 150px;\n    }\n\n    #location,\n    #saved-locations {\n        padding: 40px;\n    }\n}\n\n@media (min-width: 1100px) and (max-width: 1499px) {\n    .location-card {\n        height: 15vh;\n    }\n}\n\n@media (min-width: 1500px) {\n    :root {\n        /* CARD NIGHT POSITIONING */\n        \n        --card-bg-top-position-clear-night: -20%;\n        --card-bg-top-position-cloudy-night: -50%;\n        --card-bg-top-position-very-cloudy-night: -50%;\n        --card-bg-top-position-fog-night: 0%;\n        --card-bg-top-position-light-rain-night: -100%;\n        --card-bg-top-position-rain-night: -100%;\n        --card-bg-top-position-heavy-rain-night: -100%;\n        --card-bg-top-position-light-snow-night: -100%;\n        --card-bg-top-position-snow-night: -100%;\n        --card-bg-top-position-thunderstorm-night: -100%;\n        --card-bg-top-position-heavy-snow-night: -100%;\n    \n        /* CARD DAY POSITIONING */\n        --card-bg-top-position-sunny-day: 0%;\n        --card-bg-top-position-cloudy-day: -30%;\n        --card-bg-top-position-very-cloudy-day: -100%;\n        --card-bg-top-position-fog-day: 0%;\n        --card-bg-top-position-light-rain-day: -100%;\n        --card-bg-top-position-rain-day: -100%;\n        --card-bg-top-position-heavy-rain-day: -100%;\n        --card-bg-top-position-light-snow-day: -100%;\n        --card-bg-top-position-snow-day: -100%;\n        --card-bg-top-position-thunderstorm-day: -100%;\n        --card-bg-top-position-heavy-snow-day: -100%;\n\n    }\n\n    #saved-locations {\n        width: 50vw;\n    }\n\n    .location-card::before {\n        left: 0;\n        background-size: initial;\n    }\n\n}'],sourceRoot:""}]);const s=o},6153:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,'.settings-menu {\n    position: absolute;\n    background-color: #444444;\n    width: 55%;\n    height: fit-content;\n    right: -10px;\n    top: 30px;\n    z-index: 1;\n    \n    box-sizing: border-box;\n    border-radius: 10px;\n\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    /* backdrop-filter: blur(200px) brightness(0.80);\n    -webkit-backdrop-filter: blur(200px); */\n\n    overflow: hidden;\n}\n\n.settings-menu.hidden-menu {\n    display: none;\n}\n\n.settings-menu .settings-option {\n    box-sizing: border-box;\n    font-weight: 300;\n    z-index: 200;\n    padding-inline: 10px;\n\n    display: grid;\n    grid-template-columns: 1fr 6fr 1fr;\n    grid-template-rows: 40px;\n    align-items: center;\n}\n\n.settings-menu .settings-option:hover {\n    background-color: #757575;\n}\n\n.settings-menu .settings-option svg:last-child{\n    margin-left: auto;\n}\n\n.settings-option img {\n    width: 16px;\n    height: 16px;\n}\n\n.settings-option img[src=""] {\n    visibility: hidden;\n}\n\n@media (min-width: 480px) and (max-width: 1025px) {\n    .settings-btn svg {\n        transform: scale(1.4);\n    }\n\n    .settings-menu {\n        width: 30%;\n    }\n\n    .settings-menu .settings-option {\n        grid-template-rows: 50px;\n    }\n}\n\n@media (min-width: 900px) and (max-width: 1499px) {\n    .settings-btn svg {\n        transform: scale(1.5);\n    }\n}\n\n@media (min-width: 1500px) {\n    #saved-locations {\n        width: 50%;\n        margin-left: auto;\n        margin-right: auto;\n    }\n\n    .settings-menu {\n        width: 20%;\n    }\n\n}',"",{version:3,sources:["webpack://./src/styles/settings-style.css"],names:[],mappings:"AAAA;IACI,kBAAkB;IAClB,yBAAyB;IACzB,UAAU;IACV,mBAAmB;IACnB,YAAY;IACZ,SAAS;IACT,UAAU;;IAEV,sBAAsB;IACtB,mBAAmB;;IAEnB,aAAa;IACb,sBAAsB;IACtB,uBAAuB;;IAEvB;2CACuC;;IAEvC,gBAAgB;AACpB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,sBAAsB;IACtB,gBAAgB;IAChB,YAAY;IACZ,oBAAoB;;IAEpB,aAAa;IACb,kCAAkC;IAClC,wBAAwB;IACxB,mBAAmB;AACvB;;AAEA;IACI,yBAAyB;AAC7B;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,kBAAkB;AACtB;;AAEA;IACI;QACI,qBAAqB;IACzB;;IAEA;QACI,UAAU;IACd;;IAEA;QACI,wBAAwB;IAC5B;AACJ;;AAEA;IACI;QACI,qBAAqB;IACzB;AACJ;;AAEA;IACI;QACI,UAAU;QACV,iBAAiB;QACjB,kBAAkB;IACtB;;IAEA;QACI,UAAU;IACd;;AAEJ",sourcesContent:['.settings-menu {\n    position: absolute;\n    background-color: #444444;\n    width: 55%;\n    height: fit-content;\n    right: -10px;\n    top: 30px;\n    z-index: 1;\n    \n    box-sizing: border-box;\n    border-radius: 10px;\n\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    /* backdrop-filter: blur(200px) brightness(0.80);\n    -webkit-backdrop-filter: blur(200px); */\n\n    overflow: hidden;\n}\n\n.settings-menu.hidden-menu {\n    display: none;\n}\n\n.settings-menu .settings-option {\n    box-sizing: border-box;\n    font-weight: 300;\n    z-index: 200;\n    padding-inline: 10px;\n\n    display: grid;\n    grid-template-columns: 1fr 6fr 1fr;\n    grid-template-rows: 40px;\n    align-items: center;\n}\n\n.settings-menu .settings-option:hover {\n    background-color: #757575;\n}\n\n.settings-menu .settings-option svg:last-child{\n    margin-left: auto;\n}\n\n.settings-option img {\n    width: 16px;\n    height: 16px;\n}\n\n.settings-option img[src=""] {\n    visibility: hidden;\n}\n\n@media (min-width: 480px) and (max-width: 1025px) {\n    .settings-btn svg {\n        transform: scale(1.4);\n    }\n\n    .settings-menu {\n        width: 30%;\n    }\n\n    .settings-menu .settings-option {\n        grid-template-rows: 50px;\n    }\n}\n\n@media (min-width: 900px) and (max-width: 1499px) {\n    .settings-btn svg {\n        transform: scale(1.5);\n    }\n}\n\n@media (min-width: 1500px) {\n    #saved-locations {\n        width: 50%;\n        margin-left: auto;\n        margin-right: auto;\n    }\n\n    .settings-menu {\n        width: 20%;\n    }\n\n}'],sourceRoot:""}]);const s=o},1442:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.sunrise-sunset .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.js-sunrise-sunset-main-time {\n    font-size: 2.5rem;\n}\n\n.js-sunrise-sunset-next-time {\n    margin-top: auto;\n    font-size: 0.95rem;\n}","",{version:3,sources:["webpack://./src/styles/sunrise-sunset-style.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,WAAW;IACX,aAAa;IACb,sBAAsB;AAC1B;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,gBAAgB;IAChB,kBAAkB;AACtB",sourcesContent:[".card.sunrise-sunset .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n}\n\n.js-sunrise-sunset-main-time {\n    font-size: 2.5rem;\n}\n\n.js-sunrise-sunset-next-time {\n    margin-top: auto;\n    font-size: 0.95rem;\n}"],sourceRoot:""}]);const s=o},4224:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.uv-index .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n}\n\n.js-uv-index {\n    width: 100%;\n}\n\n.js-index {\n    font-size: 2.5rem;\n}\n\n.js-scale {\n    font-size: 1.3rem;\n}\n\n.js-uv-bar {\n    width: 100%;\n    height: 8px;\n    position: relative;\n    border-radius: 5px;\n    background: linear-gradient(90deg, rgba(60, 193, 65, 1) 0%, rgba(150, 232, 23, 1) 10%, rgba(201, 255, 138, 1) 20%, rgba(245, 255, 0, 1) 33%, rgba(255, 111, 0, 1) 60%, rgba(255, 0, 0, 1) 70%, rgba(250, 0, 122, 1) 80%, rgba(255, 0, 211, 1) 90%, rgba(218, 0, 255, 1) 100%);\n}\n\n.js-uv-bar .js-bar {\n    height: 100%;\n    width: 8px;\n    left: 0%;\n    position: absolute;\n    border-radius: 5px;\n    background: #ffffff;\n}\n\n.js-uv-desc {\n    margin-top: auto;\n}","",{version:3,sources:["webpack://./src/styles/uv-index-style.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,WAAW;IACX,aAAa;IACb,sBAAsB;IACtB,QAAQ;AACZ;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,WAAW;IACX,WAAW;IACX,kBAAkB;IAClB,kBAAkB;IAClB,6QAA6Q;AACjR;;AAEA;IACI,YAAY;IACZ,UAAU;IACV,QAAQ;IACR,kBAAkB;IAClB,kBAAkB;IAClB,mBAAmB;AACvB;;AAEA;IACI,gBAAgB;AACpB",sourcesContent:[".card.uv-index .card-content {\n    height: 100%;\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 5px;\n}\n\n.js-uv-index {\n    width: 100%;\n}\n\n.js-index {\n    font-size: 2.5rem;\n}\n\n.js-scale {\n    font-size: 1.3rem;\n}\n\n.js-uv-bar {\n    width: 100%;\n    height: 8px;\n    position: relative;\n    border-radius: 5px;\n    background: linear-gradient(90deg, rgba(60, 193, 65, 1) 0%, rgba(150, 232, 23, 1) 10%, rgba(201, 255, 138, 1) 20%, rgba(245, 255, 0, 1) 33%, rgba(255, 111, 0, 1) 60%, rgba(255, 0, 0, 1) 70%, rgba(250, 0, 122, 1) 80%, rgba(255, 0, 211, 1) 90%, rgba(218, 0, 255, 1) 100%);\n}\n\n.js-uv-bar .js-bar {\n    height: 100%;\n    width: 8px;\n    left: 0%;\n    position: absolute;\n    border-radius: 5px;\n    background: #ffffff;\n}\n\n.js-uv-desc {\n    margin-top: auto;\n}"],sourceRoot:""}]);const s=o},3516:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(1354),r=n.n(i),a=n(6314),o=n.n(a)()(r());o.push([t.id,".card.wind .card-content {\n    height: 100%;\n    width: 100%;\n    display: grid;\n    grid-template-columns: 1.5fr 1fr;\n}\n\n.wind-speed {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    gap: 10px;\n    width: 90%;\n}\n\n.wind-type-wind, .wind-type-gust {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.wind-left {\n    font-size: 2.5rem;\n    width: 25%;\n}\n\n.wind-right {\n    display: flex;\n    flex-direction: column;\n    gap: 3px;\n}\n\n.wind-right p {\n    font-size: 0.9rem;\n}\n\n.wind-metric {\n    color: #ddddddad;\n}\n\n.wind-direction {\n    width: 100%;\n}\n\n.circle {\n    height: 100%;\n    width: 100%;\n    position: relative;\n}\n\n.circle img {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    z-index: 1;\n}\n\n.circle img.arrow {\n    transform: rotate(0deg);\n    scale: 0.98;\n}\n\n.circle .direction {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 100;\n}\n\n.circle p {\n    width: 40px;\n    height: 40px;\n    background-color: rgb(70, 182, 243);\n    border-radius: 50%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: white;\n    font-size: 1.2rem;\n    line-height: 0;\n}\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    .circle p {\n        width: 50px;\n        height: 50px;\n    }\n}","",{version:3,sources:["webpack://./src/styles/wind-style.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,WAAW;IACX,aAAa;IACb,gCAAgC;AACpC;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,uBAAuB;IACvB,SAAS;IACT,UAAU;AACd;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,SAAS;AACb;;AAEA;IACI,iBAAiB;IACjB,UAAU;AACd;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,QAAQ;AACZ;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,YAAY;IACZ,WAAW;IACX,kBAAkB;AACtB;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,iBAAiB;IACjB,kBAAkB;IAClB,YAAY;IACZ,UAAU;AACd;;AAEA;IACI,uBAAuB;IACvB,WAAW;AACf;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,iBAAiB;IACjB,kBAAkB;IAClB,YAAY;IACZ,aAAa;IACb,uBAAuB;IACvB,mBAAmB;IACnB,YAAY;AAChB;;AAEA;IACI,WAAW;IACX,YAAY;IACZ,mCAAmC;IACnC,kBAAkB;IAClB,aAAa;IACb,uBAAuB;IACvB,mBAAmB;IACnB,YAAY;IACZ,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI;QACI,WAAW;QACX,YAAY;IAChB;AACJ",sourcesContent:[".card.wind .card-content {\n    height: 100%;\n    width: 100%;\n    display: grid;\n    grid-template-columns: 1.5fr 1fr;\n}\n\n.wind-speed {\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    gap: 10px;\n    width: 90%;\n}\n\n.wind-type-wind, .wind-type-gust {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.wind-left {\n    font-size: 2.5rem;\n    width: 25%;\n}\n\n.wind-right {\n    display: flex;\n    flex-direction: column;\n    gap: 3px;\n}\n\n.wind-right p {\n    font-size: 0.9rem;\n}\n\n.wind-metric {\n    color: #ddddddad;\n}\n\n.wind-direction {\n    width: 100%;\n}\n\n.circle {\n    height: 100%;\n    width: 100%;\n    position: relative;\n}\n\n.circle img {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    z-index: 1;\n}\n\n.circle img.arrow {\n    transform: rotate(0deg);\n    scale: 0.98;\n}\n\n.circle .direction {\n    position: absolute;\n    left: 0;\n    right: 0;\n    margin-left: auto;\n    margin-right: auto;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 100;\n}\n\n.circle p {\n    width: 40px;\n    height: 40px;\n    background-color: rgb(70, 182, 243);\n    border-radius: 50%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    color: white;\n    font-size: 1.2rem;\n    line-height: 0;\n}\n\n@media (min-width: 550px) and (max-width: 1499px) {\n    .circle p {\n        width: 50px;\n        height: 50px;\n    }\n}"],sourceRoot:""}]);const s=o},6314:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,a){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(o[l]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);i&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},4417:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},1354:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),a="/*# ".concat(r," */");return[e].concat([a]).join("\n")}return[e].join("\n")}},7007:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,a),i(n)}function a(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}f(t,e,a,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&f(t,"error",e,{once:!0})}(t,r)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function c(t,e,n,i){var r,a,o,c;if(s(n),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),o=a[e]),void 0===o)o=a[e]=n,++t._eventsCount;else if("function"==typeof o?o=a[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=l(t))>0&&o.length>r&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=o.length,c=u,console&&console.warn&&console.warn(c)}return t}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=u.bind(i);return r.listener=n,i.wrapFn=r,r}function d(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):m(r,r.length)}function p(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function f(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(a){i.once&&t.removeEventListener(e,r),n(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");o=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[t];if(void 0===l)return!1;if("function"==typeof l)i(l,this,e);else{var c=l.length,u=m(l,c);for(n=0;n<c;++n)i(u[n],this,e)}return!0},a.prototype.addListener=function(t,e){return c(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return c(this,t,e,!0)},a.prototype.once=function(t,e){return s(e),this.on(t,h(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return s(e),this.prependListener(t,h(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,i,r,a,o;if(s(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},2162:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Builder:()=>p,ByteBuffer:()=>d,Encoding:()=>h,FILE_IDENTIFIER_LENGTH:()=>a,SIZEOF_INT:()=>r,SIZEOF_SHORT:()=>i,SIZE_PREFIX_LENGTH:()=>o,float32:()=>l,float64:()=>c,int32:()=>s,isLittleEndian:()=>u});const i=2,r=4,a=4,o=4,s=new Int32Array(2),l=new Float32Array(s.buffer),c=new Float64Array(s.buffer),u=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];var h;!function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(h||(h={}));class d{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new d(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return s[0]=this.readInt32(t),l[0]}readFloat64(t){return s[u?0:1]=this.readInt32(t),s[u?1:0]=this.readInt32(t+4),c[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){l[0]=e,this.writeInt32(t,s[0])}writeFloat64(t,e){c[0]=e,this.writeInt32(t,s[u?0:1]),this.writeInt32(t+4,s[u?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+r+a)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<a;e++)t+=String.fromCharCode(this.readInt8(this.position_+r+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=r;const i=this.bytes_.subarray(t,t+n);return e===h.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+r}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=a)throw new Error("FlatBuffers: file identifier must be length "+a);for(let e=0;e<a;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+r+e))return!1;return!0}createScalarList(t,e){const n=[];for(let i=0;i<e;++i){const e=t(i);null!==e&&n.push(e)}return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const e=t(i);null!==e&&n.push(e.unpack())}return n}}class p{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,e=t||1024,this.bb=d.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=p.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||e!==n)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,i=d.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(r,0),this.writeInt32(this.offset()-t+r)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const r=(n+2)*i;this.addInt16(r);let a=0;const o=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(t)){for(let e=i;e<r;e+=i)if(this.bb.readInt16(o+e)!=this.bb.readInt16(t+e))continue t;a=this.vtables[e];break}}return a?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,a-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const i=n?o:0;if(e){const t=e;if(this.prep(this.minalign,r+a+i),t.length!=a)throw new TypeError("FlatBuffers: file identifier must be length "+a);for(let e=a-1;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,r+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(e<this.bb.readInt16(i)&&0!=this.bb.readInt16(i+e)))throw new TypeError("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(r,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(null==t)return 0;let e;return e=t instanceof Uint8Array?t:this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector()}createByteVector(t){return null==t?0:(this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];if(null===i)throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(i))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}}},2543:function(t,e,n){var i;t=n.nmd(t),function(){var r,a="Expected a function",o="__lodash_hash_undefined__",s="__lodash_placeholder__",l=32,c=128,u=1/0,h=9007199254740991,d=NaN,p=4294967295,m=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",l],["partialRight",64],["rearg",256]],f="[object Arguments]",g="[object Array]",v="[object Boolean]",y="[object Date]",_="[object Error]",x="[object Function]",b="[object GeneratorFunction]",A="[object Map]",w="[object Number]",C="[object Object]",E="[object Promise]",S="[object RegExp]",M="[object Set]",T="[object String]",I="[object Symbol]",B="[object WeakMap]",L="[object ArrayBuffer]",D="[object DataView]",P="[object Float32Array]",R="[object Float64Array]",k="[object Int8Array]",z="[object Int16Array]",F="[object Int32Array]",O="[object Uint8Array]",N="[object Uint8ClampedArray]",U="[object Uint16Array]",V="[object Uint32Array]",G=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,j=/(__e\(.*?\)|\b__t\)) \+\n'';/g,W=/&(?:amp|lt|gt|quot|#39);/g,q=/[&<>"']/g,Z=RegExp(W.source),$=RegExp(q.source),Y=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,K=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),it=/^\s+/,rt=/\s/,at=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ot=/\{\n\/\* \[wrapped with (.+)\] \*/,st=/,? & /,lt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,ut=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,dt=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,ft=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,vt=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,xt=/['\n\r\u2028\u2029\\]/g,bt="\\ud800-\\udfff",At="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",wt="\\u2700-\\u27bf",Ct="a-z\\xdf-\\xf6\\xf8-\\xff",Et="A-Z\\xc0-\\xd6\\xd8-\\xde",St="\\ufe0e\\ufe0f",Mt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Tt="["+bt+"]",It="["+Mt+"]",Bt="["+At+"]",Lt="\\d+",Dt="["+wt+"]",Pt="["+Ct+"]",Rt="[^"+bt+Mt+Lt+wt+Ct+Et+"]",kt="\\ud83c[\\udffb-\\udfff]",zt="[^"+bt+"]",Ft="(?:\\ud83c[\\udde6-\\uddff]){2}",Ot="[\\ud800-\\udbff][\\udc00-\\udfff]",Nt="["+Et+"]",Ut="\\u200d",Vt="(?:"+Pt+"|"+Rt+")",Gt="(?:"+Nt+"|"+Rt+")",Ht="(?:['](?:d|ll|m|re|s|t|ve))?",jt="(?:['](?:D|LL|M|RE|S|T|VE))?",Wt="(?:"+Bt+"|"+kt+")?",qt="["+St+"]?",Zt=qt+Wt+"(?:"+Ut+"(?:"+[zt,Ft,Ot].join("|")+")"+qt+Wt+")*",$t="(?:"+[Dt,Ft,Ot].join("|")+")"+Zt,Yt="(?:"+[zt+Bt+"?",Bt,Ft,Ot,Tt].join("|")+")",Xt=RegExp("[']","g"),Qt=RegExp(Bt,"g"),Jt=RegExp(kt+"(?="+kt+")|"+Yt+Zt,"g"),Kt=RegExp([Nt+"?"+Pt+"+"+Ht+"(?="+[It,Nt,"$"].join("|")+")",Gt+"+"+jt+"(?="+[It,Nt+Vt,"$"].join("|")+")",Nt+"?"+Vt+"+"+Ht,Nt+"+"+jt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Lt,$t].join("|"),"g"),te=RegExp("["+Ut+bt+At+St+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ne=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ie=-1,re={};re[P]=re[R]=re[k]=re[z]=re[F]=re[O]=re[N]=re[U]=re[V]=!0,re[f]=re[g]=re[L]=re[v]=re[D]=re[y]=re[_]=re[x]=re[A]=re[w]=re[C]=re[S]=re[M]=re[T]=re[B]=!1;var ae={};ae[f]=ae[g]=ae[L]=ae[D]=ae[v]=ae[y]=ae[P]=ae[R]=ae[k]=ae[z]=ae[F]=ae[A]=ae[w]=ae[C]=ae[S]=ae[M]=ae[T]=ae[I]=ae[O]=ae[N]=ae[U]=ae[V]=!0,ae[_]=ae[x]=ae[B]=!1;var oe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},se=parseFloat,le=parseInt,ce="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ue="object"==typeof self&&self&&self.Object===Object&&self,he=ce||ue||Function("return this")(),de=e&&!e.nodeType&&e,pe=de&&t&&!t.nodeType&&t,me=pe&&pe.exports===de,fe=me&&ce.process,ge=function(){try{return pe&&pe.require&&pe.require("util").types||fe&&fe.binding&&fe.binding("util")}catch(t){}}(),ve=ge&&ge.isArrayBuffer,ye=ge&&ge.isDate,_e=ge&&ge.isMap,xe=ge&&ge.isRegExp,be=ge&&ge.isSet,Ae=ge&&ge.isTypedArray;function we(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ce(t,e,n,i){for(var r=-1,a=null==t?0:t.length;++r<a;){var o=t[r];e(i,o,n(o),t)}return i}function Ee(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function Se(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Me(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function Te(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a}function Ie(t,e){return!(null==t||!t.length)&&Ne(t,e,0)>-1}function Be(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function Le(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function De(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function Pe(t,e,n,i){var r=-1,a=null==t?0:t.length;for(i&&a&&(n=t[++r]);++r<a;)n=e(n,t[r],r,t);return n}function Re(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function ke(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var ze=He("length");function Fe(t,e,n){var i;return n(t,(function(t,n,r){if(e(t,n,r))return i=n,!1})),i}function Oe(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1}function Ne(t,e,n){return e==e?function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):Oe(t,Ve,n)}function Ue(t,e,n,i){for(var r=n-1,a=t.length;++r<a;)if(i(t[r],e))return r;return-1}function Ve(t){return t!=t}function Ge(t,e){var n=null==t?0:t.length;return n?qe(t,e)/n:d}function He(t){return function(e){return null==e?r:e[t]}}function je(t){return function(e){return null==t?r:t[e]}}function We(t,e,n,i,r){return r(t,(function(t,r,a){n=i?(i=!1,t):e(n,t,r,a)})),n}function qe(t,e){for(var n,i=-1,a=t.length;++i<a;){var o=e(t[i]);o!==r&&(n=n===r?o:n+o)}return n}function Ze(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function $e(t){return t?t.slice(0,dn(t)+1).replace(it,""):t}function Ye(t){return function(e){return t(e)}}function Xe(t,e){return Le(e,(function(e){return t[e]}))}function Qe(t,e){return t.has(e)}function Je(t,e){for(var n=-1,i=t.length;++n<i&&Ne(e,t[n],0)>-1;);return n}function Ke(t,e){for(var n=t.length;n--&&Ne(e,t[n],0)>-1;);return n}var tn=je({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),en=je({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(t){return"\\"+oe[t]}function rn(t){return te.test(t)}function an(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function on(t,e){return function(n){return t(e(n))}}function sn(t,e){for(var n=-1,i=t.length,r=0,a=[];++n<i;){var o=t[n];o!==e&&o!==s||(t[n]=s,a[r++]=n)}return a}function ln(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function cn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function un(t){return rn(t)?function(t){for(var e=Jt.lastIndex=0;Jt.test(t);)++e;return e}(t):ze(t)}function hn(t){return rn(t)?function(t){return t.match(Jt)||[]}(t):function(t){return t.split("")}(t)}function dn(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var pn=je({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),mn=function t(e){var n,i=(e=null==e?he:mn.defaults(he.Object(),e,mn.pick(he,ne))).Array,rt=e.Date,bt=e.Error,At=e.Function,wt=e.Math,Ct=e.Object,Et=e.RegExp,St=e.String,Mt=e.TypeError,Tt=i.prototype,It=At.prototype,Bt=Ct.prototype,Lt=e["__core-js_shared__"],Dt=It.toString,Pt=Bt.hasOwnProperty,Rt=0,kt=(n=/[^.]+$/.exec(Lt&&Lt.keys&&Lt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",zt=Bt.toString,Ft=Dt.call(Ct),Ot=he._,Nt=Et("^"+Dt.call(Pt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=me?e.Buffer:r,Vt=e.Symbol,Gt=e.Uint8Array,Ht=Ut?Ut.allocUnsafe:r,jt=on(Ct.getPrototypeOf,Ct),Wt=Ct.create,qt=Bt.propertyIsEnumerable,Zt=Tt.splice,$t=Vt?Vt.isConcatSpreadable:r,Yt=Vt?Vt.iterator:r,Jt=Vt?Vt.toStringTag:r,te=function(){try{var t=la(Ct,"defineProperty");return t({},"",{}),t}catch(t){}}(),oe=e.clearTimeout!==he.clearTimeout&&e.clearTimeout,ce=rt&&rt.now!==he.Date.now&&rt.now,ue=e.setTimeout!==he.setTimeout&&e.setTimeout,de=wt.ceil,pe=wt.floor,fe=Ct.getOwnPropertySymbols,ge=Ut?Ut.isBuffer:r,ze=e.isFinite,je=Tt.join,fn=on(Ct.keys,Ct),gn=wt.max,vn=wt.min,yn=rt.now,_n=e.parseInt,xn=wt.random,bn=Tt.reverse,An=la(e,"DataView"),wn=la(e,"Map"),Cn=la(e,"Promise"),En=la(e,"Set"),Sn=la(e,"WeakMap"),Mn=la(Ct,"create"),Tn=Sn&&new Sn,In={},Bn=za(An),Ln=za(wn),Dn=za(Cn),Pn=za(En),Rn=za(Sn),kn=Vt?Vt.prototype:r,zn=kn?kn.valueOf:r,Fn=kn?kn.toString:r;function On(t){if(ts(t)&&!Ho(t)&&!(t instanceof Gn)){if(t instanceof Vn)return t;if(Pt.call(t,"__wrapped__"))return Fa(t)}return new Vn(t)}var Nn=function(){function t(){}return function(e){if(!Ko(e))return{};if(Wt)return Wt(e);t.prototype=e;var n=new t;return t.prototype=r,n}}();function Un(){}function Vn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function Gn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function jn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Wn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function qn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Wn;++e<n;)this.add(t[e])}function Zn(t){var e=this.__data__=new jn(t);this.size=e.size}function $n(t,e){var n=Ho(t),i=!n&&Go(t),r=!n&&!i&&Zo(t),a=!n&&!i&&!r&&ls(t),o=n||i||r||a,s=o?Ze(t.length,St):[],l=s.length;for(var c in t)!e&&!Pt.call(t,c)||o&&("length"==c||r&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||fa(c,l))||s.push(c);return s}function Yn(t){var e=t.length;return e?t[Wi(0,e-1)]:r}function Xn(t,e){return La(Sr(t),ai(e,0,t.length))}function Qn(t){return La(Sr(t))}function Jn(t,e,n){(n!==r&&!No(t[e],n)||n===r&&!(e in t))&&ii(t,e,n)}function Kn(t,e,n){var i=t[e];Pt.call(t,e)&&No(i,n)&&(n!==r||e in t)||ii(t,e,n)}function ti(t,e){for(var n=t.length;n--;)if(No(t[n][0],e))return n;return-1}function ei(t,e,n,i){return ui(t,(function(t,r,a){e(i,t,n(t),a)})),i}function ni(t,e){return t&&Mr(e,Bs(e),t)}function ii(t,e,n){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ri(t,e){for(var n=-1,a=e.length,o=i(a),s=null==t;++n<a;)o[n]=s?r:Es(t,e[n]);return o}function ai(t,e,n){return t==t&&(n!==r&&(t=t<=n?t:n),e!==r&&(t=t>=e?t:e)),t}function oi(t,e,n,i,a,o){var s,l=1&e,c=2&e,u=4&e;if(n&&(s=a?n(t,i,a,o):n(t)),s!==r)return s;if(!Ko(t))return t;var h=Ho(t);if(h){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Pt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!l)return Sr(t,s)}else{var d=ha(t),p=d==x||d==b;if(Zo(t))return xr(t,l);if(d==C||d==f||p&&!a){if(s=c||p?{}:pa(t),!l)return c?function(t,e){return Mr(t,ua(t),e)}(t,function(t,e){return t&&Mr(e,Ls(e),t)}(s,t)):function(t,e){return Mr(t,ca(t),e)}(t,ni(s,t))}else{if(!ae[d])return a?t:{};s=function(t,e,n){var i,r=t.constructor;switch(e){case L:return br(t);case v:case y:return new r(+t);case D:return function(t,e){var n=e?br(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case P:case R:case k:case z:case F:case O:case N:case U:case V:return Ar(t,n);case A:return new r;case w:case T:return new r(t);case S:return function(t){var e=new t.constructor(t.source,dt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case M:return new r;case I:return i=t,zn?Ct(zn.call(i)):{}}}(t,d,l)}}o||(o=new Zn);var m=o.get(t);if(m)return m;o.set(t,s),as(t)?t.forEach((function(i){s.add(oi(i,e,n,i,t,o))})):es(t)&&t.forEach((function(i,r){s.set(r,oi(i,e,n,r,t,o))}));var g=h?r:(u?c?ea:ta:c?Ls:Bs)(t);return Ee(g||t,(function(i,r){g&&(i=t[r=i]),Kn(s,r,oi(i,e,n,r,t,o))})),s}function si(t,e,n){var i=n.length;if(null==t)return!i;for(t=Ct(t);i--;){var a=n[i],o=e[a],s=t[a];if(s===r&&!(a in t)||!o(s))return!1}return!0}function li(t,e,n){if("function"!=typeof t)throw new Mt(a);return Ma((function(){t.apply(r,n)}),e)}function ci(t,e,n,i){var r=-1,a=Ie,o=!0,s=t.length,l=[],c=e.length;if(!s)return l;n&&(e=Le(e,Ye(n))),i?(a=Be,o=!1):e.length>=200&&(a=Qe,o=!1,e=new qn(e));t:for(;++r<s;){var u=t[r],h=null==n?u:n(u);if(u=i||0!==u?u:0,o&&h==h){for(var d=c;d--;)if(e[d]===h)continue t;l.push(u)}else a(e,h,i)||l.push(u)}return l}On.templateSettings={escape:Y,evaluate:X,interpolate:Q,variable:"",imports:{_:On}},On.prototype=Un.prototype,On.prototype.constructor=On,Vn.prototype=Nn(Un.prototype),Vn.prototype.constructor=Vn,Gn.prototype=Nn(Un.prototype),Gn.prototype.constructor=Gn,Hn.prototype.clear=function(){this.__data__=Mn?Mn(null):{},this.size=0},Hn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Hn.prototype.get=function(t){var e=this.__data__;if(Mn){var n=e[t];return n===o?r:n}return Pt.call(e,t)?e[t]:r},Hn.prototype.has=function(t){var e=this.__data__;return Mn?e[t]!==r:Pt.call(e,t)},Hn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Mn&&e===r?o:e,this},jn.prototype.clear=function(){this.__data__=[],this.size=0},jn.prototype.delete=function(t){var e=this.__data__,n=ti(e,t);return!(n<0||(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,0))},jn.prototype.get=function(t){var e=this.__data__,n=ti(e,t);return n<0?r:e[n][1]},jn.prototype.has=function(t){return ti(this.__data__,t)>-1},jn.prototype.set=function(t,e){var n=this.__data__,i=ti(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Wn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(wn||jn),string:new Hn}},Wn.prototype.delete=function(t){var e=oa(this,t).delete(t);return this.size-=e?1:0,e},Wn.prototype.get=function(t){return oa(this,t).get(t)},Wn.prototype.has=function(t){return oa(this,t).has(t)},Wn.prototype.set=function(t,e){var n=oa(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},qn.prototype.add=qn.prototype.push=function(t){return this.__data__.set(t,o),this},qn.prototype.has=function(t){return this.__data__.has(t)},Zn.prototype.clear=function(){this.__data__=new jn,this.size=0},Zn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Zn.prototype.get=function(t){return this.__data__.get(t)},Zn.prototype.has=function(t){return this.__data__.has(t)},Zn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof jn){var i=n.__data__;if(!wn||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Wn(i)}return n.set(t,e),this.size=n.size,this};var ui=Br(yi),hi=Br(_i,!0);function di(t,e){var n=!0;return ui(t,(function(t,i,r){return n=!!e(t,i,r)})),n}function pi(t,e,n){for(var i=-1,a=t.length;++i<a;){var o=t[i],s=e(o);if(null!=s&&(l===r?s==s&&!ss(s):n(s,l)))var l=s,c=o}return c}function mi(t,e){var n=[];return ui(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function fi(t,e,n,i,r){var a=-1,o=t.length;for(n||(n=ma),r||(r=[]);++a<o;){var s=t[a];e>0&&n(s)?e>1?fi(s,e-1,n,i,r):De(r,s):i||(r[r.length]=s)}return r}var gi=Lr(),vi=Lr(!0);function yi(t,e){return t&&gi(t,e,Bs)}function _i(t,e){return t&&vi(t,e,Bs)}function xi(t,e){return Te(e,(function(e){return Xo(t[e])}))}function bi(t,e){for(var n=0,i=(e=gr(e,t)).length;null!=t&&n<i;)t=t[ka(e[n++])];return n&&n==i?t:r}function Ai(t,e,n){var i=e(t);return Ho(t)?i:De(i,n(t))}function wi(t){return null==t?t===r?"[object Undefined]":"[object Null]":Jt&&Jt in Ct(t)?function(t){var e=Pt.call(t,Jt),n=t[Jt];try{t[Jt]=r;var i=!0}catch(t){}var a=zt.call(t);return i&&(e?t[Jt]=n:delete t[Jt]),a}(t):function(t){return zt.call(t)}(t)}function Ci(t,e){return t>e}function Ei(t,e){return null!=t&&Pt.call(t,e)}function Si(t,e){return null!=t&&e in Ct(t)}function Mi(t,e,n){for(var a=n?Be:Ie,o=t[0].length,s=t.length,l=s,c=i(s),u=1/0,h=[];l--;){var d=t[l];l&&e&&(d=Le(d,Ye(e))),u=vn(d.length,u),c[l]=!n&&(e||o>=120&&d.length>=120)?new qn(l&&d):r}d=t[0];var p=-1,m=c[0];t:for(;++p<o&&h.length<u;){var f=d[p],g=e?e(f):f;if(f=n||0!==f?f:0,!(m?Qe(m,g):a(h,g,n))){for(l=s;--l;){var v=c[l];if(!(v?Qe(v,g):a(t[l],g,n)))continue t}m&&m.push(g),h.push(f)}}return h}function Ti(t,e,n){var i=null==(t=Ca(t,e=gr(e,t)))?t:t[ka($a(e))];return null==i?r:we(i,t,n)}function Ii(t){return ts(t)&&wi(t)==f}function Bi(t,e,n,i,a){return t===e||(null==t||null==e||!ts(t)&&!ts(e)?t!=t&&e!=e:function(t,e,n,i,a,o){var s=Ho(t),l=Ho(e),c=s?g:ha(t),u=l?g:ha(e),h=(c=c==f?C:c)==C,d=(u=u==f?C:u)==C,p=c==u;if(p&&Zo(t)){if(!Zo(e))return!1;s=!0,h=!1}if(p&&!h)return o||(o=new Zn),s||ls(t)?Jr(t,e,n,i,a,o):function(t,e,n,i,r,a,o){switch(n){case D:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case L:return!(t.byteLength!=e.byteLength||!a(new Gt(t),new Gt(e)));case v:case y:case w:return No(+t,+e);case _:return t.name==e.name&&t.message==e.message;case S:case T:return t==e+"";case A:var s=an;case M:var l=1&i;if(s||(s=ln),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=2,o.set(t,e);var u=Jr(s(t),s(e),i,r,a,o);return o.delete(t),u;case I:if(zn)return zn.call(t)==zn.call(e)}return!1}(t,e,c,n,i,a,o);if(!(1&n)){var m=h&&Pt.call(t,"__wrapped__"),x=d&&Pt.call(e,"__wrapped__");if(m||x){var b=m?t.value():t,E=x?e.value():e;return o||(o=new Zn),a(b,E,n,i,o)}}return!!p&&(o||(o=new Zn),function(t,e,n,i,a,o){var s=1&n,l=ta(t),c=l.length;if(c!=ta(e).length&&!s)return!1;for(var u=c;u--;){var h=l[u];if(!(s?h in e:Pt.call(e,h)))return!1}var d=o.get(t),p=o.get(e);if(d&&p)return d==e&&p==t;var m=!0;o.set(t,e),o.set(e,t);for(var f=s;++u<c;){var g=t[h=l[u]],v=e[h];if(i)var y=s?i(v,g,h,e,t,o):i(g,v,h,t,e,o);if(!(y===r?g===v||a(g,v,n,i,o):y)){m=!1;break}f||(f="constructor"==h)}if(m&&!f){var _=t.constructor,x=e.constructor;_==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof x&&x instanceof x||(m=!1)}return o.delete(t),o.delete(e),m}(t,e,n,i,a,o))}(t,e,n,i,Bi,a))}function Li(t,e,n,i){var a=n.length,o=a,s=!i;if(null==t)return!o;for(t=Ct(t);a--;){var l=n[a];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<o;){var c=(l=n[a])[0],u=t[c],h=l[1];if(s&&l[2]){if(u===r&&!(c in t))return!1}else{var d=new Zn;if(i)var p=i(u,h,c,t,e,d);if(!(p===r?Bi(h,u,3,i,d):p))return!1}}return!0}function Di(t){return!(!Ko(t)||(e=t,kt&&kt in e))&&(Xo(t)?Nt:ft).test(za(t));var e}function Pi(t){return"function"==typeof t?t:null==t?nl:"object"==typeof t?Ho(t)?Oi(t[0],t[1]):Fi(t):hl(t)}function Ri(t){if(!xa(t))return fn(t);var e=[];for(var n in Ct(t))Pt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function ki(t,e){return t<e}function zi(t,e){var n=-1,r=Wo(t)?i(t.length):[];return ui(t,(function(t,i,a){r[++n]=e(t,i,a)})),r}function Fi(t){var e=sa(t);return 1==e.length&&e[0][2]?Aa(e[0][0],e[0][1]):function(n){return n===t||Li(n,t,e)}}function Oi(t,e){return va(t)&&ba(e)?Aa(ka(t),e):function(n){var i=Es(n,t);return i===r&&i===e?Ss(n,t):Bi(e,i,3)}}function Ni(t,e,n,i,a){t!==e&&gi(e,(function(o,s){if(a||(a=new Zn),Ko(o))!function(t,e,n,i,a,o,s){var l=Ea(t,n),c=Ea(e,n),u=s.get(c);if(u)Jn(t,n,u);else{var h=o?o(l,c,n+"",t,e,s):r,d=h===r;if(d){var p=Ho(c),m=!p&&Zo(c),f=!p&&!m&&ls(c);h=c,p||m||f?Ho(l)?h=l:qo(l)?h=Sr(l):m?(d=!1,h=xr(c,!0)):f?(d=!1,h=Ar(c,!0)):h=[]:is(c)||Go(c)?(h=l,Go(l)?h=gs(l):Ko(l)&&!Xo(l)||(h=pa(c))):d=!1}d&&(s.set(c,h),a(h,c,i,o,s),s.delete(c)),Jn(t,n,h)}}(t,e,s,n,Ni,i,a);else{var l=i?i(Ea(t,s),o,s+"",t,e,a):r;l===r&&(l=o),Jn(t,s,l)}}),Ls)}function Ui(t,e){var n=t.length;if(n)return fa(e+=e<0?n:0,n)?t[e]:r}function Vi(t,e,n){e=e.length?Le(e,(function(t){return Ho(t)?function(e){return bi(e,1===t.length?t[0]:t)}:t})):[nl];var i=-1;e=Le(e,Ye(aa()));var r=zi(t,(function(t,n,r){var a=Le(e,(function(e){return e(t)}));return{criteria:a,index:++i,value:t}}));return function(t,e){var i=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,a=e.criteria,o=r.length,s=n.length;++i<o;){var l=wr(r[i],a[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)}));i--;)t[i]=t[i].value;return t}(r)}function Gi(t,e,n){for(var i=-1,r=e.length,a={};++i<r;){var o=e[i],s=bi(t,o);n(s,o)&&Xi(a,gr(o,t),s)}return a}function Hi(t,e,n,i){var r=i?Ue:Ne,a=-1,o=e.length,s=t;for(t===e&&(e=Sr(e)),n&&(s=Le(t,Ye(n)));++a<o;)for(var l=0,c=e[a],u=n?n(c):c;(l=r(s,u,l,i))>-1;)s!==t&&Zt.call(s,l,1),Zt.call(t,l,1);return t}function ji(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==a){var a=r;fa(r)?Zt.call(t,r,1):lr(t,r)}}return t}function Wi(t,e){return t+pe(xn()*(e-t+1))}function qi(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=pe(e/2))&&(t+=t)}while(e);return n}function Zi(t,e){return Ta(wa(t,e,nl),t+"")}function $i(t){return Yn(Ns(t))}function Yi(t,e){var n=Ns(t);return La(n,ai(e,0,n.length))}function Xi(t,e,n,i){if(!Ko(t))return t;for(var a=-1,o=(e=gr(e,t)).length,s=o-1,l=t;null!=l&&++a<o;){var c=ka(e[a]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(a!=s){var h=l[c];(u=i?i(h,c,l):r)===r&&(u=Ko(h)?h:fa(e[a+1])?[]:{})}Kn(l,c,u),l=l[c]}return t}var Qi=Tn?function(t,e){return Tn.set(t,e),t}:nl,Ji=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:Ks(e),writable:!0})}:nl;function Ki(t){return La(Ns(t))}function tr(t,e,n){var r=-1,a=t.length;e<0&&(e=-e>a?0:a+e),(n=n>a?a:n)<0&&(n+=a),a=e>n?0:n-e>>>0,e>>>=0;for(var o=i(a);++r<a;)o[r]=t[r+e];return o}function er(t,e){var n;return ui(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}function nr(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var a=i+r>>>1,o=t[a];null!==o&&!ss(o)&&(n?o<=e:o<e)?i=a+1:r=a}return r}return ir(t,e,nl,n)}function ir(t,e,n,i){var a=0,o=null==t?0:t.length;if(0===o)return 0;for(var s=(e=n(e))!=e,l=null===e,c=ss(e),u=e===r;a<o;){var h=pe((a+o)/2),d=n(t[h]),p=d!==r,m=null===d,f=d==d,g=ss(d);if(s)var v=i||f;else v=u?f&&(i||p):l?f&&p&&(i||!m):c?f&&p&&!m&&(i||!g):!m&&!g&&(i?d<=e:d<e);v?a=h+1:o=h}return vn(o,4294967294)}function rr(t,e){for(var n=-1,i=t.length,r=0,a=[];++n<i;){var o=t[n],s=e?e(o):o;if(!n||!No(s,l)){var l=s;a[r++]=0===o?0:o}}return a}function ar(t){return"number"==typeof t?t:ss(t)?d:+t}function or(t){if("string"==typeof t)return t;if(Ho(t))return Le(t,or)+"";if(ss(t))return Fn?Fn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function sr(t,e,n){var i=-1,r=Ie,a=t.length,o=!0,s=[],l=s;if(n)o=!1,r=Be;else if(a>=200){var c=e?null:qr(t);if(c)return ln(c);o=!1,r=Qe,l=new qn}else l=e?[]:s;t:for(;++i<a;){var u=t[i],h=e?e(u):u;if(u=n||0!==u?u:0,o&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue t;e&&l.push(h),s.push(u)}else r(l,h,n)||(l!==s&&l.push(h),s.push(u))}return s}function lr(t,e){return null==(t=Ca(t,e=gr(e,t)))||delete t[ka($a(e))]}function cr(t,e,n,i){return Xi(t,e,n(bi(t,e)),i)}function ur(t,e,n,i){for(var r=t.length,a=i?r:-1;(i?a--:++a<r)&&e(t[a],a,t););return n?tr(t,i?0:a,i?a+1:r):tr(t,i?a+1:0,i?r:a)}function hr(t,e){var n=t;return n instanceof Gn&&(n=n.value()),Pe(e,(function(t,e){return e.func.apply(e.thisArg,De([t],e.args))}),n)}function dr(t,e,n){var r=t.length;if(r<2)return r?sr(t[0]):[];for(var a=-1,o=i(r);++a<r;)for(var s=t[a],l=-1;++l<r;)l!=a&&(o[a]=ci(o[a]||s,t[l],e,n));return sr(fi(o,1),e,n)}function pr(t,e,n){for(var i=-1,a=t.length,o=e.length,s={};++i<a;){var l=i<o?e[i]:r;n(s,t[i],l)}return s}function mr(t){return qo(t)?t:[]}function fr(t){return"function"==typeof t?t:nl}function gr(t,e){return Ho(t)?t:va(t,e)?[t]:Ra(vs(t))}var vr=Zi;function yr(t,e,n){var i=t.length;return n=n===r?i:n,!e&&n>=i?t:tr(t,e,n)}var _r=oe||function(t){return he.clearTimeout(t)};function xr(t,e){if(e)return t.slice();var n=t.length,i=Ht?Ht(n):new t.constructor(n);return t.copy(i),i}function br(t){var e=new t.constructor(t.byteLength);return new Gt(e).set(new Gt(t)),e}function Ar(t,e){var n=e?br(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function wr(t,e){if(t!==e){var n=t!==r,i=null===t,a=t==t,o=ss(t),s=e!==r,l=null===e,c=e==e,u=ss(e);if(!l&&!u&&!o&&t>e||o&&s&&c&&!l&&!u||i&&s&&c||!n&&c||!a)return 1;if(!i&&!o&&!u&&t<e||u&&n&&a&&!i&&!o||l&&n&&a||!s&&a||!c)return-1}return 0}function Cr(t,e,n,r){for(var a=-1,o=t.length,s=n.length,l=-1,c=e.length,u=gn(o-s,0),h=i(c+u),d=!r;++l<c;)h[l]=e[l];for(;++a<s;)(d||a<o)&&(h[n[a]]=t[a]);for(;u--;)h[l++]=t[a++];return h}function Er(t,e,n,r){for(var a=-1,o=t.length,s=-1,l=n.length,c=-1,u=e.length,h=gn(o-l,0),d=i(h+u),p=!r;++a<h;)d[a]=t[a];for(var m=a;++c<u;)d[m+c]=e[c];for(;++s<l;)(p||a<o)&&(d[m+n[s]]=t[a++]);return d}function Sr(t,e){var n=-1,r=t.length;for(e||(e=i(r));++n<r;)e[n]=t[n];return e}function Mr(t,e,n,i){var a=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var l=e[o],c=i?i(n[l],t[l],l,n,t):r;c===r&&(c=t[l]),a?ii(n,l,c):Kn(n,l,c)}return n}function Tr(t,e){return function(n,i){var r=Ho(n)?Ce:ei,a=e?e():{};return r(n,t,aa(i,2),a)}}function Ir(t){return Zi((function(e,n){var i=-1,a=n.length,o=a>1?n[a-1]:r,s=a>2?n[2]:r;for(o=t.length>3&&"function"==typeof o?(a--,o):r,s&&ga(n[0],n[1],s)&&(o=a<3?r:o,a=1),e=Ct(e);++i<a;){var l=n[i];l&&t(e,l,i,o)}return e}))}function Br(t,e){return function(n,i){if(null==n)return n;if(!Wo(n))return t(n,i);for(var r=n.length,a=e?r:-1,o=Ct(n);(e?a--:++a<r)&&!1!==i(o[a],a,o););return n}}function Lr(t){return function(e,n,i){for(var r=-1,a=Ct(e),o=i(e),s=o.length;s--;){var l=o[t?s:++r];if(!1===n(a[l],l,a))break}return e}}function Dr(t){return function(e){var n=rn(e=vs(e))?hn(e):r,i=n?n[0]:e.charAt(0),a=n?yr(n,1).join(""):e.slice(1);return i[t]()+a}}function Pr(t){return function(e){return Pe(Xs(Gs(e).replace(Xt,"")),t,"")}}function Rr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Nn(t.prototype),i=t.apply(n,e);return Ko(i)?i:n}}function kr(t){return function(e,n,i){var a=Ct(e);if(!Wo(e)){var o=aa(n,3);e=Bs(e),n=function(t){return o(a[t],t,a)}}var s=t(e,n,i);return s>-1?a[o?e[s]:s]:r}}function zr(t){return Kr((function(e){var n=e.length,i=n,o=Vn.prototype.thru;for(t&&e.reverse();i--;){var s=e[i];if("function"!=typeof s)throw new Mt(a);if(o&&!l&&"wrapper"==ia(s))var l=new Vn([],!0)}for(i=l?i:n;++i<n;){var c=ia(s=e[i]),u="wrapper"==c?na(s):r;l=u&&ya(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ia(u[0])].apply(l,u[3]):1==s.length&&ya(s)?l[c]():l.thru(s)}return function(){var t=arguments,i=t[0];if(l&&1==t.length&&Ho(i))return l.plant(i).value();for(var r=0,a=n?e[r].apply(this,t):i;++r<n;)a=e[r].call(this,a);return a}}))}function Fr(t,e,n,a,o,s,l,u,h,d){var p=e&c,m=1&e,f=2&e,g=24&e,v=512&e,y=f?r:Rr(t);return function c(){for(var _=arguments.length,x=i(_),b=_;b--;)x[b]=arguments[b];if(g)var A=ra(c),w=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(x,A);if(a&&(x=Cr(x,a,o,g)),s&&(x=Er(x,s,l,g)),_-=w,g&&_<d){var C=sn(x,A);return jr(t,e,Fr,c.placeholder,n,x,C,u,h,d-_)}var E=m?n:this,S=f?E[t]:t;return _=x.length,u?x=function(t,e){for(var n=t.length,i=vn(e.length,n),a=Sr(t);i--;){var o=e[i];t[i]=fa(o,n)?a[o]:r}return t}(x,u):v&&_>1&&x.reverse(),p&&h<_&&(x.length=h),this&&this!==he&&this instanceof c&&(S=y||Rr(S)),S.apply(E,x)}}function Or(t,e){return function(n,i){return function(t,e,n,i){return yi(t,(function(t,r,a){e(i,n(t),r,a)})),i}(n,t,e(i),{})}}function Nr(t,e){return function(n,i){var a;if(n===r&&i===r)return e;if(n!==r&&(a=n),i!==r){if(a===r)return i;"string"==typeof n||"string"==typeof i?(n=or(n),i=or(i)):(n=ar(n),i=ar(i)),a=t(n,i)}return a}}function Ur(t){return Kr((function(e){return e=Le(e,Ye(aa())),Zi((function(n){var i=this;return t(e,(function(t){return we(t,i,n)}))}))}))}function Vr(t,e){var n=(e=e===r?" ":or(e)).length;if(n<2)return n?qi(e,t):e;var i=qi(e,de(t/un(e)));return rn(e)?yr(hn(i),0,t).join(""):i.slice(0,t)}function Gr(t){return function(e,n,a){return a&&"number"!=typeof a&&ga(e,n,a)&&(n=a=r),e=ds(e),n===r?(n=e,e=0):n=ds(n),function(t,e,n,r){for(var a=-1,o=gn(de((e-t)/(n||1)),0),s=i(o);o--;)s[r?o:++a]=t,t+=n;return s}(e,n,a=a===r?e<n?1:-1:ds(a),t)}}function Hr(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=fs(e),n=fs(n)),t(e,n)}}function jr(t,e,n,i,a,o,s,c,u,h){var d=8&e;e|=d?l:64,4&(e&=~(d?64:l))||(e&=-4);var p=[t,e,a,d?o:r,d?s:r,d?r:o,d?r:s,c,u,h],m=n.apply(r,p);return ya(t)&&Sa(m,p),m.placeholder=i,Ia(m,t,e)}function Wr(t){var e=wt[t];return function(t,n){if(t=fs(t),(n=null==n?0:vn(ps(n),292))&&ze(t)){var i=(vs(t)+"e").split("e");return+((i=(vs(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var qr=En&&1/ln(new En([,-0]))[1]==u?function(t){return new En(t)}:sl;function Zr(t){return function(e){var n=ha(e);return n==A?an(e):n==M?cn(e):function(t,e){return Le(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function $r(t,e,n,o,u,h,d,p){var m=2&e;if(!m&&"function"!=typeof t)throw new Mt(a);var f=o?o.length:0;if(f||(e&=-97,o=u=r),d=d===r?d:gn(ps(d),0),p=p===r?p:ps(p),f-=u?u.length:0,64&e){var g=o,v=u;o=u=r}var y=m?r:na(t),_=[t,e,n,o,u,g,v,h,d,p];if(y&&function(t,e){var n=t[1],i=e[1],r=n|i,a=r<131,o=i==c&&8==n||i==c&&256==n&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!a&&!o)return t;1&i&&(t[2]=e[2],r|=1&n?0:4);var l=e[3];if(l){var u=t[3];t[3]=u?Cr(u,l,e[4]):l,t[4]=u?sn(t[3],s):e[4]}(l=e[5])&&(u=t[5],t[5]=u?Er(u,l,e[6]):l,t[6]=u?sn(t[5],s):e[6]),(l=e[7])&&(t[7]=l),i&c&&(t[8]=null==t[8]?e[8]:vn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(_,y),t=_[0],e=_[1],n=_[2],o=_[3],u=_[4],!(p=_[9]=_[9]===r?m?0:t.length:gn(_[9]-f,0))&&24&e&&(e&=-25),e&&1!=e)x=8==e||16==e?function(t,e,n){var a=Rr(t);return function o(){for(var s=arguments.length,l=i(s),c=s,u=ra(o);c--;)l[c]=arguments[c];var h=s<3&&l[0]!==u&&l[s-1]!==u?[]:sn(l,u);return(s-=h.length)<n?jr(t,e,Fr,o.placeholder,r,l,h,r,r,n-s):we(this&&this!==he&&this instanceof o?a:t,this,l)}}(t,e,p):e!=l&&33!=e||u.length?Fr.apply(r,_):function(t,e,n,r){var a=1&e,o=Rr(t);return function e(){for(var s=-1,l=arguments.length,c=-1,u=r.length,h=i(u+l),d=this&&this!==he&&this instanceof e?o:t;++c<u;)h[c]=r[c];for(;l--;)h[c++]=arguments[++s];return we(d,a?n:this,h)}}(t,e,n,o);else var x=function(t,e,n){var i=1&e,r=Rr(t);return function e(){return(this&&this!==he&&this instanceof e?r:t).apply(i?n:this,arguments)}}(t,e,n);return Ia((y?Qi:Sa)(x,_),t,e)}function Yr(t,e,n,i){return t===r||No(t,Bt[n])&&!Pt.call(i,n)?e:t}function Xr(t,e,n,i,a,o){return Ko(t)&&Ko(e)&&(o.set(e,t),Ni(t,e,r,Xr,o),o.delete(e)),t}function Qr(t){return is(t)?r:t}function Jr(t,e,n,i,a,o){var s=1&n,l=t.length,c=e.length;if(l!=c&&!(s&&c>l))return!1;var u=o.get(t),h=o.get(e);if(u&&h)return u==e&&h==t;var d=-1,p=!0,m=2&n?new qn:r;for(o.set(t,e),o.set(e,t);++d<l;){var f=t[d],g=e[d];if(i)var v=s?i(g,f,d,e,t,o):i(f,g,d,t,e,o);if(v!==r){if(v)continue;p=!1;break}if(m){if(!ke(e,(function(t,e){if(!Qe(m,e)&&(f===t||a(f,t,n,i,o)))return m.push(e)}))){p=!1;break}}else if(f!==g&&!a(f,g,n,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function Kr(t){return Ta(wa(t,r,Ha),t+"")}function ta(t){return Ai(t,Bs,ca)}function ea(t){return Ai(t,Ls,ua)}var na=Tn?function(t){return Tn.get(t)}:sl;function ia(t){for(var e=t.name+"",n=In[e],i=Pt.call(In,e)?n.length:0;i--;){var r=n[i],a=r.func;if(null==a||a==t)return r.name}return e}function ra(t){return(Pt.call(On,"placeholder")?On:t).placeholder}function aa(){var t=On.iteratee||il;return t=t===il?Pi:t,arguments.length?t(arguments[0],arguments[1]):t}function oa(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function sa(t){for(var e=Bs(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,ba(r)]}return e}function la(t,e){var n=function(t,e){return null==t?r:t[e]}(t,e);return Di(n)?n:r}var ca=fe?function(t){return null==t?[]:(t=Ct(t),Te(fe(t),(function(e){return qt.call(t,e)})))}:ml,ua=fe?function(t){for(var e=[];t;)De(e,ca(t)),t=jt(t);return e}:ml,ha=wi;function da(t,e,n){for(var i=-1,r=(e=gr(e,t)).length,a=!1;++i<r;){var o=ka(e[i]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++i!=r?a:!!(r=null==t?0:t.length)&&Jo(r)&&fa(o,r)&&(Ho(t)||Go(t))}function pa(t){return"function"!=typeof t.constructor||xa(t)?{}:Nn(jt(t))}function ma(t){return Ho(t)||Go(t)||!!($t&&t&&t[$t])}function fa(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&vt.test(t))&&t>-1&&t%1==0&&t<e}function ga(t,e,n){if(!Ko(n))return!1;var i=typeof e;return!!("number"==i?Wo(n)&&fa(e,n.length):"string"==i&&e in n)&&No(n[e],t)}function va(t,e){if(Ho(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ss(t))||K.test(t)||!J.test(t)||null!=e&&t in Ct(e)}function ya(t){var e=ia(t),n=On[e];if("function"!=typeof n||!(e in Gn.prototype))return!1;if(t===n)return!0;var i=na(n);return!!i&&t===i[0]}(An&&ha(new An(new ArrayBuffer(1)))!=D||wn&&ha(new wn)!=A||Cn&&ha(Cn.resolve())!=E||En&&ha(new En)!=M||Sn&&ha(new Sn)!=B)&&(ha=function(t){var e=wi(t),n=e==C?t.constructor:r,i=n?za(n):"";if(i)switch(i){case Bn:return D;case Ln:return A;case Dn:return E;case Pn:return M;case Rn:return B}return e});var _a=Lt?Xo:fl;function xa(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Bt)}function ba(t){return t==t&&!Ko(t)}function Aa(t,e){return function(n){return null!=n&&n[t]===e&&(e!==r||t in Ct(n))}}function wa(t,e,n){return e=gn(e===r?t.length-1:e,0),function(){for(var r=arguments,a=-1,o=gn(r.length-e,0),s=i(o);++a<o;)s[a]=r[e+a];a=-1;for(var l=i(e+1);++a<e;)l[a]=r[a];return l[e]=n(s),we(t,this,l)}}function Ca(t,e){return e.length<2?t:bi(t,tr(e,0,-1))}function Ea(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Sa=Ba(Qi),Ma=ue||function(t,e){return he.setTimeout(t,e)},Ta=Ba(Ji);function Ia(t,e,n){var i=e+"";return Ta(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(at,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return Ee(m,(function(n){var i="_."+n[0];e&n[1]&&!Ie(t,i)&&t.push(i)})),t.sort()}(function(t){var e=t.match(ot);return e?e[1].split(st):[]}(i),n)))}function Ba(t){var e=0,n=0;return function(){var i=yn(),a=16-(i-n);if(n=i,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(r,arguments)}}function La(t,e){var n=-1,i=t.length,a=i-1;for(e=e===r?i:e;++n<e;){var o=Wi(n,a),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}var Da,Pa,Ra=(Da=Po((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,i,r){e.push(i?r.replace(ut,"$1"):n||t)})),e}),(function(t){return 500===Pa.size&&Pa.clear(),t})),Pa=Da.cache,Da);function ka(t){if("string"==typeof t||ss(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function za(t){if(null!=t){try{return Dt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Fa(t){if(t instanceof Gn)return t.clone();var e=new Vn(t.__wrapped__,t.__chain__);return e.__actions__=Sr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Oa=Zi((function(t,e){return qo(t)?ci(t,fi(e,1,qo,!0)):[]})),Na=Zi((function(t,e){var n=$a(e);return qo(n)&&(n=r),qo(t)?ci(t,fi(e,1,qo,!0),aa(n,2)):[]})),Ua=Zi((function(t,e){var n=$a(e);return qo(n)&&(n=r),qo(t)?ci(t,fi(e,1,qo,!0),r,n):[]}));function Va(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:ps(n);return r<0&&(r=gn(i+r,0)),Oe(t,aa(e,3),r)}function Ga(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var a=i-1;return n!==r&&(a=ps(n),a=n<0?gn(i+a,0):vn(a,i-1)),Oe(t,aa(e,3),a,!0)}function Ha(t){return null!=t&&t.length?fi(t,1):[]}function ja(t){return t&&t.length?t[0]:r}var Wa=Zi((function(t){var e=Le(t,mr);return e.length&&e[0]===t[0]?Mi(e):[]})),qa=Zi((function(t){var e=$a(t),n=Le(t,mr);return e===$a(n)?e=r:n.pop(),n.length&&n[0]===t[0]?Mi(n,aa(e,2)):[]})),Za=Zi((function(t){var e=$a(t),n=Le(t,mr);return(e="function"==typeof e?e:r)&&n.pop(),n.length&&n[0]===t[0]?Mi(n,r,e):[]}));function $a(t){var e=null==t?0:t.length;return e?t[e-1]:r}var Ya=Zi(Xa);function Xa(t,e){return t&&t.length&&e&&e.length?Hi(t,e):t}var Qa=Kr((function(t,e){var n=null==t?0:t.length,i=ri(t,e);return ji(t,Le(e,(function(t){return fa(t,n)?+t:t})).sort(wr)),i}));function Ja(t){return null==t?t:bn.call(t)}var Ka=Zi((function(t){return sr(fi(t,1,qo,!0))})),to=Zi((function(t){var e=$a(t);return qo(e)&&(e=r),sr(fi(t,1,qo,!0),aa(e,2))})),eo=Zi((function(t){var e=$a(t);return e="function"==typeof e?e:r,sr(fi(t,1,qo,!0),r,e)}));function no(t){if(!t||!t.length)return[];var e=0;return t=Te(t,(function(t){if(qo(t))return e=gn(t.length,e),!0})),Ze(e,(function(e){return Le(t,He(e))}))}function io(t,e){if(!t||!t.length)return[];var n=no(t);return null==e?n:Le(n,(function(t){return we(e,r,t)}))}var ro=Zi((function(t,e){return qo(t)?ci(t,e):[]})),ao=Zi((function(t){return dr(Te(t,qo))})),oo=Zi((function(t){var e=$a(t);return qo(e)&&(e=r),dr(Te(t,qo),aa(e,2))})),so=Zi((function(t){var e=$a(t);return e="function"==typeof e?e:r,dr(Te(t,qo),r,e)})),lo=Zi(no),co=Zi((function(t){var e=t.length,n=e>1?t[e-1]:r;return n="function"==typeof n?(t.pop(),n):r,io(t,n)}));function uo(t){var e=On(t);return e.__chain__=!0,e}function ho(t,e){return e(t)}var po=Kr((function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,a=function(e){return ri(e,t)};return!(e>1||this.__actions__.length)&&i instanceof Gn&&fa(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:ho,args:[a],thisArg:r}),new Vn(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(r),t}))):this.thru(a)})),mo=Tr((function(t,e,n){Pt.call(t,n)?++t[n]:ii(t,n,1)})),fo=kr(Va),go=kr(Ga);function vo(t,e){return(Ho(t)?Ee:ui)(t,aa(e,3))}function yo(t,e){return(Ho(t)?Se:hi)(t,aa(e,3))}var _o=Tr((function(t,e,n){Pt.call(t,n)?t[n].push(e):ii(t,n,[e])})),xo=Zi((function(t,e,n){var r=-1,a="function"==typeof e,o=Wo(t)?i(t.length):[];return ui(t,(function(t){o[++r]=a?we(e,t,n):Ti(t,e,n)})),o})),bo=Tr((function(t,e,n){ii(t,n,e)}));function Ao(t,e){return(Ho(t)?Le:zi)(t,aa(e,3))}var wo=Tr((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Co=Zi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ga(t,e[0],e[1])?e=[]:n>2&&ga(e[0],e[1],e[2])&&(e=[e[0]]),Vi(t,fi(e,1),[])})),Eo=ce||function(){return he.Date.now()};function So(t,e,n){return e=n?r:e,e=t&&null==e?t.length:e,$r(t,c,r,r,r,r,e)}function Mo(t,e){var n;if("function"!=typeof e)throw new Mt(a);return t=ps(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=r),n}}var To=Zi((function(t,e,n){var i=1;if(n.length){var r=sn(n,ra(To));i|=l}return $r(t,i,e,n,r)})),Io=Zi((function(t,e,n){var i=3;if(n.length){var r=sn(n,ra(Io));i|=l}return $r(e,i,t,n,r)}));function Bo(t,e,n){var i,o,s,l,c,u,h=0,d=!1,p=!1,m=!0;if("function"!=typeof t)throw new Mt(a);function f(e){var n=i,a=o;return i=o=r,h=e,l=t.apply(a,n)}function g(t){var n=t-u;return u===r||n>=e||n<0||p&&t-h>=s}function v(){var t=Eo();if(g(t))return y(t);c=Ma(v,function(t){var n=e-(t-u);return p?vn(n,s-(t-h)):n}(t))}function y(t){return c=r,m&&i?f(t):(i=o=r,l)}function _(){var t=Eo(),n=g(t);if(i=arguments,o=this,u=t,n){if(c===r)return function(t){return h=t,c=Ma(v,e),d?f(t):l}(u);if(p)return _r(c),c=Ma(v,e),f(u)}return c===r&&(c=Ma(v,e)),l}return e=fs(e)||0,Ko(n)&&(d=!!n.leading,s=(p="maxWait"in n)?gn(fs(n.maxWait)||0,e):s,m="trailing"in n?!!n.trailing:m),_.cancel=function(){c!==r&&_r(c),h=0,i=u=o=c=r},_.flush=function(){return c===r?l:y(Eo())},_}var Lo=Zi((function(t,e){return li(t,1,e)})),Do=Zi((function(t,e,n){return li(t,fs(e)||0,n)}));function Po(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Mt(a);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],a=n.cache;if(a.has(r))return a.get(r);var o=t.apply(this,i);return n.cache=a.set(r,o)||a,o};return n.cache=new(Po.Cache||Wn),n}function Ro(t){if("function"!=typeof t)throw new Mt(a);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Po.Cache=Wn;var ko=vr((function(t,e){var n=(e=1==e.length&&Ho(e[0])?Le(e[0],Ye(aa())):Le(fi(e,1),Ye(aa()))).length;return Zi((function(i){for(var r=-1,a=vn(i.length,n);++r<a;)i[r]=e[r].call(this,i[r]);return we(t,this,i)}))})),zo=Zi((function(t,e){var n=sn(e,ra(zo));return $r(t,l,r,e,n)})),Fo=Zi((function(t,e){var n=sn(e,ra(Fo));return $r(t,64,r,e,n)})),Oo=Kr((function(t,e){return $r(t,256,r,r,r,e)}));function No(t,e){return t===e||t!=t&&e!=e}var Uo=Hr(Ci),Vo=Hr((function(t,e){return t>=e})),Go=Ii(function(){return arguments}())?Ii:function(t){return ts(t)&&Pt.call(t,"callee")&&!qt.call(t,"callee")},Ho=i.isArray,jo=ve?Ye(ve):function(t){return ts(t)&&wi(t)==L};function Wo(t){return null!=t&&Jo(t.length)&&!Xo(t)}function qo(t){return ts(t)&&Wo(t)}var Zo=ge||fl,$o=ye?Ye(ye):function(t){return ts(t)&&wi(t)==y};function Yo(t){if(!ts(t))return!1;var e=wi(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!is(t)}function Xo(t){if(!Ko(t))return!1;var e=wi(t);return e==x||e==b||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Qo(t){return"number"==typeof t&&t==ps(t)}function Jo(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function Ko(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ts(t){return null!=t&&"object"==typeof t}var es=_e?Ye(_e):function(t){return ts(t)&&ha(t)==A};function ns(t){return"number"==typeof t||ts(t)&&wi(t)==w}function is(t){if(!ts(t)||wi(t)!=C)return!1;var e=jt(t);if(null===e)return!0;var n=Pt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Dt.call(n)==Ft}var rs=xe?Ye(xe):function(t){return ts(t)&&wi(t)==S},as=be?Ye(be):function(t){return ts(t)&&ha(t)==M};function os(t){return"string"==typeof t||!Ho(t)&&ts(t)&&wi(t)==T}function ss(t){return"symbol"==typeof t||ts(t)&&wi(t)==I}var ls=Ae?Ye(Ae):function(t){return ts(t)&&Jo(t.length)&&!!re[wi(t)]},cs=Hr(ki),us=Hr((function(t,e){return t<=e}));function hs(t){if(!t)return[];if(Wo(t))return os(t)?hn(t):Sr(t);if(Yt&&t[Yt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Yt]());var e=ha(t);return(e==A?an:e==M?ln:Ns)(t)}function ds(t){return t?(t=fs(t))===u||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ps(t){var e=ds(t),n=e%1;return e==e?n?e-n:e:0}function ms(t){return t?ai(ps(t),0,p):0}function fs(t){if("number"==typeof t)return t;if(ss(t))return d;if(Ko(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ko(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=$e(t);var n=mt.test(t);return n||gt.test(t)?le(t.slice(2),n?2:8):pt.test(t)?d:+t}function gs(t){return Mr(t,Ls(t))}function vs(t){return null==t?"":or(t)}var ys=Ir((function(t,e){if(xa(e)||Wo(e))Mr(e,Bs(e),t);else for(var n in e)Pt.call(e,n)&&Kn(t,n,e[n])})),_s=Ir((function(t,e){Mr(e,Ls(e),t)})),xs=Ir((function(t,e,n,i){Mr(e,Ls(e),t,i)})),bs=Ir((function(t,e,n,i){Mr(e,Bs(e),t,i)})),As=Kr(ri),ws=Zi((function(t,e){t=Ct(t);var n=-1,i=e.length,a=i>2?e[2]:r;for(a&&ga(e[0],e[1],a)&&(i=1);++n<i;)for(var o=e[n],s=Ls(o),l=-1,c=s.length;++l<c;){var u=s[l],h=t[u];(h===r||No(h,Bt[u])&&!Pt.call(t,u))&&(t[u]=o[u])}return t})),Cs=Zi((function(t){return t.push(r,Xr),we(Ps,r,t)}));function Es(t,e,n){var i=null==t?r:bi(t,e);return i===r?n:i}function Ss(t,e){return null!=t&&da(t,e,Si)}var Ms=Or((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),t[e]=n}),Ks(nl)),Ts=Or((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),Pt.call(t,e)?t[e].push(n):t[e]=[n]}),aa),Is=Zi(Ti);function Bs(t){return Wo(t)?$n(t):Ri(t)}function Ls(t){return Wo(t)?$n(t,!0):function(t){if(!Ko(t))return function(t){var e=[];if(null!=t)for(var n in Ct(t))e.push(n);return e}(t);var e=xa(t),n=[];for(var i in t)("constructor"!=i||!e&&Pt.call(t,i))&&n.push(i);return n}(t)}var Ds=Ir((function(t,e,n){Ni(t,e,n)})),Ps=Ir((function(t,e,n,i){Ni(t,e,n,i)})),Rs=Kr((function(t,e){var n={};if(null==t)return n;var i=!1;e=Le(e,(function(e){return e=gr(e,t),i||(i=e.length>1),e})),Mr(t,ea(t),n),i&&(n=oi(n,7,Qr));for(var r=e.length;r--;)lr(n,e[r]);return n})),ks=Kr((function(t,e){return null==t?{}:function(t,e){return Gi(t,e,(function(e,n){return Ss(t,n)}))}(t,e)}));function zs(t,e){if(null==t)return{};var n=Le(ea(t),(function(t){return[t]}));return e=aa(e),Gi(t,n,(function(t,n){return e(t,n[0])}))}var Fs=Zr(Bs),Os=Zr(Ls);function Ns(t){return null==t?[]:Xe(t,Bs(t))}var Us=Pr((function(t,e,n){return e=e.toLowerCase(),t+(n?Vs(e):e)}));function Vs(t){return Ys(vs(t).toLowerCase())}function Gs(t){return(t=vs(t))&&t.replace(yt,tn).replace(Qt,"")}var Hs=Pr((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),js=Pr((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ws=Dr("toLowerCase"),qs=Pr((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Zs=Pr((function(t,e,n){return t+(n?" ":"")+Ys(e)})),$s=Pr((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ys=Dr("toUpperCase");function Xs(t,e,n){return t=vs(t),(e=n?r:e)===r?function(t){return ee.test(t)}(t)?function(t){return t.match(Kt)||[]}(t):function(t){return t.match(lt)||[]}(t):t.match(e)||[]}var Qs=Zi((function(t,e){try{return we(t,r,e)}catch(t){return Yo(t)?t:new bt(t)}})),Js=Kr((function(t,e){return Ee(e,(function(e){e=ka(e),ii(t,e,To(t[e],t))})),t}));function Ks(t){return function(){return t}}var tl=zr(),el=zr(!0);function nl(t){return t}function il(t){return Pi("function"==typeof t?t:oi(t,1))}var rl=Zi((function(t,e){return function(n){return Ti(n,t,e)}})),al=Zi((function(t,e){return function(n){return Ti(t,n,e)}}));function ol(t,e,n){var i=Bs(e),r=xi(e,i);null!=n||Ko(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=xi(e,Bs(e)));var a=!(Ko(n)&&"chain"in n&&!n.chain),o=Xo(t);return Ee(r,(function(n){var i=e[n];t[n]=i,o&&(t.prototype[n]=function(){var e=this.__chain__;if(a||e){var n=t(this.__wrapped__);return(n.__actions__=Sr(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,De([this.value()],arguments))})})),t}function sl(){}var ll=Ur(Le),cl=Ur(Me),ul=Ur(ke);function hl(t){return va(t)?He(ka(t)):function(t){return function(e){return bi(e,t)}}(t)}var dl=Gr(),pl=Gr(!0);function ml(){return[]}function fl(){return!1}var gl,vl=Nr((function(t,e){return t+e}),0),yl=Wr("ceil"),_l=Nr((function(t,e){return t/e}),1),xl=Wr("floor"),bl=Nr((function(t,e){return t*e}),1),Al=Wr("round"),wl=Nr((function(t,e){return t-e}),0);return On.after=function(t,e){if("function"!=typeof e)throw new Mt(a);return t=ps(t),function(){if(--t<1)return e.apply(this,arguments)}},On.ary=So,On.assign=ys,On.assignIn=_s,On.assignInWith=xs,On.assignWith=bs,On.at=As,On.before=Mo,On.bind=To,On.bindAll=Js,On.bindKey=Io,On.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ho(t)?t:[t]},On.chain=uo,On.chunk=function(t,e,n){e=(n?ga(t,e,n):e===r)?1:gn(ps(e),0);var a=null==t?0:t.length;if(!a||e<1)return[];for(var o=0,s=0,l=i(de(a/e));o<a;)l[s++]=tr(t,o,o+=e);return l},On.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var a=t[e];a&&(r[i++]=a)}return r},On.concat=function(){var t=arguments.length;if(!t)return[];for(var e=i(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return De(Ho(n)?Sr(n):[n],fi(e,1))},On.cond=function(t){var e=null==t?0:t.length,n=aa();return t=e?Le(t,(function(t){if("function"!=typeof t[1])throw new Mt(a);return[n(t[0]),t[1]]})):[],Zi((function(n){for(var i=-1;++i<e;){var r=t[i];if(we(r[0],this,n))return we(r[1],this,n)}}))},On.conforms=function(t){return function(t){var e=Bs(t);return function(n){return si(n,t,e)}}(oi(t,1))},On.constant=Ks,On.countBy=mo,On.create=function(t,e){var n=Nn(t);return null==e?n:ni(n,e)},On.curry=function t(e,n,i){var a=$r(e,8,r,r,r,r,r,n=i?r:n);return a.placeholder=t.placeholder,a},On.curryRight=function t(e,n,i){var a=$r(e,16,r,r,r,r,r,n=i?r:n);return a.placeholder=t.placeholder,a},On.debounce=Bo,On.defaults=ws,On.defaultsDeep=Cs,On.defer=Lo,On.delay=Do,On.difference=Oa,On.differenceBy=Na,On.differenceWith=Ua,On.drop=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,(e=n||e===r?1:ps(e))<0?0:e,i):[]},On.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,0,(e=i-(e=n||e===r?1:ps(e)))<0?0:e):[]},On.dropRightWhile=function(t,e){return t&&t.length?ur(t,aa(e,3),!0,!0):[]},On.dropWhile=function(t,e){return t&&t.length?ur(t,aa(e,3),!0):[]},On.fill=function(t,e,n,i){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&ga(t,e,n)&&(n=0,i=a),function(t,e,n,i){var a=t.length;for((n=ps(n))<0&&(n=-n>a?0:a+n),(i=i===r||i>a?a:ps(i))<0&&(i+=a),i=n>i?0:ms(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},On.filter=function(t,e){return(Ho(t)?Te:mi)(t,aa(e,3))},On.flatMap=function(t,e){return fi(Ao(t,e),1)},On.flatMapDeep=function(t,e){return fi(Ao(t,e),u)},On.flatMapDepth=function(t,e,n){return n=n===r?1:ps(n),fi(Ao(t,e),n)},On.flatten=Ha,On.flattenDeep=function(t){return null!=t&&t.length?fi(t,u):[]},On.flattenDepth=function(t,e){return null!=t&&t.length?fi(t,e=e===r?1:ps(e)):[]},On.flip=function(t){return $r(t,512)},On.flow=tl,On.flowRight=el,On.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},On.functions=function(t){return null==t?[]:xi(t,Bs(t))},On.functionsIn=function(t){return null==t?[]:xi(t,Ls(t))},On.groupBy=_o,On.initial=function(t){return null!=t&&t.length?tr(t,0,-1):[]},On.intersection=Wa,On.intersectionBy=qa,On.intersectionWith=Za,On.invert=Ms,On.invertBy=Ts,On.invokeMap=xo,On.iteratee=il,On.keyBy=bo,On.keys=Bs,On.keysIn=Ls,On.map=Ao,On.mapKeys=function(t,e){var n={};return e=aa(e,3),yi(t,(function(t,i,r){ii(n,e(t,i,r),t)})),n},On.mapValues=function(t,e){var n={};return e=aa(e,3),yi(t,(function(t,i,r){ii(n,i,e(t,i,r))})),n},On.matches=function(t){return Fi(oi(t,1))},On.matchesProperty=function(t,e){return Oi(t,oi(e,1))},On.memoize=Po,On.merge=Ds,On.mergeWith=Ps,On.method=rl,On.methodOf=al,On.mixin=ol,On.negate=Ro,On.nthArg=function(t){return t=ps(t),Zi((function(e){return Ui(e,t)}))},On.omit=Rs,On.omitBy=function(t,e){return zs(t,Ro(aa(e)))},On.once=function(t){return Mo(2,t)},On.orderBy=function(t,e,n,i){return null==t?[]:(Ho(e)||(e=null==e?[]:[e]),Ho(n=i?r:n)||(n=null==n?[]:[n]),Vi(t,e,n))},On.over=ll,On.overArgs=ko,On.overEvery=cl,On.overSome=ul,On.partial=zo,On.partialRight=Fo,On.partition=wo,On.pick=ks,On.pickBy=zs,On.property=hl,On.propertyOf=function(t){return function(e){return null==t?r:bi(t,e)}},On.pull=Ya,On.pullAll=Xa,On.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Hi(t,e,aa(n,2)):t},On.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Hi(t,e,r,n):t},On.pullAt=Qa,On.range=dl,On.rangeRight=pl,On.rearg=Oo,On.reject=function(t,e){return(Ho(t)?Te:mi)(t,Ro(aa(e,3)))},On.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],a=t.length;for(e=aa(e,3);++i<a;){var o=t[i];e(o,i,t)&&(n.push(o),r.push(i))}return ji(t,r),n},On.rest=function(t,e){if("function"!=typeof t)throw new Mt(a);return Zi(t,e=e===r?e:ps(e))},On.reverse=Ja,On.sampleSize=function(t,e,n){return e=(n?ga(t,e,n):e===r)?1:ps(e),(Ho(t)?Xn:Yi)(t,e)},On.set=function(t,e,n){return null==t?t:Xi(t,e,n)},On.setWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:Xi(t,e,n,i)},On.shuffle=function(t){return(Ho(t)?Qn:Ki)(t)},On.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&ga(t,e,n)?(e=0,n=i):(e=null==e?0:ps(e),n=n===r?i:ps(n)),tr(t,e,n)):[]},On.sortBy=Co,On.sortedUniq=function(t){return t&&t.length?rr(t):[]},On.sortedUniqBy=function(t,e){return t&&t.length?rr(t,aa(e,2)):[]},On.split=function(t,e,n){return n&&"number"!=typeof n&&ga(t,e,n)&&(e=n=r),(n=n===r?p:n>>>0)?(t=vs(t))&&("string"==typeof e||null!=e&&!rs(e))&&!(e=or(e))&&rn(t)?yr(hn(t),0,n):t.split(e,n):[]},On.spread=function(t,e){if("function"!=typeof t)throw new Mt(a);return e=null==e?0:gn(ps(e),0),Zi((function(n){var i=n[e],r=yr(n,0,e);return i&&De(r,i),we(t,this,r)}))},On.tail=function(t){var e=null==t?0:t.length;return e?tr(t,1,e):[]},On.take=function(t,e,n){return t&&t.length?tr(t,0,(e=n||e===r?1:ps(e))<0?0:e):[]},On.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,(e=i-(e=n||e===r?1:ps(e)))<0?0:e,i):[]},On.takeRightWhile=function(t,e){return t&&t.length?ur(t,aa(e,3),!1,!0):[]},On.takeWhile=function(t,e){return t&&t.length?ur(t,aa(e,3)):[]},On.tap=function(t,e){return e(t),t},On.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new Mt(a);return Ko(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Bo(t,e,{leading:i,maxWait:e,trailing:r})},On.thru=ho,On.toArray=hs,On.toPairs=Fs,On.toPairsIn=Os,On.toPath=function(t){return Ho(t)?Le(t,ka):ss(t)?[t]:Sr(Ra(vs(t)))},On.toPlainObject=gs,On.transform=function(t,e,n){var i=Ho(t),r=i||Zo(t)||ls(t);if(e=aa(e,4),null==n){var a=t&&t.constructor;n=r?i?new a:[]:Ko(t)&&Xo(a)?Nn(jt(t)):{}}return(r?Ee:yi)(t,(function(t,i,r){return e(n,t,i,r)})),n},On.unary=function(t){return So(t,1)},On.union=Ka,On.unionBy=to,On.unionWith=eo,On.uniq=function(t){return t&&t.length?sr(t):[]},On.uniqBy=function(t,e){return t&&t.length?sr(t,aa(e,2)):[]},On.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?sr(t,r,e):[]},On.unset=function(t,e){return null==t||lr(t,e)},On.unzip=no,On.unzipWith=io,On.update=function(t,e,n){return null==t?t:cr(t,e,fr(n))},On.updateWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:cr(t,e,fr(n),i)},On.values=Ns,On.valuesIn=function(t){return null==t?[]:Xe(t,Ls(t))},On.without=ro,On.words=Xs,On.wrap=function(t,e){return zo(fr(e),t)},On.xor=ao,On.xorBy=oo,On.xorWith=so,On.zip=lo,On.zipObject=function(t,e){return pr(t||[],e||[],Kn)},On.zipObjectDeep=function(t,e){return pr(t||[],e||[],Xi)},On.zipWith=co,On.entries=Fs,On.entriesIn=Os,On.extend=_s,On.extendWith=xs,ol(On,On),On.add=vl,On.attempt=Qs,On.camelCase=Us,On.capitalize=Vs,On.ceil=yl,On.clamp=function(t,e,n){return n===r&&(n=e,e=r),n!==r&&(n=(n=fs(n))==n?n:0),e!==r&&(e=(e=fs(e))==e?e:0),ai(fs(t),e,n)},On.clone=function(t){return oi(t,4)},On.cloneDeep=function(t){return oi(t,5)},On.cloneDeepWith=function(t,e){return oi(t,5,e="function"==typeof e?e:r)},On.cloneWith=function(t,e){return oi(t,4,e="function"==typeof e?e:r)},On.conformsTo=function(t,e){return null==e||si(t,e,Bs(e))},On.deburr=Gs,On.defaultTo=function(t,e){return null==t||t!=t?e:t},On.divide=_l,On.endsWith=function(t,e,n){t=vs(t),e=or(e);var i=t.length,a=n=n===r?i:ai(ps(n),0,i);return(n-=e.length)>=0&&t.slice(n,a)==e},On.eq=No,On.escape=function(t){return(t=vs(t))&&$.test(t)?t.replace(q,en):t},On.escapeRegExp=function(t){return(t=vs(t))&&nt.test(t)?t.replace(et,"\\$&"):t},On.every=function(t,e,n){var i=Ho(t)?Me:di;return n&&ga(t,e,n)&&(e=r),i(t,aa(e,3))},On.find=fo,On.findIndex=Va,On.findKey=function(t,e){return Fe(t,aa(e,3),yi)},On.findLast=go,On.findLastIndex=Ga,On.findLastKey=function(t,e){return Fe(t,aa(e,3),_i)},On.floor=xl,On.forEach=vo,On.forEachRight=yo,On.forIn=function(t,e){return null==t?t:gi(t,aa(e,3),Ls)},On.forInRight=function(t,e){return null==t?t:vi(t,aa(e,3),Ls)},On.forOwn=function(t,e){return t&&yi(t,aa(e,3))},On.forOwnRight=function(t,e){return t&&_i(t,aa(e,3))},On.get=Es,On.gt=Uo,On.gte=Vo,On.has=function(t,e){return null!=t&&da(t,e,Ei)},On.hasIn=Ss,On.head=ja,On.identity=nl,On.includes=function(t,e,n,i){t=Wo(t)?t:Ns(t),n=n&&!i?ps(n):0;var r=t.length;return n<0&&(n=gn(r+n,0)),os(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Ne(t,e,n)>-1},On.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:ps(n);return r<0&&(r=gn(i+r,0)),Ne(t,e,r)},On.inRange=function(t,e,n){return e=ds(e),n===r?(n=e,e=0):n=ds(n),function(t,e,n){return t>=vn(e,n)&&t<gn(e,n)}(t=fs(t),e,n)},On.invoke=Is,On.isArguments=Go,On.isArray=Ho,On.isArrayBuffer=jo,On.isArrayLike=Wo,On.isArrayLikeObject=qo,On.isBoolean=function(t){return!0===t||!1===t||ts(t)&&wi(t)==v},On.isBuffer=Zo,On.isDate=$o,On.isElement=function(t){return ts(t)&&1===t.nodeType&&!is(t)},On.isEmpty=function(t){if(null==t)return!0;if(Wo(t)&&(Ho(t)||"string"==typeof t||"function"==typeof t.splice||Zo(t)||ls(t)||Go(t)))return!t.length;var e=ha(t);if(e==A||e==M)return!t.size;if(xa(t))return!Ri(t).length;for(var n in t)if(Pt.call(t,n))return!1;return!0},On.isEqual=function(t,e){return Bi(t,e)},On.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:r)?n(t,e):r;return i===r?Bi(t,e,r,n):!!i},On.isError=Yo,On.isFinite=function(t){return"number"==typeof t&&ze(t)},On.isFunction=Xo,On.isInteger=Qo,On.isLength=Jo,On.isMap=es,On.isMatch=function(t,e){return t===e||Li(t,e,sa(e))},On.isMatchWith=function(t,e,n){return n="function"==typeof n?n:r,Li(t,e,sa(e),n)},On.isNaN=function(t){return ns(t)&&t!=+t},On.isNative=function(t){if(_a(t))throw new bt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Di(t)},On.isNil=function(t){return null==t},On.isNull=function(t){return null===t},On.isNumber=ns,On.isObject=Ko,On.isObjectLike=ts,On.isPlainObject=is,On.isRegExp=rs,On.isSafeInteger=function(t){return Qo(t)&&t>=-9007199254740991&&t<=h},On.isSet=as,On.isString=os,On.isSymbol=ss,On.isTypedArray=ls,On.isUndefined=function(t){return t===r},On.isWeakMap=function(t){return ts(t)&&ha(t)==B},On.isWeakSet=function(t){return ts(t)&&"[object WeakSet]"==wi(t)},On.join=function(t,e){return null==t?"":je.call(t,e)},On.kebabCase=Hs,On.last=$a,On.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var a=i;return n!==r&&(a=(a=ps(n))<0?gn(i+a,0):vn(a,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,a):Oe(t,Ve,a,!0)},On.lowerCase=js,On.lowerFirst=Ws,On.lt=cs,On.lte=us,On.max=function(t){return t&&t.length?pi(t,nl,Ci):r},On.maxBy=function(t,e){return t&&t.length?pi(t,aa(e,2),Ci):r},On.mean=function(t){return Ge(t,nl)},On.meanBy=function(t,e){return Ge(t,aa(e,2))},On.min=function(t){return t&&t.length?pi(t,nl,ki):r},On.minBy=function(t,e){return t&&t.length?pi(t,aa(e,2),ki):r},On.stubArray=ml,On.stubFalse=fl,On.stubObject=function(){return{}},On.stubString=function(){return""},On.stubTrue=function(){return!0},On.multiply=bl,On.nth=function(t,e){return t&&t.length?Ui(t,ps(e)):r},On.noConflict=function(){return he._===this&&(he._=Ot),this},On.noop=sl,On.now=Eo,On.pad=function(t,e,n){t=vs(t);var i=(e=ps(e))?un(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return Vr(pe(r),n)+t+Vr(de(r),n)},On.padEnd=function(t,e,n){t=vs(t);var i=(e=ps(e))?un(t):0;return e&&i<e?t+Vr(e-i,n):t},On.padStart=function(t,e,n){t=vs(t);var i=(e=ps(e))?un(t):0;return e&&i<e?Vr(e-i,n)+t:t},On.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),_n(vs(t).replace(it,""),e||0)},On.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ga(t,e,n)&&(e=n=r),n===r&&("boolean"==typeof e?(n=e,e=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&e===r?(t=0,e=1):(t=ds(t),e===r?(e=t,t=0):e=ds(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var a=xn();return vn(t+a*(e-t+se("1e-"+((a+"").length-1))),e)}return Wi(t,e)},On.reduce=function(t,e,n){var i=Ho(t)?Pe:We,r=arguments.length<3;return i(t,aa(e,4),n,r,ui)},On.reduceRight=function(t,e,n){var i=Ho(t)?Re:We,r=arguments.length<3;return i(t,aa(e,4),n,r,hi)},On.repeat=function(t,e,n){return e=(n?ga(t,e,n):e===r)?1:ps(e),qi(vs(t),e)},On.replace=function(){var t=arguments,e=vs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},On.result=function(t,e,n){var i=-1,a=(e=gr(e,t)).length;for(a||(a=1,t=r);++i<a;){var o=null==t?r:t[ka(e[i])];o===r&&(i=a,o=n),t=Xo(o)?o.call(t):o}return t},On.round=Al,On.runInContext=t,On.sample=function(t){return(Ho(t)?Yn:$i)(t)},On.size=function(t){if(null==t)return 0;if(Wo(t))return os(t)?un(t):t.length;var e=ha(t);return e==A||e==M?t.size:Ri(t).length},On.snakeCase=qs,On.some=function(t,e,n){var i=Ho(t)?ke:er;return n&&ga(t,e,n)&&(e=r),i(t,aa(e,3))},On.sortedIndex=function(t,e){return nr(t,e)},On.sortedIndexBy=function(t,e,n){return ir(t,e,aa(n,2))},On.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=nr(t,e);if(i<n&&No(t[i],e))return i}return-1},On.sortedLastIndex=function(t,e){return nr(t,e,!0)},On.sortedLastIndexBy=function(t,e,n){return ir(t,e,aa(n,2),!0)},On.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=nr(t,e,!0)-1;if(No(t[n],e))return n}return-1},On.startCase=Zs,On.startsWith=function(t,e,n){return t=vs(t),n=null==n?0:ai(ps(n),0,t.length),e=or(e),t.slice(n,n+e.length)==e},On.subtract=wl,On.sum=function(t){return t&&t.length?qe(t,nl):0},On.sumBy=function(t,e){return t&&t.length?qe(t,aa(e,2)):0},On.template=function(t,e,n){var i=On.templateSettings;n&&ga(t,e,n)&&(e=r),t=vs(t),e=xs({},e,i,Yr);var a,o,s=xs({},e.imports,i.imports,Yr),l=Bs(s),c=Xe(s,l),u=0,h=e.interpolate||_t,d="__p += '",p=Et((e.escape||_t).source+"|"+h.source+"|"+(h===Q?ht:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),m="//# sourceURL="+(Pt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ie+"]")+"\n";t.replace(p,(function(e,n,i,r,s,l){return i||(i=r),d+=t.slice(u,l).replace(xt,nn),n&&(a=!0,d+="' +\n__e("+n+") +\n'"),s&&(o=!0,d+="';\n"+s+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+e.length,e})),d+="';\n";var f=Pt.call(e,"variable")&&e.variable;if(f){if(ct.test(f))throw new bt("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(G,""):d).replace(H,"$1").replace(j,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=Qs((function(){return At(l,m+"return "+d).apply(r,c)}));if(g.source=d,Yo(g))throw g;return g},On.times=function(t,e){if((t=ps(t))<1||t>h)return[];var n=p,i=vn(t,p);e=aa(e),t-=p;for(var r=Ze(i,e);++n<t;)e(n);return r},On.toFinite=ds,On.toInteger=ps,On.toLength=ms,On.toLower=function(t){return vs(t).toLowerCase()},On.toNumber=fs,On.toSafeInteger=function(t){return t?ai(ps(t),-9007199254740991,h):0===t?t:0},On.toString=vs,On.toUpper=function(t){return vs(t).toUpperCase()},On.trim=function(t,e,n){if((t=vs(t))&&(n||e===r))return $e(t);if(!t||!(e=or(e)))return t;var i=hn(t),a=hn(e);return yr(i,Je(i,a),Ke(i,a)+1).join("")},On.trimEnd=function(t,e,n){if((t=vs(t))&&(n||e===r))return t.slice(0,dn(t)+1);if(!t||!(e=or(e)))return t;var i=hn(t);return yr(i,0,Ke(i,hn(e))+1).join("")},On.trimStart=function(t,e,n){if((t=vs(t))&&(n||e===r))return t.replace(it,"");if(!t||!(e=or(e)))return t;var i=hn(t);return yr(i,Je(i,hn(e))).join("")},On.truncate=function(t,e){var n=30,i="...";if(Ko(e)){var a="separator"in e?e.separator:a;n="length"in e?ps(e.length):n,i="omission"in e?or(e.omission):i}var o=(t=vs(t)).length;if(rn(t)){var s=hn(t);o=s.length}if(n>=o)return t;var l=n-un(i);if(l<1)return i;var c=s?yr(s,0,l).join(""):t.slice(0,l);if(a===r)return c+i;if(s&&(l+=c.length-l),rs(a)){if(t.slice(l).search(a)){var u,h=c;for(a.global||(a=Et(a.source,vs(dt.exec(a))+"g")),a.lastIndex=0;u=a.exec(h);)var d=u.index;c=c.slice(0,d===r?l:d)}}else if(t.indexOf(or(a),l)!=l){var p=c.lastIndexOf(a);p>-1&&(c=c.slice(0,p))}return c+i},On.unescape=function(t){return(t=vs(t))&&Z.test(t)?t.replace(W,pn):t},On.uniqueId=function(t){var e=++Rt;return vs(t)+e},On.upperCase=$s,On.upperFirst=Ys,On.each=vo,On.eachRight=yo,On.first=ja,ol(On,(gl={},yi(On,(function(t,e){Pt.call(On.prototype,e)||(gl[e]=t)})),gl),{chain:!1}),On.VERSION="4.17.21",Ee(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){On[t].placeholder=On})),Ee(["drop","take"],(function(t,e){Gn.prototype[t]=function(n){n=n===r?1:gn(ps(n),0);var i=this.__filtered__&&!e?new Gn(this):this.clone();return i.__filtered__?i.__takeCount__=vn(n,i.__takeCount__):i.__views__.push({size:vn(n,p),type:t+(i.__dir__<0?"Right":"")}),i},Gn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Ee(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=1==n||3==n;Gn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:aa(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}})),Ee(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Gn.prototype[t]=function(){return this[n](1).value()[0]}})),Ee(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Gn.prototype[t]=function(){return this.__filtered__?new Gn(this):this[n](1)}})),Gn.prototype.compact=function(){return this.filter(nl)},Gn.prototype.find=function(t){return this.filter(t).head()},Gn.prototype.findLast=function(t){return this.reverse().find(t)},Gn.prototype.invokeMap=Zi((function(t,e){return"function"==typeof t?new Gn(this):this.map((function(n){return Ti(n,t,e)}))})),Gn.prototype.reject=function(t){return this.filter(Ro(aa(t)))},Gn.prototype.slice=function(t,e){t=ps(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Gn(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==r&&(n=(e=ps(e))<0?n.dropRight(-e):n.take(e-t)),n)},Gn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Gn.prototype.toArray=function(){return this.take(p)},yi(Gn.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),a=On[i?"take"+("last"==e?"Right":""):e],o=i||/^find/.test(e);a&&(On.prototype[e]=function(){var e=this.__wrapped__,s=i?[1]:arguments,l=e instanceof Gn,c=s[0],u=l||Ho(e),h=function(t){var e=a.apply(On,De([t],s));return i&&d?e[0]:e};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var d=this.__chain__,p=!!this.__actions__.length,m=o&&!d,f=l&&!p;if(!o&&u){e=f?e:new Gn(this);var g=t.apply(e,s);return g.__actions__.push({func:ho,args:[h],thisArg:r}),new Vn(g,d)}return m&&f?t.apply(this,s):(g=this.thru(h),m?i?g.value()[0]:g.value():g)})})),Ee(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Tt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);On.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(Ho(r)?r:[],t)}return this[n]((function(n){return e.apply(Ho(n)?n:[],t)}))}})),yi(Gn.prototype,(function(t,e){var n=On[e];if(n){var i=n.name+"";Pt.call(In,i)||(In[i]=[]),In[i].push({name:e,func:n})}})),In[Fr(r,2).name]=[{name:"wrapper",func:r}],Gn.prototype.clone=function(){var t=new Gn(this.__wrapped__);return t.__actions__=Sr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Sr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Sr(this.__views__),t},Gn.prototype.reverse=function(){if(this.__filtered__){var t=new Gn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Gn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ho(t),i=e<0,r=n?t.length:0,a=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var a=n[i],o=a.size;switch(a.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=vn(e,t+o);break;case"takeRight":t=gn(t,e-o)}}return{start:t,end:e}}(0,r,this.__views__),o=a.start,s=a.end,l=s-o,c=i?s:o-1,u=this.__iteratees__,h=u.length,d=0,p=vn(l,this.__takeCount__);if(!n||!i&&r==l&&p==l)return hr(t,this.__actions__);var m=[];t:for(;l--&&d<p;){for(var f=-1,g=t[c+=e];++f<h;){var v=u[f],y=v.iteratee,_=v.type,x=y(g);if(2==_)g=x;else if(!x){if(1==_)continue t;break t}}m[d++]=g}return m},On.prototype.at=po,On.prototype.chain=function(){return uo(this)},On.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},On.prototype.next=function(){this.__values__===r&&(this.__values__=hs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?r:this.__values__[this.__index__++]}},On.prototype.plant=function(t){for(var e,n=this;n instanceof Un;){var i=Fa(n);i.__index__=0,i.__values__=r,e?a.__wrapped__=i:e=i;var a=i;n=n.__wrapped__}return a.__wrapped__=t,e},On.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Gn){var e=t;return this.__actions__.length&&(e=new Gn(this)),(e=e.reverse()).__actions__.push({func:ho,args:[Ja],thisArg:r}),new Vn(e,this.__chain__)}return this.thru(Ja)},On.prototype.toJSON=On.prototype.valueOf=On.prototype.value=function(){return hr(this.__wrapped__,this.__actions__)},On.prototype.first=On.prototype.head,Yt&&(On.prototype[Yt]=function(){return this}),On}();he._=mn,(i=function(){return mn}.call(e,n,e,t))===r||(t.exports=i)}.call(this)},1133:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.fetchWeatherApi=void 0;const r=n(2162),a=n(8513),o=t=>new Promise((e=>setTimeout(e,t)));e.fetchWeatherApi=function(t,e){return i(this,arguments,void 0,(function*(t,e,n=3,s=.2,l=2){const c=new URLSearchParams(e);c.set("format","flatbuffers");const u=yield function(t){return i(this,arguments,void 0,(function*(t,e=3,n=.5,i=2){const r=[500,502,504];let a=0,s=yield fetch(t);for(;r.includes(s.status);){if(a++,a>=e)throw new Error(s.statusText);const r=1e3*Math.min(n*Math.pow(2,a),i);yield o(r),s=yield fetch(t)}if([400,429].includes(s.status)){const t=yield s.json();if("reason"in t)throw new Error(t.reason);throw new Error(s.statusText)}return s}))}(`${t}?${c.toString()}`,n,s,l),h=new r.ByteBuffer(new Uint8Array(yield u.arrayBuffer())),d=[];let p=0;for(;p<h.capacity();){h.setPosition(p);const t=h.readInt32(h.position());d.push(a.WeatherApiResponse.getSizePrefixedRootAsWeatherApiResponse(h)),p+=t+4}return d}))}},5072:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var a={},o=[],s=0;s<t.length;s++){var l=t[s],c=i.base?l[0]+i.base:l[0],u=a[c]||0,h="".concat(c," ").concat(u);a[c]=u+1;var d=n(h),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var m=r(p,i);i.byIndex=s,e.splice(s,0,{identifier:h,updater:m,references:1})}o.push(h)}return o}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var a=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<a.length;o++){var s=n(a[o]);e[s].references--}for(var l=i(t,r),c=0;c<a.length;c++){var u=n(a[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}a=l}}},7659:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},5056:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7825:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},1113:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},2395:(t,e,n)=>{t.exports=n(3317)},3317:function(t,e,n){var i;!function(r,a){var o=function(t,e){var n=t.document,i=Array.prototype.slice,r=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)};var a=function(){var t=50,e=50,a={dialRadius:40,dialStartAngle:135,dialEndAngle:45,value:0,max:100,min:0,valueDialClass:"value",valueClass:"value-text",dialClass:"dial",gaugeClass:"gauge",showValue:!0,gaugeColor:null,label:function(t){return Math.round(t)}};function o(t,e,i){var r=n.createElementNS("http://www.w3.org/2000/svg",t);for(var a in e)r.setAttribute(a,e[a]);return i&&i.forEach((function(t){r.appendChild(t)})),r}function s(t,e){return t*e/100}function l(t,e,n){var i=Number(t);return i>n?n:i<e?e:i}function c(t,e,n,i){var r=i*Math.PI/180;return{x:Math.round(1e3*(t+n*Math.cos(r)))/1e3,y:Math.round(1e3*(e+n*Math.sin(r)))/1e3}}return function(n,u){var h,d,p,m=n,f=(u=function(){var t=arguments[0];return i.call(arguments,1).forEach((function(e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})),t}({},a,u)).max,g=u.min,v=l(u.value,g,f),y=u.dialRadius,_=u.showValue,x=u.dialStartAngle,b=u.dialEndAngle,A=u.valueDialClass,w=u.valueClass,C=(u.valueLabelClass,u.dialClass),E=u.gaugeClass,S=u.color,M=u.label,T=u.viewBox;if(x<b){console.log("WARN! startAngle < endAngle, Swapping");var I=x;x=b,b=I}function B(n,i,r,a){var o=function(n,i,r){var a=t,o=e;return{end:c(a,o,n,r),start:c(a,o,n,i)}}(n,i,r),s=o.start,l=o.end,u=void 0===a?1:a;return["M",s.x,s.y,"A",n,n,0,u,1,l.x,l.y].join(" ")}function L(t,e){var n=s(function(t,e,n){return 100*(t-e)/(n-e)}(t,g,f),360-Math.abs(x-b)),i=n<=180?0:1;_&&(h.textContent=M.call(u,t)),d.setAttribute("d",B(y,x,n+x,i))}function D(t,e){var n=S.call(u,t),i="stroke "+1e3*e+"ms ease";d.style.stroke=n,d.style["-webkit-transition"]=i,d.style["-moz-transition"]=i,d.style.transition=i}return p={setMaxValue:function(t){f=t,L(v)},setValue:function(t){v=l(t,g,f),S&&D(v,0),L(v)},setValueAnimated:function(t,e){var n=v;n!==(v=l(t,g,f))&&(S&&D(v,e),function(t){var e=t.duration,n=1,i=60*e,a=t.start||0,o=t.end-a,s=t.step,l=t.easing||function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)};r((function t(){var e=n/i,c=o*l(e)+a;s(c,n),n+=1,e<1&&r(t)}))}({start:n||0,end:v,duration:e||1,step:function(t,e){L(t)}}))},getValue:function(){return v}},function(t){h=o("text",{x:50,y:50,fill:"#999",class:w,"font-size":"100%","font-family":"sans-serif","font-weight":"normal","text-anchor":"middle","alignment-baseline":"middle","dominant-baseline":"central"}),d=o("path",{class:A,fill:"none",stroke:"#666","stroke-width":2.5,d:B(y,x,x)});var e=s(100,360-Math.abs(x-b)),n=o("svg",{viewBox:T||"0 0 100 100",class:E},[o("path",{class:C,fill:"none",stroke:"#eee","stroke-width":2,d:B(y,x,b,e<=180?0:1)}),o("g",{class:"text-container"},[h]),d]);t.appendChild(n)}(m),p.setValue(v),p}}();return a}(r);void 0===(i=function(){return o}.call(e,n,e,t))||(t.exports=i)}("undefined"==typeof window?this:window)},433:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C-3.24298%2C2.63257%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22matrix%281.20712%2C0%2C0%2C1.20712%2C14.9145%2C2.51292%29%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M2.5%2C9.406L0%2C9.406L4%2C17.875L8%2C9.406L5.5%2C9.406C5.483%2C10.22%204.818%2C10.875%204%2C10.875C3.182%2C10.875%202.517%2C10.22%202.5%2C9.406Z%22%20style%3D%22fill%3Argb%2829%2C50%2C98%29%3Bfill-opacity%3A0.35%3B%22%2F%3E%0A%20%20%20%20%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%20%20%20%20%3Cg%20transform%3D%22matrix%281.20712%2C0%2C0%2C1.20712%2C14.9145%2C2.51292%29%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M4%2C0.938L0%2C9.406L2.5%2C9.406L2.5%2C9.375C2.5%2C8.547%203.172%2C7.875%204%2C7.875C4.828%2C7.875%205.5%2C8.547%205.5%2C9.375L5.5%2C9.406L8%2C9.406L4%2C0.938Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3B%22%2F%3E%0A%20%20%20%20%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},7528:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C7.99998%2C11%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.083%2C10.209C0.722%2C10.209%200.459%2C10.049%200.292%2C9.73C0.125%2C9.41%200.153%2C9.105%200.375%2C8.813L3.625%2C4.48C3.806%2C4.244%204.042%2C4.126%204.333%2C4.126C4.625%2C4.126%204.861%2C4.244%205.042%2C4.48L7.5%2C7.751C7.653%2C7.944%207.847%2C8.063%208.083%2C8.105C8.32%2C8.146%208.535%2C8.09%208.729%2C7.938C8.924%2C7.799%209.038%2C7.619%209.073%2C7.396C9.108%2C7.174%209.069%2C6.965%208.958%2C6.771L7.104%2C4.313L9.458%2C1.147C9.639%2C0.91%209.875%2C0.792%2010.167%2C0.792C10.458%2C0.792%2010.694%2C0.91%2010.875%2C1.147L16.625%2C8.813C16.847%2C9.105%2016.875%2C9.41%2016.708%2C9.73C16.541%2C10.049%2016.278%2C10.209%2015.917%2C10.209L1.083%2C10.209Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},6054:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C8.00023%2C11%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.083%2C10.209C0.722%2C10.209%200.458%2C10.049%200.292%2C9.73C0.125%2C9.41%200.153%2C9.105%200.375%2C8.813L3.625%2C4.48C3.805%2C4.244%204.041%2C4.126%204.333%2C4.126C4.625%2C4.126%204.861%2C4.244%205.042%2C4.48L8.021%2C8.459L14.167%2C8.459L10.167%2C3.147L8.188%2C5.751L7.104%2C4.313L9.458%2C1.147C9.638%2C0.91%209.875%2C0.792%2010.167%2C0.792C10.458%2C0.792%2010.694%2C0.91%2010.875%2C1.147L16.625%2C8.813C16.847%2C9.105%2016.874%2C9.41%2016.708%2C9.73C16.541%2C10.049%2016.277%2C10.209%2015.917%2C10.209L1.083%2C10.209ZM2.833%2C8.459L5.833%2C8.459L4.333%2C6.459L2.833%2C8.459ZM2.833%2C8.459L5.833%2C8.459L2.833%2C8.459Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},3051:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C8.49996%2C8.5%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.434%2C5.576C1.2%2C5.576%200.997%2C5.49%200.825%2C5.317C0.653%2C5.146%200.567%2C4.943%200.567%2C4.709C0.567%2C4.475%200.653%2C4.272%200.825%2C4.1C0.997%2C3.929%201.2%2C3.843%201.434%2C3.843L2.609%2C3.843L0.732%2C1.965C0.567%2C1.8%200.488%2C1.597%200.495%2C1.356C0.502%2C1.115%200.588%2C0.913%200.753%2C0.748C0.918%2C0.583%201.121%2C0.5%201.361%2C0.5C1.602%2C0.5%201.805%2C0.583%201.97%2C0.748L3.828%2C2.624L3.828%2C1.449C3.828%2C1.215%203.913%2C1.012%204.085%2C0.84C4.257%2C0.668%204.46%2C0.582%204.694%2C0.582C4.928%2C0.582%205.131%2C0.668%205.302%2C0.84C5.475%2C1.012%205.561%2C1.215%205.561%2C1.449L5.561%2C4.709C5.561%2C4.943%205.475%2C5.146%205.302%2C5.317C5.131%2C5.49%204.928%2C5.576%204.694%2C5.576L1.434%2C5.576ZM14.557%2C5.576L11.296%2C5.576C11.063%2C5.576%2010.86%2C5.49%2010.688%2C5.317C10.516%2C5.146%2010.43%2C4.943%2010.43%2C4.709L10.43%2C1.449C10.43%2C1.215%2010.516%2C1.012%2010.688%2C0.84C10.86%2C0.668%2011.063%2C0.582%2011.296%2C0.582C11.531%2C0.582%2011.734%2C0.668%2011.906%2C0.84C12.077%2C1.012%2012.163%2C1.215%2012.163%2C1.449L12.163%2C2.624L14.041%2C0.748C14.206%2C0.583%2014.409%2C0.5%2014.65%2C0.5C14.89%2C0.5%2015.093%2C0.583%2015.258%2C0.748C15.423%2C0.913%2015.506%2C1.115%2015.506%2C1.356C15.506%2C1.597%2015.423%2C1.8%2015.258%2C1.965L13.381%2C3.843L14.557%2C3.843C14.791%2C3.843%2014.994%2C3.929%2015.166%2C4.1C15.338%2C4.272%2015.424%2C4.475%2015.424%2C4.709C15.424%2C4.943%2015.338%2C5.146%2015.166%2C5.317C14.994%2C5.49%2014.791%2C5.576%2014.557%2C5.576ZM0.753%2C15.252C0.588%2C15.087%200.506%2C14.888%200.506%2C14.654C0.506%2C14.42%200.588%2C14.221%200.753%2C14.056L2.63%2C12.178L1.434%2C12.178C1.2%2C12.178%200.997%2C12.092%200.825%2C11.921C0.653%2C11.749%200.567%2C11.546%200.567%2C11.312C0.567%2C11.078%200.653%2C10.875%200.825%2C10.703C0.997%2C10.531%201.2%2C10.445%201.434%2C10.445L4.694%2C10.445C4.928%2C10.445%205.131%2C10.531%205.302%2C10.703C5.475%2C10.875%205.561%2C11.078%205.561%2C11.312L5.561%2C14.572C5.561%2C14.806%205.475%2C15.009%205.302%2C15.181C5.131%2C15.353%204.928%2C15.439%204.694%2C15.439C4.46%2C15.439%204.257%2C15.353%204.085%2C15.181C3.913%2C15.009%203.828%2C14.806%203.828%2C14.572L3.828%2C13.376L1.95%2C15.252C1.785%2C15.418%201.585%2C15.5%201.351%2C15.5C1.118%2C15.5%200.918%2C15.418%200.753%2C15.252ZM11.296%2C15.439C11.063%2C15.439%2010.86%2C15.353%2010.688%2C15.181C10.516%2C15.009%2010.43%2C14.806%2010.43%2C14.572L10.43%2C11.312C10.43%2C11.078%2010.516%2C10.875%2010.688%2C10.703C10.86%2C10.531%2011.063%2C10.445%2011.296%2C10.445L14.557%2C10.445C14.791%2C10.445%2014.994%2C10.531%2015.166%2C10.703C15.338%2C10.875%2015.424%2C11.078%2015.424%2C11.312C15.424%2C11.546%2015.338%2C11.749%2015.166%2C11.921C14.994%2C12.092%2014.791%2C12.178%2014.557%2C12.178L13.36%2C12.178L15.237%2C14.056C15.402%2C14.221%2015.485%2C14.42%2015.485%2C14.654C15.485%2C14.888%2015.402%2C15.087%2015.237%2C15.252C15.072%2C15.418%2014.873%2C15.5%2014.639%2C15.5C14.405%2C15.5%2014.206%2C15.418%2014.041%2C15.252L12.163%2C13.376L12.163%2C14.572C12.163%2C14.806%2012.077%2C15.009%2011.906%2C15.181C11.734%2C15.353%2011.531%2C15.439%2011.296%2C15.439Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},7664:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9%2C9%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M0.875%2C5.042C0.639%2C5.042%200.434%2C4.955%200.26%2C4.781C0.087%2C4.608%200%2C4.403%200%2C4.167L0%2C0.875C0%2C0.639%200.087%2C0.434%200.26%2C0.26C0.434%2C0.087%200.639%2C0%200.875%2C0L4.167%2C0C4.403%2C0%204.608%2C0.087%204.781%2C0.26C4.955%2C0.434%205.042%2C0.639%205.042%2C0.875C5.042%2C1.111%204.955%2C1.316%204.781%2C1.49C4.608%2C1.663%204.403%2C1.75%204.167%2C1.75L2.958%2C1.75L4.875%2C3.667C5.042%2C3.834%205.122%2C4.031%205.115%2C4.26C5.108%2C4.489%205.021%2C4.687%204.854%2C4.854C4.687%2C5.021%204.486%2C5.104%204.25%2C5.104C4.014%2C5.104%203.813%2C5.021%203.646%2C4.854L1.75%2C2.958L1.75%2C4.167C1.75%2C4.403%201.663%2C4.608%201.49%2C4.781C1.316%2C4.955%201.111%2C5.042%200.875%2C5.042ZM10.146%2C4.854C9.979%2C4.687%209.896%2C4.486%209.896%2C4.25C9.896%2C4.014%209.979%2C3.813%2010.146%2C3.646L12.042%2C1.75L10.833%2C1.75C10.597%2C1.75%2010.392%2C1.663%2010.219%2C1.49C10.045%2C1.316%209.958%2C1.111%209.958%2C0.875C9.958%2C0.639%2010.045%2C0.434%2010.219%2C0.26C10.392%2C0.087%2010.597%2C0%2010.833%2C0L14.125%2C0C14.361%2C0%2014.566%2C0.087%2014.74%2C0.26C14.913%2C0.434%2015%2C0.639%2015%2C0.875L15%2C4.167C15%2C4.403%2014.913%2C4.608%2014.74%2C4.781C14.566%2C4.955%2014.361%2C5.042%2014.125%2C5.042C13.889%2C5.042%2013.684%2C4.955%2013.51%2C4.781C13.337%2C4.608%2013.25%2C4.403%2013.25%2C4.167L13.25%2C2.958L11.333%2C4.875C11.166%2C5.042%2010.969%2C5.122%2010.74%2C5.115C10.511%2C5.108%2010.313%2C5.021%2010.146%2C4.854ZM10.833%2C15C10.597%2C15%2010.392%2C14.913%2010.219%2C14.74C10.045%2C14.566%209.958%2C14.361%209.958%2C14.125C9.958%2C13.889%2010.045%2C13.684%2010.219%2C13.51C10.392%2C13.337%2010.597%2C13.25%2010.833%2C13.25L12.021%2C13.25L10.125%2C11.354C9.958%2C11.187%209.875%2C10.986%209.875%2C10.75C9.875%2C10.514%209.965%2C10.306%2010.146%2C10.125C10.313%2C9.958%2010.517%2C9.875%2010.76%2C9.875C11.003%2C9.875%2011.208%2C9.958%2011.375%2C10.125L13.25%2C12.021L13.25%2C10.833C13.25%2C10.597%2013.337%2C10.392%2013.51%2C10.219C13.684%2C10.045%2013.889%2C9.958%2014.125%2C9.958C14.361%2C9.958%2014.566%2C10.045%2014.74%2C10.219C14.913%2C10.392%2015%2C10.597%2015%2C10.833L15%2C14.125C15%2C14.361%2014.913%2C14.566%2014.74%2C14.74C14.566%2C14.913%2014.361%2C15%2014.125%2C15L10.833%2C15ZM0.875%2C15C0.639%2C15%200.434%2C14.913%200.26%2C14.74C0.087%2C14.566%200%2C14.361%200%2C14.125L0%2C10.833C0%2C10.597%200.087%2C10.392%200.26%2C10.219C0.434%2C10.045%200.639%2C9.958%200.875%2C9.958C1.111%2C9.958%201.316%2C10.045%201.49%2C10.219C1.663%2C10.392%201.75%2C10.597%201.75%2C10.833L1.75%2C12.021L3.646%2C10.125C3.813%2C9.958%204.014%2C9.872%204.25%2C9.865C4.486%2C9.858%204.694%2C9.944%204.875%2C10.125C5.042%2C10.292%205.125%2C10.497%205.125%2C10.74C5.125%2C10.983%205.042%2C11.187%204.875%2C11.354L2.979%2C13.25L4.167%2C13.25C4.403%2C13.25%204.608%2C13.337%204.781%2C13.51C4.955%2C13.684%205.042%2C13.889%205.042%2C14.125C5.042%2C14.361%204.955%2C14.566%204.781%2C14.74C4.608%2C14.913%204.403%2C15%204.167%2C15L0.875%2C15Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},8994:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.5%2C15.25%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M1.475%2C2.225C1.212%2C2.225%200.984%2C2.128%200.79%2C1.935C0.597%2C1.741%200.5%2C1.513%200.5%2C1.25C0.5%2C0.987%200.597%2C0.759%200.79%2C0.566C0.984%2C0.372%201.212%2C0.275%201.475%2C0.275L12.525%2C0.275C12.788%2C0.275%2013.016%2C0.372%2013.21%2C0.566C13.403%2C0.759%2013.5%2C0.987%2013.5%2C1.25C13.5%2C1.513%2013.403%2C1.741%2013.21%2C1.935C13.016%2C2.128%2012.788%2C2.225%2012.525%2C2.225L1.475%2C2.225Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},3754:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.5%2C9.25%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M7%2C13.75C6.737%2C13.75%206.509%2C13.653%206.315%2C13.46C6.122%2C13.266%206.025%2C13.038%206.025%2C12.775L6.025%2C8.225L1.475%2C8.225C1.212%2C8.225%200.984%2C8.128%200.79%2C7.935C0.597%2C7.741%200.5%2C7.513%200.5%2C7.25C0.5%2C6.987%200.597%2C6.759%200.79%2C6.565C0.984%2C6.372%201.212%2C6.275%201.475%2C6.275L6.025%2C6.275L6.025%2C1.725C6.025%2C1.462%206.122%2C1.234%206.315%2C1.04C6.509%2C0.847%206.737%2C0.75%207%2C0.75C7.263%2C0.75%207.491%2C0.847%207.685%2C1.04C7.878%2C1.234%207.975%2C1.462%207.975%2C1.725L7.975%2C6.275L12.525%2C6.275C12.788%2C6.275%2013.016%2C6.372%2013.21%2C6.565C13.403%2C6.759%2013.5%2C6.987%2013.5%2C7.25C13.5%2C7.513%2013.403%2C7.741%2013.21%2C7.935C13.016%2C8.128%2012.788%2C8.225%2012.525%2C8.225L7.975%2C8.225L7.975%2C12.775C7.975%2C13.038%207.878%2C13.266%207.685%2C13.46C7.491%2C13.653%207.263%2C13.75%207%2C13.75Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},1872:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.50001%2C8.89492%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.932L0.567%2C6.865C0.391%2C6.798%200.253%2C6.69%200.152%2C6.541C0.051%2C6.392%200%2C6.223%200%2C6.035C0%2C5.846%200.051%2C5.68%200.152%2C5.538C0.253%2C5.396%200.391%2C5.291%200.567%2C5.224L12.846%2C0.665C13.021%2C0.597%2013.187%2C0.587%2013.343%2C0.634C13.498%2C0.682%2013.629%2C0.759%2013.738%2C0.868C13.846%2C0.976%2013.924%2C1.107%2013.971%2C1.262C14.018%2C1.418%2014.008%2C1.584%2013.94%2C1.759L9.381%2C14.059C9.3%2C14.247%209.186%2C14.386%209.037%2C14.474C8.888%2C14.561%208.732%2C14.605%208.57%2C14.605C8.408%2C14.605%208.253%2C14.558%208.104%2C14.463C7.956%2C14.368%207.841%2C14.233%207.76%2C14.059L5.673%2C8.932Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%280.598546%2C0.598546%2C-0.707107%2C0.707107%2C11.7313%2C1.9674%29%22%3E%0A%20%20%20%20%20%20%20%20%3Crect%20x%3D%226.516%22%20y%3D%223.78%22%20width%3D%2219.271%22%20height%3D%220.716%22%20style%3D%22fill%3Argb%28229%2C0%2C0%29%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},4170:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.50001%2C8.89492%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.932L0.567%2C6.865C0.391%2C6.798%200.253%2C6.69%200.152%2C6.541C0.051%2C6.392%200%2C6.223%200%2C6.035C0%2C5.846%200.051%2C5.68%200.152%2C5.538C0.253%2C5.396%200.391%2C5.291%200.567%2C5.224L12.846%2C0.665C13.021%2C0.597%2013.187%2C0.587%2013.343%2C0.634C13.498%2C0.682%2013.629%2C0.759%2013.738%2C0.868C13.846%2C0.976%2013.924%2C1.107%2013.971%2C1.262C14.018%2C1.418%2014.008%2C1.584%2013.94%2C1.759L9.381%2C14.059C9.3%2C14.247%209.186%2C14.386%209.037%2C14.474C8.888%2C14.561%208.732%2C14.605%208.57%2C14.605C8.408%2C14.605%208.253%2C14.558%208.104%2C14.463C7.956%2C14.368%207.841%2C14.233%207.76%2C14.059L5.673%2C8.932Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},3155:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.50001%2C9.25%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%280.598546%2C0.598546%2C-0.707107%2C0.707107%2C11.7313%2C1.9674%29%22%3E%0A%20%20%20%20%20%20%20%20%3Crect%20x%3D%226.516%22%20y%3D%223.78%22%20width%3D%2219.271%22%20height%3D%220.716%22%20style%3D%22fill%3Argb%28229%2C0%2C0%29%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},1323:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.50001%2C9.25%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},374:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%20standalone%3D%22no%22%3F%3E%0A%3C%21DOCTYPE%20svg%20PUBLIC%20%22-%2F%2FW3C%2F%2FDTD%20SVG%201.1%2F%2FEN%22%20%22http%3A%2F%2Fwww.w3.org%2FGraphics%2FSVG%2F1.1%2FDTD%2Fsvg11.dtd%22%3E%0A%3Csvg%20width%3D%22100%25%22%20height%3D%22100%25%22%20viewBox%3D%220%200%2033%2033%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xml%3Aspace%3D%22preserve%22%20xmlns%3Aserif%3D%22http%3A%2F%2Fwww.serif.com%2F%22%20style%3D%22fill-rule%3Aevenodd%3Bclip-rule%3Aevenodd%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A2%3B%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M10.685%2C14.817L22.511%2C10.669L18.217%2C22.082L15.824%2C17.233L10.685%2C14.817Z%22%20style%3D%22fill%3Argb%2829%2C50%2C98%29%3Bfill-opacity%3A0.2%3B%22%2F%3E%0A%20%20%20%20%3Cg%20transform%3D%22matrix%281%2C0%2C0%2C1%2C9.50001%2C9.25%29%22%3E%0A%20%20%20%20%20%20%20%20%3Cpath%20d%3D%22M5.673%2C8.577L0.567%2C6.51C0.391%2C6.443%200.253%2C6.335%200.152%2C6.186C0.051%2C6.037%200%2C5.868%200%2C5.68C0%2C5.49%200.051%2C5.325%200.152%2C5.183C0.253%2C5.041%200.391%2C4.936%200.567%2C4.869L12.846%2C0.31C13.021%2C0.242%2013.187%2C0.232%2013.343%2C0.279C13.498%2C0.326%2013.629%2C0.404%2013.738%2C0.513C13.846%2C0.621%2013.924%2C0.752%2013.971%2C0.907C14.018%2C1.063%2014.008%2C1.229%2013.94%2C1.404L9.381%2C13.703C9.3%2C13.892%209.186%2C14.031%209.037%2C14.119C8.888%2C14.206%208.732%2C14.25%208.57%2C14.25C8.408%2C14.25%208.253%2C14.203%208.104%2C14.108C7.956%2C14.013%207.841%2C13.879%207.76%2C13.703L5.673%2C8.577ZM8.53%2C11.11L11.691%2C2.559L3.14%2C5.72L6.991%2C7.259L8.53%2C11.11Z%22%20style%3D%22fill%3Argb%2868%2C73%2C82%29%3Bfill-rule%3Anonzero%3B%22%2F%3E%0A%20%20%20%20%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A"},5446:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%23333%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},6694:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2722%27 height=%2722%27 fill=%27%2333b5e5%27 viewBox=%270 0 22 22%27%3E%3Cpath d=%27m1.754 13.406 4.453-4.851 3.09 3.09 3.281 3.277.969-.969-3.309-3.312 3.844-4.121 6.148 6.886h1.082v-.855l-7.207-8.07-4.84 5.187L6.169 6.57l-5.48 5.965v.871ZM.688 16.844h20.625v1.375H.688Zm0 0%27/%3E%3C/svg%3E"},6117:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},6311:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2724%27 height=%2724%27 fill=%27%23fff%27 fill-rule=%27evenodd%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0%27/%3E%3C/svg%3E"},4420:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},7035:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},3470:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},3490:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},216:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23333%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},7695:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},2228:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%2333b5e5%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},3737:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23666%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},8460:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23999%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},5796:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23aaa%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3Cpath fill=%27red%27 d=%27m14 5 1 1-9 9-1-1z%27/%3E%3C/svg%3E"},8869:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e54e33%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3C/svg%3E"},9819:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23e58978%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},557:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},8164:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},4665:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},1413:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},3913:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},1907:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 fill=%27%23fff%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},6539:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 20 20%27%3E%3Cpath d=%27M10 4C9 4 9 5 9 5v.1A5 5 0 0 0 5.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 0 0 9 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 0 0 3.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0 0 11 5.1V5s0-1-1-1m0 2.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 1 1 0-7%27/%3E%3Ccircle cx=%2710%27 cy=%2710%27 r=%272%27/%3E%3C/svg%3E"},4890:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13z%27/%3E%3C/svg%3E"},3363:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5%27/%3E%3C/svg%3E"},7603:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1z%27/%3E%3C/svg%3E"},4643:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1z%27/%3E%3C/svg%3E"},8605:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2729%27 height=%2729%27 viewBox=%270 0 29 29%27%3E%3Cpath d=%27m10.5 14 4-8 4 8z%27/%3E%3Cpath fill=%27%23ccc%27 d=%27m10.5 16 4 8 4-8z%27/%3E%3C/svg%3E"},7914:t=>{"use strict";t.exports="data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2788%27 height=%2723%27 fill=%27none%27%3E%3Cpath fill=%27%23000%27 fill-opacity=%27.4%27 fill-rule=%27evenodd%27 d=%27M17.408 16.796h-1.827l2.501-12.095h.198l3.324 6.533.988 2.19.988-2.19 3.258-6.533h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.929 5.644h-.098l-2.914-5.644-.757-1.71-.345 1.71zm1.958-3.42-.726 3.663a1.255 1.255 0 0 1-1.232 1.011h-1.827a1.255 1.255 0 0 1-1.229-1.509l2.501-12.095a1.255 1.255 0 0 1 1.23-1.001h.197a1.25 1.25 0 0 1 1.12.685l3.19 6.273 3.125-6.263a1.25 1.25 0 0 1 1.123-.695h.181a1.255 1.255 0 0 1 1.227.991l1.443 6.71a5 5 0 0 1 .314-.787l.009-.016a4.6 4.6 0 0 1 1.777-1.887c.782-.46 1.668-.667 2.611-.667a4.6 4.6 0 0 1 1.7.32l.306.134c.21-.16.474-.256.759-.256h1.694a1.255 1.255 0 0 1 1.212.925 1.255 1.255 0 0 1 1.212-.925h1.711c.284 0 .545.094.755.252.613-.3 1.312-.45 2.075-.45 1.356 0 2.557.445 3.482 1.4q.47.48.763 1.064V4.701a1.255 1.255 0 0 1 1.255-1.255h1.86A1.255 1.255 0 0 1 54.44 4.7v9.194h2.217c.19 0 .37.043.532.118v-4.77c0-.356.147-.678.385-.906a2.42 2.42 0 0 1-.682-1.71c0-.665.267-1.253.735-1.7a2.45 2.45 0 0 1 1.722-.674 2.43 2.43 0 0 1 1.705.675q.318.302.504.683V4.7a1.255 1.255 0 0 1 1.255-1.255h1.744A1.255 1.255 0 0 1 65.812 4.7v3.335a4.8 4.8 0 0 1 1.526-.246c.938 0 1.817.214 2.59.69a4.47 4.47 0 0 1 1.67 1.743v-.98a1.255 1.255 0 0 1 1.256-1.256h1.777c.233 0 .451.064.639.174a3.4 3.4 0 0 1 1.567-.372c.346 0 .861.02 1.285.232a1.25 1.25 0 0 1 .689 1.004 4.7 4.7 0 0 1 .853-.588c.795-.44 1.675-.647 2.61-.647 1.385 0 2.65.39 3.525 1.396.836.938 1.168 2.173 1.168 3.528q-.001.515-.056 1.051a1.255 1.255 0 0 1-.947 1.09l.408.952a1.255 1.255 0 0 1-.477 1.552c-.418.268-.92.463-1.458.612-.613.171-1.304.244-2.049.244-1.06 0-2.043-.207-2.886-.698l-.015-.008c-.798-.48-1.419-1.135-1.818-1.963l-.004-.008a5.8 5.8 0 0 1-.548-2.512q0-.429.053-.843a1.3 1.3 0 0 1-.333-.086l-.166-.004c-.223 0-.426.062-.643.228-.03.024-.142.139-.142.59v3.883a1.255 1.255 0 0 1-1.256 1.256h-1.777a1.255 1.255 0 0 1-1.256-1.256V15.69l-.032.057a4.8 4.8 0 0 1-1.86 1.833 5.04 5.04 0 0 1-2.484.634 4.5 4.5 0 0 1-1.935-.424 1.25 1.25 0 0 1-.764.258h-1.71a1.255 1.255 0 0 1-1.256-1.255V7.687a2.4 2.4 0 0 1-.428.625c.253.23.412.561.412.93v7.553a1.255 1.255 0 0 1-1.256 1.255h-1.843a1.25 1.25 0 0 1-.894-.373c-.228.23-.544.373-.894.373H51.32a1.255 1.255 0 0 1-1.256-1.255v-1.251l-.061.117a4.7 4.7 0 0 1-1.782 1.884 4.77 4.77 0 0 1-2.485.67 5.6 5.6 0 0 1-1.485-.188l.009 2.764a1.255 1.255 0 0 1-1.255 1.259h-1.729a1.255 1.255 0 0 1-1.255-1.255v-3.537a1.255 1.255 0 0 1-1.167.793h-1.679a1.25 1.25 0 0 1-.77-.263 4.5 4.5 0 0 1-1.945.429c-.885 0-1.724-.21-2.495-.632l-.017-.01a5 5 0 0 1-1.081-.836 1.255 1.255 0 0 1-1.254 1.312h-1.81a1.255 1.255 0 0 1-1.228-.99l-.782-3.625-2.044 3.939a1.25 1.25 0 0 1-1.115.676h-.098a1.25 1.25 0 0 1-1.116-.68l-2.061-3.994zM35.92 16.63l.207-.114.223-.15q.493-.356.735-.785l.061-.118.033 1.332h1.678V9.242h-1.694l-.033 1.267q-.133-.329-.526-.658l-.032-.028a3.2 3.2 0 0 0-.668-.428l-.27-.12a3.3 3.3 0 0 0-1.235-.23q-1.136-.001-1.974.493a3.36 3.36 0 0 0-1.3 1.382q-.445.89-.444 2.074 0 1.2.51 2.107a3.8 3.8 0 0 0 1.382 1.381 3.9 3.9 0 0 0 1.893.477q.795 0 1.455-.33zm-2.789-5.38q-.576.675-.575 1.762 0 1.102.559 1.794.576.675 1.645.675a2.25 2.25 0 0 0 .934-.19 2.2 2.2 0 0 0 .468-.29l.178-.161a2.2 2.2 0 0 0 .397-.561q.244-.5.244-1.15v-.115q0-.708-.296-1.267l-.043-.077a2.2 2.2 0 0 0-.633-.709l-.13-.086-.047-.028a2.1 2.1 0 0 0-1.073-.285q-1.052 0-1.629.692zm2.316 2.706c.163-.17.28-.407.28-.83v-.114c0-.292-.06-.508-.15-.68a.96.96 0 0 0-.353-.389.85.85 0 0 0-.464-.127c-.4 0-.56.114-.664.239l-.01.012c-.148.174-.275.45-.275.945 0 .506.122.801.27.99.097.11.266.224.68.224.303 0 .504-.09.687-.269zm7.545 1.705a2.6 2.6 0 0 0 .331.423q.319.33.755.548l.173.074q.65.255 1.49.255 1.02 0 1.844-.493a3.45 3.45 0 0 0 1.316-1.4q.493-.904.493-2.089 0-1.909-.988-2.913-.988-1.02-2.584-1.02-.898 0-1.575.347a3 3 0 0 0-.415.262l-.199.166a3.4 3.4 0 0 0-.64.82V9.242h-1.712v11.553h1.729l-.017-5.134zm.53-1.138q.206.29.48.5l.155.11.053.034q.51.296 1.119.297 1.07 0 1.645-.675.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.435 0-.835.16a2 2 0 0 0-.284.136 2 2 0 0 0-.363.254 2.2 2.2 0 0 0-.46.569l-.082.162a2.6 2.6 0 0 0-.213 1.072v.115q0 .707.296 1.267l.135.211zm.964-.818a1.1 1.1 0 0 0 .367.385.94.94 0 0 0 .476.118c.423 0 .59-.117.687-.23.159-.194.28-.478.28-.95 0-.53-.133-.8-.266-.952l-.021-.025c-.078-.094-.231-.221-.68-.221a1 1 0 0 0-.503.135l-.012.007a.86.86 0 0 0-.335.343c-.073.133-.132.324-.132.614v.115a1.4 1.4 0 0 0 .14.66zm15.7-6.222q.347-.346.346-.856a1.05 1.05 0 0 0-.345-.79 1.18 1.18 0 0 0-.84-.329q-.51 0-.855.33a1.05 1.05 0 0 0-.346.79q0 .51.346.855.345.346.856.346.51 0 .839-.346zm4.337 9.314.033-1.332q.191.403.59.747l.098.081a4 4 0 0 0 .316.224l.223.122a3.2 3.2 0 0 0 1.44.322 3.8 3.8 0 0 0 1.875-.477 3.5 3.5 0 0 0 1.382-1.366q.527-.89.526-2.09 0-1.184-.444-2.073a3.24 3.24 0 0 0-1.283-1.399q-.823-.51-1.942-.51a3.5 3.5 0 0 0-1.527.344l-.086.043-.165.09a3 3 0 0 0-.33.214q-.432.315-.656.707a2 2 0 0 0-.099.198l.082-1.283V4.701h-1.744v12.095zm.473-2.509a2.5 2.5 0 0 0 .566.7q.117.098.245.18l.144.08a2.1 2.1 0 0 0 .975.232q1.07 0 1.645-.675.576-.69.576-1.778 0-1.102-.576-1.777-.56-.691-1.645-.692a2.2 2.2 0 0 0-1.015.235q-.22.113-.415.282l-.15.142a2.1 2.1 0 0 0-.42.594q-.223.479-.223 1.1v.115q0 .705.293 1.26zm2.616-.293c.157-.191.28-.479.28-.967 0-.51-.13-.79-.276-.961l-.021-.026c-.082-.1-.232-.225-.67-.225a.87.87 0 0 0-.681.279l-.012.011c-.154.155-.274.38-.274.807v.115c0 .285.057.499.144.669a1.1 1.1 0 0 0 .367.405c.137.082.28.123.455.123.423 0 .59-.118.686-.23zm8.266-3.013q.345-.13.724-.14l.069-.002q.493 0 .642.099l.247-1.794q-.196-.099-.717-.099a2.3 2.3 0 0 0-.545.063 2 2 0 0 0-.411.148 2.2 2.2 0 0 0-.4.249 2.5 2.5 0 0 0-.485.499 2.7 2.7 0 0 0-.32.581l-.05.137v-1.48h-1.778v7.553h1.777v-3.884q0-.546.159-.943a1.5 1.5 0 0 1 .466-.636 2.5 2.5 0 0 1 .399-.253 2 2 0 0 1 .224-.099zm9.784 2.656.05-.922q0-1.743-.856-2.698-.838-.97-2.584-.97-1.119-.001-2.007.493a3.46 3.46 0 0 0-1.4 1.382q-.493.906-.493 2.106 0 1.07.428 1.975.428.89 1.332 1.432.906.526 2.255.526.973 0 1.668-.185l.044-.012.135-.04q.613-.184.984-.421l-.542-1.267q-.3.162-.642.274l-.297.087q-.51.131-1.3.131-.954 0-1.497-.444a1.6 1.6 0 0 1-.192-.193q-.366-.44-.512-1.234l-.004-.021zm-5.427-1.256-.003.022h3.752v-.138q-.011-.727-.288-1.118a1 1 0 0 0-.156-.176q-.46-.428-1.316-.428-.986 0-1.494.604-.379.45-.494 1.234zm-27.053 2.77V4.7h-1.86v12.095h5.333V15.15zm7.103-5.908v7.553h-1.843V9.242h1.843z%27/%3E%3Cpath fill=%27%23fff%27 d=%27m19.63 11.151-.757-1.71-.345 1.71-1.12 5.644h-1.827L18.083 4.7h.197l3.325 6.533.988 2.19.988-2.19L26.839 4.7h.181l2.6 12.095h-1.81l-1.218-5.644-.362-1.71-.658 1.71-2.93 5.644h-.098l-2.913-5.644zm14.836 5.81q-1.02 0-1.893-.478a3.8 3.8 0 0 1-1.381-1.382q-.51-.906-.51-2.106 0-1.185.444-2.074a3.36 3.36 0 0 1 1.3-1.382q.839-.494 1.974-.494a3.3 3.3 0 0 1 1.234.231 3.3 3.3 0 0 1 .97.575q.396.33.527.659l.033-1.267h1.694v7.553H37.18l-.033-1.332q-.279.593-1.02 1.053a3.17 3.17 0 0 1-1.662.444zm.296-1.482q.938 0 1.58-.642.642-.66.642-1.711v-.115q0-.708-.296-1.267a2.2 2.2 0 0 0-.807-.872 2.1 2.1 0 0 0-1.119-.313q-1.053 0-1.629.692-.575.675-.575 1.76 0 1.103.559 1.795.577.675 1.645.675zm6.521-6.237h1.711v1.4q.906-1.597 2.83-1.597 1.596 0 2.584 1.02.988 1.005.988 2.914 0 1.185-.493 2.09a3.46 3.46 0 0 1-1.316 1.399 3.5 3.5 0 0 1-1.844.493q-.954 0-1.662-.329a2.67 2.67 0 0 1-1.086-.97l.017 5.134h-1.728zm4.048 6.22q1.07 0 1.645-.674.577-.69.576-1.762 0-1.119-.576-1.777-.558-.675-1.645-.675-.592 0-1.12.296-.51.28-.822.823-.296.527-.296 1.234v.115q0 .708.296 1.267.313.543.823.855.51.296 1.119.297z%27/%3E%3Cpath fill=%27%23e1e3e9%27 d=%27M51.325 4.7h1.86v10.45h3.473v1.646h-5.333zm7.12 4.542h1.843v7.553h-1.843zm.905-1.415a1.16 1.16 0 0 1-.856-.346 1.17 1.17 0 0 1-.346-.856 1.05 1.05 0 0 1 .346-.79q.346-.329.856-.329.494 0 .839.33a1.05 1.05 0 0 1 .345.79 1.16 1.16 0 0 1-.345.855q-.33.346-.84.346zm7.875 9.133a3.17 3.17 0 0 1-1.662-.444q-.723-.46-1.004-1.053l-.033 1.332h-1.71V4.701h1.743v4.657l-.082 1.283q.279-.658 1.086-1.119a3.5 3.5 0 0 1 1.778-.477q1.119 0 1.942.51a3.24 3.24 0 0 1 1.283 1.4q.445.888.444 2.072 0 1.201-.526 2.09a3.5 3.5 0 0 1-1.382 1.366 3.8 3.8 0 0 1-1.876.477zm-.296-1.481q1.069 0 1.645-.675.577-.69.577-1.778 0-1.102-.577-1.776-.56-.691-1.645-.692a2.12 2.12 0 0 0-1.58.659q-.642.641-.642 1.694v.115q0 .71.296 1.267a2.4 2.4 0 0 0 .807.872 2.1 2.1 0 0 0 1.119.313zm5.927-6.237h1.777v1.481q.263-.757.856-1.217a2.14 2.14 0 0 1 1.349-.46q.527 0 .724.098l-.247 1.794q-.149-.099-.642-.099-.774 0-1.416.494-.626.493-.626 1.58v3.883h-1.777V9.242zm9.534 7.718q-1.35 0-2.255-.526-.904-.543-1.332-1.432a4.6 4.6 0 0 1-.428-1.975q0-1.2.493-2.106a3.46 3.46 0 0 1 1.4-1.382q.889-.495 2.007-.494 1.744 0 2.584.97.855.956.856 2.7 0 .444-.05.92h-5.43q.18 1.005.708 1.45.542.443 1.497.443.79 0 1.3-.131a4 4 0 0 0 .938-.362l.542 1.267q-.411.263-1.119.46-.708.198-1.711.197zm1.596-4.558q.016-1.02-.444-1.432-.46-.428-1.316-.428-1.728 0-1.991 1.86z%27/%3E%3Cpath d=%27M5.074 15.948a.484.657 0 0 0-.486.659v1.84a.484.657 0 0 0 .486.659h4.101a.484.657 0 0 0 .486-.659v-1.84a.484.657 0 0 0-.486-.659zm3.56 1.16H5.617v.838h3.017z%27 style=%27fill:%23fff;fill-rule:evenodd;stroke-width:1.03600001%27/%3E%3Cg style=%27stroke-width:1.12603545%27%3E%3Cpath d=%27M-9.408-1.416c-3.833-.025-7.056 2.912-7.08 6.615-.02 3.08 1.653 4.832 3.107 6.268.903.892 1.721 1.74 2.32 2.902l-.525-.004c-.543-.003-.992.304-1.24.639a1.87 1.87 0 0 0-.362 1.121l-.011 1.877c-.003.402.104.787.347 1.125.244.338.688.653 1.23.656l4.142.028c.542.003.99-.306 1.238-.641a1.87 1.87 0 0 0 .363-1.121l.012-1.875a1.87 1.87 0 0 0-.348-1.127c-.243-.338-.688-.653-1.23-.656l-.518-.004c.597-1.145 1.425-1.983 2.348-2.87 1.473-1.414 3.18-3.149 3.2-6.226-.016-3.59-2.923-6.684-6.993-6.707m-.006 1.1v.002c3.274.02 5.92 2.532 5.9 5.6-.017 2.706-1.39 4.026-2.863 5.44-1.034.994-2.118 2.033-2.814 3.633-.018.041-.052.055-.075.065q-.013.004-.02.01a.34.34 0 0 1-.226.084.34.34 0 0 1-.224-.086l-.092-.077c-.699-1.615-1.768-2.669-2.781-3.67-1.454-1.435-2.797-2.762-2.78-5.478.02-3.067 2.7-5.545 5.975-5.523m-.02 2.826c-1.62-.01-2.944 1.315-2.955 2.96-.01 1.646 1.295 2.988 2.916 2.999h.002c1.621.01 2.943-1.316 2.953-2.961.011-1.646-1.294-2.988-2.916-2.998m-.005 1.1c1.017.006 1.829.83 1.822 1.89s-.83 1.874-1.848 1.867c-1.018-.006-1.829-.83-1.822-1.89s.83-1.874 1.848-1.868m-2.155 11.857 4.14.025c.271.002.49.305.487.676l-.013 1.875c-.003.37-.224.67-.495.668l-4.14-.025c-.27-.002-.487-.306-.485-.676l.012-1.875c.003-.37.224-.67.494-.668%27 style=%27color:%23000;font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:%23000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;text-orientation:mixed;dominant-baseline:auto;baseline-shift:baseline;text-anchor:start;white-space:normal;shape-padding:0;clip-rule:evenodd;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:%23000;solid-opacity:1;vector-effect:none;fill:%23000;fill-opacity:.4;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-9.415-.316C-12.69-.338-15.37 2.14-15.39 5.207c-.017 2.716 1.326 4.041 2.78 5.477 1.013 1 2.081 2.055 2.78 3.67l.092.076a.34.34 0 0 0 .225.086.34.34 0 0 0 .227-.083l.019-.01c.022-.009.057-.024.074-.064.697-1.6 1.78-2.64 2.814-3.634 1.473-1.414 2.847-2.733 2.864-5.44.02-3.067-2.627-5.58-5.901-5.601m-.057 8.784c1.621.011 2.944-1.315 2.955-2.96.01-1.646-1.295-2.988-2.916-2.999-1.622-.01-2.945 1.315-2.955 2.96s1.295 2.989 2.916 3%27 style=%27clip-rule:evenodd;fill:%23e1e3e9;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3Cpath d=%27M-11.594 15.465c-.27-.002-.492.297-.494.668l-.012 1.876c-.003.371.214.673.485.675l4.14.027c.271.002.492-.298.495-.668l.012-1.877c.003-.37-.215-.672-.485-.674z%27 style=%27clip-rule:evenodd;fill:%23fff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:2.47727823;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:.4%27 transform=%27translate%2815.553 2.85%29scale%28.88807%29%27/%3E%3C/g%3E%3C/svg%3E"},6443:function(t){t.exports=function(){"use strict";var t={},e={};function n(n,i,r){if(e[n]=r,"index"===n){var a="var sharedModule = {}; ("+e.shared+")(sharedModule); ("+e.worker+")(sharedModule);",o={};return e.shared(o),e.index(t,o),"undefined"!=typeof window&&t.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),t}}return n("shared",0,(function(t){function e(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(t){a(t)}}function s(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))}function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}"function"==typeof SuppressedError&&SuppressedError;var i=r;function r(t,e){this.x=t,this.y=e}r.prototype={clone:function(){return new r(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=i,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-i*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},r.convert=function(t){return t instanceof r?t:Array.isArray(t)?new r(t[0],t[1]):t};var a=n(i),o=s;function s(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var r=this.sampleCurveX(n)-t;if(Math.abs(r)<e)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var o=0,s=1;for(n=t,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-t)<e));i++)t>r?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var l=n(o);let c,u;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function d(){if(null==u&&(u=!1,h())){const t=5,e=new OffscreenCanvas(t,t).getContext("2d",{willReadFrequently:!0});if(e){for(let n=0;n<t*t;n++){const i=4*n;e.fillStyle=`rgb(${i},${i+1},${i+2})`,e.fillRect(n%t,Math.floor(n/t),1,1)}const n=e.getImageData(0,0,t,t).data;for(let e=0;e<t*t*4;e++)if(e%4!=3&&n[e]!==e){u=!0;break}}}return u||!1}function p(t,e,n,i){const r=new l(t,e,n,i);return t=>r.solve(t)}const m=p(.25,.1,.25,1);function f(t,e,n){return Math.min(n,Math.max(e,t))}function g(t,e,n){const i=n-e,r=((t-e)%i+i)%i+e;return r===e?n:r}function v(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}let y=1;function _(t,e,n){const i={};for(const n in t)i[n]=e.call(this,t[n],n,t);return i}function x(t,e,n){const i={};for(const n in t)e.call(this,t[n],n,t)&&(i[n]=t[n]);return i}function b(t){return Array.isArray(t)?t.map(b):"object"==typeof t&&t?_(t,b):t}const A={};function w(t){A[t]||("undefined"!=typeof console&&console.warn(t),A[t]=!0)}function C(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function E(t){return"undefined"!=typeof WorkerGlobalScope&&void 0!==t&&t instanceof WorkerGlobalScope}let S=null;function M(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap}const T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function I(t,n,i,r,a){return e(this,void 0,void 0,(function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const e=new VideoFrame(t,{timestamp:0});try{const o=null==e?void 0:e.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error(`Unrecognized format ${o}`);const s=o.startsWith("BGR"),l=new Uint8ClampedArray(r*a*4);if(yield e.copyTo(l,function(t,e,n,i,r){const a=4*Math.max(-e,0),o=(Math.max(0,n)-n)*i*4+a,s=4*i,l=Math.max(0,e),c=Math.max(0,n);return{rect:{x:l,y:c,width:Math.min(t.width,e+i)-l,height:Math.min(t.height,n+r)-c},layout:[{offset:o,stride:s}]}}(t,n,i,r,a)),s)for(let t=0;t<l.length;t+=4){const e=l[t];l[t]=l[t+2],l[t+2]=e}return l}finally{e.close()}}))}let B,L;const D="AbortError";function P(){return new Error(D)}const R={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function k(t){return R.REGISTERED_PROTOCOLS[t.substring(0,t.indexOf("://"))]}const z="global-dispatcher";class F extends Error{constructor(t,e,n,i){super(`AJAXError: ${e} (${t}): ${n}`),this.status=t,this.statusText=e,this.url=n,this.body=i}}const O=()=>E(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,N=function(t,n){if(/:\/\//.test(t.url)&&!/^https?:|^file:/.test(t.url)){const e=k(t.url);if(e)return e(t,n);if(E(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,targetMapId:z},n)}if(!(/^file:/.test(i=t.url)||/^file:/.test(O())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(t,n){return e(this,void 0,void 0,(function*(){const e=new Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,cache:t.cache,referrer:O(),signal:n.signal});"json"!==t.type||e.headers.has("Accept")||e.headers.set("Accept","application/json");const i=yield fetch(e);if(!i.ok){const e=yield i.blob();throw new F(i.status,i.statusText,t.url,e)}let r;r="arrayBuffer"===t.type||"image"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text();const a=yield r;if(n.signal.aborted)throw P();return{data:a,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}}))}(t,n);if(E(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:t,mustQueue:!0,targetMapId:z},n)}var i;return function(t,e){return new Promise(((n,i)=>{var r;const a=new XMLHttpRequest;a.open(t.method||"GET",t.url,!0),"arrayBuffer"!==t.type&&"image"!==t.type||(a.responseType="arraybuffer");for(const e in t.headers)a.setRequestHeader(e,t.headers[e]);"json"===t.type&&(a.responseType="text",(null===(r=t.headers)||void 0===r?void 0:r.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===t.credentials,a.onerror=()=>{i(new Error(a.statusText))},a.onload=()=>{if(!e.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let e=a.response;if("json"===t.type)try{e=JSON.parse(a.response)}catch(t){return void i(t)}n({data:e,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const e=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});i(new F(a.status,a.statusText,t.url,e))}},e.signal.addEventListener("abort",(()=>{a.abort(),i(P())})),a.send(t.body)}))}(t,n)};function U(t){if(!t||t.indexOf("://")<=0||0===t.indexOf("data:image/")||0===t.indexOf("blob:"))return!0;const e=new URL(t),n=window.location;return e.protocol===n.protocol&&e.host===n.host}function V(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function G(t,e,n){if(n&&n[t]){const i=n[t].indexOf(e);-1!==i&&n[t].splice(i,1)}}class H{constructor(t,e={}){v(this,e),this.type=t}}class j extends H{constructor(t,e={}){super("error",v({error:t},e))}}class W{on(t,e){return this._listeners=this._listeners||{},V(t,e,this._listeners),this}off(t,e){return G(t,e,this._listeners),G(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},V(t,e,this._oneTimeListeners),this):new Promise((e=>this.once(t,e)))}fire(t,e){"string"==typeof t&&(t=new H(t,e||{}));const n=t.type;if(this.listens(n)){t.target=this;const e=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of e)n.call(this,t);const i=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const e of i)G(n,e,this._oneTimeListeners),e.call(this,t);const r=this._eventedParent;r&&(v(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof j&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var q={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Z=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $(t,e){const n={};for(const e in t)"ref"!==e&&(n[e]=t[e]);return Z.forEach((t=>{t in e&&(n[t]=e[t])})),n}function Y(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Y(t[n],e[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!Y(t[n],e[n]))return!1;return!0}return t===e}function X(t,e){t.push(e)}function Q(t,e,n){X(n,{command:"addSource",args:[t,e[t]]})}function J(t,e,n){X(e,{command:"removeSource",args:[t]}),n[t]=!0}function K(t,e,n,i){J(t,n,i),Q(t,e,n)}function tt(t,e,n){let i;for(i in t[n])if(Object.prototype.hasOwnProperty.call(t[n],i)&&"data"!==i&&!Y(t[n][i],e[n][i]))return!1;for(i in e[n])if(Object.prototype.hasOwnProperty.call(e[n],i)&&"data"!==i&&!Y(t[n][i],e[n][i]))return!1;return!0}function et(t,e,n,i,r,a){t=t||{},e=e||{};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(Y(t[o],e[o])||n.push({command:a,args:[i,o,e[o],r]}));for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&!Object.prototype.hasOwnProperty.call(t,o)&&(Y(t[o],e[o])||n.push({command:a,args:[i,o,e[o],r]}))}function nt(t){return t.id}function it(t,e){return t[e.id]=e,t}class rt{constructor(t,e,n,i){this.message=(t?`${t}: `:"")+n,i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}}function at(t,...e){for(const n of e)for(const e in n)t[e]=n[e];return t}class ot extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class st{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,n]of e)this.bindings[t]=n}concat(t){return new st(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const lt={kind:"null"},ct={kind:"number"},ut={kind:"string"},ht={kind:"boolean"},dt={kind:"color"},pt={kind:"object"},mt={kind:"value"},ft={kind:"collator"},gt={kind:"formatted"},vt={kind:"padding"},yt={kind:"resolvedImage"},_t={kind:"variableAnchorOffsetCollection"};function xt(t,e){return{kind:"array",itemType:t,N:e}}function bt(t){if("array"===t.kind){const e=bt(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const At=[lt,ct,ut,ht,dt,gt,pt,xt(mt),vt,yt,_t];function wt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!wt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of At)if(!wt(t,e))return null}return`Expected ${bt(t)} but found ${bt(e)} instead.`}function Ct(t,e){return e.some((e=>e.kind===t.kind))}function Et(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}function St(t,e){return"array"===t.kind&&"array"===e.kind?t.itemType.kind===e.itemType.kind&&"number"==typeof t.N:t.kind===e.kind}const Mt=.96422,Tt=.82521,It=4/29,Bt=6/29,Lt=3*Bt*Bt,Dt=Bt*Bt*Bt,Pt=Math.PI/180,Rt=180/Math.PI;function kt(t){return(t%=360)<0&&(t+=360),t}function zt([t,e,n,i]){let r,a;const o=Ot((.2225045*(t=Ft(t))+.7168786*(e=Ft(e))+.0606169*(n=Ft(n)))/1);t===e&&e===n?r=a=o:(r=Ot((.4360747*t+.3850649*e+.1430804*n)/Mt),a=Ot((.0139322*t+.0971045*e+.7141733*n)/Tt));const s=116*o-16;return[s<0?0:s,500*(r-o),200*(o-a),i]}function Ft(t){return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ot(t){return t>Dt?Math.pow(t,1/3):t/Lt+It}function Nt([t,e,n,i]){let r=(t+16)/116,a=isNaN(e)?r:r+e/500,o=isNaN(n)?r:r-n/200;return r=1*Vt(r),a=Mt*Vt(a),o=Tt*Vt(o),[Ut(3.1338561*a-1.6168667*r-.4906146*o),Ut(-.9787684*a+1.9161415*r+.033454*o),Ut(.0719453*a-.2289914*r+1.4052427*o),i]}function Ut(t){return(t=t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055)<0?0:t>1?1:t}function Vt(t){return t>Bt?t*t*t:Lt*(t-It)}function Gt(t){return parseInt(t.padEnd(2,t),16)/255}function Ht(t,e){return jt(e?t/100:t,0,1)}function jt(t,e,n){return Math.min(Math.max(e,t),n)}function Wt(t){return!t.some(Number.isNaN)}const qt={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Zt{constructor(t,e,n,i=1,r=!0){this.r=t,this.g=e,this.b=n,this.a=i,r||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[t,e,n,i]))}static parse(t){if(t instanceof Zt)return t;if("string"!=typeof t)return;const e=function(t){if("transparent"===(t=t.toLowerCase().trim()))return[0,0,0,0];const e=qt[t];if(e){const[t,n,i]=e;return[t/255,n/255,i/255,1]}if(t.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(t)){const e=t.length<6?1:2;let n=1;return[Gt(t.slice(n,n+=e)),Gt(t.slice(n,n+=e)),Gt(t.slice(n,n+=e)),Gt(t.slice(n,n+e)||"ff")]}if(t.startsWith("rgb")){const e=t.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(e){const[t,n,i,r,a,o,s,l,c,u,h,d]=e,p=[r||" ",s||" ",u].join("");if("  "===p||"  /"===p||",,"===p||",,,"===p){const t=[i,o,c].join(""),e="%%%"===t?100:""===t?255:0;if(e){const t=[jt(+n/e,0,1),jt(+a/e,0,1),jt(+l/e,0,1),h?Ht(+h,d):1];if(Wt(t))return t}}return}}const n=t.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(n){const[t,e,i,r,a,o,s,l,c]=n,u=[i||" ",a||" ",s].join("");if("  "===u||"  /"===u||",,"===u||",,,"===u){const t=[+e,jt(+r,0,100),jt(+o,0,100),l?Ht(+l,c):1];if(Wt(t))return function([t,e,n,i]){function r(i){const r=(i+t/30)%12,a=e*Math.min(n,1-n);return n-a*Math.max(-1,Math.min(r-3,9-r,1))}return t=kt(t),e/=100,n/=100,[r(0),r(8),r(4),i]}(t)}}}(t);return e?new Zt(...e,!1):void 0}get rgb(){const{r:t,g:e,b:n,a:i}=this,r=i||1/0;return this.overwriteGetter("rgb",[t/r,e/r,n/r,i])}get hcl(){return this.overwriteGetter("hcl",function(t){const[e,n,i,r]=zt(t),a=Math.sqrt(n*n+i*i);return[Math.round(1e4*a)?kt(Math.atan2(i,n)*Rt):NaN,a,e,r]}(this.rgb))}get lab(){return this.overwriteGetter("lab",zt(this.rgb))}overwriteGetter(t,e){return Object.defineProperty(this,t,{value:e}),e}toString(){const[t,e,n,i]=this.rgb;return`rgba(${[t,e,n].map((t=>Math.round(255*t))).join(",")},${i})`}}Zt.black=new Zt(0,0,0,1),Zt.white=new Zt(1,1,1,1),Zt.transparent=new Zt(0,0,0,0),Zt.red=new Zt(1,0,0,1);class $t{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yt{constructor(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}}class Xt{constructor(t){this.sections=t}static fromString(t){return new Xt([new Yt(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof Xt?t:Xt.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}}class Qt{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Qt)return t;if("number"==typeof t)return new Qt([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const e of t)if("number"!=typeof e)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Qt(t)}}toString(){return JSON.stringify(this.values)}}const Jt=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Kt{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Kt)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let e=0;e<t.length;e+=2){const n=t[e],i=t[e+1];if("string"!=typeof n||!Jt.has(n))return;if(!Array.isArray(i)||2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])return}return new Kt(t)}}toString(){return JSON.stringify(this.values)}}class te{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new te({name:t,available:!1}):null}}function ee(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ne(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Zt||t instanceof $t||t instanceof Xt||t instanceof Qt||t instanceof Kt||t instanceof te)return!0;if(Array.isArray(t)){for(const e of t)if(!ne(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ne(t[e]))return!1;return!0}return!1}function ie(t){if(null===t)return lt;if("string"==typeof t)return ut;if("boolean"==typeof t)return ht;if("number"==typeof t)return ct;if(t instanceof Zt)return dt;if(t instanceof $t)return ft;if(t instanceof Xt)return gt;if(t instanceof Qt)return vt;if(t instanceof Kt)return _t;if(t instanceof te)return yt;if(Array.isArray(t)){const e=t.length;let n;for(const e of t){const t=ie(e);if(n){if(n===t)continue;n=mt;break}n=t}return xt(n||mt,e)}return pt}function re(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Zt||t instanceof Xt||t instanceof Qt||t instanceof Kt||t instanceof te?t.toString():JSON.stringify(t)}class ae{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ne(t[1]))return e.error("invalid value");const n=t[1];let i=ie(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new ae(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class oe{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const se={string:ut,number:ct,boolean:ht,object:pt};class le{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,a;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in se)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=se[n],i++}else r=mt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);a=t[2],i++}n=xt(r,a)}else{if(!se[r])throw new Error(`Types doesn't contain name = ${r}`);n=se[r]}const a=[];for(;i<t.length;i++){const n=e.parse(t[i],i,mt);if(!n)return null;a.push(n)}return new le(n,a)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!wt(this.type,ie(n)))return n;if(e===this.args.length-1)throw new oe(`Expected value to be of type ${bt(this.type)}, but found ${bt(ie(n))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const ce={"to-boolean":ht,"to-color":dt,"to-number":ct,"to-string":ut};class ue{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(!ce[n])throw new Error(`Can't parse ${n} as it is not part of the known types`);if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=ce[n],r=[];for(let n=1;n<t.length;n++){const i=e.parse(t[n],n,mt);if(!i)return null;r.push(i)}return new ue(i,r)}evaluate(t){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(t));case"color":{let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof Zt)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:ee(e[0],e[1],e[2],e[3]),!n))return new Zt(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new oe(n||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"padding":{let e;for(const n of this.args){e=n.evaluate(t);const i=Qt.parse(e);if(i)return i}throw new oe(`Could not parse padding from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"variableAnchorOffsetCollection":{let e;for(const n of this.args){e=n.evaluate(t);const i=Kt.parse(e);if(i)return i}throw new oe(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof e?e:JSON.stringify(e)}'`)}case"number":{let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new oe(`Could not convert ${JSON.stringify(e)} to number.`)}case"formatted":return Xt.fromString(re(this.args[0].evaluate(t)));case"resolvedImage":return te.fromString(re(this.args[0].evaluate(t)));default:return re(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const he=["Unknown","Point","LineString","Polygon"];class de{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?he[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Zt.parse(t)),e}}class pe{constructor(t,e,n=[],i,r=new st,a=[]){this.registry=t,this.path=n,this.key=n.map((t=>`[${t}]`)).join(""),this.scope=r,this.errors=a,this.expectedType=i,this._isConstant=e}parse(t,e,n,i,r={}){return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new le(e,[t]):"coerce"===n?new ue(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind)if("padding"!==t.kind||"value"!==r.kind&&"number"!==r.kind&&"array"!==r.kind)if("variableAnchorOffsetCollection"!==t.kind||"value"!==r.kind&&"array"!==r.kind){if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof ae)&&"resolvedImage"!==i.type.kind&&this._isConstant(i)){const e=new de;try{i=new ae(i.type,i.evaluate(e))}catch(t){return this.error(t.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new pe(this.registry,this._isConstant,i,e||null,r,this.errors)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new ot(n,t))}checkSubtype(t,e){const n=wt(t,e);return n&&this.error(n),n}}class me{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let i=1;i<t.length-1;i+=2){const r=t[i];if("string"!=typeof r)return e.error(`Expected string, but found ${typeof r} instead.`,i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);const a=e.parse(t[i+1],i+1);if(!a)return null;n.push([r,a])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new me(n,i):null}outputDefined(){return this.result.outputDefined()}}class fe{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new fe(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ge{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,ct),i=e.parse(t[2],2,xt(e.expectedType||mt));return n&&i?new ge(i.type.itemType,n,i):null}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new oe(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new oe(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new oe(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class ve{constructor(t,e){this.type=ht,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,mt),i=e.parse(t[2],2,mt);return n&&i?Ct(n.type,[ht,ut,ct,lt,mt])?new ve(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${bt(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Et(e,["boolean","string","number","null"]))throw new oe(`Expected first argument to be of type boolean, string, number or null, but found ${bt(ie(e))} instead.`);if(!Et(n,["string","array"]))throw new oe(`Expected second argument to be of type array or string, but found ${bt(ie(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ye{constructor(t,e,n){this.type=ct,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,mt),i=e.parse(t[2],2,mt);if(!n||!i)return null;if(!Ct(n.type,[ht,ut,ct,lt,mt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${bt(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,ct);return r?new ye(n,i,r):null}return new ye(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Et(e,["boolean","string","number","null"]))throw new oe(`Expected first argument to be of type boolean, string, number or null, but found ${bt(ie(e))} instead.`);if(!Et(n,["string","array"]))throw new oe(`Expected second argument to be of type array or string, but found ${bt(ie(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class _e{constructor(t,e,n,i,r,a){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=a}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},a=[];for(let o=2;o<t.length-1;o+=2){let s=t[o];const l=t[o+1];Array.isArray(s)||(s=[s]);const c=e.concat(o);if(0===s.length)return c.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return c.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,ie(t)))return null}else n=ie(t);if(void 0!==r[String(t)])return c.error("Branch labels must be unique.");r[String(t)]=a.length}const u=e.parse(l,o,i);if(!u)return null;i=i||u.type,a.push(u)}const o=e.parse(t[1],1,mt);if(!o)return null;const s=e.parse(t[t.length-1],t.length-1,i);return s?"value"!==o.type.kind&&e.concat(1).checkSubtype(n,o.type)?null:new _e(n,i,o,r,a,s):null}evaluate(t){const e=this.input.evaluate(t);return(ie(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class xe{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let r=1;r<t.length-1;r+=2){const a=e.parse(t[r],r,ht);if(!a)return null;const o=e.parse(t[r+1],r+1,n);if(!o)return null;i.push([a,o]),n=n||o.type}const r=e.parse(t[t.length-1],t.length-1,n);if(!r)return null;if(!n)throw new Error("Can't infer output type");return new xe(n,i,r)}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}}class be{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,mt),i=e.parse(t[2],2,ct);if(!n||!i)return null;if(!Ct(n.type,[xt(mt),ut,mt]))return e.error(`Expected first argument to be of type array or string, but found ${bt(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,ct);return r?new be(n.type,n,i,r):null}return new be(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Et(e,["string","array"]))throw new oe(`Expected first argument to be of type array or string, but found ${bt(ie(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ae(t,e){const n=t.length-1;let i,r,a=0,o=n,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),i=t[s],r=t[s+1],i<=e){if(s===n||e<r)return s;a=s+1}else{if(!(i>e))throw new oe("Input is not a number.");o=s-1}return 0}class we{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,ct);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let n=1;n<t.length;n+=2){const a=1===n?-1/0:t[n],o=t[n+1],s=n,l=n+1;if("number"!=typeof a)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(i.length&&i[i.length-1][0]>=a)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=e.parse(o,l,r);if(!c)return null;r=r||c.type,i.push([a,c])}return new we(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[Ae(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}var Ce=Ee;function Ee(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=i}Ee.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,i=0;i<8;i++){var r=this.sampleCurveX(n)-t;if(Math.abs(r)<e)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=r/a}var o=0,s=1;for(n=t,i=0;i<20&&(r=this.sampleCurveX(n),!(Math.abs(r-t)<e));i++)t>r?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Se=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(Ce);function Me(t,e,n){return t+n*(e-t)}function Te(t,e,n){return t.map(((t,i)=>Me(t,e[i],n)))}const Ie={number:Me,color:function(t,e,n,i="rgb"){switch(i){case"rgb":{const[i,r,a,o]=Te(t.rgb,e.rgb,n);return new Zt(i,r,a,o,!1)}case"hcl":{const[i,r,a,o]=t.hcl,[s,l,c,u]=e.hcl;let h,d;if(isNaN(i)||isNaN(s))isNaN(i)?isNaN(s)?h=NaN:(h=s,1!==a&&0!==a||(d=l)):(h=i,1!==c&&0!==c||(d=r));else{let t=s-i;s>i&&t>180?t-=360:s<i&&i-s>180&&(t+=360),h=i+n*t}const[p,m,f,g]=function([t,e,n,i]){return t=isNaN(t)?0:t*Pt,Nt([n,Math.cos(t)*e,Math.sin(t)*e,i])}([h,null!=d?d:Me(r,l,n),Me(a,c,n),Me(o,u,n)]);return new Zt(p,m,f,g,!1)}case"lab":{const[i,r,a,o]=Nt(Te(t.lab,e.lab,n));return new Zt(i,r,a,o,!1)}}},array:Te,padding:function(t,e,n){return new Qt(Te(t.values,e.values,n))},variableAnchorOffsetCollection:function(t,e,n){const i=t.values,r=e.values;if(i.length!==r.length)throw new oe(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${e.toString()}`);const a=[];for(let t=0;t<i.length;t+=2){if(i[t]!==r[t])throw new oe(`Cannot interpolate values containing mismatched anchors. from[${t}]: ${i[t]}, to[${t}]: ${r[t]}`);a.push(i[t]);const[e,o]=i[t+1],[s,l]=r[t+1];a.push([Me(e,s,n),Me(o,l,n)])}return new Kt(a)}};class Be{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,n,i){let r=0;if("exponential"===t.name)r=Le(e,t.base,n,i);else if("linear"===t.name)r=Le(e,1,n,i);else if("cubic-bezier"===t.name){const a=t.controlPoints;r=new Se(a[0],a[1],a[2],a[3]).solve(Le(e,1,n,i))}return r}static parse(t,e){let[n,i,r,...a]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,ct),!r)return null;const o=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=dt:e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let t=0;t<a.length;t+=2){const n=a[t],i=a[t+1],r=t+3,l=t+4;if("number"!=typeof n)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(o.length&&o[o.length-1][0]>=n)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const c=e.parse(i,l,s);if(!c)return null;s=s||c.type,o.push([n,c])}return St(s,ct)||St(s,dt)||St(s,vt)||St(s,_t)||St(s,xt(ct))?new Be(s,n,i,r,o):e.error(`Type ${bt(s)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const a=Ae(e,i),o=Be.interpolationFactor(this.interpolation,i,e[a],e[a+1]),s=n[a].evaluate(t),l=n[a+1].evaluate(t);switch(this.operator){case"interpolate":return Ie[this.type.kind](s,l,o);case"interpolate-hcl":return Ie.color(s,l,o,"hcl");case"interpolate-lab":return Ie.color(s,l,o,"lab")}}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Le(t,e,n,i){const r=i-n,a=t-n;return 0===r?0:1===e?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}class De{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const i of t.slice(1)){const t=e.parse(i,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}if(!n)throw new Error("No output type");const a=i&&r.some((t=>wt(i,t.type)));return new De(a?mt:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args)if(i++,n=r.evaluate(t),n&&n instanceof te&&!n.available&&(e||(e=n.name),n=null,i===this.args.length&&(n=e)),null!==n)break;return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function Pe(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Re(t,e,n,i){return 0===i.compare(e,n)}function ke(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=ht,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let a=e.parse(t[1],1,mt);if(!a)return null;if(!Pe(n,a.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${bt(a.type)}'.`);let o=e.parse(t[2],2,mt);if(!o)return null;if(!Pe(n,o.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${bt(o.type)}'.`);if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${bt(a.type)}' and '${bt(o.type)}'.`);i&&("value"===a.type.kind&&"value"!==o.type.kind?a=new le(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new le(a.type,[o])));let s=null;if(4===t.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(s=e.parse(t[3],3,ft),!s)return null}return new r(a,o,s)}evaluate(r){const a=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=ie(a),n=ie(o);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new oe(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=ie(a),n=ie(o);if("string"!==t.kind||"string"!==n.kind)return e(r,a,o)}return this.collator?n(r,a,o,this.collator.evaluate(r)):e(r,a,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}}}const ze=ke("==",(function(t,e,n){return e===n}),Re),Fe=ke("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!Re(0,e,n,i)})),Oe=ke("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),Ne=ke(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),Ue=ke("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),Ve=ke(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0}));class Ge{constructor(t,e,n){this.type=ft,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,ht);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,ht);if(!r)return null;let a=null;return n.locale&&(a=e.parse(n.locale,1,ut),!a)?null:new Ge(i,r,a)}evaluate(t){return new $t(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class He{constructor(t,e,n,i,r){this.type=ut,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ct);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,ut),!r))return null;let a=null;if(i.currency&&(a=e.parse(i.currency,1,ut),!a))return null;let o=null;if(i["min-fraction-digits"]&&(o=e.parse(i["min-fraction-digits"],1,ct),!o))return null;let s=null;return i["max-fraction-digits"]&&(s=e.parse(i["max-fraction-digits"],1,ct),!s)?null:new He(n,r,a,o,s)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class je{constructor(t){this.type=gt,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let n=1;n<=t.length-1;++n){const a=t[n];if(r&&"object"==typeof a&&!Array.isArray(a)){r=!1;let t=null;if(a["font-scale"]&&(t=e.parse(a["font-scale"],1,ct),!t))return null;let n=null;if(a["text-font"]&&(n=e.parse(a["text-font"],1,xt(ut)),!n))return null;let o=null;if(a["text-color"]&&(o=e.parse(a["text-color"],1,dt),!o))return null;const s=i[i.length-1];s.scale=t,s.font=n,s.textColor=o}else{const a=e.parse(t[n],1,mt);if(!a)return null;const o=a.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:a,scale:null,font:null,textColor:null})}}return new je(i)}evaluate(t){return new Xt(this.sections.map((e=>{const n=e.content.evaluate(t);return ie(n)===yt?new Yt("",n,null,null,null):new Yt(re(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}}class We{constructor(t){this.type=yt,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,ut);return n?new We(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=te.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}}class qe{constructor(t){this.type=ct,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${bt(n.type)} instead.`):new qe(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new oe(`Expected value to be of type string or array, but found ${bt(ie(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ze=8192;function $e(t,e){const n=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(n*r*Ze),Math.round(i*r*Ze)]}function Ye(t,e){const n=Math.pow(2,e.z);return[(r=(t[0]/Ze+e.x)/n,360*r-180),(i=(t[1]/Ze+e.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,r}function Xe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Qe(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Je(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],a=t[0]-n[0],o=t[1]-n[1];return i*o-a*r==0&&i*a<=0&&r*o<=0}function Ke(t,e,n,i){return 0!=(r=[i[0]-n[0],i[1]-n[1]])[0]*(a=[e[0]-t[0],e[1]-t[1]])[1]-r[1]*a[0]&&!(!on(t,e,n,i)||!on(n,i,t,e));var r,a}function tn(t,e,n){for(const i of n)for(let n=0;n<i.length-1;++n)if(Ke(t,e,i[n],i[n+1]))return!0;return!1}function en(t,e,n=!1){let i=!1;for(const s of e)for(let e=0;e<s.length-1;e++){if(Je(t,s[e],s[e+1]))return n;(a=s[e])[1]>(r=t)[1]!=(o=s[e+1])[1]>r[1]&&r[0]<(o[0]-a[0])*(r[1]-a[1])/(o[1]-a[1])+a[0]&&(i=!i)}var r,a,o;return i}function nn(t,e){for(const n of e)if(en(t,n))return!0;return!1}function rn(t,e){for(const n of t)if(!en(n,e))return!1;for(let n=0;n<t.length-1;++n)if(tn(t[n],t[n+1],e))return!1;return!0}function an(t,e){for(const n of e)if(rn(t,n))return!0;return!1}function on(t,e,n,i){const r=i[0]-n[0],a=i[1]-n[1],o=(t[0]-n[0])*a-r*(t[1]-n[1]),s=(e[0]-n[0])*a-r*(e[1]-n[1]);return o>0&&s<0||o<0&&s>0}function sn(t,e,n){const i=[];for(let r=0;r<t.length;r++){const a=[];for(let i=0;i<t[r].length;i++){const o=$e(t[r][i],n);Xe(e,o),a.push(o)}i.push(a)}return i}function ln(t,e,n){const i=[];for(let r=0;r<t.length;r++){const a=sn(t[r],e,n);i.push(a)}return i}function cn(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}Xe(e,t)}function un(t,e,n,i){const r=Math.pow(2,i.z)*Ze,a=[i.x*Ze,i.y*Ze],o=[];for(const i of t)for(const t of i){const i=[t.x+a[0],t.y+a[1]];cn(i,e,n,r),o.push(i)}return o}function hn(t,e,n,i){const r=Math.pow(2,i.z)*Ze,a=[i.x*Ze,i.y*Ze],o=[];for(const n of t){const t=[];for(const i of n){const n=[i.x+a[0],i.y+a[1]];Xe(e,n),t.push(n)}o.push(t)}if(e[2]-e[0]<=r/2){(s=e)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const t of o)for(const i of t)cn(i,e,n,r)}var s;return o}class dn{constructor(t,e){this.type=ht,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ne(t[1])){const e=t[1];if("FeatureCollection"===e.type){const t=[];for(const n of e.features){const{type:e,coordinates:i}=n.geometry;"Polygon"===e&&t.push(i),"MultiPolygon"===e&&t.push(...i)}if(t.length)return new dn(e,{type:"MultiPolygon",coordinates:t})}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new dn(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new dn(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const a=sn(e.coordinates,i,r),o=un(t.geometry(),n,i,r);if(!Qe(n,i))return!1;for(const t of o)if(!en(t,a))return!1}if("MultiPolygon"===e.type){const a=ln(e.coordinates,i,r),o=un(t.geometry(),n,i,r);if(!Qe(n,i))return!1;for(const t of o)if(!nn(t,a))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const a=sn(e.coordinates,i,r),o=hn(t.geometry(),n,i,r);if(!Qe(n,i))return!1;for(const t of o)if(!rn(t,a))return!1}if("MultiPolygon"===e.type){const a=ln(e.coordinates,i,r),o=hn(t.geometry(),n,i,r);if(!Qe(n,i))return!1;for(const t of o)if(!an(t,a))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let pn=class{constructor(t=[],e=mn){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,a=e[r];if(n(i,a)>=0)break;e[t]=a,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),a=e[i];const o=i+1;if(o<this.length&&n(e[o],a)<0&&(i=o,a=e[o]),n(a,r)>=0)break;e[t]=a,t=i}e[t]=r}};function mn(t,e){return t<e?-1:t>e?1:0}function fn(t,e,n,i,r){gn(t,e,n,i||t.length-1,r||yn)}function gn(t,e,n,i,r){for(;i>n;){if(i-n>600){var a=i-n+1,o=e-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);gn(t,e,Math.max(n,Math.floor(e-o*l/a+c)),Math.min(i,Math.floor(e+(a-o)*l/a+c)),r)}var u=t[e],h=n,d=i;for(vn(t,n,e),r(t[i],u)>0&&vn(t,n,i);h<d;){for(vn(t,h,d),h++,d--;r(t[h],u)<0;)h++;for(;r(t[d],u)>0;)d--}0===r(t[n],u)?vn(t,n,d):vn(t,++d,i),d<=e&&(n=d+1),e<=d&&(i=d-1)}}function vn(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function yn(t,e){return t<e?-1:t>e?1:0}function _n(t,e){if(t.length<=1)return[t];const n=[];let i,r;for(const e of t){const t=bn(e);0!==t&&(e.area=Math.abs(t),void 0===r&&(r=t<0),r===t<0?(i&&n.push(i),i=[e]):i.push(e))}if(i&&n.push(i),e>1)for(let t=0;t<n.length;t++)n[t].length<=e||(fn(n[t],e,1,n[t].length-1,xn),n[t]=n[t].slice(0,e));return n}function xn(t,e){return e.area-t.area}function bn(t){let e=0;for(let n,i,r=0,a=t.length,o=a-1;r<a;o=r++)n=t[r],i=t[o],e+=(i.x-n.x)*(n.y+i.y);return e}const An=1/298.257223563,wn=An*(2-An),Cn=Math.PI/180;class En{constructor(t){const e=6378.137*Cn*1e3,n=Math.cos(t*Cn),i=1/(1-wn*(1-n*n)),r=Math.sqrt(i);this.kx=e*r*n,this.ky=e*r*i*(1-wn)}distance(t,e){const n=this.wrap(t[0]-e[0])*this.kx,i=(t[1]-e[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(t,e){let n,i,r,a,o=1/0;for(let s=0;s<t.length-1;s++){let l=t[s][0],c=t[s][1],u=this.wrap(t[s+1][0]-l)*this.kx,h=(t[s+1][1]-c)*this.ky,d=0;0===u&&0===h||(d=(this.wrap(e[0]-l)*this.kx*u+(e[1]-c)*this.ky*h)/(u*u+h*h),d>1?(l=t[s+1][0],c=t[s+1][1]):d>0&&(l+=u/this.kx*d,c+=h/this.ky*d)),u=this.wrap(e[0]-l)*this.kx,h=(e[1]-c)*this.ky;const p=u*u+h*h;p<o&&(o=p,n=l,i=c,r=s,a=d)}return{point:[n,i],index:r,t:Math.max(0,Math.min(1,a))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Sn(t,e){return e[0]-t[0]}function Mn(t){return t[1]-t[0]+1}function Tn(t,e){return t[1]>=t[0]&&t[1]<e}function In(t,e){if(t[0]>t[1])return[null,null];const n=Mn(t);if(e){if(2===n)return[t,null];const e=Math.floor(n/2);return[[t[0],t[0]+e],[t[0]+e,t[1]]]}if(1===n)return[t,null];const i=Math.floor(n/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}function Bn(t,e){if(!Tn(e,t.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let i=e[0];i<=e[1];++i)Xe(n,t[i]);return n}function Ln(t){const e=[1/0,1/0,-1/0,-1/0];for(const n of t)for(const t of n)Xe(e,t);return e}function Dn(t){return t[0]!==-1/0&&t[1]!==-1/0&&t[2]!==1/0&&t[3]!==1/0}function Pn(t,e,n){if(!Dn(t)||!Dn(e))return NaN;let i=0,r=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(r=t[1]-e[3]),t[3]<e[1]&&(r=e[1]-t[3]),n.distance([0,0],[i,r])}function Rn(t,e,n){const i=n.pointOnLine(e,t);return n.distance(t,i.point)}function kn(t,e,n,i,r){const a=Math.min(Rn(t,[n,i],r),Rn(e,[n,i],r)),o=Math.min(Rn(n,[t,e],r),Rn(i,[t,e],r));return Math.min(a,o)}function zn(t,e,n,i,r){if(!Tn(e,t.length)||!Tn(i,n.length))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){const e=t[o],s=t[o+1];for(let t=i[0];t<i[1];++t){const i=n[t],o=n[t+1];if(Ke(e,s,i,o))return 0;a=Math.min(a,kn(e,s,i,o,r))}}return a}function Fn(t,e,n,i,r){if(!Tn(e,t.length)||!Tn(i,n.length))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let e=i[0];e<=i[1];++e)if(a=Math.min(a,r.distance(t[o],n[e])),0===a)return a;return a}function On(t,e,n){if(en(t,e,!0))return 0;let i=1/0;for(const r of e){const e=r[0],a=r[r.length-1];if(e!==a&&(i=Math.min(i,Rn(t,[a,e],n)),0===i))return i;const o=n.pointOnLine(r,t);if(i=Math.min(i,n.distance(t,o.point)),0===i)return i}return i}function Nn(t,e,n,i){if(!Tn(e,t.length))return NaN;for(let i=e[0];i<=e[1];++i)if(en(t[i],n,!0))return 0;let r=1/0;for(let a=e[0];a<e[1];++a){const e=t[a],o=t[a+1];for(const t of n)for(let n=0,a=t.length,s=a-1;n<a;s=n++){const a=t[s],l=t[n];if(Ke(e,o,a,l))return 0;r=Math.min(r,kn(e,o,a,l,i))}}return r}function Un(t,e){for(const n of t)for(const t of n)if(en(t,e,!0))return!0;return!1}function Vn(t,e,n,i=1/0){const r=Ln(t),a=Ln(e);if(i!==1/0&&Pn(r,a,n)>=i)return i;if(Qe(r,a)){if(Un(t,e))return 0}else if(Un(e,t))return 0;let o=1/0;for(const i of t)for(let t=0,r=i.length,a=r-1;t<r;a=t++){const r=i[a],s=i[t];for(const t of e)for(let e=0,i=t.length,a=i-1;e<i;a=e++){const i=t[a],l=t[e];if(Ke(r,s,i,l))return 0;o=Math.min(o,kn(r,s,i,l,n))}}return o}function Gn(t,e,n,i,r,a){if(!a)return;const o=Pn(Bn(i,a),r,n);o<e&&t.push([o,a,[0,0]])}function Hn(t,e,n,i,r,a,o){if(!a||!o)return;const s=Pn(Bn(i,a),Bn(r,o),n);s<e&&t.push([s,a,o])}function jn(t,e,n,i,r=1/0){let a=Math.min(i.distance(t[0],n[0][0]),r);if(0===a)return a;const o=new pn([[0,[0,t.length-1],[0,0]]],Sn),s=Ln(n);for(;o.length>0;){const r=o.pop();if(r[0]>=a)continue;const l=r[1],c=e?50:100;if(Mn(l)<=c){if(!Tn(l,t.length))return NaN;if(e){const e=Nn(t,l,n,i);if(isNaN(e)||0===e)return e;a=Math.min(a,e)}else for(let e=l[0];e<=l[1];++e){const r=On(t[e],n,i);if(a=Math.min(a,r),0===a)return 0}}else{const n=In(l,e);Gn(o,a,i,t,s,n[0]),Gn(o,a,i,t,s,n[1])}}return a}function Wn(t,e,n,i,r,a=1/0){let o=Math.min(a,r.distance(t[0],n[0]));if(0===o)return o;const s=new pn([[0,[0,t.length-1],[0,n.length-1]]],Sn);for(;s.length>0;){const a=s.pop();if(a[0]>=o)continue;const l=a[1],c=a[2],u=e?50:100,h=i?50:100;if(Mn(l)<=u&&Mn(c)<=h){if(!Tn(l,t.length)&&Tn(c,n.length))return NaN;let a;if(e&&i)a=zn(t,l,n,c,r),o=Math.min(o,a);else if(e&&!i){const e=t.slice(l[0],l[1]+1);for(let t=c[0];t<=c[1];++t)if(a=Rn(n[t],e,r),o=Math.min(o,a),0===o)return o}else if(!e&&i){const e=n.slice(c[0],c[1]+1);for(let n=l[0];n<=l[1];++n)if(a=Rn(t[n],e,r),o=Math.min(o,a),0===o)return o}else a=Fn(t,l,n,c,r),o=Math.min(o,a)}else{const a=In(l,e),u=In(c,i);Hn(s,o,r,t,n,a[0],u[0]),Hn(s,o,r,t,n,a[0],u[1]),Hn(s,o,r,t,n,a[1],u[0]),Hn(s,o,r,t,n,a[1],u[1])}}return o}function qn(t){return"MultiPolygon"===t.type?t.coordinates.map((t=>({type:"Polygon",coordinates:t}))):"MultiLineString"===t.type?t.coordinates.map((t=>({type:"LineString",coordinates:t}))):"MultiPoint"===t.type?t.coordinates.map((t=>({type:"Point",coordinates:t}))):[t]}class Zn{constructor(t,e){this.type=ct,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ne(t[1])){const e=t[1];if("FeatureCollection"===e.type)return new Zn(e,e.features.map((t=>qn(t.geometry))).flat());if("Feature"===e.type)return new Zn(e,qn(e.geometry));if("type"in e&&"coordinates"in e)return new Zn(e,qn(e))}return e.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=t.geometry(),i=n.flat().map((e=>Ye([e.x,e.y],t.canonical)));if(0===n.length)return NaN;const r=new En(i[0][1]);let a=1/0;for(const t of e){switch(t.type){case"Point":a=Math.min(a,Wn(i,!1,[t.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,Wn(i,!1,t.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,jn(i,!1,t.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=t.geometry(),i=n.flat().map((e=>Ye([e.x,e.y],t.canonical)));if(0===n.length)return NaN;const r=new En(i[0][1]);let a=1/0;for(const t of e){switch(t.type){case"Point":a=Math.min(a,Wn(i,!0,[t.coordinates],!1,r,a));break;case"LineString":a=Math.min(a,Wn(i,!0,t.coordinates,!0,r,a));break;case"Polygon":a=Math.min(a,jn(i,!0,t.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries);if("Polygon"===t.geometryType())return function(t,e){const n=t.geometry();if(0===n.length||0===n[0].length)return NaN;const i=_n(n,0).map((e=>e.map((e=>e.map((e=>Ye([e.x,e.y],t.canonical))))))),r=new En(i[0][0][0][1]);let a=1/0;for(const t of e)for(const e of i){switch(t.type){case"Point":a=Math.min(a,jn([t.coordinates],!1,e,r,a));break;case"LineString":a=Math.min(a,jn(t.coordinates,!0,e,r,a));break;case"Polygon":a=Math.min(a,Vn(e,t.coordinates,r,a))}if(0===a)return a}return a}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const $n={"==":ze,"!=":Fe,">":Ne,"<":Oe,">=":Ve,"<=":Ue,array:le,at:ge,boolean:le,case:xe,coalesce:De,collator:Ge,format:je,image:We,in:ve,"index-of":ye,interpolate:Be,"interpolate-hcl":Be,"interpolate-lab":Be,length:qe,let:me,literal:ae,match:_e,number:le,"number-format":He,object:le,slice:be,step:we,string:le,"to-boolean":ue,"to-color":ue,"to-number":ue,"to-string":ue,var:fe,within:dn,distance:Zn};class Yn{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,e){const n=t[0],i=Yn.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=a.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let s=null;for(const[i,a]of o){s=new pe(e.registry,ti,e.path,null,e.scope);const o=[];let l=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(i)?i[e-1]:i.type,a=s.parse(n,1+o.length,r);if(!a){l=!0;break}o.push(a)}if(!l)if(Array.isArray(i)&&i.length!==o.length)s.error(`Expected ${i.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(i)?i[t]:i.type,n=o[t];s.concat(t+1).checkSubtype(e,n.type)}if(0===s.errors.length)return new Yn(n,r,a,o)}}if(1===o.length)e.errors.push(...s.errors);else{const n=(o.length?o:a).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(bt).join(", ")})`:`(${bt(e.type)}...)`;var e})).join(" | "),i=[];for(let n=1;n<t.length;n++){const r=e.parse(t[n],1+i.length);if(!r)return null;i.push(bt(r.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){Yn.definitions=e;for(const n in e)t[n]=Yn}}function Xn(t,[e,n,i,r]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const a=r?r.evaluate(t):1,o=ee(e,n,i,a);if(o)throw new oe(o);return new Zt(e/255,n/255,i/255,a,!1)}function Qn(t,e){return t in e}function Jn(t,e){const n=e[t];return void 0===n?null:n}function Kn(t){return{type:t}}function ti(t){if(t instanceof fe)return ti(t.boundExpression);if(t instanceof Yn&&"error"===t.name)return!1;if(t instanceof Ge)return!1;if(t instanceof dn)return!1;if(t instanceof Zn)return!1;const e=t instanceof ue||t instanceof le;let n=!0;return t.eachChild((t=>{n=e?n&&ti(t):n&&t instanceof ae})),!!n&&ei(t)&&ii(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ei(t){if(t instanceof Yn){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof dn)return!1;if(t instanceof Zn)return!1;let e=!0;return t.eachChild((t=>{e&&!ei(t)&&(e=!1)})),e}function ni(t){if(t instanceof Yn&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild((t=>{e&&!ni(t)&&(e=!1)})),e}function ii(t,e){if(t instanceof Yn&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!ii(t,e)&&(n=!1)})),n}function ri(t){return{result:"success",value:t}}function ai(t){return{result:"error",value:t}}function oi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function si(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function li(t){return!!t.expression&&t.expression.interpolated}function ci(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function ui(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function hi(t){return t}function di(t,e){const n="color"===e.type,i=t.stops&&"object"==typeof t.stops[0][0],r=i||!(i||void 0!==t.property),a=t.type||(li(e)?"exponential":"interval");if(n||"padding"===e.type){const i=n?Zt.parse:Qt.parse;(t=at({},t)).stops&&(t.stops=t.stops.map((t=>[t[0],i(t[1])]))),t.default=i(t.default?t.default:e.default)}if(t.colorSpace&&"rgb"!==(o=t.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error(`Unknown color space: "${t.colorSpace}"`);var o;let s,l,c;if("exponential"===a)s=gi;else if("interval"===a)s=fi;else if("categorical"===a){s=mi,l=Object.create(null);for(const e of t.stops)l[e[0]]=e[1];c=typeof t.stops[0][0]}else{if("identity"!==a)throw new Error(`Unknown function type "${a}"`);s=vi}if(i){const n={},i=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],a=r[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:t.type,property:t.property,default:t.default,stops:[]},i.push(a)),n[a].stops.push([r[0].value,r[1]])}const r=[];for(const t of i)r.push([n[t].zoom,di(n[t],e)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:Be.interpolationFactor.bind(void 0,a),zoomStops:r.map((t=>t[0])),evaluate:({zoom:n},i)=>gi({stops:r,base:t.base},e,n).evaluate(n,i)}}if(r){const n="exponential"===a?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:Be.interpolationFactor.bind(void 0,n),zoomStops:t.stops.map((t=>t[0])),evaluate:({zoom:n})=>s(t,e,n,l,c)}}return{kind:"source",evaluate(n,i){const r=i&&i.properties?i.properties[t.property]:void 0;return void 0===r?pi(t.default,e.default):s(t,e,r,l,c)}}}function pi(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function mi(t,e,n,i,r){return pi(typeof n===r?i[n]:void 0,t.default,e.default)}function fi(t,e,n){if("number"!==ci(n))return pi(t.default,e.default);const i=t.stops.length;if(1===i)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[i-1][0])return t.stops[i-1][1];const r=Ae(t.stops.map((t=>t[0])),n);return t.stops[r][1]}function gi(t,e,n){const i=void 0!==t.base?t.base:1;if("number"!==ci(n))return pi(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[r-1][0])return t.stops[r-1][1];const a=Ae(t.stops.map((t=>t[0])),n),o=function(t,e,n,i){const r=i-n,a=t-n;return 0===r?0:1===e?a/r:(Math.pow(e,a)-1)/(Math.pow(e,r)-1)}(n,i,t.stops[a][0],t.stops[a+1][0]),s=t.stops[a][1],l=t.stops[a+1][1],c=Ie[e.type]||hi;return"function"==typeof s.evaluate?{evaluate(...e){const n=s.evaluate.apply(void 0,e),i=l.evaluate.apply(void 0,e);if(void 0!==n&&void 0!==i)return c(n,i,o,t.colorSpace)}}:c(s,l,o,t.colorSpace)}function vi(t,e,n){switch(e.type){case"color":n=Zt.parse(n);break;case"formatted":n=Xt.fromString(n.toString());break;case"resolvedImage":n=te.fromString(n.toString());break;case"padding":n=Qt.parse(n);break;default:ci(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0)}return pi(n,t.default,e.default)}Yn.register($n,{error:[{kind:"error"},[ut],(t,[e])=>{throw new oe(e.evaluate(t))}],typeof:[ut,[mt],(t,[e])=>bt(ie(e.evaluate(t)))],"to-rgba":[xt(ct,4),[dt],(t,[e])=>{const[n,i,r,a]=e.evaluate(t).rgb;return[255*n,255*i,255*r,a]}],rgb:[dt,[ct,ct,ct],Xn],rgba:[dt,[ct,ct,ct,ct],Xn],has:{type:ht,overloads:[[[ut],(t,[e])=>Qn(e.evaluate(t),t.properties())],[[ut,pt],(t,[e,n])=>Qn(e.evaluate(t),n.evaluate(t))]]},get:{type:mt,overloads:[[[ut],(t,[e])=>Jn(e.evaluate(t),t.properties())],[[ut,pt],(t,[e,n])=>Jn(e.evaluate(t),n.evaluate(t))]]},"feature-state":[mt,[ut],(t,[e])=>Jn(e.evaluate(t),t.featureState||{})],properties:[pt,[],t=>t.properties()],"geometry-type":[ut,[],t=>t.geometryType()],id:[mt,[],t=>t.id()],zoom:[ct,[],t=>t.globals.zoom],"heatmap-density":[ct,[],t=>t.globals.heatmapDensity||0],"line-progress":[ct,[],t=>t.globals.lineProgress||0],accumulated:[mt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ct,Kn(ct),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[ct,Kn(ct),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:ct,overloads:[[[ct,ct],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[ct],(t,[e])=>-e.evaluate(t)]]},"/":[ct,[ct,ct],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[ct,[ct,ct],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[ct,[ct],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))],log2:[ct,[ct],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[ct,[ct],(t,[e])=>Math.sin(e.evaluate(t))],cos:[ct,[ct],(t,[e])=>Math.cos(e.evaluate(t))],tan:[ct,[ct],(t,[e])=>Math.tan(e.evaluate(t))],asin:[ct,[ct],(t,[e])=>Math.asin(e.evaluate(t))],acos:[ct,[ct],(t,[e])=>Math.acos(e.evaluate(t))],atan:[ct,[ct],(t,[e])=>Math.atan(e.evaluate(t))],min:[ct,Kn(ct),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[ct,Kn(ct),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[ct,[ct],(t,[e])=>Math.abs(e.evaluate(t))],round:[ct,[ct],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[ct,[ct],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[ct,[ct],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[ht,[ut,mt],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[ht,[mt],(t,[e])=>t.id()===e.value],"filter-type-==":[ht,[ut],(t,[e])=>t.geometryType()===e.value],"filter-<":[ht,[ut,mt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[ht,[mt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[ht,[ut,mt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[ht,[mt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[ht,[ut,mt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[ht,[mt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[ht,[ut,mt],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[ht,[mt],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[ht,[mt],(t,[e])=>e.value in t.properties()],"filter-has-id":[ht,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[ht,[xt(ut)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[ht,[xt(mt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[ht,[ut,xt(mt)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[ht,[ut,xt(mt)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[Kn(ht),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[Kn(ht),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[ht,[ht],(t,[e])=>!e.evaluate(t)],"is-supported-script":[ht,[ut],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[ut,[ut],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[ut,[ut],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[ut,Kn(mt),(t,e)=>e.map((e=>re(e.evaluate(t)))).join("")],"resolved-locale":[ut,[ft],(t,[e])=>e.evaluate(t).resolvedLocale()]});class yi{constructor(t,e){var n;this.expression=t,this._warningHistory={},this._evaluator=new de,this._defaultValue=e?"color"===(n=e).type&&ui(n.default)?new Zt(0,0,0,0):"color"===n.type?Zt.parse(n.default)||null:"padding"===n.type?Qt.parse(n.default)||null:"variableAnchorOffsetCollection"===n.type?Kt.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,e,n,i,r,a){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=a||null;try{const t=this.expression.evaluate(this._evaluator);if(null==t||"number"==typeof t&&t!=t)return this._defaultValue;if(this._enumValues&&!(t in this._enumValues))throw new oe(`Expected value to be one of ${Object.keys(this._enumValues).map((t=>JSON.stringify(t))).join(", ")}, but found ${JSON.stringify(t)} instead.`);return t}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}}function _i(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in $n}function xi(t,e){const n=new pe($n,ti,[],e?function(t){const e={color:dt,string:ut,number:ct,enum:ut,boolean:ht,formatted:gt,padding:vt,resolvedImage:yt,variableAnchorOffsetCollection:_t};return"array"===t.type?xt(e[t.value]||mt,t.length):e[t.type]}(e):void 0),i=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return i?ri(new yi(i,e)):ai(n.errors)}class bi{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!ni(e.expression)}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,a)}evaluate(t,e,n,i,r,a){return this._styleExpression.evaluate(t,e,n,i,r,a)}}class Ai{constructor(t,e,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=e,this.isStateDependent="camera"!==t&&!ni(e.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,e,n,i,r,a){return this._styleExpression.evaluateWithoutErrorHandling(t,e,n,i,r,a)}evaluate(t,e,n,i,r,a){return this._styleExpression.evaluate(t,e,n,i,r,a)}interpolationFactor(t,e,n){return this.interpolationType?Be.interpolationFactor(this.interpolationType,t,e,n):0}}function wi(t,e){const n=xi(t,e);if("error"===n.result)return n;const i=n.value.expression,r=ei(i);if(!r&&!oi(e))return ai([new ot("","data expressions not supported")]);const a=ii(i,["zoom"]);if(!a&&!si(e))return ai([new ot("","zoom expressions not supported")]);const o=Ei(i);return o||a?o instanceof ot?ai([o]):o instanceof Be&&!li(e)?ai([new ot("",'"interpolate" expressions cannot be used with this property')]):ri(o?new Ai(r?"camera":"composite",n.value,o.labels,o instanceof Be?o.interpolation:void 0):new bi(r?"constant":"source",n.value)):ai([new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Ci{constructor(t,e){this._parameters=t,this._specification=e,at(this,di(this._parameters,this._specification))}static deserialize(t){return new Ci(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ei(t){let e=null;if(t instanceof me)e=Ei(t.result);else if(t instanceof De){for(const n of t.args)if(e=Ei(n),e)break}else(t instanceof we||t instanceof Be)&&t.input instanceof Yn&&"zoom"===t.input.name&&(e=t);return e instanceof ot||t.eachChild((t=>{const n=Ei(t);n instanceof ot?e=n:!e&&n?e=new ot("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&n&&e!==n&&(e=new ot("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Si(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Si(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Mi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ti(t){if(null==t)return{filter:()=>!0,needGeometry:!1};Si(t)||(t=Li(t));const e=xi(t,Mi);if("error"===e.result)throw new Error(e.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return{filter:(t,n,i)=>e.value.evaluate(t,n,{},i),needGeometry:Bi(t)}}function Ii(t,e){return t<e?-1:t>e?1:0}function Bi(t){if(!Array.isArray(t))return!1;if("within"===t[0]||"distance"===t[0])return!0;for(let e=1;e<t.length;e++)if(Bi(t[e]))return!0;return!1}function Li(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Di(t[1],t[2],"=="):"!="===e?ki(Di(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Di(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Li))):"all"===e?["all"].concat(t.slice(1).map(Li)):"none"===e?["all"].concat(t.slice(1).map(Li).map(ki)):"in"===e?Pi(t[1],t.slice(2)):"!in"===e?ki(Pi(t[1],t.slice(2))):"has"===e?Ri(t[1]):"!has"!==e||ki(Ri(t[1]));var n}function Di(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Pi(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((t=>typeof t!=typeof e[0]))?["filter-in-large",t,["literal",e.sort(Ii)]]:["filter-in-small",t,["literal",e]]}}function Ri(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function ki(t){return["!",t]}function zi(t){const e=typeof t;if("number"===e||"boolean"===e||"string"===e||null==t)return JSON.stringify(t);if(Array.isArray(t)){let e="[";for(const n of t)e+=`${zi(n)},`;return`${e}]`}const n=Object.keys(t).sort();let i="{";for(let e=0;e<n.length;e++)i+=`${JSON.stringify(n[e])}:${zi(t[n[e]])},`;return`${i}}`}function Fi(t){let e="";for(const n of Z)e+=`/${zi(t[n])}`;return e}function Oi(t){const e=t.value;return e?[new rt(t.key,e,"constants have been deprecated as of v8")]:[]}function Ni(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ui(t){if(Array.isArray(t))return t.map(Ui);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Ui(t[n]);return e}return Ni(t)}function Vi(t){const e=t.key,n=t.value,i=t.valueSpec||{},r=t.objectElementValidators||{},a=t.style,o=t.styleSpec,s=t.validateSpec;let l=[];const c=ci(n);if("object"!==c)return[new rt(e,n,`object expected, ${c} found`)];for(const t in n){const c=t.split(".")[0],u=i[c]||i["*"];let h;if(r[c])h=r[c];else if(i[c])h=s;else if(r["*"])h=r["*"];else{if(!i["*"]){l.push(new rt(e,n[t],`unknown property "${t}"`));continue}h=s}l=l.concat(h({key:(e?`${e}.`:e)+t,value:n[t],valueSpec:u,style:a,styleSpec:o,object:n,objectKey:t,validateSpec:s},n))}for(const t in i)r[t]||i[t].required&&void 0===i[t].default&&void 0===n[t]&&l.push(new rt(e,n,`missing required property "${t}"`));return l}function Gi(t){const e=t.value,n=t.valueSpec,i=t.style,r=t.styleSpec,a=t.key,o=t.arrayElementValidator||t.validateSpec;if("array"!==ci(e))return[new rt(a,e,`array expected, ${ci(e)} found`)];if(n.length&&e.length!==n.length)return[new rt(a,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new rt(a,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let s={type:n.value,values:n.values};r.$version<7&&(s.function=n.function),"object"===ci(n.value)&&(s=n.value);let l=[];for(let n=0;n<e.length;n++)l=l.concat(o({array:e,arrayIndex:n,value:e[n],valueSpec:s,validateSpec:t.validateSpec,style:i,styleSpec:r,key:`${a}[${n}]`}));return l}function Hi(t){const e=t.key,n=t.value,i=t.valueSpec;let r=ci(n);return"number"===r&&n!=n&&(r="NaN"),"number"!==r?[new rt(e,n,`number expected, ${r} found`)]:"minimum"in i&&n<i.minimum?[new rt(e,n,`${n} is less than the minimum value ${i.minimum}`)]:"maximum"in i&&n>i.maximum?[new rt(e,n,`${n} is greater than the maximum value ${i.maximum}`)]:[]}function ji(t){const e=t.valueSpec,n=Ni(t.value.type);let i,r,a,o={};const s="categorical"!==n&&void 0===t.value.property,l=!s,c="array"===ci(t.value.stops)&&"array"===ci(t.value.stops[0])&&"object"===ci(t.value.stops[0][0]),u=Vi({key:t.key,value:t.value,valueSpec:t.styleSpec.function,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===n)return[new rt(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const i=t.value;return e=e.concat(Gi({key:t.key,value:i,valueSpec:t.valueSpec,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===ci(i)&&0===i.length&&e.push(new rt(t.key,i,"array must have at least one stop")),e},default:function(t){return t.validateSpec({key:t.key,value:t.value,valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===n&&s&&u.push(new rt(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||u.push(new rt(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!li(t.valueSpec)&&u.push(new rt(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!oi(t.valueSpec)?u.push(new rt(t.key,t.value,"property functions not supported")):s&&!si(t.valueSpec)&&u.push(new rt(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!c||void 0!==t.value.property||u.push(new rt(t.key,t.value,'"property" property is required')),u;function h(t){let n=[];const i=t.value,s=t.key;if("array"!==ci(i))return[new rt(s,i,`array expected, ${ci(i)} found`)];if(2!==i.length)return[new rt(s,i,`array length 2 expected, length ${i.length} found`)];if(c){if("object"!==ci(i[0]))return[new rt(s,i,`object expected, ${ci(i[0])} found`)];if(void 0===i[0].zoom)return[new rt(s,i,"object stop key must have zoom")];if(void 0===i[0].value)return[new rt(s,i,"object stop key must have value")];if(a&&a>Ni(i[0].zoom))return[new rt(s,i[0].zoom,"stop zoom values must appear in ascending order")];Ni(i[0].zoom)!==a&&(a=Ni(i[0].zoom),r=void 0,o={}),n=n.concat(Vi({key:`${s}[0]`,value:i[0],valueSpec:{zoom:{}},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:Hi,value:d}}))}else n=n.concat(d({key:`${s}[0]`,value:i[0],valueSpec:{},validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec},i));return _i(Ui(i[1]))?n.concat([new rt(`${s}[1]`,i[1],"expressions are not allowed in function stops.")]):n.concat(t.validateSpec({key:`${s}[1]`,value:i[1],valueSpec:e,validateSpec:t.validateSpec,style:t.style,styleSpec:t.styleSpec}))}function d(t,a){const s=ci(t.value),l=Ni(t.value),c=null!==t.value?t.value:a;if(i){if(s!==i)return[new rt(t.key,c,`${s} stop domain type must match previous stop domain type ${i}`)]}else i=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new rt(t.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==n){let i=`number expected, ${s} found`;return oi(e)&&void 0===n&&(i+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new rt(t.key,c,i)]}return"categorical"!==n||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===s&&void 0!==r&&l<r?[new rt(t.key,c,"stop domain values must appear in ascending order")]:(r=l,"categorical"===n&&l in o?[new rt(t.key,c,"stop domain values must be unique")]:(o[l]=!0,[])):[new rt(t.key,c,`integer expected, found ${l}`)]}}function Wi(t){const e=("property"===t.expressionContext?wi:xi)(Ui(t.value),t.valueSpec);if("error"===e.result)return e.value.map((e=>new rt(`${t.key}${e.key}`,t.value,e.message)));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new rt(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!ni(n))return[new rt(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!ni(n))return[new rt(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!ii(n,["zoom","feature-state"]))return[new rt(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!ei(n))return[new rt(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qi(t){const e=t.key,n=t.value,i=t.valueSpec,r=[];return Array.isArray(i.values)?-1===i.values.indexOf(Ni(n))&&r.push(new rt(e,n,`expected one of [${i.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(i.values).indexOf(Ni(n))&&r.push(new rt(e,n,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(n)} found`)),r}function Zi(t){return Si(Ui(t.value))?Wi(at({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):$i(t)}function $i(t){const e=t.value,n=t.key;if("array"!==ci(e))return[new rt(n,e,`array expected, ${ci(e)} found`)];const i=t.styleSpec;let r,a=[];if(e.length<1)return[new rt(n,e,"filter array must have at least 1 element")];switch(a=a.concat(qi({key:`${n}[0]`,value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),Ni(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Ni(e[1])&&a.push(new rt(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&a.push(new rt(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(r=ci(e[1]),"string"!==r&&a.push(new rt(`${n}[1]`,e[1],`string expected, ${r} found`)));for(let o=2;o<e.length;o++)r=ci(e[o]),"$type"===Ni(e[1])?a=a.concat(qi({key:`${n}[${o}]`,value:e[o],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&a.push(new rt(`${n}[${o}]`,e[o],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let i=1;i<e.length;i++)a=a.concat($i({key:`${n}[${i}]`,value:e[i],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=ci(e[1]),2!==e.length?a.push(new rt(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==r&&a.push(new rt(`${n}[1]`,e[1],`string expected, ${r} found`))}return a}function Yi(t,e){const n=t.key,i=t.validateSpec,r=t.style,a=t.styleSpec,o=t.value,s=t.objectKey,l=a[`${e}_${t.layerType}`];if(!l)return[];const c=s.match(/^(.*)-transition$/);if("paint"===e&&c&&l[c[1]]&&l[c[1]].transition)return i({key:n,value:o,valueSpec:a.transition,style:r,styleSpec:a});const u=t.valueSpec||l[s];if(!u)return[new rt(n,o,`unknown property "${s}"`)];let h;if("string"===ci(o)&&oi(u)&&!u.tokens&&(h=/^{([^}]+)}$/.exec(o)))return[new rt(n,o,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(h[1])} }\`.`)];const d=[];return"symbol"===t.layerType&&("text-field"===s&&r&&!r.glyphs&&d.push(new rt(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&ui(Ui(o))&&"identity"===Ni(o.type)&&d.push(new rt(n,o,'"text-font" does not support identity functions'))),d.concat(i({key:t.key,value:o,valueSpec:u,style:r,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}function Xi(t){return Yi(t,"paint")}function Qi(t){return Yi(t,"layout")}function Ji(t){let e=[];const n=t.value,i=t.key,r=t.style,a=t.styleSpec;n.type||n.ref||e.push(new rt(i,n,'either "type" or "ref" is required'));let o=Ni(n.type);const s=Ni(n.ref);if(n.id){const a=Ni(n.id);for(let o=0;o<t.arrayIndex;o++){const t=r.layers[o];Ni(t.id)===a&&e.push(new rt(i,n.id,`duplicate layer id "${n.id}", previously used at line ${t.id.__line__}`))}}if("ref"in n){let t;["type","source","source-layer","filter","layout"].forEach((t=>{t in n&&e.push(new rt(i,n[t],`"${t}" is prohibited for ref layers`))})),r.layers.forEach((e=>{Ni(e.id)===s&&(t=e)})),t?t.ref?e.push(new rt(i,n.ref,"ref cannot reference another ref layer")):o=Ni(t.type):e.push(new rt(i,n.ref,`ref layer "${s}" not found`))}else if("background"!==o)if(n.source){const t=r.sources&&r.sources[n.source],a=t&&Ni(t.type);t?"vector"===a&&"raster"===o?e.push(new rt(i,n.source,`layer "${n.id}" requires a raster source`)):"raster-dem"!==a&&"hillshade"===o?e.push(new rt(i,n.source,`layer "${n.id}" requires a raster-dem source`)):"raster"===a&&"raster"!==o?e.push(new rt(i,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==a||n["source-layer"]?"raster-dem"===a&&"hillshade"!==o?e.push(new rt(i,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!n.paint||!n.paint["line-gradient"]||"geojson"===a&&t.lineMetrics||e.push(new rt(i,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new rt(i,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new rt(i,n.source,`source "${n.source}" not found`))}else e.push(new rt(i,n,'missing required property "source"'));return e=e.concat(Vi({key:i,value:n,valueSpec:a.layer,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":()=>[],type:()=>t.validateSpec({key:`${i}.type`,value:n.type,valueSpec:a.layer.type,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,object:n,objectKey:"type"}),filter:Zi,layout:t=>Vi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Qi(at({layerType:o},t))}}),paint:t=>Vi({layer:n,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,validateSpec:t.validateSpec,objectElementValidators:{"*":t=>Xi(at({layerType:o},t))}})}})),e}function Ki(t){const e=t.value,n=t.key,i=ci(e);return"string"!==i?[new rt(n,e,`string expected, ${i} found`)]:[]}const tr={promoteId:function({key:t,value:e}){if("string"===ci(e))return Ki({key:t,value:e});{const n=[];for(const i in e)n.push(...Ki({key:`${t}.${i}`,value:e[i]}));return n}}};function er(t){const e=t.value,n=t.key,i=t.styleSpec,r=t.style,a=t.validateSpec;if(!e.type)return[new rt(n,e,'"type" is required')];const o=Ni(e.type);let s;switch(o){case"vector":case"raster":return s=Vi({key:n,value:e,valueSpec:i[`source_${o.replace("-","_")}`],style:t.style,styleSpec:i,objectElementValidators:tr,validateSpec:a}),s;case"raster-dem":return s=function(t){var e;const n=null!==(e=t.sourceName)&&void 0!==e?e:"",i=t.value,r=t.styleSpec,a=r.source_raster_dem,o=t.style;let s=[];const l=ci(i);if(void 0===i)return s;if("object"!==l)return s.push(new rt("source_raster_dem",i,`object expected, ${l} found`)),s;const c="custom"===Ni(i.encoding),u=["redFactor","greenFactor","blueFactor","baseShift"],h=t.value.encoding?`"${t.value.encoding}"`:"Default";for(const e in i)!c&&u.includes(e)?s.push(new rt(e,i[e],`In "${n}": "${e}" is only valid when "encoding" is set to "custom". ${h} encoding found`)):a[e]?s=s.concat(t.validateSpec({key:e,value:i[e],valueSpec:a[e],validateSpec:t.validateSpec,style:o,styleSpec:r})):s.push(new rt(e,i[e],`unknown property "${e}"`));return s}({sourceName:n,value:e,style:t.style,styleSpec:i,validateSpec:a}),s;case"geojson":if(s=Vi({key:n,value:e,valueSpec:i.source_geojson,style:r,styleSpec:i,validateSpec:a,objectElementValidators:tr}),e.cluster)for(const t in e.clusterProperties){const[i,r]=e.clusterProperties[t],o="string"==typeof i?[i,["accumulated"],["get",t]]:i;s.push(...Wi({key:`${n}.${t}.map`,value:r,validateSpec:a,expressionContext:"cluster-map"})),s.push(...Wi({key:`${n}.${t}.reduce`,value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return Vi({key:n,value:e,valueSpec:i.source_video,style:r,validateSpec:a,styleSpec:i});case"image":return Vi({key:n,value:e,valueSpec:i.source_image,style:r,validateSpec:a,styleSpec:i});case"canvas":return[new rt(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return qi({key:`${n}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,validateSpec:a,styleSpec:i})}}function nr(t){const e=t.value,n=t.styleSpec,i=n.light,r=t.style;let a=[];const o=ci(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new rt("light",e,`object expected, ${o} found`)]),a;for(const o in e){const s=o.match(/^(.*)-transition$/);a=a.concat(s&&i[s[1]]&&i[s[1]].transition?t.validateSpec({key:o,value:e[o],valueSpec:n.transition,validateSpec:t.validateSpec,style:r,styleSpec:n}):i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],validateSpec:t.validateSpec,style:r,styleSpec:n}):[new rt(o,e[o],`unknown property "${o}"`)])}return a}function ir(t){const e=t.value,n=t.styleSpec,i=n.sky,r=t.style,a=ci(e);if(void 0===e)return[];if("object"!==a)return[new rt("sky",e,`object expected, ${a} found`)];let o=[];for(const a in e)o=o.concat(i[a]?t.validateSpec({key:a,value:e[a],valueSpec:i[a],style:r,styleSpec:n}):[new rt(a,e[a],`unknown property "${a}"`)]);return o}function rr(t){const e=t.value,n=t.styleSpec,i=n.terrain,r=t.style;let a=[];const o=ci(e);if(void 0===e)return a;if("object"!==o)return a=a.concat([new rt("terrain",e,`object expected, ${o} found`)]),a;for(const o in e)a=a.concat(i[o]?t.validateSpec({key:o,value:e[o],valueSpec:i[o],validateSpec:t.validateSpec,style:r,styleSpec:n}):[new rt(o,e[o],`unknown property "${o}"`)]);return a}function ar(t){let e=[];const n=t.value,i=t.key;if(Array.isArray(n)){const r=[],a=[];for(const o in n)n[o].id&&r.includes(n[o].id)&&e.push(new rt(i,n,`all the sprites' ids must be unique, but ${n[o].id} is duplicated`)),r.push(n[o].id),n[o].url&&a.includes(n[o].url)&&e.push(new rt(i,n,`all the sprites' URLs must be unique, but ${n[o].url} is duplicated`)),a.push(n[o].url),e=e.concat(Vi({key:`${i}[${o}]`,value:n[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:t.validateSpec}));return e}return Ki({key:i,value:n})}const or={"*":()=>[],array:Gi,boolean:function(t){const e=t.value,n=t.key,i=ci(e);return"boolean"!==i?[new rt(n,e,`boolean expected, ${i} found`)]:[]},number:Hi,color:function(t){const e=t.key,n=t.value,i=ci(n);return"string"!==i?[new rt(e,n,`color expected, ${i} found`)]:Zt.parse(String(n))?[]:[new rt(e,n,`color expected, "${n}" found`)]},constants:Oi,enum:qi,filter:Zi,function:ji,layer:Ji,object:Vi,source:er,light:nr,sky:ir,terrain:rr,projection:function(t){const e=t.value,n=t.styleSpec,i=n.projection,r=t.style,a=ci(e);if(void 0===e)return[];if("object"!==a)return[new rt("projection",e,`object expected, ${a} found`)];let o=[];for(const a in e)o=o.concat(i[a]?t.validateSpec({key:a,value:e[a],valueSpec:i[a],style:r,styleSpec:n}):[new rt(a,e[a],`unknown property "${a}"`)]);return o},string:Ki,formatted:function(t){return 0===Ki(t).length?[]:Wi(t)},resolvedImage:function(t){return 0===Ki(t).length?[]:Wi(t)},padding:function(t){const e=t.key,n=t.value;if("array"===ci(n)){if(n.length<1||n.length>4)return[new rt(e,n,`padding requires 1 to 4 values; ${n.length} values found`)];const i={type:"number"};let r=[];for(let a=0;a<n.length;a++)r=r.concat(t.validateSpec({key:`${e}[${a}]`,value:n[a],validateSpec:t.validateSpec,valueSpec:i}));return r}return Hi({key:e,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(t){const e=t.key,n=t.value,i=ci(n),r=t.styleSpec;if("array"!==i||n.length<1||n.length%2!=0)return[new rt(e,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let i=0;i<n.length;i+=2)a=a.concat(qi({key:`${e}[${i}]`,value:n[i],valueSpec:r.layout_symbol["text-anchor"]})),a=a.concat(Gi({key:`${e}[${i+1}]`,value:n[i+1],valueSpec:{length:2,value:"number"},validateSpec:t.validateSpec,style:t.style,styleSpec:r}));return a},sprite:ar};function sr(t){const e=t.value,n=t.valueSpec,i=t.styleSpec;return t.validateSpec=sr,n.expression&&ui(Ni(e))?ji(t):n.expression&&_i(Ui(e))?Wi(t):n.type&&or[n.type]?or[n.type](t):Vi(at({},t,{valueSpec:n.type?i[n.type]:n}))}function lr(t){const e=t.value,n=t.key,i=Ki(t);return i.length||(-1===e.indexOf("{fontstack}")&&i.push(new rt(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&i.push(new rt(n,e,'"glyphs" url must include a "{range}" token'))),i}function cr(t,e=q){let n=[];return n=n.concat(sr({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,validateSpec:sr,objectElementValidators:{glyphs:lr,"*":()=>[]}})),t.constants&&(n=n.concat(Oi({key:"constants",value:t.constants,style:t,styleSpec:e,validateSpec:sr}))),hr(n)}function ur(t){return function(e){return t({...e,validateSpec:sr})}}function hr(t){return[].concat(t).sort(((t,e)=>t.line-e.line))}function dr(t){return function(...e){return hr(t.apply(this,e))}}cr.source=dr(ur(er)),cr.sprite=dr(ur(ar)),cr.glyphs=dr(ur(lr)),cr.light=dr(ur(nr)),cr.sky=dr(ur(ir)),cr.terrain=dr(ur(rr)),cr.layer=dr(ur(Ji)),cr.filter=dr(ur(Zi)),cr.paintProperty=dr(ur(Xi)),cr.layoutProperty=dr(ur(Qi));const pr=cr,mr=pr.light,fr=pr.paintProperty,gr=pr.layoutProperty;function vr(t,e){let n=!1;if(e&&e.length)for(const i of e)t.fire(new j(new Error(i.message))),n=!0;return n}class yr{constructor(t,e,n){const i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(n=r[2]);for(let t=0;t<this.d*this.d;t++){const e=r[3+t],n=r[3+t+1];i.push(e===n?null:r.subarray(e,n))}const a=r[3+i.length+1];this.keys=r.subarray(r[3+i.length],a),this.bboxes=r.subarray(a),this.insert=this._insertReadonly}else{this.d=e+2*n;for(let t=0;t<this.d*this.d;t++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;const r=n/e*t;this.min=-r,this.max=t+r}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,e,n,i,r,a){this.cells[r].push(a)}query(t,e,n,i,r){const a=this.min,o=this.max;if(t<=a&&e<=a&&o<=n&&o<=i&&!r)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(t,e,n,i,this._queryCell,a,{},r),a}}_queryCell(t,e,n,i,r,a,o,s){const l=this.cells[r];if(null!==l){const r=this.keys,c=this.bboxes;for(let u=0;u<l.length;u++){const h=l[u];if(void 0===o[h]){const l=4*h;(s?s(c[l+0],c[l+1],c[l+2],c[l+3]):t<=c[l+2]&&e<=c[l+3]&&n>=c[l+0]&&i>=c[l+1])?(o[h]=!0,a.push(r[h])):o[h]=!1}}}}_forEachCell(t,e,n,i,r,a,o,s){const l=this._convertToCellCoord(t),c=this._convertToCellCoord(e),u=this._convertToCellCoord(n),h=this._convertToCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++){const c=this.d*l+d;if((!s||s(this._convertFromCellCoord(d),this._convertFromCellCoord(l),this._convertFromCellCoord(d+1),this._convertFromCellCoord(l+1)))&&r.call(this,t,e,n,i,c,a,o,s))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,e=3+this.cells.length+1+1;let n=0;for(let t=0;t<this.cells.length;t++)n+=this.cells[t].length;const i=new Int32Array(e+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let r=e;for(let e=0;e<t.length;e++){const n=t[e];i[3+e]=r,i.set(n,r),r+=n.length}return i[3+t.length]=r,i.set(this.keys,r),r+=this.keys.length,i[3+t.length+1]=r,i.set(this.bboxes,r),r+=this.bboxes.length,i.buffer}static serialize(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}}static deserialize(t){return new yr(t.buffer)}}const _r={};function xr(t,e,n={}){if(_r[t])throw new Error(`${t} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),_r[t]={klass:e,omit:n.omit||[],shallow:n.shallow||[]}}xr("Object",Object),xr("TransferableGridIndex",yr),xr("Color",Zt),xr("Error",Error),xr("AJAXError",F),xr("ResolvedImage",te),xr("StylePropertyFunction",Ci),xr("StyleExpression",yi,{omit:["_evaluator"]}),xr("ZoomDependentExpression",Ai),xr("ZoomConstantExpression",bi),xr("CompoundExpression",Yn,{omit:["_evaluate"]});for(const t in $n)$n[t]._classRegistryKey||xr(`Expression_${t}`,$n[t]);function br(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Ar(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error)return t;if(br(t))return e&&e.push(t),t;if(M(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const i of t)n.push(Ar(i,e));return n}if("object"==typeof t){const n=t.constructor,i=n._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${n.name}`);if(!_r[i])throw new Error(`${i} is not registered.`);const r=n.serialize?n.serialize(t,e):{};if(n.serialize){if(e&&r===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const n in t){if(!t.hasOwnProperty(n))continue;if(_r[i].omit.indexOf(n)>=0)continue;const a=t[n];r[n]=_r[i].shallow.indexOf(n)>=0?a:Ar(a,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==i&&(r.$name=i),r}throw new Error("can't serialize object of type "+typeof t)}function wr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||t instanceof Blob||t instanceof Error||br(t)||M(t)||ArrayBuffer.isView(t)||t instanceof ImageData)return t;if(Array.isArray(t))return t.map(wr);if("object"==typeof t){const e=t.$name||"Object";if(!_r[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:n}=_r[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const i=Object.create(n.prototype);for(const n of Object.keys(t)){if("$name"===n)continue;const r=t[n];i[n]=_r[e].shallow.indexOf(n)>=0?r:wr(r)}return i}throw new Error("can't deserialize object of type "+typeof t)}class Cr{constructor(){this.first=!0}update(t,e){const n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=n,!0))}}const Er={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function Sr(t){for(const e of t)if(Ir(e.charCodeAt(0)))return!0;return!1}function Mr(t){for(const e of t)if(!Tr(e.charCodeAt(0)))return!1;return!0}function Tr(t){return!(Er.Arabic(t)||Er["Arabic Supplement"](t)||Er["Arabic Extended-A"](t)||Er["Arabic Presentation Forms-A"](t)||Er["Arabic Presentation Forms-B"](t))}function Ir(t){return!(746!==t&&747!==t&&(t<4352||!(Er["Bopomofo Extended"](t)||Er.Bopomofo(t)||Er["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Er["CJK Compatibility Ideographs"](t)||Er["CJK Compatibility"](t)||Er["CJK Radicals Supplement"](t)||Er["CJK Strokes"](t)||!(!Er["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Er["CJK Unified Ideographs Extension A"](t)||Er["CJK Unified Ideographs"](t)||Er["Enclosed CJK Letters and Months"](t)||Er["Hangul Compatibility Jamo"](t)||Er["Hangul Jamo Extended-A"](t)||Er["Hangul Jamo Extended-B"](t)||Er["Hangul Jamo"](t)||Er["Hangul Syllables"](t)||Er.Hiragana(t)||Er["Ideographic Description Characters"](t)||Er.Kanbun(t)||Er["Kangxi Radicals"](t)||Er["Katakana Phonetic Extensions"](t)||Er.Katakana(t)&&12540!==t||!(!Er["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Er["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Er["Unified Canadian Aboriginal Syllabics"](t)||Er["Unified Canadian Aboriginal Syllabics Extended"](t)||Er["Vertical Forms"](t)||Er["Yijing Hexagram Symbols"](t)||Er["Yi Syllables"](t)||Er["Yi Radicals"](t))))}function Br(t){return!(Ir(t)||function(t){return!!(Er["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||Er["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||Er["Letterlike Symbols"](t)||Er["Number Forms"](t)||Er["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||Er["Control Pictures"](t)&&9251!==t||Er["Optical Character Recognition"](t)||Er["Enclosed Alphanumerics"](t)||Er["Geometric Shapes"](t)||Er["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Er["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Er["CJK Symbols and Punctuation"](t)||Er.Katakana(t)||Er["Private Use Area"](t)||Er["CJK Compatibility Forms"](t)||Er["Small Form Variants"](t)||Er["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Lr(t){return t>=1424&&t<=2303||Er["Arabic Presentation Forms-A"](t)||Er["Arabic Presentation Forms-B"](t)}function Dr(t,e){return!(!e&&Lr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Er.Khmer(t))}function Pr(t){for(const e of t)if(Lr(e.charCodeAt(0)))return!0;return!1}const Rr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(t){this.pluginStatus=t.pluginStatus,this.pluginURL=t.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(t){this.applyArabicShaping=t.applyArabicShaping,this.processBidirectionalText=t.processBidirectionalText,this.processStyledBidirectionalText=t.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class kr{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cr,this.transition={})}isSupportedScript(t){return function(t,e){for(const n of t)if(!Dr(n.charCodeAt(0),e))return!1;return!0}(t,"loaded"===Rr.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*e}}}class zr{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(ui(t))return new Ci(t,e);if(_i(t)){const n=wi(t,e);if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));return n.value}{let n=t;return"color"===e.type&&"string"==typeof t?n=Zt.parse(t):"padding"!==e.type||"number"!=typeof t&&!Array.isArray(t)?"variableAnchorOffsetCollection"===e.type&&Array.isArray(t)&&(n=Kt.parse(t)):n=Qt.parse(t),{kind:"constant",evaluate:()=>n}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,n){return this.property.possiblyEvaluate(this,t,e,n)}}class Fr{constructor(t){this.property=t,this.value=new zr(t,void 0)}transitioned(t,e){return new Nr(this.property,this.value,e,v({},t.transition,this.transition),t.now)}untransitioned(){return new Nr(this.property,this.value,null,{},0)}}class Or{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return b(this._values[t].value.value)}setValue(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fr(this._values[t].property)),this._values[t].value=new zr(this._values[t].property,null===e?void 0:b(e))}getTransition(t){return b(this._values[t].transition)}setTransition(t,e){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fr(this._values[t].property)),this._values[t].transition=b(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n);const i=this.getTransition(e);void 0!==i&&(t[`${e}-transition`]=i)}return t}transitioned(t,e){const n=new Ur(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,e._values[i]);return n}untransitioned(){const t=new Ur(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class Nr{constructor(t,e,n,i,r){this.property=t,this.value=e,this.begin=r+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,e,n){const i=t.now||0,r=this.value.possiblyEvaluate(t,e,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(i<this.begin)return a.possiblyEvaluate(t,e,n);{const o=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,e,n),r,function(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}(o))}}return r}}class Ur{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,n){const i=new Hr(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Vr{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return void 0!==this._values[t].value}getValue(t){return b(this._values[t].value)}setValue(t,e){this._values[t]=new zr(this._values[t].property,null===e?void 0:b(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const n=this.getValue(e);void 0!==n&&(t[e]=n)}return t}possiblyEvaluate(t,e,n){const i=new Hr(this._properties);for(const r of Object.keys(this._values))i._values[r]=this._values[r].possiblyEvaluate(t,e,n);return i}}class Gr{constructor(t,e,n){this.property=t,this.value=e,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,n,i){return this.property.evaluate(this.value,this.parameters,t,e,n,i)}}class Hr{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class jr{constructor(t){this.specification=t}possiblyEvaluate(t,e){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(e)}interpolate(t,e,n){const i=Ie[this.specification.type];return i?i(t,e,n):t}}class Wr{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,n,i){return new Gr(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},n,i)}:t.expression,e)}interpolate(t,e,n){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new Gr(this,{kind:"constant",value:void 0},t.parameters);const i=Ie[this.specification.type];if(i){const r=i(t.value.value,e.value.value,n);return new Gr(this,{kind:"constant",value:r},t.parameters)}return t}evaluate(t,e,n,i,r,a){return"constant"===t.kind?t.value:t.evaluate(e,n,i,r,a)}}class qr extends Wr{possiblyEvaluate(t,e,n,i){if(void 0===t.value)return new Gr(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i),a="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,o=this._calculate(a,a,a,e);return new Gr(this,{kind:"constant",value:o},e)}if("camera"===t.expression.kind){const n=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new Gr(this,{kind:"constant",value:n},e)}return new Gr(this,t.expression,e)}evaluate(t,e,n,i,r,a){if("source"===t.kind){const o=t.evaluate(e,n,i,r,a);return this._calculate(o,o,o,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},n,i),t.evaluate({zoom:Math.floor(e.zoom)},n,i),t.evaluate({zoom:Math.floor(e.zoom)+1},n,i),e):t.value}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class Zr{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},n,i);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new kr(Math.floor(e.zoom-1),e)),t.expression.evaluate(new kr(Math.floor(e.zoom),e)),t.expression.evaluate(new kr(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:n,to:e}}interpolate(t){return t}}class $r{constructor(t){this.specification=t}possiblyEvaluate(t,e,n,i){return!!t.expression.evaluate(e,null,{},n,i)}interpolate(){return!1}}class Yr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const n=t[e];n.specification.overridable&&this.overridableProperties.push(e);const i=this.defaultPropertyValues[e]=new zr(n,void 0),r=this.defaultTransitionablePropertyValues[e]=new Fr(n);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=i.possiblyEvaluate({})}}}xr("DataDrivenProperty",Wr),xr("DataConstantProperty",jr),xr("CrossFadedDataDrivenProperty",qr),xr("CrossFadedProperty",Zr),xr("ColorRampProperty",$r);const Xr="-transition";class Qr extends W{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new Vr(e.layout)),e.paint)){this._transitionablePaint=new Or(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Hr(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,n={}){null!=e&&this._validate(gr,`layers.${this.id}.layout.${t}`,t,e,n)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return t.endsWith(Xr)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,n={}){if(null!=e&&this._validate(fr,`layers.${this.id}.paint.${t}`,t,e,n))return!1;if(t.endsWith(Xr))return this._transitionablePaint.setTransition(t.slice(0,-11),e||void 0),!1;{const n=this._transitionablePaint._values[t],i="cross-faded-data-driven"===n.property.specification["property-type"],r=n.value.isDataDriven(),a=n.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const o=this._transitionablePaint._values[t].value;return o.isDataDriven()||r||i||this._handleOverridablePaintPropertyUpdate(t,a,o)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,e,n){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),x(t,((t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length)))}_validate(t,e,n,i,r={}){return(!r||!1!==r.validate)&&vr(this,t.call(pr,{key:e,layerType:this.type,objectKey:n,value:i,styleSpec:q,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof Gr&&oi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Jr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Kr{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ta{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ea(t,e=1){let n=0,i=0;return{members:t.map((t=>{const r=Jr[t.type].BYTES_PER_ELEMENT,a=n=na(n,Math.max(e,r)),o=t.components||1;return i=Math.max(i,r),n+=r*o,{name:t.name,type:t.type,components:o,offset:a}})),size:na(n,Math.max(i,e)),alignment:e}}function na(t,e){return Math.ceil(t/e)*e}class ia extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.int16[i+0]=e,this.int16[i+1]=n,t}}ia.prototype.bytesPerElement=4,xr("StructArrayLayout2i4",ia);class ra extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=n,this.int16[r+2]=i,t}}ra.prototype.bytesPerElement=6,xr("StructArrayLayout3i6",ra);class aa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const a=4*t;return this.int16[a+0]=e,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=r,t}}aa.prototype.bytesPerElement=8,xr("StructArrayLayout4i8",aa);class oa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,o){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,t}}oa.prototype.bytesPerElement=12,xr("StructArrayLayout2i4i12",oa);class sa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,o){const s=4*t,l=8*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.uint8[l+4]=i,this.uint8[l+5]=r,this.uint8[l+6]=a,this.uint8[l+7]=o,t}}sa.prototype.bytesPerElement=8,xr("StructArrayLayout2i4ub8",sa);class la extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.float32[i+0]=e,this.float32[i+1]=n,t}}la.prototype.bytesPerElement=8,xr("StructArrayLayout2f8",la);class ca extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,o,s,l,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,e,n,i,r,a,o,s,l,c)}emplace(t,e,n,i,r,a,o,s,l,c,u){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=n,this.uint16[h+2]=i,this.uint16[h+3]=r,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=c,this.uint16[h+9]=u,t}}ca.prototype.bytesPerElement=20,xr("StructArrayLayout10ui20",ca);class ua extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,o,s,l,c,u,h){const d=this.length;return this.resize(d+1),this.emplace(d,t,e,n,i,r,a,o,s,l,c,u,h)}emplace(t,e,n,i,r,a,o,s,l,c,u,h,d){const p=12*t;return this.int16[p+0]=e,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=r,this.uint16[p+4]=a,this.uint16[p+5]=o,this.uint16[p+6]=s,this.uint16[p+7]=l,this.int16[p+8]=c,this.int16[p+9]=u,this.int16[p+10]=h,this.int16[p+11]=d,t}}ua.prototype.bytesPerElement=24,xr("StructArrayLayout4i4ui4i24",ua);class ha extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}ha.prototype.bytesPerElement=12,xr("StructArrayLayout3f12",ha);class da extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}da.prototype.bytesPerElement=4,xr("StructArrayLayout1ul4",da);class pa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,o,s,l){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,n,i,r,a,o,s,l)}emplace(t,e,n,i,r,a,o,s,l,c){const u=10*t,h=5*t;return this.int16[u+0]=e,this.int16[u+1]=n,this.int16[u+2]=i,this.int16[u+3]=r,this.int16[u+4]=a,this.int16[u+5]=o,this.uint32[h+3]=s,this.uint16[u+8]=l,this.uint16[u+9]=c,t}}pa.prototype.bytesPerElement=20,xr("StructArrayLayout6i1ul2ui20",pa);class ma extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,o){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=n,this.int16[s+2]=i,this.int16[s+3]=r,this.int16[s+4]=a,this.int16[s+5]=o,t}}ma.prototype.bytesPerElement=12,xr("StructArrayLayout2i2i2i12",ma);class fa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,n,i,r)}emplace(t,e,n,i,r,a){const o=4*t,s=8*t;return this.float32[o+0]=e,this.float32[o+1]=n,this.float32[o+2]=i,this.int16[s+6]=r,this.int16[s+7]=a,t}}fa.prototype.bytesPerElement=16,xr("StructArrayLayout2f1f2i16",fa);class ga extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,n,i,r,a)}emplace(t,e,n,i,r,a,o){const s=16*t,l=4*t,c=8*t;return this.uint8[s+0]=e,this.uint8[s+1]=n,this.float32[l+1]=i,this.float32[l+2]=r,this.int16[c+6]=a,this.int16[c+7]=o,t}}ga.prototype.bytesPerElement=16,xr("StructArrayLayout2ub2f2i16",ga);class va extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=n,this.uint16[r+2]=i,t}}va.prototype.bytesPerElement=6,xr("StructArrayLayout3ui6",va);class ya extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g)}emplace(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v){const y=24*t,_=12*t,x=48*t;return this.int16[y+0]=e,this.int16[y+1]=n,this.uint16[y+2]=i,this.uint16[y+3]=r,this.uint32[_+2]=a,this.uint32[_+3]=o,this.uint32[_+4]=s,this.uint16[y+10]=l,this.uint16[y+11]=c,this.uint16[y+12]=u,this.float32[_+7]=h,this.float32[_+8]=d,this.uint8[x+36]=p,this.uint8[x+37]=m,this.uint8[x+38]=f,this.uint32[_+10]=g,this.int16[y+22]=v,t}}ya.prototype.bytesPerElement=48,xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ya);class _a extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v,y,_,x,b,A,w,C,E,S,M){const T=this.length;return this.resize(T+1),this.emplace(T,t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v,y,_,x,b,A,w,C,E,S,M)}emplace(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v,y,_,x,b,A,w,C,E,S,M,T){const I=32*t,B=16*t;return this.int16[I+0]=e,this.int16[I+1]=n,this.int16[I+2]=i,this.int16[I+3]=r,this.int16[I+4]=a,this.int16[I+5]=o,this.int16[I+6]=s,this.int16[I+7]=l,this.uint16[I+8]=c,this.uint16[I+9]=u,this.uint16[I+10]=h,this.uint16[I+11]=d,this.uint16[I+12]=p,this.uint16[I+13]=m,this.uint16[I+14]=f,this.uint16[I+15]=g,this.uint16[I+16]=v,this.uint16[I+17]=y,this.uint16[I+18]=_,this.uint16[I+19]=x,this.uint16[I+20]=b,this.uint16[I+21]=A,this.uint16[I+22]=w,this.uint32[B+12]=C,this.float32[B+13]=E,this.float32[B+14]=S,this.uint16[I+30]=M,this.uint16[I+31]=T,t}}_a.prototype.bytesPerElement=64,xr("StructArrayLayout8i15ui1ul2f2ui64",_a);class xa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}xa.prototype.bytesPerElement=4,xr("StructArrayLayout1f4",xa);class ba extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=3*t;return this.uint16[6*t+0]=e,this.float32[r+1]=n,this.float32[r+2]=i,t}}ba.prototype.bytesPerElement=12,xr("StructArrayLayout1ui2f12",ba);class Aa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,n){const i=this.length;return this.resize(i+1),this.emplace(i,t,e,n)}emplace(t,e,n,i){const r=4*t;return this.uint32[2*t+0]=e,this.uint16[r+2]=n,this.uint16[r+3]=i,t}}Aa.prototype.bytesPerElement=8,xr("StructArrayLayout1ul2ui8",Aa);class wa extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const n=this.length;return this.resize(n+1),this.emplace(n,t,e)}emplace(t,e,n){const i=2*t;return this.uint16[i+0]=e,this.uint16[i+1]=n,t}}wa.prototype.bytesPerElement=4,xr("StructArrayLayout2ui4",wa);class Ca extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}Ca.prototype.bytesPerElement=2,xr("StructArrayLayout1ui2",Ca);class Ea extends ta{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,n,i){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,n,i)}emplace(t,e,n,i,r){const a=4*t;return this.float32[a+0]=e,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=r,t}}Ea.prototype.bytesPerElement=16,xr("StructArrayLayout4f16",Ea);class Sa extends Kr{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new a(this.anchorPointX,this.anchorPointY)}}Sa.prototype.size=20;class Ma extends pa{get(t){return new Sa(this,t)}}xr("CollisionBoxArray",Ma);class Ta extends Kr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ta.prototype.size=48;class Ia extends ya{get(t){return new Ta(this,t)}}xr("PlacedSymbolArray",Ia);class Ba extends Kr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ba.prototype.size=64;class La extends _a{get(t){return new Ba(this,t)}}xr("SymbolInstanceArray",La);class Da extends xa{getoffsetX(t){return this.float32[1*t+0]}}xr("GlyphOffsetArray",Da);class Pa extends ra{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}xr("SymbolLineVertexArray",Pa);class Ra extends Kr{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ra.prototype.size=12;class ka extends ba{get(t){return new Ra(this,t)}}xr("TextAnchorOffsetArray",ka);class za extends Kr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}za.prototype.size=8;class Fa extends Aa{get(t){return new za(this,t)}}xr("FeatureIndexArray",Fa);class Oa extends ia{}class Na extends ia{}class Ua extends ia{}class Va extends oa{}class Ga extends sa{}class Ha extends la{}class ja extends ca{}class Wa extends ua{}class qa extends ha{}class Za extends da{}class $a extends ma{}class Ya extends ga{}class Xa extends va{}class Qa extends wa{}const Ja=ea([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ka}=Ja;class to{constructor(t=[]){this.segments=t}prepareSegment(t,e,n,i){let r=this.segments[this.segments.length-1];return t>to.MAX_VERTEX_ARRAY_LENGTH&&w(`Max vertices per segment is ${to.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!r||r.vertexLength+t>to.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==i)&&(r={vertexOffset:e.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(r.sortKey=i),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,n,i){return new to([{vertexOffset:t,primitiveOffset:e,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}function eo(t,e){return 256*(t=f(Math.floor(t),0,255))+f(Math.floor(e),0,255)}to.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xr("SegmentVector",to);const no=ea([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var io={exports:{}},ro=function(t,e){var n,i,r,a,o,s,l,c;for(i=t.length-(n=3&t.length),r=e,o=3432918353,s=461845907,c=0;c<i;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,r=27492+(65535&(a=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0},ao=function(t,e){for(var n,i=t.length,r=e^i,a=0;i>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),i-=4,++a;switch(i){case 3:r^=(255&t.charCodeAt(a+2))<<16;case 2:r^=(255&t.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0};io.exports=ro,io.exports.murmur3=ro,io.exports.murmur2=ao;var oo=n(io.exports);class so{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,n,i){this.ids.push(lo(t)),this.positions.push(e,n,i)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const e=lo(t);let n=0,i=this.ids.length-1;for(;n<i;){const t=n+i>>1;this.ids[t]>=e?i=t:n=t+1}const r=[];for(;this.ids[n]===e;)r.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return r}static serialize(t,e){const n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return co(n,i,0,n.length-1),e&&e.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){const e=new so;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function lo(t){const e=+t;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:oo(String(t))}function co(t,e,n,i){for(;n<i;){const r=t[n+i>>1];let a=n-1,o=i+1;for(;;){do{a++}while(t[a]<r);do{o--}while(t[o]>r);if(a>=o)break;uo(t,a,o),uo(e,3*a,3*o),uo(e,3*a+1,3*o+1),uo(e,3*a+2,3*o+2)}o-n<i-o?(co(t,e,n,o),n=o+1):(co(t,e,o+1,i),i=o)}}function uo(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}xr("FeaturePositionMap",so);class ho{constructor(t,e){this.gl=t.gl,this.location=e}}class po extends ho{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class mo extends ho{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class fo extends ho{constructor(t,e){super(t,e),this.current=Zt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const go=new Float32Array(16);function vo(t){return[eo(255*t.r,255*t.g),eo(255*t.b,255*t.a)]}class yo{constructor(t,e,n){this.value=t,this.uniformNames=e.map((t=>`u_${t}`)),this.type=n}setUniform(t,e,n){t.set(n.constantOr(this.value))}getBinding(t,e,n){return"color"===this.type?new fo(t,e):new po(t,e)}}class _o{constructor(t,e){this.uniformNames=e.map((t=>`u_${t}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr}setUniform(t,e,n,i){const r="u_pattern_to"===i?this.patternTo:"u_pattern_from"===i?this.patternFrom:"u_pixel_ratio_to"===i?this.pixelRatioTo:"u_pixel_ratio_from"===i?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,n){return"u_pattern"===n.substr(0,9)?new mo(t,e):new po(t,e)}}class xo{constructor(t,e,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?2:1,offset:0}))),this.paintVertexArray=new i}populatePaintArray(t,e,n,i,r){const a=this.paintVertexArray.length,o=this.expression.evaluate(new kr(0),e,{},i,[],r);this.paintVertexArray.resize(t),this._setPaintValue(a,t,o)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,e,r)}_setPaintValue(t,e,n){if("color"===this.type){const i=vo(n);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i[0],i[1])}else{for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bo{constructor(t,e,n,i,r,a){this.expression=t,this.uniformNames=e.map((t=>`u_${t}_t`)),this.type=n,this.useIntegerZoom=i,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map((t=>({name:`a_${t}`,type:"Float32",components:"color"===n?4:2,offset:0}))),this.paintVertexArray=new a}populatePaintArray(t,e,n,i,r){const a=this.expression.evaluate(new kr(this.zoom),e,{},i,[],r),o=this.expression.evaluate(new kr(this.zoom+1),e,{},i,[],r),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,a,o)}updatePaintArray(t,e,n,i){const r=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,e,r,a)}_setPaintValue(t,e,n,i){if("color"===this.type){const r=vo(n),a=vo(i);for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,r[0],r[1],a[0],a[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const n=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,i=f(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,e,n){return new po(t,e)}}class Ao{constructor(t,e,n,i,r,a){this.expression=t,this.type=e,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new r,this.zoomOutPaintVertexArray=new r}populatePaintArray(t,e,n){const i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,e.patterns&&e.patterns[this.layerId],n)}updatePaintArray(t,e,n,i,r){this._setPaintValues(t,e,n.patterns&&n.patterns[this.layerId],r)}_setPaintValues(t,e,n,i){if(!i||!n)return;const{min:r,mid:a,max:o}=n,s=i[r],l=i[a],c=i[o];if(s&&l&&c)for(let n=t;n<e;n++)this.zoomInPaintVertexArray.emplace(n,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(n,l.tl[0],l.tl[1],l.br[0],l.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],l.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,no.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,no.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class wo{constructor(t,e,n){this.binders={},this._buffers=[];const i=[];for(const r in t.paint._values){if(!n(r))continue;const a=t.paint.get(r);if(!(a instanceof Gr&&oi(a.property.specification)))continue;const o=Eo(r,t.type),s=a.value,l=a.property.specification.type,c=a.property.useIntegerZoom,u=a.property.specification["property-type"],h="cross-faded"===u||"cross-faded-data-driven"===u;if("constant"===s.kind)this.binders[r]=h?new _o(s.value,o):new yo(s.value,o,l),i.push(`/u_${r}`);else if("source"===s.kind||h){const n=So(r,l,"source");this.binders[r]=h?new Ao(s,l,c,e,n,t.id):new xo(s,o,l,n),i.push(`/a_${r}`)}else{const t=So(r,l,"composite");this.binders[r]=new bo(s,o,l,c,e,t),i.push(`/z_${r}`)}}this.cacheKey=i.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof xo||e instanceof bo?e.maxValue:0}populatePaintArrays(t,e,n,i,r){for(const a in this.binders){const o=this.binders[a];(o instanceof xo||o instanceof bo||o instanceof Ao)&&o.populatePaintArray(t,e,n,i,r)}}setConstantPatternPositions(t,e){for(const n in this.binders){const i=this.binders[n];i instanceof _o&&i.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,n,i,r){let a=!1;for(const o in t){const s=e.getPositions(o);for(const e of s){const s=n.feature(e.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof xo||l instanceof bo||l instanceof Ao)&&!0===l.expression.isStateDependent){const c=i.paint.get(n);l.expression=c.value,l.updatePaintArray(e.start,e.end,s,t[o],r),a=!0}}}}return a}defines(){const t=[];for(const e in this.binders){const n=this.binders[e];(n instanceof yo||n instanceof _o)&&t.push(...n.uniformNames.map((t=>`#define HAS_UNIFORM_${t}`)))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof xo||n instanceof bo)for(let e=0;e<n.paintVertexAttributes.length;e++)t.push(n.paintVertexAttributes[e].name);else if(n instanceof Ao)for(let e=0;e<no.members.length;e++)t.push(no.members[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const n=this.binders[e];if(n instanceof yo||n instanceof _o||n instanceof bo)for(const e of n.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const n=[];for(const i in this.binders){const r=this.binders[i];if(r instanceof yo||r instanceof _o||r instanceof bo)for(const a of r.uniformNames)if(e[a]){const o=r.getBinding(t,e[a],a);n.push({name:a,property:i,binding:o})}}return n}setUniforms(t,e,n,i){for(const{name:t,property:r,binding:a}of e)this.binders[r].setUniform(a,i,n.get(r),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const n=this.binders[e];if(t&&n instanceof Ao){const e=2===t.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(n instanceof xo||n instanceof bo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(const e in this.binders){const n=this.binders[e];(n instanceof xo||n instanceof bo||n instanceof Ao)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof xo||e instanceof bo||e instanceof Ao)&&e.destroy()}}}class Co{constructor(t,e,n=(()=>!0)){this.programConfigurations={};for(const i of t)this.programConfigurations[i.id]=new wo(i,e,n);this.needsUpload=!1,this._featureMap=new so,this._bufferOffset=0}populatePaintArrays(t,e,n,i,r,a){for(const n in this.programConfigurations)this.programConfigurations[n].populatePaintArrays(t,e,i,r,a);void 0!==e.id&&this._featureMap.add(e.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,n,i){for(const r of n)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Eo(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}function So(t,e,n){const i={color:{source:la,composite:Ea},number:{source:xa,composite:la}},r=function(t){return{"line-pattern":{source:ja,composite:ja},"fill-pattern":{source:ja,composite:ja},"fill-extrusion-pattern":{source:ja,composite:ja}}[t]}(t);return r&&r[n]||i[e][n]}xr("ConstantBinder",yo),xr("CrossFadedConstantBinder",_o),xr("SourceExpressionBinder",xo),xr("CrossFadedCompositeBinder",Ao),xr("CompositeExpressionBinder",bo),xr("ProgramConfiguration",wo,{omit:["_buffers"]}),xr("ProgramConfigurationSet",Co);const Mo=8192,To=Math.pow(2,14)-1,Io=-To-1;function Bo(t){const e=Mo/t.extent,n=t.loadGeometry();for(let t=0;t<n.length;t++){const i=n[t];for(let t=0;t<i.length;t++){const n=i[t],r=Math.round(n.x*e),a=Math.round(n.y*e);n.x=f(r,Io,To),n.y=f(a,Io,To),(r<n.x||r>n.x+1||a<n.y||a>n.y+1)&&w("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Lo(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Bo(t):[]}}function Do(t,e,n,i,r){t.emplaceBack(2*e+(i+1)/2,2*n+(r+1)/2)}class Po{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Na,this.indexArray=new Xa,this.segments=new to,this.programConfigurations=new Co(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){const i=this.layers[0],r=[];let a=null,o=!1;"circle"===i.type&&(a=i.layout.get("circle-sort-key"),o=!a.isConstant());for(const{feature:e,id:i,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Lo(e,t);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),c,n))continue;const u=o?a.evaluate(c,{},n):void 0,h={id:i,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:Bo(e),patterns:{},sortKey:u};r.push(h)}o&&r.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of r){const{geometry:r,index:a,sourceLayerIndex:o}=i,s=t[a].feature;this.addFeature(i,r,a,n),e.featureIndex.insert(s,r,a,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ka),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,n,i){for(const n of e)for(const e of n){const n=e.x,i=e.y;if(n<0||n>=Mo||i<0||i>=Mo)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),a=r.vertexLength;Do(this.layoutVertexArray,n,i,-1,-1),Do(this.layoutVertexArray,n,i,1,-1),Do(this.layoutVertexArray,n,i,1,1),Do(this.layoutVertexArray,n,i,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)}}function Ro(t,e){for(let n=0;n<t.length;n++)if(Ho(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Ho(t,e[n]))return!0;return!!Oo(t,e)}function ko(t,e,n){return!!Ho(t,e)||!!Uo(e,t,n)}function zo(t,e){if(1===t.length)return Go(e,t[0]);for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++)if(Ho(t,i[e]))return!0}for(let n=0;n<t.length;n++)if(Go(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Oo(t,e[n]))return!0;return!1}function Fo(t,e,n){if(t.length>1){if(Oo(t,e))return!0;for(let i=0;i<e.length;i++)if(Uo(e[i],t,n))return!0}for(let i=0;i<t.length;i++)if(Uo(t[i],e,n))return!0;return!1}function Oo(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1];for(let t=0;t<e.length-1;t++)if(No(i,r,e[t],e[t+1]))return!0}return!1}function No(t,e,n,i){return C(t,n,i)!==C(e,n,i)&&C(t,e,n)!==C(t,e,i)}function Uo(t,e,n){const i=n*n;if(1===e.length)return t.distSqr(e[0])<i;for(let n=1;n<e.length;n++)if(Vo(t,e[n-1],e[n])<i)return!0;return!1}function Vo(t,e,n){const i=e.distSqr(n);if(0===i)return t.distSqr(e);const r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return t.distSqr(r<0?e:r>1?n:n.sub(e)._mult(r)._add(e))}function Go(t,e){let n,i,r,a=!1;for(let o=0;o<t.length;o++){n=t[o];for(let t=0,o=n.length-1;t<n.length;o=t++)i=n[t],r=n[o],i.y>e.y!=r.y>e.y&&e.x<(r.x-i.x)*(e.y-i.y)/(r.y-i.y)+i.x&&(a=!a)}return a}function Ho(t,e){let n=!1;for(let i=0,r=t.length-1;i<t.length;r=i++){const a=t[i],o=t[r];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(n=!n)}return n}function jo(t,e,n){const i=n[0],r=n[2];if(t.x<i.x&&e.x<i.x||t.x>r.x&&e.x>r.x||t.y<i.y&&e.y<i.y||t.y>r.y&&e.y>r.y)return!1;const a=C(t,e,n[0]);return a!==C(t,e,n[1])||a!==C(t,e,n[2])||a!==C(t,e,n[3])}function Wo(t,e,n){const i=e.paint.get(t).value;return"constant"===i.kind?i.value:n.programConfigurations.get(e.id).getMaxValue(t)}function qo(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Zo(t,e,n,i,r){if(!e[0]&&!e[1])return t;const o=a.convert(e)._mult(r);"viewport"===n&&o._rotate(-i);const s=[];for(let e=0;e<t.length;e++)s.push(t[e].sub(o));return s}let $o,Yo;xr("CircleBucket",Po,{omit:["layers"]});var Xo={get paint(){return Yo=Yo||new Yr({"circle-radius":new Wr(q.paint_circle["circle-radius"]),"circle-color":new Wr(q.paint_circle["circle-color"]),"circle-blur":new Wr(q.paint_circle["circle-blur"]),"circle-opacity":new Wr(q.paint_circle["circle-opacity"]),"circle-translate":new jr(q.paint_circle["circle-translate"]),"circle-translate-anchor":new jr(q.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jr(q.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jr(q.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wr(q.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wr(q.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wr(q.paint_circle["circle-stroke-opacity"])})},get layout(){return $o=$o||new Yr({"circle-sort-key":new Wr(q.layout_circle["circle-sort-key"])})}},Qo=1e-6,Jo="undefined"!=typeof Float32Array?Float32Array:Array;function Ko(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ts(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],m=e[11],f=e[12],g=e[13],v=e[14],y=e[15],_=n[0],x=n[1],b=n[2],A=n[3];return t[0]=_*i+x*s+b*h+A*f,t[1]=_*r+x*l+b*d+A*g,t[2]=_*a+x*c+b*p+A*v,t[3]=_*o+x*u+b*m+A*y,t[4]=(_=n[4])*i+(x=n[5])*s+(b=n[6])*h+(A=n[7])*f,t[5]=_*r+x*l+b*d+A*g,t[6]=_*a+x*c+b*p+A*v,t[7]=_*o+x*u+b*m+A*y,t[8]=(_=n[8])*i+(x=n[9])*s+(b=n[10])*h+(A=n[11])*f,t[9]=_*r+x*l+b*d+A*g,t[10]=_*a+x*c+b*p+A*v,t[11]=_*o+x*u+b*m+A*y,t[12]=(_=n[12])*i+(x=n[13])*s+(b=n[14])*h+(A=n[15])*f,t[13]=_*r+x*l+b*d+A*g,t[14]=_*a+x*c+b*p+A*v,t[15]=_*o+x*u+b*m+A*y,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var es,ns=ts;function is(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*a+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*a+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*a+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*a+n[15]*o,t}es=new Jo(4),Jo!=Float32Array&&(es[0]=0,es[1]=0,es[2]=0,es[3]=0);class rs extends Qr{constructor(t){super(t,Xo)}createBucket(t){return new Po(t)}queryRadius(t){const e=t;return Wo("circle-radius",this,e)+Wo("circle-stroke-width",this,e)+qo(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,i,r,a,o,s){const l=Zo(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,o),c=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n),u="map"===this.paint.get("circle-pitch-alignment"),h=u?l:function(t,e){return t.map((t=>as(t,e)))}(l,s),d=u?c*o:c;for(const t of i)for(const e of t){const t=u?e:as(e,s);let n=d;const i=is([],[e.x,e.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?n*=i[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(n*=a.cameraToCenterDistance/i[3]),ko(h,t,n))return!0}return!1}}function as(t,e){const n=is([],[t.x,t.y,0,1],e);return new a(n[0]/n[3],n[1]/n[3])}class os extends Po{}let ss;xr("HeatmapBucket",os,{omit:["layers"]});var ls={get paint(){return ss=ss||new Yr({"heatmap-radius":new Wr(q.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wr(q.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jr(q.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $r(q.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jr(q.paint_heatmap["heatmap-opacity"])})}};function cs(t,{width:e,height:n},i,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*n*i)throw new RangeError(`mismatched image size. expected: ${r.length} but got: ${e*n*i}`)}else r=new Uint8Array(e*n*i);return t.width=e,t.height=n,t.data=r,t}function us(t,{width:e,height:n},i){if(e===t.width&&n===t.height)return;const r=cs({},{width:e,height:n},i);hs(t,r,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,n)},i),t.width=e,t.height=n,t.data=r.data}function hs(t,e,n,i,r,a){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||n.x>t.width-r.width||n.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||i.x>e.width-r.width||i.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const o=t.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<r.height;l++){const c=((n.y+l)*t.width+n.x)*a,u=((i.y+l)*e.width+i.x)*a;for(let t=0;t<r.width*a;t++)s[u+t]=o[c+t]}return e}class ds{constructor(t,e){cs(this,t,1,e)}resize(t){us(this,t,1)}clone(){return new ds({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){hs(t,e,n,i,r,1)}}class ps{constructor(t,e){cs(this,t,4,e)}resize(t){us(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ps({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,n,i,r){hs(t,e,n,i,r,4)}}function ms(t){const e={},n=t.resolution||256,i=t.clips?t.clips.length:1,r=t.image||new ps({width:n,height:i});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const a=(n,i,a)=>{e[t.evaluationKey]=a;const o=t.expression.evaluate(e);r.data[n+i+0]=Math.floor(255*o.r/o.a),r.data[n+i+1]=Math.floor(255*o.g/o.a),r.data[n+i+2]=Math.floor(255*o.b/o.a),r.data[n+i+3]=Math.floor(255*o.a)};if(t.clips)for(let e=0,r=0;e<i;++e,r+=4*n)for(let i=0,o=0;i<n;i++,o+=4){const s=i/(n-1),{start:l,end:c}=t.clips[e];a(r,o,l*(1-s)+c*s)}else for(let t=0,e=0;t<n;t++,e+=4)a(0,e,t/(n-1));return r}xr("AlphaImage",ds),xr("RGBAImage",ps);class fs extends Qr{createBucket(t){return new os(t)}constructor(t){super(t,ls),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ms({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let gs;var vs={get paint(){return gs=gs||new Yr({"hillshade-illumination-direction":new jr(q.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new jr(q.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jr(q.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jr(q.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jr(q.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jr(q.paint_hillshade["hillshade-accent-color"])})}};class ys extends Qr{constructor(t){super(t,vs)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const _s=ea([{name:"a_pos",components:2,type:"Int16"}],4),{members:xs}=_s;var bs={exports:{}};function As(t,e,n){n=n||2;var i,r,a,o,s,l,c,u=e&&e.length,h=u?e[0]*n:t.length,d=ws(t,0,h,n,!0),p=[];if(!d||d.next===d.prev)return p;if(u&&(d=function(t,e,n,i){var r,a,o,s=[];for(r=0,a=e.length;r<a;r++)(o=ws(t,e[r]*i,r<a-1?e[r+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),s.push(Rs(o));for(s.sort(Bs),r=0;r<s.length;r++)n=Ls(s[r],n);return n}(t,e,d,n)),t.length>80*n){i=a=t[0],r=o=t[1];for(var m=n;m<h;m+=n)(s=t[m])<i&&(i=s),(l=t[m+1])<r&&(r=l),s>a&&(a=s),l>o&&(o=l);c=0!==(c=Math.max(a-i,o-r))?32767/c:0}return Es(d,p,n,i,r,c,0),p}function ws(t,e,n,i,r){var a,o;if(r===Zs(t,e,n,i)>0)for(a=e;a<n;a+=i)o=js(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=js(a,t[a],t[a+1],o);return o&&Os(o,o.next)&&(Ws(o),o=o.next),o}function Cs(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Os(i,i.next)&&0!==Fs(i.prev,i,i.next))i=i.next;else{if(Ws(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Es(t,e,n,i,r,a,o){if(t){!o&&a&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=Ps(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,o,s,l,c=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,c*=2}while(o>1)}(r)}(t,i,r,a);for(var s,l,c=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?Ms(t,i,r,a):Ss(t))e.push(s.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),Ws(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?Es(t=Ts(Cs(t),e,n),e,n,i,r,a,2):2===o&&Is(t,e,n,i,r,a):Es(Cs(t),e,n,i,r,a,1);break}}}function Ss(t){var e=t.prev,n=t,i=t.next;if(Fs(e,n,i)>=0)return!1;for(var r=e.x,a=n.x,o=i.x,s=e.y,l=n.y,c=i.y,u=r<a?r<o?r:o:a<o?a:o,h=s<l?s<c?s:c:l<c?l:c,d=r>a?r>o?r:o:a>o?a:o,p=s>l?s>c?s:c:l>c?l:c,m=i.next;m!==e;){if(m.x>=u&&m.x<=d&&m.y>=h&&m.y<=p&&ks(r,s,a,l,o,c,m.x,m.y)&&Fs(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Ms(t,e,n,i){var r=t.prev,a=t,o=t.next;if(Fs(r,a,o)>=0)return!1;for(var s=r.x,l=a.x,c=o.x,u=r.y,h=a.y,d=o.y,p=s<l?s<c?s:c:l<c?l:c,m=u<h?u<d?u:d:h<d?h:d,f=s>l?s>c?s:c:l>c?l:c,g=u>h?u>d?u:d:h>d?h:d,v=Ps(p,m,e,n,i),y=Ps(f,g,e,n,i),_=t.prevZ,x=t.nextZ;_&&_.z>=v&&x&&x.z<=y;){if(_.x>=p&&_.x<=f&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&ks(s,u,l,h,c,d,_.x,_.y)&&Fs(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,x.x>=p&&x.x<=f&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&ks(s,u,l,h,c,d,x.x,x.y)&&Fs(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;_&&_.z>=v;){if(_.x>=p&&_.x<=f&&_.y>=m&&_.y<=g&&_!==r&&_!==o&&ks(s,u,l,h,c,d,_.x,_.y)&&Fs(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=y;){if(x.x>=p&&x.x<=f&&x.y>=m&&x.y<=g&&x!==r&&x!==o&&ks(s,u,l,h,c,d,x.x,x.y)&&Fs(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Ts(t,e,n){var i=t;do{var r=i.prev,a=i.next.next;!Os(r,a)&&Ns(r,i,i.next,a)&&Gs(r,a)&&Gs(a,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(a.i/n|0),Ws(i),Ws(i.next),i=t=a),i=i.next}while(i!==t);return Cs(i)}function Is(t,e,n,i,r,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&zs(o,s)){var l=Hs(o,s);return o=Cs(o,o.next),l=Cs(l,l.next),Es(o,e,n,i,r,a,0),void Es(l,e,n,i,r,a,0)}s=s.next}o=o.next}while(o!==t)}function Bs(t,e){return t.x-e.x}function Ls(t,e){var n=function(t,e){var n,i=e,r=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o&&(o=s,n=i.x<i.next.x?i:i.next,s===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,c=n,u=n.x,h=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&ks(a<h?r:o,a,u,h,a<h?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),Gs(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&Ds(n,i)))&&(n=i,d=l)),i=i.next}while(i!==c);return n}(t,e);if(!n)return e;var i=Hs(n,t);return Cs(i,i.next),Cs(n,n.next)}function Ds(t,e){return Fs(t.prev,t,e.prev)<0&&Fs(e.next,t,t.next)<0}function Ps(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Rs(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function ks(t,e,n,i,r,a,o,s){return(r-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(i-s)>=(n-o)*(e-s)&&(n-o)*(a-s)>=(r-o)*(i-s)}function zs(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ns(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Gs(t,e)&&Gs(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Fs(t.prev,t,e.prev)||Fs(t,e.prev,e))||Os(t,e)&&Fs(t.prev,t,t.next)>0&&Fs(e.prev,e,e.next)>0)}function Fs(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Os(t,e){return t.x===e.x&&t.y===e.y}function Ns(t,e,n,i){var r=Vs(Fs(t,e,n)),a=Vs(Fs(t,e,i)),o=Vs(Fs(n,i,t)),s=Vs(Fs(n,i,e));return r!==a&&o!==s||!(0!==r||!Us(t,n,e))||!(0!==a||!Us(t,i,e))||!(0!==o||!Us(n,t,i))||!(0!==s||!Us(n,e,i))}function Us(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Vs(t){return t>0?1:t<0?-1:0}function Gs(t,e){return Fs(t.prev,t,t.next)<0?Fs(t,e,t.next)>=0&&Fs(t,t.prev,e)>=0:Fs(t,e,t.prev)<0||Fs(t,t.next,e)<0}function Hs(t,e){var n=new qs(t.i,t.x,t.y),i=new qs(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function js(t,e,n,i){var r=new qs(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ws(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function qs(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Zs(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}bs.exports=As,bs.exports.default=As,As.deviation=function(t,e,n,i){var r=e&&e.length,a=Math.abs(Zs(t,0,r?e[0]*n:t.length,n));if(r)for(var o=0,s=e.length;o<s;o++)a-=Math.abs(Zs(t,e[o]*n,o<s-1?e[o+1]*n:t.length,n));var l=0;for(o=0;o<i.length;o+=3){var c=i[o]*n,u=i[o+1]*n,h=i[o+2]*n;l+=Math.abs((t[c]-t[h])*(t[u+1]-t[c+1])-(t[c]-t[u])*(t[h+1]-t[c+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},As.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var o=0;o<e;o++)n.vertices.push(t[r][a][o]);r>0&&n.holes.push(i+=t[r-1].length)}return n};var $s=n(bs.exports);function Ys(t,e,n){const i=n.patternDependencies;let r=!1;for(const n of e){const e=n.paint.get(`${t}-pattern`);e.isConstant()||(r=!0);const a=e.constantOr(null);a&&(r=!0,i[a.to]=!0,i[a.from]=!0)}return r}function Xs(t,e,n,i,r){const a=r.patternDependencies;for(const o of e){const e=o.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:i-1},n,{},r.availableImages),s=e.evaluate({zoom:i},n,{},r.availableImages),l=e.evaluate({zoom:i+1},n,{},r.availableImages);t=t&&t.name?t.name:t,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,a[t]=!0,a[s]=!0,a[l]=!0,n.patterns[o.id]={min:t,mid:s,max:l}}}return n}class Qs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ua,this.indexArray=new Xa,this.indexArray2=new Qa,this.programConfigurations=new Co(t.layers,t.zoom),this.segments=new to,this.segments2=new to,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=Ys("fill",this.layers,e);const i=this.layers[0].layout.get("fill-sort-key"),r=!i.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:c}of t){const t=this.layers[0]._featureFilter.needGeometry,u=Lo(o,t);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),u,n))continue;const h=r?i.evaluate(u,{},n,e.availableImages):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:c,index:l,geometry:t?u.geometry:Bo(o),patterns:{},sortKey:h};a.push(d)}r&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of a){const{geometry:r,index:a,sourceLayerIndex:o}=i;if(this.hasPattern){const t=Xs("fill",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,r,a,n,{});e.featureIndex.insert(t[a].feature,r,a,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xs),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,n,i,r){for(const t of _n(e,500)){let e=0;for(const n of t)e+=n.length;const n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),i=n.vertexLength,r=[],a=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&a.push(r.length/2);const n=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),i=n.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(i+e.length-1,i),r.push(e[0].x),r.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(i+t-1,i+t),r.push(e[t].x),r.push(e[t].y);n.vertexLength+=e.length,n.primitiveLength+=e.length}const o=$s(r,a);for(let t=0;t<o.length;t+=3)this.indexArray.emplaceBack(i+o[t],i+o[t+1],i+o[t+2]);n.vertexLength+=e,n.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}}let Js,Ks;xr("FillBucket",Qs,{omit:["layers","patternFeatures"]});var tl={get paint(){return Ks=Ks||new Yr({"fill-antialias":new jr(q.paint_fill["fill-antialias"]),"fill-opacity":new Wr(q.paint_fill["fill-opacity"]),"fill-color":new Wr(q.paint_fill["fill-color"]),"fill-outline-color":new Wr(q.paint_fill["fill-outline-color"]),"fill-translate":new jr(q.paint_fill["fill-translate"]),"fill-translate-anchor":new jr(q.paint_fill["fill-translate-anchor"]),"fill-pattern":new qr(q.paint_fill["fill-pattern"])})},get layout(){return Js=Js||new Yr({"fill-sort-key":new Wr(q.layout_fill["fill-sort-key"])})}};class el extends Qr{constructor(t){super(t,tl)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Qs(t)}queryRadius(){return qo(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,i,r,a,o){return zo(Zo(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,o),i)}isTileClipped(){return!0}}const nl=ea([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),il=ea([{name:"a_centroid",components:2,type:"Int16"}],4),{members:rl}=nl;var al={},ol=i,sl=ll;function ll(t,e,n,i,r){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=r,t.readFields(cl,this,e)}function cl(t,e,n){1==t?e.id=n.readVarint():2==t?function(t,e){for(var n=t.readVarint()+t.pos;t.pos<n;){var i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function ul(t){for(var e,n,i=0,r=0,a=t.length,o=a-1;r<a;o=r++)i+=((n=t[o]).x-(e=t[r]).x)*(e.y+n.y);return i}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,i=1,r=0,a=0,o=0,s=[];t.pos<n;){if(r<=0){var l=t.readVarint();i=7&l,r=l>>3}if(r--,1===i||2===i)a+=t.readSVarint(),o+=t.readSVarint(),1===i&&(e&&s.push(e),e=[]),e.push(new ol(a,o));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&s.push(e),s},ll.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,i=0,r=0,a=0,o=1/0,s=-1/0,l=1/0,c=-1/0;t.pos<e;){if(i<=0){var u=t.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)(r+=t.readSVarint())<o&&(o=r),r>s&&(s=r),(a+=t.readSVarint())<l&&(l=a),a>c&&(c=a);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,s,c]},ll.prototype.toGeoJSON=function(t,e,n){var i,r,a=this.extent*Math.pow(2,n),o=this.extent*t,s=this.extent*e,l=this.loadGeometry(),c=ll.types[this.type];function u(t){for(var e=0;e<t.length;e++){var n=t[e];t[e]=[360*(n.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(i=0;i<l.length;i++)h[i]=l[i][0];u(l=h);break;case 2:for(i=0;i<l.length;i++)u(l[i]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var n,i,r=[],a=0;a<e;a++){var o=ul(t[a]);0!==o&&(void 0===i&&(i=o<0),i===o<0?(n&&r.push(n),n=[t[a]]):n.push(t[a]))}return n&&r.push(n),r}(l),i=0;i<l.length;i++)for(r=0;r<l[i].length;r++)u(l[i][r])}1===l.length?l=l[0]:c="Multi"+c;var d={type:"Feature",geometry:{type:c,coordinates:l},properties:this.properties};return"id"in this&&(d.id=this.id),d};var hl=sl,dl=pl;function pl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(ml,this,e),this.length=this._features.length}function ml(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){for(var e=null,n=t.readVarint()+t.pos;t.pos<n;){var i=t.readVarint()>>3;e=1===i?t.readString():2===i?t.readFloat():3===i?t.readDouble():4===i?t.readVarint64():5===i?t.readVarint():6===i?t.readSVarint():7===i?t.readBoolean():null}return e}(n))}pl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new hl(this._pbf,e,this.extent,this._keys,this._values)};var fl=dl;function gl(t,e,n){if(3===t){var i=new fl(n,n.readVarint()+n.pos);i.length&&(e[i.name]=i)}}al.VectorTile=function(t,e){this.layers=t.readFields(gl,{},e)},al.VectorTileFeature=sl,al.VectorTileLayer=dl;const vl=al.VectorTileFeature.types,yl=Math.pow(2,13);function _l(t,e,n,i,r,a,o,s){t.emplaceBack(e,n,2*Math.floor(i*yl)+o,r*yl*2,a*yl*2,Math.round(s))}class xl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Va,this.centroidVertexArray=new Oa,this.indexArray=new Xa,this.programConfigurations=new Co(t.layers,t.zoom),this.segments=new to,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.features=[],this.hasPattern=Ys("fill-extrusion",this.layers,e);for(const{feature:i,id:r,index:a,sourceLayerIndex:o}of t){const t=this.layers[0]._featureFilter.needGeometry,s=Lo(i,t);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),s,n))continue;const l={id:r,sourceLayerIndex:o,index:a,geometry:t?s.geometry:Bo(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Xs("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,a,n,{}),e.featureIndex.insert(i,l.geometry,a,o,this.index,!0)}}addFeatures(t,e,n){for(const t of this.features){const{geometry:i}=t;this.addFeature(t,i,t.index,e,n)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rl),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,il.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,e,n,i,r){for(const n of _n(e,500)){const e={x:0,y:0,vertexCount:0};let i=0;for(const t of n)i+=t.length;let r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const t of n){if(0===t.length)continue;if(Al(t))continue;let n=0;for(let i=0;i<t.length;i++){const a=t[i];if(i>=1){const o=t[i-1];if(!bl(a,o)){r.vertexLength+4>to.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=a.sub(o)._perp()._unit(),i=o.dist(a);n+i>32768&&(n=0),_l(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,0,n),_l(this.layoutVertexArray,a.x,a.y,t.x,t.y,0,1,n),e.x+=2*a.x,e.y+=2*a.y,e.vertexCount+=2,n+=i,_l(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,0,n),_l(this.layoutVertexArray,o.x,o.y,t.x,t.y,0,1,n),e.x+=2*o.x,e.y+=2*o.y,e.vertexCount+=2;const s=r.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),r.vertexLength+=4,r.primitiveLength+=2}}}}if(r.vertexLength+i>to.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(i,this.layoutVertexArray,this.indexArray)),"Polygon"!==vl[t.type])continue;const a=[],o=[],s=r.vertexLength;for(const t of n)if(0!==t.length){t!==n[0]&&o.push(a.length/2);for(let n=0;n<t.length;n++){const i=t[n];_l(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),e.x+=i.x,e.y+=i.y,e.vertexCount+=1,a.push(i.x),a.push(i.y)}}const l=$s(a,o);for(let t=0;t<l.length;t+=3)this.indexArray.emplaceBack(s+l[t],s+l[t+2],s+l[t+1]);r.primitiveLength+=l.length/3,r.vertexLength+=i;for(let t=0;t<e.vertexCount;t++){const t=Math.floor(e.x/e.vertexCount),n=Math.floor(e.y/e.vertexCount);this.centroidVertexArray.emplaceBack(t,n)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}}function bl(t,e){return t.x===e.x&&(t.x<0||t.x>Mo)||t.y===e.y&&(t.y<0||t.y>Mo)}function Al(t){return t.every((t=>t.x<0))||t.every((t=>t.x>Mo))||t.every((t=>t.y<0))||t.every((t=>t.y>Mo))}let wl;xr("FillExtrusionBucket",xl,{omit:["layers","features"]});var Cl={get paint(){return wl=wl||new Yr({"fill-extrusion-opacity":new jr(q["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wr(q["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jr(q["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jr(q["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qr(q["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wr(q["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wr(q["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jr(q["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class El extends Qr{constructor(t){super(t,Cl)}createBucket(t){return new xl(t)}queryRadius(){return qo(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,e,n,i,r,o,s,l){const c=Zo(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),u=this.paint.get("fill-extrusion-height").evaluate(e,n),h=this.paint.get("fill-extrusion-base").evaluate(e,n),d=function(t,e,n,i){const r=[];for(const n of t){const t=[n.x,n.y,0,1];is(t,t,e),r.push(new a(t[0]/t[3],t[1]/t[3]))}return r}(c,l),p=function(t,e,n,i){const r=[],o=[],s=i[8]*e,l=i[9]*e,c=i[10]*e,u=i[11]*e,h=i[8]*n,d=i[9]*n,p=i[10]*n,m=i[11]*n;for(const e of t){const t=[],n=[];for(const r of e){const e=r.x,o=r.y,f=i[0]*e+i[4]*o+i[12],g=i[1]*e+i[5]*o+i[13],v=i[2]*e+i[6]*o+i[14],y=i[3]*e+i[7]*o+i[15],_=v+c,x=y+u,b=f+h,A=g+d,w=v+p,C=y+m,E=new a((f+s)/x,(g+l)/x);E.z=_/x,t.push(E);const S=new a(b/C,A/C);S.z=w/C,n.push(S)}r.push(t),o.push(n)}return[r,o]}(i,h,u,l);return function(t,e,n){let i=1/0;zo(n,e)&&(i=Ml(n,e[0]));for(let r=0;r<e.length;r++){const a=e[r],o=t[r];for(let t=0;t<a.length-1;t++){const e=a[t],r=[e,a[t+1],o[t+1],o[t],e];Ro(n,r)&&(i=Math.min(i,Ml(n,r)))}}return i!==1/0&&i}(p[0],p[1],d)}}function Sl(t,e){return t.x*e.x+t.y*e.y}function Ml(t,e){if(1===t.length){let n=0;const i=e[n++];let r;for(;!r||i.equals(r);)if(r=e[n++],!r)return 1/0;for(;n<e.length;n++){const a=e[n],o=t[0],s=r.sub(i),l=a.sub(i),c=o.sub(i),u=Sl(s,s),h=Sl(s,l),d=Sl(l,l),p=Sl(c,s),m=Sl(c,l),f=u*d-h*h,g=(d*p-h*m)/f,v=(u*m-h*p)/f,y=i.z*(1-g-v)+r.z*g+a.z*v;if(isFinite(y))return y}return 1/0}{let t=1/0;for(const n of e)t=Math.min(t,n.z);return t}}const Tl=ea([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Il}=Tl,Bl=ea([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Ll}=Bl,Dl=al.VectorTileFeature.types,Pl=Math.cos(Math.PI/180*37.5),Rl=Math.pow(2,14)/.5;class kl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((t=>{this.gradients[t.id]={}})),this.layoutVertexArray=new Ga,this.layoutVertexArray2=new Ha,this.indexArray=new Xa,this.programConfigurations=new Co(t.layers,t.zoom),this.segments=new to,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id))}populate(t,e,n){this.hasPattern=Ys("line",this.layers,e);const i=this.layers[0].layout.get("line-sort-key"),r=!i.isConstant(),a=[];for(const{feature:e,id:o,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,c=Lo(e,t);if(!this.layers[0]._featureFilter.filter(new kr(this.zoom),c,n))continue;const u=r?i.evaluate(c,{},n):void 0,h={id:o,properties:e.properties,type:e.type,sourceLayerIndex:l,index:s,geometry:t?c.geometry:Bo(e),patterns:{},sortKey:u};a.push(h)}r&&a.sort(((t,e)=>t.sortKey-e.sortKey));for(const i of a){const{geometry:r,index:a,sourceLayerIndex:o}=i;if(this.hasPattern){const t=Xs("line",this.layers,i,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(i,r,a,n,{});e.featureIndex.insert(t[a].feature,r,a,o,this.index)}}update(t,e,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,n)}addFeatures(t,e,n){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ll)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Il),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,n,i,r){const a=this.layers[0].layout,o=a.get("line-join").evaluate(t,{}),s=a.get("line-cap"),l=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const n of e)this.addLine(n,t,o,s,l,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,r,i)}addLine(t,e,n,i,r,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Dl[e.type];let s=t.length;for(;s>=2&&t[s-1].equals(t[s-2]);)s--;let l=0;for(;l<s-1&&t[l].equals(t[l+1]);)l++;if(s<(o?3:2))return;"bevel"===n&&(r=1.05);const c=this.overscaling<=16?15*Mo/(512*this.overscaling):0,u=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let h,d,p,m,f;this.e1=this.e2=-1,o&&(h=t[s-2],f=t[l].sub(h)._unit()._perp());for(let e=l;e<s;e++){if(p=e===s-1?o?t[l+1]:void 0:t[e+1],p&&t[e].equals(p))continue;f&&(m=f),h&&(d=h),h=t[e],f=p?p.sub(h)._unit()._perp():m,m=m||f;let g=m.add(f);0===g.x&&0===g.y||g._unit();const v=m.x*f.x+m.y*f.y,y=g.x*f.x+g.y*f.y,_=0!==y?1/y:1/0,x=2*Math.sqrt(2-2*y),b=y<Pl&&d&&p,A=m.x*f.y-m.y*f.x>0;if(b&&e>l){const t=h.dist(d);if(t>2*c){const e=h.sub(h.sub(d)._mult(c/t)._round());this.updateDistance(d,e),this.addCurrentVertex(e,m,0,0,u),d=e}}const w=d&&p;let C=w?n:o?"butt":i;if(w&&"round"===C&&(_<a?C="miter":_<=2&&(C="fakeround")),"miter"===C&&_>r&&(C="bevel"),"bevel"===C&&(_>2&&(C="flipbevel"),_<r&&(C="miter")),d&&this.updateDistance(d,h),"miter"===C)g._mult(_),this.addCurrentVertex(h,g,0,0,u);else if("flipbevel"===C){if(_>100)g=f.mult(-1);else{const t=_*m.add(f).mag()/m.sub(f).mag();g._perp()._mult(t*(A?-1:1))}this.addCurrentVertex(h,g,0,0,u),this.addCurrentVertex(h,g.mult(-1),0,0,u)}else if("bevel"===C||"fakeround"===C){const t=-Math.sqrt(_*_-1),e=A?t:0,n=A?0:t;if(d&&this.addCurrentVertex(h,m,e,n,u),"fakeround"===C){const t=Math.round(180*x/Math.PI/20);for(let e=1;e<t;e++){let n=e/t;if(.5!==n){const t=n-.5;n+=n*t*(n-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*t*t+(.848013+v*(.215638*v-1.06021)))}const i=f.sub(m)._mult(n)._add(m)._unit()._mult(A?-1:1);this.addHalfVertex(h,i.x,i.y,!1,A,0,u)}}p&&this.addCurrentVertex(h,f,-e,-n,u)}else if("butt"===C)this.addCurrentVertex(h,g,0,0,u);else if("square"===C){const t=d?1:-1;this.addCurrentVertex(h,g,t,t,u)}else"round"===C&&(d&&(this.addCurrentVertex(h,m,0,0,u),this.addCurrentVertex(h,m,1,1,u,!0)),p&&(this.addCurrentVertex(h,f,-1,-1,u,!0),this.addCurrentVertex(h,f,0,0,u)));if(b&&e<s-1){const t=h.dist(p);if(t>2*c){const e=h.add(p.sub(h)._mult(c/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,f,0,0,u),h=e}}}}addCurrentVertex(t,e,n,i,r,a=!1){const o=e.y*i-e.x,s=-e.y-e.x*i;this.addHalfVertex(t,e.x+e.y*n,e.y-e.x*n,a,!1,n,r),this.addHalfVertex(t,o,s,a,!0,-i,r),this.distance>Rl/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,e,n,i,r,a))}addHalfVertex({x:t,y:e},n,i,r,a,o,s){const l=.5*(this.lineClips?this.scaledDistance*(Rl-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(r?1:0),(e<<1)+(a?1:0),Math.round(63*n)+128,Math.round(63*i)+128,1+(0===o?0:o<0?-1:1)|(63&l)<<2,l>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),s.primitiveLength++),a?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}let zl,Fl;xr("LineBucket",kl,{omit:["layers","patternFeatures"]});var Ol={get paint(){return Fl=Fl||new Yr({"line-opacity":new Wr(q.paint_line["line-opacity"]),"line-color":new Wr(q.paint_line["line-color"]),"line-translate":new jr(q.paint_line["line-translate"]),"line-translate-anchor":new jr(q.paint_line["line-translate-anchor"]),"line-width":new Wr(q.paint_line["line-width"]),"line-gap-width":new Wr(q.paint_line["line-gap-width"]),"line-offset":new Wr(q.paint_line["line-offset"]),"line-blur":new Wr(q.paint_line["line-blur"]),"line-dasharray":new Zr(q.paint_line["line-dasharray"]),"line-pattern":new qr(q.paint_line["line-pattern"]),"line-gradient":new $r(q.paint_line["line-gradient"])})},get layout(){return zl=zl||new Yr({"line-cap":new jr(q.layout_line["line-cap"]),"line-join":new Wr(q.layout_line["line-join"]),"line-miter-limit":new jr(q.layout_line["line-miter-limit"]),"line-round-limit":new jr(q.layout_line["line-round-limit"]),"line-sort-key":new Wr(q.layout_line["line-sort-key"])})}};class Nl extends Wr{possiblyEvaluate(t,e){return e=new kr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,i){return e=v({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,i)}}let Ul;class Vl extends Qr{constructor(t){super(t,Ol),this.gradientVersion=0,Ul||(Ul=new Nl(Ol.paint.properties["line-width"].specification),Ul.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this.gradientExpression();this.stepInterpolant=!!function(t){return void 0!==t._styleExpression}(t)&&t._styleExpression.expression instanceof we,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Ul.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new kl(t)}queryRadius(t){const e=t,n=Gl(Wo("line-width",this,e),Wo("line-gap-width",this,e)),i=Wo("line-offset",this,e);return n/2+Math.abs(i)+qo(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,i,r,o,s){const l=Zo(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),c=s/2*Gl(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),u=this.paint.get("line-offset").evaluate(e,n);return u&&(i=function(t,e){const n=[];for(let i=0;i<t.length;i++){const r=t[i],o=[];for(let t=0;t<r.length;t++){const n=r[t-1],i=r[t],s=r[t+1],l=0===t?new a(0,0):i.sub(n)._unit()._perp(),c=t===r.length-1?new a(0,0):s.sub(i)._unit()._perp(),u=l._add(c)._unit(),h=u.x*c.x+u.y*c.y;0!==h&&u._mult(1/h),o.push(u._mult(e)._add(i))}n.push(o)}return n}(i,u*s)),function(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];if(t.length>=3)for(let e=0;e<r.length;e++)if(Ho(t,r[e]))return!0;if(Fo(t,r,n))return!0}return!1}(l,i,c)}isTileClipped(){return!0}}function Gl(t,e){return e>0?e+2*t:t}const Hl=ea([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jl=ea([{name:"a_projected_pos",components:3,type:"Float32"}],4);ea([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wl=ea([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ea([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ql=ea([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zl=ea([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $l(t,e,n){return t.sections.forEach((t=>{t.text=function(t,e,n){const i=e.layout.get("text-transform").evaluate(n,{});return"uppercase"===i?t=t.toLocaleUpperCase():"lowercase"===i&&(t=t.toLocaleLowerCase()),Rr.applyArabicShaping&&(t=Rr.applyArabicShaping(t)),t}(t.text,e,n)})),t}ea([{name:"triangle",components:3,type:"Uint16"}]),ea([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ea([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ea([{type:"Float32",name:"offsetX"}]),ea([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ea([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Yl={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Xl=24,Ql=tc,Jl=function(t,e,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,p=t[e+h];for(h+=d,a=p&(1<<-u)-1,p>>=-u,u+=s;u>0;a=256*a+t[e+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=i;u>0;o=256*o+t[e+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),a-=c}return(p?-1:1)*o*Math.pow(2,a-i)},Kl=function(t,e,n,i,r,a){var o,s,l,c=8*a-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:a-1,m=i?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(e*l-1)*Math.pow(2,r),o+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;t[n+p]=255&s,p+=m,s/=256,r-=8);for(o=o<<r|s,c+=r;c>0;t[n+p]=255&o,p+=m,o/=256,c-=8);t[n+p-m]|=128*f};function tc(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}tc.Varint=0,tc.Fixed64=1,tc.Bytes=2,tc.Fixed32=5;var ec=4294967296,nc=1/ec,ic="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function rc(t){return t.type===tc.Bytes?t.readVarint()+t.pos:t.pos+1}function ac(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function oc(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function sc(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function lc(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function cc(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function uc(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function hc(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function dc(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function pc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function mc(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function fc(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function gc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function vc(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function yc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}tc.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,a=this.pos;this.type=7&i,t(r,e,this),this.pos===a&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=gc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=yc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=gc(this.buf,this.pos)+gc(this.buf,this.pos+4)*ec;return this.pos+=8,t},readSFixed64:function(){var t=gc(this.buf,this.pos)+yc(this.buf,this.pos+4)*ec;return this.pos+=8,t},readFloat:function(){var t=Jl(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Jl(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,a=n.buf;if(i=(112&(r=a[n.pos++]))>>4,r<128)return ac(t,i,e);if(i|=(127&(r=a[n.pos++]))<<3,r<128)return ac(t,i,e);if(i|=(127&(r=a[n.pos++]))<<10,r<128)return ac(t,i,e);if(i|=(127&(r=a[n.pos++]))<<17,r<128)return ac(t,i,e);if(i|=(127&(r=a[n.pos++]))<<24,r<128)return ac(t,i,e);if(i|=(1&(r=a[n.pos++]))<<31,r<128)return ac(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&ic?function(t,e,n){return ic.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var a,o,s,l=t[r],c=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(c=l):2===u?128==(192&(a=t[r+1]))&&(c=(31&l)<<6|63&a)<=127&&(c=null):3===u?(o=t[r+2],128==(192&(a=t[r+1]))&&128==(192&o)&&((c=(15&l)<<12|(63&a)<<6|63&o)<=2047||c>=55296&&c<=57343)&&(c=null)):4===u&&(o=t[r+2],s=t[r+3],128==(192&(a=t[r+1]))&&128==(192&o)&&128==(192&s)&&((c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,u=1):c>65535&&(c-=65536,i+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),i+=String.fromCharCode(c),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==tc.Bytes)return t.push(this.readVarint(e));var n=rc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==tc.Bytes)return t.push(this.readSVarint());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==tc.Bytes)return t.push(this.readBoolean());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==tc.Bytes)return t.push(this.readFloat());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==tc.Bytes)return t.push(this.readDouble());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==tc.Bytes)return t.push(this.readFixed32());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==tc.Bytes)return t.push(this.readSFixed32());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==tc.Bytes)return t.push(this.readFixed64());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==tc.Bytes)return t.push(this.readSFixed64());var e=rc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===tc.Varint)for(;this.buf[this.pos++]>127;);else if(e===tc.Bytes)this.pos=this.readVarint()+this.pos;else if(e===tc.Fixed32)this.pos+=4;else{if(e!==tc.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),vc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),vc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),vc(this.buf,-1&t,this.pos),vc(this.buf,Math.floor(t*nc),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),vc(this.buf,-1&t,this.pos),vc(this.buf,Math.floor(t*nc),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,n.buf[n.pos]=127&(t>>>=7)}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,a=0;a<e.length;a++){if((i=e.charCodeAt(a))>55295&&i<57344){if(!r){i>56319||a+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&oc(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Kl(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Kl(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&oc(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,tc.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,sc,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,lc,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,hc,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,cc,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,uc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,dc,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,pc,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,mc,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,fc,e)},writeBytesField:function(t,e){this.writeTag(t,tc.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,tc.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,tc.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,tc.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,tc.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,tc.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,tc.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,tc.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,tc.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,tc.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var _c=n(Ql);const xc=3;function bc(t,e,n){1===t&&n.readMessage(Ac,e)}function Ac(t,e,n){if(3===t){const{id:t,bitmap:i,width:r,height:a,left:o,top:s,advance:l}=n.readMessage(wc,{});e.push({id:t,bitmap:new ds({width:r+2*xc,height:a+2*xc},i),metrics:{width:r,height:a,left:o,top:s,advance:l}})}}function wc(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}const Cc=xc;function Ec(t){let e=0,n=0;for(const i of t)e+=i.w*i.h,n=Math.max(n,i.w);t.sort(((t,e)=>e.h-t.h));const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let r=0,a=0;for(const e of t)for(let t=i.length-1;t>=0;t--){const n=i[t];if(!(e.w>n.w||e.h>n.h)){if(e.x=n.x,e.y=n.y,a=Math.max(a,e.y+e.h),r=Math.max(r,e.x+e.w),e.w===n.w&&e.h===n.h){const e=i.pop();t<i.length&&(i[t]=e)}else e.h===n.h?(n.x+=e.w,n.w-=e.w):e.w===n.w?(n.y+=e.h,n.h-=e.h):(i.push({x:n.x+e.w,y:n.y,w:n.w-e.w,h:e.h}),n.y+=e.h,n.h-=e.h);break}}return{w:r,h:a,fill:e/(r*a)||0}}const Sc=1;class Mc{constructor(t,{pixelRatio:e,version:n,stretchX:i,stretchY:r,content:a,textFitWidth:o,textFitHeight:s}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=i,this.stretchY=r,this.content=a,this.version=n,this.textFitWidth=o,this.textFitHeight=s}get tl(){return[this.paddedRect.x+Sc,this.paddedRect.y+Sc]}get br(){return[this.paddedRect.x+this.paddedRect.w-Sc,this.paddedRect.y+this.paddedRect.h-Sc]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Sc)/this.pixelRatio,(this.paddedRect.h-2*Sc)/this.pixelRatio]}}class Tc{constructor(t,e){const n={},i={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,n,r),this.addImages(e,i,r);const{w:a,h:o}=Ec(r),s=new ps({width:a||1,height:o||1});for(const e in t){const i=t[e],r=n[e].paddedRect;ps.copy(i.data,s,{x:0,y:0},{x:r.x+Sc,y:r.y+Sc},i.data)}for(const t in e){const n=e[t],r=i[t].paddedRect,a=r.x+Sc,o=r.y+Sc,l=n.data.width,c=n.data.height;ps.copy(n.data,s,{x:0,y:0},{x:a,y:o},n.data),ps.copy(n.data,s,{x:0,y:c-1},{x:a,y:o-1},{width:l,height:1}),ps.copy(n.data,s,{x:0,y:0},{x:a,y:o+c},{width:l,height:1}),ps.copy(n.data,s,{x:l-1,y:0},{x:a-1,y:o},{width:1,height:c}),ps.copy(n.data,s,{x:0,y:0},{x:a+l,y:o},{width:1,height:c})}this.image=s,this.iconPositions=n,this.patternPositions=i}addImages(t,e,n){for(const i in t){const r=t[i],a={x:0,y:0,w:r.data.width+2*Sc,h:r.data.height+2*Sc};n.push(a),e[i]=new Mc(a,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),e),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),e)}patchUpdatedImage(t,e,n){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[i,r]=t.tl;n.update(e.data,void 0,{x:i,y:r})}}var Ic;xr("ImagePosition",Mc),xr("ImageAtlas",Tc),t.ah=void 0,(Ic=t.ah||(t.ah={}))[Ic.none=0]="none",Ic[Ic.horizontal=1]="horizontal",Ic[Ic.vertical=2]="vertical",Ic[Ic.horizontalOnly=3]="horizontalOnly";const Bc=-17;class Lc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const n=new Lc;return n.scale=t||1,n.fontStack=e,n}static forImage(t){const e=new Lc;return e.imageName=t,e}}class Dc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const n=new Dc;for(let i=0;i<t.sections.length;i++){const r=t.sections[i];r.image?n.addImageSection(r):n.addTextSection(r,e)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let n=0;n<t.length;n++){const i=t.charCodeAt(n+1)||null,r=t.charCodeAt(n-1)||null;e+=i&&Br(i)&&!Yl[t[n+1]]||r&&Br(r)&&!Yl[t[n-1]]||!Yl[t[n]]?t[n]:Yl[t[n]]}return e}(this.text)}trim(){let t=0;for(let e=0;e<this.text.length&&Rc[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&Rc[this.text.charCodeAt(n)];n--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const n=new Dc;return n.text=this.text.substring(t,e),n.sectionIndex=this.sectionIndex.slice(t,e),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,e)=>Math.max(t,this.sections[e].scale)),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(Lc.forText(t.scale,t.fontStack||e));const n=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(n)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void w("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Lc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Pc(e,n,i,r,a,o,s,l,c,u,h,d,p,m,f){const g=Dc.fromFeature(e,a);let v;d===t.ah.vertical&&g.verticalizePunctuation();const{processBidirectionalText:y,processStyledBidirectionalText:_}=Rr;if(y&&1===g.sections.length){v=[];const t=y(g.toString(),Gc(g,u,o,n,r,m));for(const e of t){const t=new Dc;t.text=e,t.sections=g.sections;for(let n=0;n<e.length;n++)t.sectionIndex.push(0);v.push(t)}}else if(_){v=[];const t=_(g.text,g.sectionIndex,Gc(g,u,o,n,r,m));for(const e of t){const t=new Dc;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,v.push(t)}}else v=function(t,e){const n=[],i=t.text;let r=0;for(const i of e)n.push(t.substring(r,i)),r=i;return r<i.length&&n.push(t.substring(r,i.length)),n}(g,Gc(g,u,o,n,r,m));const x=[],b={positionedLines:x,text:g.toString(),top:h[1],bottom:h[1],left:h[0],right:h[0],writingMode:d,iconsInText:!1,verticalizable:!1};return function(e,n,i,r,a,o,s,l,c,u,h,d){let p=0,m=Bc,f=0,g=0;const v="right"===l?1:"left"===l?0:.5;let y=0;for(const s of a){s.trim();const a=s.getMaxScale(),l=(a-1)*Xl,x={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=x;const b=x.positionedGlyphs;let A=0;if(!s.length()){m+=o,++y;continue}for(let o=0;o<s.length();o++){const f=s.getSection(o),g=s.getSectionIndex(o),v=s.getCharCode(o);let y=0,x=null,w=null,C=null,E=Xl;const S=!(c===t.ah.horizontal||!h&&!Ir(v)||h&&(Rc[v]||(_=v,Er.Arabic(_)||Er["Arabic Supplement"](_)||Er["Arabic Extended-A"](_)||Er["Arabic Presentation Forms-A"](_)||Er["Arabic Presentation Forms-B"](_))));if(f.imageName){const t=r[f.imageName];if(!t)continue;C=f.imageName,e.iconsInText=e.iconsInText||!0,w=t.paddedRect;const n=t.displaySize;f.scale=f.scale*Xl/d,x={width:n[0],height:n[1],left:Sc,top:-Cc,advance:S?n[1]:n[0]},y=l+(Xl-n[1]*f.scale),E=x.advance;const i=S?n[0]*f.scale-Xl*a:n[1]*f.scale-Xl*a;i>0&&i>A&&(A=i)}else{const t=i[f.fontStack],e=t&&t[v];if(e&&e.rect)w=e.rect,x=e.metrics;else{const t=n[f.fontStack],e=t&&t[v];if(!e)continue;x=e.metrics}y=(a-f.scale)*Xl}S?(e.verticalizable=!0,b.push({glyph:v,imageName:C,x:p,y:m+y,vertical:S,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:x,rect:w}),p+=E*f.scale+u):(b.push({glyph:v,imageName:C,x:p,y:m+y,vertical:S,scale:f.scale,fontStack:f.fontStack,sectionIndex:g,metrics:x,rect:w}),p+=x.advance*f.scale+u)}0!==b.length&&(f=Math.max(p-u,f),jc(b,0,b.length-1,v,A)),p=0;const w=o*a+A;x.lineOffset=Math.max(A,l),m+=w,g=Math.max(w,g),++y}var _;const x=m-Bc,{horizontalAlign:b,verticalAlign:A}=Hc(s);(function(t,e,n,i,r,a,o,s,l){const c=(e-n)*r;let u=0;u=a!==o?-s*i-Bc:(-i*l+.5)*o;for(const e of t)for(const t of e.positionedGlyphs)t.x+=c,t.y+=u})(e.positionedLines,v,b,A,f,g,o,x,a.length),e.top+=-A*x,e.bottom=e.top+x,e.left+=-b*f,e.right=e.left+f}(b,n,i,r,v,s,l,c,d,u,p,f),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(x)&&b}const Rc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kc={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},zc={40:!0};function Fc(t,e,n,i,r,a){if(e.imageName){const t=i[e.imageName];return t?t.displaySize[0]*e.scale*Xl/a+r:0}{const i=n[e.fontStack],a=i&&i[t];return a?a.metrics.advance*e.scale+r:0}}function Oc(t,e,n,i){const r=Math.pow(t-e,2);return i?t<e?r/2:2*r:r+Math.abs(n)*n}function Nc(t,e,n){let i=0;return 10===t&&(i-=1e4),n&&(i+=150),40!==t&&65288!==t||(i+=50),41!==e&&65289!==e||(i+=50),i}function Uc(t,e,n,i,r,a){let o=null,s=Oc(e,n,r,a);for(const t of i){const i=Oc(e-t.x,n,r,a)+t.badness;i<=s&&(o=t,s=i)}return{index:t,x:e,priorBreak:o,badness:s}}function Vc(t){return t?Vc(t.priorBreak).concat(t.index):[]}function Gc(t,e,n,i,r,a){if(!t)return[];const o=[],s=function(t,e,n,i,r,a){let o=0;for(let n=0;n<t.length();n++){const s=t.getSection(n);o+=Fc(t.getCharCode(n),s,i,r,e,a)}return o/Math.max(1,Math.ceil(o/n))}(t,e,n,i,r,a),l=t.text.indexOf("")>=0;let c=0;for(let n=0;n<t.length();n++){const h=t.getSection(n),d=t.getCharCode(n);if(Rc[d]||(c+=Fc(d,h,i,r,e,a)),n<t.length()-1){const e=!((u=d)<11904||!(Er["Bopomofo Extended"](u)||Er.Bopomofo(u)||Er["CJK Compatibility Forms"](u)||Er["CJK Compatibility Ideographs"](u)||Er["CJK Compatibility"](u)||Er["CJK Radicals Supplement"](u)||Er["CJK Strokes"](u)||Er["CJK Symbols and Punctuation"](u)||Er["CJK Unified Ideographs Extension A"](u)||Er["CJK Unified Ideographs"](u)||Er["Enclosed CJK Letters and Months"](u)||Er["Halfwidth and Fullwidth Forms"](u)||Er.Hiragana(u)||Er["Ideographic Description Characters"](u)||Er["Kangxi Radicals"](u)||Er["Katakana Phonetic Extensions"](u)||Er.Katakana(u)||Er["Vertical Forms"](u)||Er["Yi Radicals"](u)||Er["Yi Syllables"](u)));(kc[d]||e||h.imageName||n!==t.length()-2&&zc[t.getCharCode(n+1)])&&o.push(Uc(n+1,c,s,o,Nc(d,t.getCharCode(n+1),e&&l),!1))}}var u;return Vc(Uc(t.length(),c,s,o,0,!0))}function Hc(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function jc(t,e,n,i,r){if(!i&&!r)return;const a=t[n],o=(t[n].x+a.metrics.advance*a.scale)*i;for(let i=e;i<=n;i++)t[i].x-=o,t[i].y+=r}function Wc(t,e,n){const{horizontalAlign:i,verticalAlign:r}=Hc(n),a=e[0]-t.displaySize[0]*i,o=e[1]-t.displaySize[1]*r;return{image:t,top:o,bottom:o+t.displaySize[1],left:a,right:a+t.displaySize[0]}}function qc(t){var e,n;let i=t.left,r=t.top,a=t.right-i,o=t.bottom-r;const s=null!==(e=t.image.textFitWidth)&&void 0!==e?e:"stretchOrShrink",l=null!==(n=t.image.textFitHeight)&&void 0!==n?n:"stretchOrShrink",c=(t.image.content[2]-t.image.content[0])/(t.image.content[3]-t.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&a/o<c||"proportional"===s){const t=Math.ceil(o*c);i*=t/a,a=t}}else if("proportional"===s&&"stretchOnly"===l&&0!==c&&a/o>c){const t=Math.ceil(a/c);r*=t/o,o=t}return{x1:i,y1:r,x2:i+a,y2:r+o}}function Zc(t,e,n,i,r,a){const o=t.image;let s;if(o.content){const t=o.content,e=o.pixelRatio||1;s=[t[0]/e,t[1]/e,o.displaySize[0]-t[2]/e,o.displaySize[1]-t[3]/e]}const l=e.left*a,c=e.right*a;let u,h,d,p;"width"===n||"both"===n?(p=r[0]+l-i[3],h=r[0]+c+i[1]):(p=r[0]+(l+c-o.displaySize[0])/2,h=p+o.displaySize[0]);const m=e.top*a,f=e.bottom*a;return"height"===n||"both"===n?(u=r[1]+m-i[0],d=r[1]+f+i[2]):(u=r[1]+(m+f-o.displaySize[1])/2,d=u+o.displaySize[1]),{image:o,top:u,right:h,bottom:d,left:p,collisionPadding:s}}const $c=255,Yc=128,Xc=$c*Yc;function Qc(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new kr(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:i}=n;let r=0;for(;r<e.length&&e[r]<=t;)r++;r=Math.max(0,r-1);let a=r;for(;a<e.length&&e[a]<t+1;)a++;a=Math.min(e.length-1,a);const o=e[r],s=e[a];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:i}:{kind:"camera",minZoom:o,maxZoom:s,minSize:n.evaluate(new kr(o)),maxSize:n.evaluate(new kr(s)),interpolationType:i}}}function Jc(t,e,n){let i="never";const r=t.get(e);return r?i=r:t.get(n)&&(i="always"),i}const Kc=al.VectorTileFeature.types,tu=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function eu(t,e,n,i,r,a,o,s,l,c,u,h,d){const p=s?Math.min(Xc,Math.round(s[0])):0,m=s?Math.min(Xc,Math.round(s[1])):0;t.emplaceBack(e,n,Math.round(32*i),Math.round(32*r),a,o,(p<<1)+(l?1:0),m,16*c,16*u,256*h,256*d)}function nu(t,e,n){t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n),t.emplaceBack(e.x,e.y,n)}function iu(t){for(const e of t.sections)if(Pr(e.text))return!0;return!1}class ru{constructor(t){this.layoutVertexArray=new Wa,this.indexArray=new Xa,this.programConfigurations=t,this.segments=new to,this.dynamicLayoutVertexArray=new qa,this.opacityVertexArray=new Za,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ia}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Hl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jl.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,tu,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xr("SymbolBuffers",ru);class au{constructor(t,e,n){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new n,this.segments=new to,this.collisionVertexArray=new Ya}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Wl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xr("CollisionBuffers",au);class ou{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((t=>t.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ko([]),this.placementViewportMatrix=Ko([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qc(this.zoom,n["text-size"]),this.iconSizeData=Qc(this.zoom,n["icon-size"]);const i=this.layers[0].layout,r=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap="never"!==Jc(i,"text-overlap","text-allow-overlap")||"never"!==Jc(i,"icon-overlap","icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!r.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map((e=>t.ah[e]))),this.stateDependentLayerIds=this.layers.filter((t=>t.isStateDependent())).map((t=>t.id)),this.sourceID=e.sourceID}createArrays(){this.text=new ru(new Co(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new ru(new Co(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new Da,this.lineVertexArray=new Pa,this.symbolInstances=new La,this.textAnchorOffsets=new ka}calculateGlyphDependencies(t,e,n,i,r){for(let a=0;a<t.length;a++)if(e[t.charCodeAt(a)]=!0,(n||i)&&r){const n=Yl[t.charAt(a)];n&&(e[n.charCodeAt(0)]=!0)}}populate(e,n,i){const r=this.layers[0],a=r.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),c=("constant"!==s.value.kind||s.value.value instanceof Xt&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,h=a.get("symbol-sort-key");if(this.features=[],!c&&!u)return;const d=n.iconDependencies,p=n.glyphDependencies,m=n.availableImages,f=new kr(this.zoom);for(const{feature:n,id:s,index:l,sourceLayerIndex:g}of e){const e=r._featureFilter.needGeometry,v=Lo(n,e);if(!r._featureFilter.filter(f,v,i))continue;let y,_;if(e||(v.geometry=Bo(n)),c){const t=r.getValueAndResolveTokens("text-field",v,i,m),e=Xt.factory(t),n=this.hasRTLText=this.hasRTLText||iu(e);(!n||"unavailable"===Rr.getRTLTextPluginStatus()||n&&Rr.isParsed())&&(y=$l(e,r,v))}if(u){const t=r.getValueAndResolveTokens("icon-image",v,i,m);_=t instanceof te?t:te.fromString(t)}if(!y&&!_)continue;const x=this.sortFeaturesByKey?h.evaluate(v,{},i):void 0;if(this.features.push({id:s,text:y,icon:_,index:l,sourceLayerIndex:g,geometry:v.geometry,properties:n.properties,type:Kc[n.type],sortKey:x}),_&&(d[_.name]=!0),y){const e=o.evaluate(v,{},i).join(","),n="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(t.ah.vertical)>=0;for(const t of y.sections)if(t.image)d[t.image.name]=!0;else{const i=Sr(y.toString()),r=t.fontStack||e,a=p[r]=p[r]||{};this.calculateGlyphDependencies(t.text,a,n,this.allowVerticalPlacement,i)}}}"line"===a.get("symbol-placement")&&(this.features=function(t){const e={},n={},i=[];let r=0;function a(e){i.push(t[e]),r++}function o(t,e,r){const a=n[t];return delete n[t],n[e]=a,i[a].geometry[0].pop(),i[a].geometry[0]=i[a].geometry[0].concat(r[0]),a}function s(t,n,r){const a=e[n];return delete e[n],e[t]=a,i[a].geometry[0].shift(),i[a].geometry[0]=r[0].concat(i[a].geometry[0]),a}function l(t,e,n){const i=n?e[0][e[0].length-1]:e[0][0];return`${t}:${i.x}:${i.y}`}for(let c=0;c<t.length;c++){const u=t[c],h=u.geometry,d=u.text?u.text.toString():null;if(!d){a(c);continue}const p=l(d,h),m=l(d,h,!0);if(p in n&&m in e&&n[p]!==e[m]){const t=s(p,m,h),r=o(p,m,i[t].geometry);delete e[p],delete n[m],n[l(d,i[r].geometry,!0)]=r,i[t].geometry=null}else p in n?o(p,m,h):m in e?s(p,m,h):(a(c),e[p]=r-1,n[m]=r-1)}return i.filter((t=>t.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((t,e)=>t.sortKey-e.sortKey))}update(t,e,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const n=this.lineVertexArray.length;if(void 0!==t.segment){let n=t.dist(e[t.segment+1]),i=t.dist(e[t.segment]);const r={};for(let i=t.segment+1;i<e.length;i++)r[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:n},i<e.length-1&&(n+=e[i+1].dist(e[i]));for(let n=t.segment||0;n>=0;n--)r[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:i},n>0&&(i+=e[n-1].dist(e[n]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(e,n,i,r,a,o,s,l,c,u,h,d){const p=e.indexArray,m=e.layoutVertexArray,f=e.segments.prepareSegment(4*n.length,m,p,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,v=f.vertexLength,y=this.allowVerticalPlacement&&s===t.ah.vertical?Math.PI/2:0,_=o.text&&o.text.sections;for(let t=0;t<n.length;t++){const{tl:r,tr:a,bl:s,br:c,tex:u,pixelOffsetTL:h,pixelOffsetBR:g,minFontScaleX:v,minFontScaleY:x,glyphOffset:b,isSDF:A,sectionIndex:w}=n[t],C=f.vertexLength,E=b[1];eu(m,l.x,l.y,r.x,E+r.y,u.x,u.y,i,A,h.x,h.y,v,x),eu(m,l.x,l.y,a.x,E+a.y,u.x+u.w,u.y,i,A,g.x,h.y,v,x),eu(m,l.x,l.y,s.x,E+s.y,u.x,u.y+u.h,i,A,h.x,g.y,v,x),eu(m,l.x,l.y,c.x,E+c.y,u.x+u.w,u.y+u.h,i,A,g.x,g.y,v,x),nu(e.dynamicLayoutVertexArray,l,y),p.emplaceBack(C,C+1,C+2),p.emplaceBack(C+1,C+2,C+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),t!==n.length-1&&w===n[t+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,o,o.index,{},d,_&&_[w])}e.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,v,c,u,l.segment,i?i[0]:0,i?i[1]:0,r[0],r[1],s,0,!1,0,h)}_addCollisionDebugVertex(t,e,n,i,r,a){return e.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,r,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,e,n,i,r,o,s){const l=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),c=l.vertexLength,u=r.layoutVertexArray,h=r.collisionVertexArray,d=s.anchorX,p=s.anchorY;this._addCollisionDebugVertex(u,h,o,d,p,new a(t,e)),this._addCollisionDebugVertex(u,h,o,d,p,new a(n,e)),this._addCollisionDebugVertex(u,h,o,d,p,new a(n,i)),this._addCollisionDebugVertex(u,h,o,d,p,new a(t,i)),l.vertexLength+=4;const m=r.indexArray;m.emplaceBack(c,c+1),m.emplaceBack(c+1,c+2),m.emplaceBack(c+2,c+3),m.emplaceBack(c+3,c),l.primitiveLength+=4}addDebugCollisionBoxes(t,e,n,i){for(let r=t;r<e;r++){const t=this.collisionBoxArray.get(r);this.addCollisionDebugVertices(t.x1,t.y1,t.x2,t.y2,i?this.textCollisionBox:this.iconCollisionBox,t.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new au($a,ql.members,Qa),this.iconCollisionBox=new au($a,ql.members,Qa);for(let t=0;t<this.symbolInstances.length;t++){const e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}}_deserializeCollisionBoxesForSymbol(t,e,n,i,r,a,o,s,l){const c={};for(let i=e;i<n;i++){const e=t.get(i);c.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},c.textFeatureIndex=e.featureIndex;break}for(let e=i;e<r;e++){const n=t.get(e);c.verticalTextBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.verticalTextFeatureIndex=n.featureIndex;break}for(let e=a;e<o;e++){const n=t.get(e);c.iconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.iconFeatureIndex=n.featureIndex;break}for(let e=s;e<l;e++){const n=t.get(e);c.verticalIconBox={x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2,anchorPointX:n.anchorPointX,anchorPointY:n.anchorPointY},c.verticalIconFeatureIndex=n.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const n=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const n=t.placedSymbolArray.get(e),i=n.vertexStartIndex+4*n.numGlyphs;for(let e=n.vertexStartIndex;e<i;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),n=Math.cos(t),i=[],r=[],a=[];for(let t=0;t<this.symbolInstances.length;++t){a.push(t);const o=this.symbolInstances.get(t);i.push(0|Math.round(e*o.anchorX+n*o.anchorY)),r.push(o.featureIndex)}return a.sort(((t,e)=>i[t]-i[e]||r[e]-r[t])),a}addToSortKeyRanges(t,e){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===e?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(((t,e,n)=>{t>=0&&n.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)})),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let su,lu;xr("SymbolBucket",ou,{omit:["layers","collisionBoxArray","features","compareText"]}),ou.MAX_GLYPHS=65535,ou.addDynamicAttributes=nu;var cu={get paint(){return lu=lu||new Yr({"icon-opacity":new Wr(q.paint_symbol["icon-opacity"]),"icon-color":new Wr(q.paint_symbol["icon-color"]),"icon-halo-color":new Wr(q.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wr(q.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wr(q.paint_symbol["icon-halo-blur"]),"icon-translate":new jr(q.paint_symbol["icon-translate"]),"icon-translate-anchor":new jr(q.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wr(q.paint_symbol["text-opacity"]),"text-color":new Wr(q.paint_symbol["text-color"],{runtimeType:dt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Wr(q.paint_symbol["text-halo-color"]),"text-halo-width":new Wr(q.paint_symbol["text-halo-width"]),"text-halo-blur":new Wr(q.paint_symbol["text-halo-blur"]),"text-translate":new jr(q.paint_symbol["text-translate"]),"text-translate-anchor":new jr(q.paint_symbol["text-translate-anchor"])})},get layout(){return su=su||new Yr({"symbol-placement":new jr(q.layout_symbol["symbol-placement"]),"symbol-spacing":new jr(q.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jr(q.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wr(q.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jr(q.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jr(q.layout_symbol["icon-allow-overlap"]),"icon-overlap":new jr(q.layout_symbol["icon-overlap"]),"icon-ignore-placement":new jr(q.layout_symbol["icon-ignore-placement"]),"icon-optional":new jr(q.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jr(q.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wr(q.layout_symbol["icon-size"]),"icon-text-fit":new jr(q.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jr(q.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wr(q.layout_symbol["icon-image"]),"icon-rotate":new Wr(q.layout_symbol["icon-rotate"]),"icon-padding":new Wr(q.layout_symbol["icon-padding"]),"icon-keep-upright":new jr(q.layout_symbol["icon-keep-upright"]),"icon-offset":new Wr(q.layout_symbol["icon-offset"]),"icon-anchor":new Wr(q.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jr(q.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jr(q.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jr(q.layout_symbol["text-rotation-alignment"]),"text-field":new Wr(q.layout_symbol["text-field"]),"text-font":new Wr(q.layout_symbol["text-font"]),"text-size":new Wr(q.layout_symbol["text-size"]),"text-max-width":new Wr(q.layout_symbol["text-max-width"]),"text-line-height":new jr(q.layout_symbol["text-line-height"]),"text-letter-spacing":new Wr(q.layout_symbol["text-letter-spacing"]),"text-justify":new Wr(q.layout_symbol["text-justify"]),"text-radial-offset":new Wr(q.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jr(q.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Wr(q.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Wr(q.layout_symbol["text-anchor"]),"text-max-angle":new jr(q.layout_symbol["text-max-angle"]),"text-writing-mode":new jr(q.layout_symbol["text-writing-mode"]),"text-rotate":new Wr(q.layout_symbol["text-rotate"]),"text-padding":new jr(q.layout_symbol["text-padding"]),"text-keep-upright":new jr(q.layout_symbol["text-keep-upright"]),"text-transform":new Wr(q.layout_symbol["text-transform"]),"text-offset":new Wr(q.layout_symbol["text-offset"]),"text-allow-overlap":new jr(q.layout_symbol["text-allow-overlap"]),"text-overlap":new jr(q.layout_symbol["text-overlap"]),"text-ignore-placement":new jr(q.layout_symbol["text-ignore-placement"]),"text-optional":new jr(q.layout_symbol["text-optional"])})}};class uu{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:lt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xr("FormatSectionOverride",uu,{omit:["defaultValue"]});class hu extends Qr{constructor(t){super(t,cu)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const n of t)e.indexOf(n)<0&&e.push(n);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,n,i){const r=this.layout.get(t).evaluate(e,{},n,i),a=this._unevaluatedLayout._values[t];return a.isDataDriven()||_i(a.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,((e,n)=>t&&n in t?String(t[n]):""))}(e.properties,r)}createBucket(t){return new ou(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of cu.paint.overridableProperties){if(!hu.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),n=new uu(e),i=new yi(n,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new bi("source",i):new Ai("composite",i,e.value.zoomStops),this.paint._values[t]=new Gr(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,n){return!(!this.layout||e.isDataDriven()||n.isDataDriven())&&hu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const n=t.get("text-field"),i=cu.paint.properties[e];let r=!1;const a=t=>{for(const e of t)if(i.overrides&&i.overrides.hasOverride(e))return void(r=!0)};if("constant"===n.value.kind&&n.value.value instanceof Xt)a(n.value.value.sections);else if("source"===n.value.kind){const t=e=>{r||(e instanceof ae&&ie(e.value)===gt?a(e.value.sections):e instanceof je?a(e.sections):e.eachChild(t))},e=n.value;e._styleExpression&&t(e._styleExpression.expression)}return r}}let du;var pu={get paint(){return du=du||new Yr({"background-color":new jr(q.paint_background["background-color"]),"background-pattern":new Zr(q.paint_background["background-pattern"]),"background-opacity":new jr(q.paint_background["background-opacity"])})}};class mu extends Qr{constructor(t){super(t,pu)}}let fu;var gu={get paint(){return fu=fu||new Yr({"raster-opacity":new jr(q.paint_raster["raster-opacity"]),"raster-hue-rotate":new jr(q.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jr(q.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jr(q.paint_raster["raster-brightness-max"]),"raster-saturation":new jr(q.paint_raster["raster-saturation"]),"raster-contrast":new jr(q.paint_raster["raster-contrast"]),"raster-resampling":new jr(q.paint_raster["raster-resampling"]),"raster-fade-duration":new jr(q.paint_raster["raster-fade-duration"])})}};class vu extends Qr{constructor(t){super(t,gu)}}class yu extends Qr{constructor(t){super(t,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class _u{constructor(t){this._methodToThrottle=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const xu=6371008.8;class bu{constructor(t,e){if(isNaN(t)||isNaN(e))throw new Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bu(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,n=this.lat*e,i=t.lat*e,r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*e);return xu*Math.acos(Math.min(r,1))}static convert(t){if(t instanceof bu)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new bu(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new bu(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Au=2*Math.PI*xu;function wu(t){return Au*Math.cos(t*Math.PI/180)}function Cu(t){return(180+t)/360}function Eu(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Su(t,e){return t/wu(e)}function Mu(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}class Tu{constructor(t,e,n=0){this.x=+t,this.y=+e,this.z=+n}static fromLngLat(t,e=0){const n=bu.convert(t);return new Tu(Cu(n.lng),Eu(n.lat),Su(e,n.lat))}toLngLat(){return new bu(360*this.x-180,Mu(this.y))}toAltitude(){return this.z*wu(Mu(this.y))}meterInMercatorCoordinateUnits(){return 1/Au*(t=Mu(this.y),1/Math.cos(t*Math.PI/180));var t}}function Iu(t,e,n){var i=2*Math.PI*6378137/256/Math.pow(2,n);return[t*i-2*Math.PI*6378137/2,e*i-2*Math.PI*6378137/2]}class Bu{constructor(t,e,n){if(t<0||t>25||n<0||n>=Math.pow(2,t)||e<0||e>=Math.pow(2,t))throw new Error(`x=${e}, y=${n}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=e,this.y=n,this.key=Pu(0,t,t,e,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e,n){const i=(a=this.y,o=this.z,s=Iu(256*(r=this.x),256*(a=Math.pow(2,o)-a-1),o),l=Iu(256*(r+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var r,a,o,s,l;const c=function(t,e,n){let i,r="";for(let a=t;a>0;a--)i=1<<a-1,r+=(e&i?1:0)+(n&i?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,e>1?"@2x":"").replace(/{quadkey}/g,c).replace(/{bbox-epsg-3857}/g,i)}isChildOf(t){const e=this.z-t.z;return e>0&&t.x===this.x>>e&&t.y===this.y>>e}getTilePoint(t){const e=Math.pow(2,this.z);return new a((t.x*e-this.x)*Mo,(t.y*e-this.y)*Mo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Lu{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Pu(t,e.z,e.z,e.x,e.y)}}class Du{constructor(t,e,n,i,r){if(t<n)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${n}`);this.overscaledZ=t,this.wrap=e,this.canonical=new Bu(n,+i,+r),this.key=Pu(e,t,n,i,r)}clone(){return new Du(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const e=this.canonical.z-t;return t>this.canonical.z?new Du(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Du(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?Pu(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):Pu(this.wrap*+e,t,t,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new Du(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new Du(e,this.wrap,e,n,i),new Du(e,this.wrap,e,n+1,i),new Du(e,this.wrap,e,n,i+1),new Du(e,this.wrap,e,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Du(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Du(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Lu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Tu(t.x-this.wrap,t.y))}}function Pu(t,e,n,i,r){(t*=2)<0&&(t=-1*t-1);const a=1<<n;return(a*a*t+a*r+i).toString(36)+n.toString(36)+e.toString(36)}xr("CanonicalTileID",Bu),xr("OverscaledTileID",Du,{omit:["posMatrix"]});class Ru{constructor(t,e,n,i=1,r=1,a=1,o=0){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n))return void w(`"${n}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=e.height;const s=this.dim=e.height-2;switch(this.data=new Uint32Array(e.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=r,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let t=0;t<s;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(s,t)]=this.data[this._idx(s-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,s)]=this.data[this._idx(t,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let t=0;t<s;t++)for(let e=0;e<s;e++){const n=this.get(t,e);n>this.max&&(this.max=n),n<this.min&&(this.min=n)}}get(t,e){const n=new Uint8Array(this.data.buffer),i=4*this._idx(t,e);return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}unpack(t,e,n){return t*this.redFactor+e*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new ps({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=e*this.dim,r=e*this.dim+this.dim,a=n*this.dim,o=n*this.dim+this.dim;switch(e){case-1:i=r-1;break;case 1:r=i+1}switch(n){case-1:a=o-1;break;case 1:o=a+1}const s=-e*this.dim,l=-n*this.dim;for(let e=a;e<o;e++)for(let n=i;n<r;n++)this.data[this._idx(n,e)]=t.data[this._idx(n+s,e+l)]}}xr("DEMData",Ru);class ku{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const n=t[e];this._stringToNumber[n]=e,this._numberToString[e]=n}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class zu{constructor(t,e,n,i,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=n,t._y=i,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}class Fu{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new yr(Mo,16,0),this.grid3D=new yr(Mo,16,0),this.featureIndexArray=new Fa,this.promoteId=e}insert(t,e,n,i,r,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,r);const s=a?this.grid3D:this.grid;for(let t=0;t<e.length;t++){const n=e[t],i=[1/0,1/0,-1/0,-1/0];for(let t=0;t<n.length;t++){const e=n[t];i[0]=Math.min(i[0],e.x),i[1]=Math.min(i[1],e.y),i[2]=Math.max(i[2],e.x),i[3]=Math.max(i[3],e.y)}i[0]<Mo&&i[1]<Mo&&i[2]>=0&&i[3]>=0&&s.insert(o,i[0],i[1],i[2],i[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new al.VectorTile(new _c(this.rawTileData)).layers,this.sourceLayerCoder=new ku(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,n,i){this.loadVTLayers();const r=t.params||{},o=Mo/t.tileSize/t.scale,s=Ti(r.filter),l=t.queryGeometry,c=t.queryPadding*o,u=Nu(l),h=this.grid.query(u.minX-c,u.minY-c,u.maxX+c,u.maxY+c),d=Nu(t.cameraQueryGeometry),p=this.grid3D.query(d.minX-c,d.minY-c,d.maxX+c,d.maxY+c,((e,n,i,r)=>function(t,e,n,i,r){for(const a of t)if(e<=a.x&&n<=a.y&&i>=a.x&&r>=a.y)return!0;const o=[new a(e,n),new a(e,r),new a(i,r),new a(i,n)];if(t.length>2)for(const e of o)if(Ho(t,e))return!0;for(let e=0;e<t.length-1;e++)if(jo(t[e],t[e+1],o))return!0;return!1}(t.cameraQueryGeometry,e-c,n-c,i+c,r+c)));for(const t of p)h.push(t);h.sort(Uu);const m={};let f;for(let a=0;a<h.length;a++){const c=h[a];if(c===f)continue;f=c;const u=this.featureIndexArray.get(c);let d=null;this.loadMatchingFeature(m,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,s,r.layers,r.availableImages,e,n,i,((e,n,i)=>(d||(d=Bo(e)),n.queryIntersectsFeature(l,e,i,d,this.z,t.transform,o,t.pixelPosMatrix))))}return m}loadMatchingFeature(t,e,n,i,r,a,o,s,l,c,u){const h=this.bucketLayerIDs[e];if(a&&!function(t,e){for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>=0)return!0;return!1}(a,h))return;const d=this.sourceLayerCoder.decode(n),p=this.vtLayers[d].feature(i);if(r.needGeometry){const t=Lo(p,!0);if(!r.filter(new kr(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!r.filter(new kr(this.tileID.overscaledZ),p))return;const m=this.getId(p,d);for(let e=0;e<h.length;e++){const n=h[e];if(a&&a.indexOf(n)<0)continue;const r=s[n];if(!r)continue;let d={};m&&c&&(d=c.getState(r.sourceLayer||"_geojsonTileLayer",m));const f=v({},l[n]);f.paint=Ou(f.paint,r.paint,p,d,o),f.layout=Ou(f.layout,r.layout,p,d,o);const g=!u||u(p,r,d);if(!g)continue;const y=new zu(p,this.z,this.x,this.y,m);y.layer=f;let _=t[n];void 0===_&&(_=t[n]=[]),_.push({featureIndex:i,feature:y,intersectionZ:g})}}lookupSymbolFeatures(t,e,n,i,r,a,o,s){const l={};this.loadVTLayers();const c=Ti(r);for(const r of t)this.loadMatchingFeature(l,n,i,r,c,a,o,s,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const n of e)if(t===n)return!0;return!1}getId(t,e){let n=t.id;return this.promoteId&&(n=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]],"boolean"==typeof n&&(n=Number(n))),n}}function Ou(t,e,n,i,r){return _(t,((t,a)=>{const o=e instanceof Hr?e.get(a):null;return o&&o.evaluate?o.evaluate(n,i,r):o}))}function Nu(t){let e=1/0,n=1/0,i=-1/0,r=-1/0;for(const a of t)e=Math.min(e,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y);return{minX:e,minY:n,maxX:i,maxY:r}}function Uu(t,e){return e-t}function Vu(t,e,n,i,r){const o=[];for(let s=0;s<t.length;s++){const l=t[s];let c;for(let t=0;t<l.length-1;t++){let s=l[t],u=l[t+1];s.x<e&&u.x<e||(s.x<e?s=new a(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x<e&&(u=new a(e,s.y+(e-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y<n&&u.y<n||(s.y<n?s=new a(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round():u.y<n&&(u=new a(s.x+(n-s.y)/(u.y-s.y)*(u.x-s.x),n)._round()),s.x>=i&&u.x>=i||(s.x>=i?s=new a(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round():u.x>=i&&(u=new a(i,s.y+(i-s.x)/(u.x-s.x)*(u.y-s.y))._round()),s.y>=r&&u.y>=r||(s.y>=r?s=new a(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round():u.y>=r&&(u=new a(s.x+(r-s.y)/(u.y-s.y)*(u.x-s.x),r)._round()),c&&s.equals(c[c.length-1])||(c=[s],o.push(c)),c.push(u)))))}}return o}xr("FeatureIndex",Fu,{omit:["rawTileData","sourceLayerCoder"]});class Gu extends a{constructor(t,e,n,i){super(t,e),this.angle=n,void 0!==i&&(this.segment=i)}clone(){return new Gu(this.x,this.y,this.angle,this.segment)}}function Hu(t,e,n,i,r){if(void 0===e.segment||0===n)return!0;let a=e,o=e.segment+1,s=0;for(;s>-n/2;){if(o--,o<0)return!1;s-=t[o].dist(a),a=t[o]}s+=t[o].dist(t[o+1]),o++;const l=[];let c=0;for(;s<n/2;){const e=t[o],n=t[o+1];if(!n)return!1;let a=t[o-1].angleTo(e)-e.angleTo(n);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),c+=a;s-l[0].distance>i;)c-=l.shift().angleDelta;if(c>r)return!1;o++,s+=e.dist(n)}return!0}function ju(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Wu(t,e,n){return t?.6*e*n:0}function qu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Zu(t,e,n,i,r,a){const o=Wu(n,r,a),s=qu(n,i)*a;let l=0;const c=ju(t)/2;for(let n=0;n<t.length-1;n++){const i=t[n],r=t[n+1],a=i.dist(r);if(l+a>c){const u=(c-l)/a,h=Ie.number(i.x,r.x,u),d=Ie.number(i.y,r.y,u),p=new Gu(h,d,r.angleTo(i),n);return p._round(),!o||Hu(t,p,s,o,e)?p:void 0}l+=a}}function $u(t,e,n,i,r,a,o,s,l){const c=Wu(i,a,o),u=qu(i,r),h=u*o,d=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Yu(t,d?e/2*s%e:(u/2+2*a)*o*s%e,e,c,n,h,d,!1,l)}function Yu(t,e,n,i,r,a,o,s,l){const c=a/2,u=ju(t);let h=0,d=e-n,p=[];for(let e=0;e<t.length-1;e++){const o=t[e],s=t[e+1],m=o.dist(s),f=s.angleTo(o);for(;d+n<h+m;){d+=n;const g=(d-h)/m,v=Ie.number(o.x,s.x,g),y=Ie.number(o.y,s.y,g);if(v>=0&&v<l&&y>=0&&y<l&&d-c>=0&&d+c<=u){const n=new Gu(v,y,f,e);n._round(),i&&!Hu(t,n,a,i,r)||p.push(n)}}h+=m}return s||p.length||o||(p=Yu(t,h/2,n,i,r,a,o,!0,l)),p}xr("Anchor",Gu);const Xu=Sc;function Qu(t,e,n,i){const r=[],o=t.image,s=o.pixelRatio,l=o.paddedRect.w-2*Xu,c=o.paddedRect.h-2*Xu;let u={x1:t.left,y1:t.top,x2:t.right,y2:t.bottom};const h=o.stretchX||[[0,l]],d=o.stretchY||[[0,c]],p=(t,e)=>t+e[1]-e[0],m=h.reduce(p,0),f=d.reduce(p,0),g=l-m,v=c-f;let y=0,_=m,x=0,b=f,A=0,w=g,C=0,E=v;if(o.content&&i){const e=o.content,n=e[2]-e[0],i=e[3]-e[1];(o.textFitWidth||o.textFitHeight)&&(u=qc(t)),y=Ju(h,0,e[0]),x=Ju(d,0,e[1]),_=Ju(h,e[0],e[2]),b=Ju(d,e[1],e[3]),A=e[0]-y,C=e[1]-x,w=n-_,E=i-b}const S=u.x1,M=u.y1,T=u.x2-S,I=u.y2-M,B=(t,i,r,l)=>{const c=th(t.stretch-y,_,T,S),u=eh(t.fixed-A,w,t.stretch,m),h=th(i.stretch-x,b,I,M),d=eh(i.fixed-C,E,i.stretch,f),p=th(r.stretch-y,_,T,S),g=eh(r.fixed-A,w,r.stretch,m),v=th(l.stretch-x,b,I,M),B=eh(l.fixed-C,E,l.stretch,f),L=new a(c,h),D=new a(p,h),P=new a(p,v),R=new a(c,v),k=new a(u/s,d/s),z=new a(g/s,B/s),F=e*Math.PI/180;if(F){const t=Math.sin(F),e=Math.cos(F),n=[e,-t,t,e];L._matMult(n),D._matMult(n),R._matMult(n),P._matMult(n)}const O=t.stretch+t.fixed,N=i.stretch+i.fixed;return{tl:L,tr:D,bl:R,br:P,tex:{x:o.paddedRect.x+Xu+O,y:o.paddedRect.y+Xu+N,w:r.stretch+r.fixed-O,h:l.stretch+l.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:k,pixelOffsetBR:z,minFontScaleX:w/s/T,minFontScaleY:E/s/I,isSDF:n}};if(i&&(o.stretchX||o.stretchY)){const t=Ku(h,g,m),e=Ku(d,v,f);for(let n=0;n<t.length-1;n++){const i=t[n],a=t[n+1];for(let t=0;t<e.length-1;t++)r.push(B(i,e[t],a,e[t+1]))}}else r.push(B({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:c+1}));return r}function Ju(t,e,n){let i=0;for(const r of t)i+=Math.max(e,Math.min(n,r[1]))-Math.max(e,Math.min(n,r[0]));return i}function Ku(t,e,n){const i=[{fixed:-Xu,stretch:0}];for(const[e,n]of t){const t=i[i.length-1];i.push({fixed:e-t.stretch,stretch:t.stretch}),i.push({fixed:e-t.stretch,stretch:t.stretch+(n-e)})}return i.push({fixed:e+Xu,stretch:n}),i}function th(t,e,n,i){return t/e*n+i}function eh(t,e,n,i){return t-e*n/i}class nh{constructor(t,e,n,i,r,o,s,l,c,u){var h;if(this.boxStartIndex=t.length,c){let t=o.top,e=o.bottom;const n=o.collisionPadding;n&&(t-=n[1],e+=n[3]);let i=e-t;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{const c=(null===(h=o.image)||void 0===h?void 0:h.content)&&(o.image.textFitWidth||o.image.textFitHeight)?qc(o):{x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};c.y1=c.y1*s-l[0],c.y2=c.y2*s+l[2],c.x1=c.x1*s-l[3],c.x2=c.x2*s+l[1];const d=o.collisionPadding;if(d&&(c.x1-=d[0]*s,c.y1-=d[1]*s,c.x2+=d[2]*s,c.y2+=d[3]*s),u){const t=new a(c.x1,c.y1),e=new a(c.x2,c.y1),n=new a(c.x1,c.y2),i=new a(c.x2,c.y2),r=u*Math.PI/180;t._rotate(r),e._rotate(r),n._rotate(r),i._rotate(r),c.x1=Math.min(t.x,e.x,n.x,i.x),c.x2=Math.max(t.x,e.x,n.x,i.x),c.y1=Math.min(t.y,e.y,n.y,i.y),c.y2=Math.max(t.y,e.y,n.y,i.y)}t.emplaceBack(e.x,e.y,c.x1,c.y1,c.x2,c.y2,n,i,r)}this.boxEndIndex=t.length}}class ih{constructor(t=[],e=rh){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,a=e[r];if(n(i,a)>=0)break;e[t]=a,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),a=e[i];const o=i+1;if(o<this.length&&n(e[o],a)<0&&(i=o,a=e[o]),n(a,r)>=0)break;e[t]=a,t=i}e[t]=r}}function rh(t,e){return t<e?-1:t>e?1:0}function ah(t,e=1,n=!1){let i=1/0,r=1/0,o=-1/0,s=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<i)&&(i=e.x),(!t||e.y<r)&&(r=e.y),(!t||e.x>o)&&(o=e.x),(!t||e.y>s)&&(s=e.y)}const c=Math.min(o-i,s-r);let u=c/2;const h=new ih([],oh);if(0===c)return new a(i,r);for(let e=i;e<o;e+=c)for(let n=r;n<s;n+=c)h.push(new sh(e+u,n+u,u,t));let d=function(t){let e=0,n=0,i=0;const r=t[0];for(let t=0,a=r.length,o=a-1;t<a;o=t++){const a=r[t],s=r[o],l=a.x*s.y-s.x*a.y;n+=(a.x+s.x)*l,i+=(a.y+s.y)*l,e+=3*l}return new sh(n/e,i/e,0,t)}(t),p=h.length;for(;h.length;){const i=h.pop();(i.d>d.d||!d.d)&&(d=i,n&&console.log("found best %d after %d probes",Math.round(1e4*i.d)/1e4,p)),i.max-d.d<=e||(u=i.h/2,h.push(new sh(i.p.x-u,i.p.y-u,u,t)),h.push(new sh(i.p.x+u,i.p.y-u,u,t)),h.push(new sh(i.p.x-u,i.p.y+u,u,t)),h.push(new sh(i.p.x+u,i.p.y+u,u,t)),p+=4)}return n&&(console.log(`num probes: ${p}`),console.log(`best distance: ${d.d}`)),d.p}function oh(t,e){return e.max-t.max}function sh(t,e,n,i){this.p=new a(t,e),this.h=n,this.d=function(t,e){let n=!1,i=1/0;for(let r=0;r<e.length;r++){const a=e[r];for(let e=0,r=a.length,o=r-1;e<r;o=e++){const r=a[e],s=a[o];r.y>t.y!=s.y>t.y&&t.x<(s.x-r.x)*(t.y-r.y)/(s.y-r.y)+r.x&&(n=!n),i=Math.min(i,Vo(t,r,s))}}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}var lh;t.aq=void 0,(lh=t.aq||(t.aq={}))[lh.center=1]="center",lh[lh.left=2]="left",lh[lh.right=3]="right",lh[lh.top=4]="top",lh[lh.bottom=5]="bottom",lh[lh["top-left"]=6]="top-left",lh[lh["top-right"]=7]="top-right",lh[lh["bottom-left"]=8]="bottom-left",lh[lh["bottom-right"]=9]="bottom-right";const ch=7,uh=Number.POSITIVE_INFINITY;function hh(t,e){return e[1]!==uh?function(t,e,n){let i=0,r=0;switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":r=n-ch;break;case"bottom-right":case"bottom-left":case"bottom":r=-n+ch}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}return[i,r]}(t,e[0],e[1]):function(t,e){let n=0,i=0;e<0&&(e=0);const r=e/Math.SQRT2;switch(t){case"top-right":case"top-left":i=r-ch;break;case"bottom-right":case"bottom-left":i=-r+ch;break;case"bottom":i=-e+ch;break;case"top":i=e-ch}switch(t){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=e;break;case"right":n=-e}return[n,i]}(t,e[0])}function dh(t,e,n){var i;const r=t.layout,a=null===(i=r.get("text-variable-anchor-offset"))||void 0===i?void 0:i.evaluate(e,{},n);if(a){const t=a.values,e=[];for(let n=0;n<t.length;n+=2){const i=e[n]=t[n],r=t[n+1].map((t=>t*Xl));i.startsWith("top")?r[1]-=ch:i.startsWith("bottom")&&(r[1]+=ch),e[n+1]=r}return new Kt(e)}const o=r.get("text-variable-anchor");if(o){let i;i=void 0!==t._unevaluatedLayout.getValue("text-radial-offset")?[r.get("text-radial-offset").evaluate(e,{},n)*Xl,uh]:r.get("text-offset").evaluate(e,{},n).map((t=>t*Xl));const a=[];for(const t of o)a.push(t,hh(t,i));return new Kt(a)}return null}function ph(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function mh(e,n,i,r,a,o,s,l,c,u,h){let d=o.textMaxSize.evaluate(n,{});void 0===d&&(d=s);const p=e.layers[0].layout,m=p.get("icon-offset").evaluate(n,{},h),f=gh(i.horizontal),g=s/24,v=e.tilePixelRatio*g,y=e.tilePixelRatio*d/24,_=e.tilePixelRatio*l,x=e.tilePixelRatio*p.get("symbol-spacing"),b=p.get("text-padding")*e.tilePixelRatio,A=function(t,e,n,i=1){const r=t.get("icon-padding").evaluate(e,{},n),a=r&&r.values;return[a[0]*i,a[1]*i,a[2]*i,a[3]*i]}(p,n,h,e.tilePixelRatio),C=p.get("text-max-angle")/180*Math.PI,E="viewport"!==p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),S="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),M=p.get("symbol-placement"),T=x/2,I=p.get("icon-text-fit");let B;r&&"none"!==I&&(e.allowVerticalPlacement&&i.vertical&&(B=Zc(r,i.vertical,I,p.get("icon-text-fit-padding"),m,g)),f&&(r=Zc(r,f,I,p.get("icon-text-fit-padding"),m,g)));const L=(l,d)=>{d.x<0||d.x>=Mo||d.y<0||d.y>=Mo||function(e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v,y,_,x,b,A,C,E,S){const M=e.addToLineVertexArray(n,i);let T,I,B,L,D=0,P=0,R=0,k=0,z=-1,F=-1;const O={};let N=oo("");if(e.allowVerticalPlacement&&r.vertical){const t=l.layout.get("text-rotate").evaluate(b,{},E)+90;B=new nh(c,n,u,h,d,r.vertical,p,m,f,t),s&&(L=new nh(c,n,u,h,d,s,v,y,f,t))}if(a){const i=l.layout.get("icon-rotate").evaluate(b,{}),r="none"!==l.layout.get("icon-text-fit"),o=Qu(a,i,C,r),p=s?Qu(s,i,C,r):void 0;I=new nh(c,n,u,h,d,a,v,y,!1,i),D=4*o.length;const m=e.iconSizeData;let f=null;"source"===m.kind?(f=[Yc*l.layout.get("icon-size").evaluate(b,{})],f[0]>Xc&&w(`${e.layerIds[0]}: Value for "icon-size" is >= ${$c}. Reduce your "icon-size".`)):"composite"===m.kind&&(f=[Yc*A.compositeIconSizes[0].evaluate(b,{},E),Yc*A.compositeIconSizes[1].evaluate(b,{},E)],(f[0]>Xc||f[1]>Xc)&&w(`${e.layerIds[0]}: Value for "icon-size" is >= ${$c}. Reduce your "icon-size".`)),e.addSymbols(e.icon,o,f,x,_,b,t.ah.none,n,M.lineStartIndex,M.lineLength,-1,E),z=e.icon.placedSymbolArray.length-1,p&&(P=4*p.length,e.addSymbols(e.icon,p,f,x,_,b,t.ah.vertical,n,M.lineStartIndex,M.lineLength,-1,E),F=e.icon.placedSymbolArray.length-1)}const U=Object.keys(r.horizontal);for(const i of U){const a=r.horizontal[i];if(!T){N=oo(a.text);const t=l.layout.get("text-rotate").evaluate(b,{},E);T=new nh(c,n,u,h,d,a,p,m,f,t)}const s=1===a.positionedLines.length;if(R+=fh(e,n,a,o,l,f,b,g,M,r.vertical?t.ah.horizontal:t.ah.horizontalOnly,s?U:[i],O,z,A,E),s)break}r.vertical&&(k+=fh(e,n,r.vertical,o,l,f,b,g,M,t.ah.vertical,["vertical"],O,F,A,E));const V=T?T.boxStartIndex:e.collisionBoxArray.length,G=T?T.boxEndIndex:e.collisionBoxArray.length,H=B?B.boxStartIndex:e.collisionBoxArray.length,j=B?B.boxEndIndex:e.collisionBoxArray.length,W=I?I.boxStartIndex:e.collisionBoxArray.length,q=I?I.boxEndIndex:e.collisionBoxArray.length,Z=L?L.boxStartIndex:e.collisionBoxArray.length,$=L?L.boxEndIndex:e.collisionBoxArray.length;let Y=-1;const X=(t,e)=>t&&t.circleDiameter?Math.max(t.circleDiameter,e):e;Y=X(T,Y),Y=X(B,Y),Y=X(I,Y),Y=X(L,Y);const Q=Y>-1?1:0;Q&&(Y*=S/Xl),e.glyphOffsetArray.length>=ou.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey);const J=dh(l,b,E),[K,tt]=function(e,n){const i=e.length,r=null==n?void 0:n.values;if((null==r?void 0:r.length)>0)for(let n=0;n<r.length;n+=2){const i=r[n+1];e.emplaceBack(t.aq[r[n]],i[0],i[1])}return[i,e.length]}(e.textAnchorOffsets,J);e.symbolInstances.emplaceBack(n.x,n.y,O.right>=0?O.right:-1,O.center>=0?O.center:-1,O.left>=0?O.left:-1,O.vertical||-1,z,F,N,V,G,H,j,W,q,Z,$,u,R,k,D,P,Q,0,p,Y,K,tt)}(e,d,l,i,r,a,B,e.layers[0],e.collisionBoxArray,n.index,n.sourceLayerIndex,e.index,v,[b,b,b,b],E,c,_,A,S,m,n,o,u,h,s)};if("line"===M)for(const t of Vu(n.geometry,0,0,Mo,Mo)){const n=$u(t,x,C,i.vertical||f,r,24,y,e.overscaling,Mo);for(const i of n)f&&vh(e,f.text,T,i)||L(t,i)}else if("line-center"===M){for(const t of n.geometry)if(t.length>1){const e=Zu(t,C,i.vertical||f,r,24,y);e&&L(t,e)}}else if("Polygon"===n.type)for(const t of _n(n.geometry,0)){const e=ah(t,16);L(t[0],new Gu(e.x,e.y,0))}else if("LineString"===n.type)for(const t of n.geometry)L(t,new Gu(t[0].x,t[0].y,0));else if("Point"===n.type)for(const t of n.geometry)for(const e of t)L([e],new Gu(e.x,e.y,0))}function fh(t,e,n,i,r,o,s,l,c,u,h,d,p,m,f){const g=function(t,e,n,i,r,o,s,l){const c=i.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(const t of e.positionedLines)for(const i of t.positionedGlyphs){if(!i.rect)continue;const o=i.rect||{};let h=Cc+1,d=!0,p=1,m=0;const f=(r||l)&&i.vertical,g=i.metrics.advance*i.scale/2;if(l&&e.verticalizable&&(m=t.lineOffset/2-(i.imageName?-(Xl-i.metrics.width*i.scale)/2:(i.scale-1)*Xl)),i.imageName){const t=s[i.imageName];d=t.sdf,p=t.pixelRatio,h=Sc/p}const v=r?[i.x+g,i.y]:[0,0];let y=r?[0,0]:[i.x+g+n[0],i.y+n[1]-m],_=[0,0];f&&(_=y,y=[0,0]);const x=i.metrics.isDoubleResolution?2:1,b=(i.metrics.left-h)*i.scale-g+y[0],A=(-i.metrics.top-h)*i.scale+y[1],w=b+o.w/x*i.scale/p,C=A+o.h/x*i.scale/p,E=new a(b,A),S=new a(w,A),M=new a(b,C),T=new a(w,C);if(f){const t=new a(-g,g-Bc),e=-Math.PI/2,n=Xl/2-g,r=new a(5-Bc-n,-(i.imageName?n:0)),o=new a(..._);E._rotateAround(e,t)._add(r)._add(o),S._rotateAround(e,t)._add(r)._add(o),M._rotateAround(e,t)._add(r)._add(o),T._rotateAround(e,t)._add(r)._add(o)}if(c){const t=Math.sin(c),e=Math.cos(c),n=[e,-t,t,e];E._matMult(n),S._matMult(n),M._matMult(n),T._matMult(n)}const I=new a(0,0),B=new a(0,0);u.push({tl:E,tr:S,bl:M,br:T,tex:o,writingMode:e.writingMode,glyphOffset:v,sectionIndex:i.sectionIndex,isSDF:d,pixelOffsetTL:I,pixelOffsetBR:B,minFontScaleX:0,minFontScaleY:0})}return u}(0,n,l,r,o,s,i,t.allowVerticalPlacement),v=t.textSizeData;let y=null;"source"===v.kind?(y=[Yc*r.layout.get("text-size").evaluate(s,{})],y[0]>Xc&&w(`${t.layerIds[0]}: Value for "text-size" is >= ${$c}. Reduce your "text-size".`)):"composite"===v.kind&&(y=[Yc*m.compositeTextSizes[0].evaluate(s,{},f),Yc*m.compositeTextSizes[1].evaluate(s,{},f)],(y[0]>Xc||y[1]>Xc)&&w(`${t.layerIds[0]}: Value for "text-size" is >= ${$c}. Reduce your "text-size".`)),t.addSymbols(t.text,g,y,l,o,s,u,e,c.lineStartIndex,c.lineLength,p,f);for(const e of h)d[e]=t.text.placedSymbolArray.length-1;return 4*g.length}function gh(t){for(const e in t)return t[e];return null}function vh(t,e,n,i){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(i.dist(t[e])<n)return!0}else r[e]=[];return r[e].push(i),!1}const yh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _h{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,n]=new Uint8Array(t,0,2);if(219!==e)throw new Error("Data does not appear to be in a KDBush format.");const i=n>>4;if(1!==i)throw new Error(`Got v${i} data when expected v1.`);const r=yh[15&n];if(!r)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[o]=new Uint32Array(t,4,1);return new _h(o,a,r,t)}constructor(t,e=64,n=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const r=yh.indexOf(this.ArrayType),a=2*t*this.ArrayType.BYTES_PER_ELEMENT,o=t*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+o+s,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=e,n}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return xh(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:a,nodeSize:o}=this,s=[0,r.length-1,0],l=[];for(;s.length;){const c=s.pop()||0,u=s.pop()||0,h=s.pop()||0;if(u-h<=o){for(let o=h;o<=u;o++){const s=a[2*o],c=a[2*o+1];s>=t&&s<=n&&c>=e&&c<=i&&l.push(r[o])}continue}const d=h+u>>1,p=a[2*d],m=a[2*d+1];p>=t&&p<=n&&m>=e&&m<=i&&l.push(r[d]),(0===c?t<=p:e<=m)&&(s.push(h),s.push(d-1),s.push(1-c)),(0===c?n>=p:i>=m)&&(s.push(d+1),s.push(u),s.push(1-c))}return l}within(t,e,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:r,nodeSize:a}=this,o=[0,i.length-1,0],s=[],l=n*n;for(;o.length;){const c=o.pop()||0,u=o.pop()||0,h=o.pop()||0;if(u-h<=a){for(let n=h;n<=u;n++)Ch(r[2*n],r[2*n+1],t,e)<=l&&s.push(i[n]);continue}const d=h+u>>1,p=r[2*d],m=r[2*d+1];Ch(p,m,t,e)<=l&&s.push(i[d]),(0===c?t-n<=p:e-n<=m)&&(o.push(h),o.push(d-1),o.push(1-c)),(0===c?t+n>=p:e+n>=m)&&(o.push(d+1),o.push(u),o.push(1-c))}return s}}function xh(t,e,n,i,r,a){if(r-i<=n)return;const o=i+r>>1;bh(t,e,o,i,r,a),xh(t,e,n,i,o-1,1-a),xh(t,e,n,o+1,r,1-a)}function bh(t,e,n,i,r,a){for(;r>i;){if(r-i>600){const o=r-i+1,s=n-i+1,l=Math.log(o),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(o-c)/o)*(s-o/2<0?-1:1);bh(t,e,n,Math.max(i,Math.floor(n-s*c/o+u)),Math.min(r,Math.floor(n+(o-s)*c/o+u)),a)}const o=e[2*n+a];let s=i,l=r;for(Ah(t,e,i,n),e[2*r+a]>o&&Ah(t,e,i,r);s<l;){for(Ah(t,e,s,l),s++,l--;e[2*s+a]<o;)s++;for(;e[2*l+a]>o;)l--}e[2*i+a]===o?Ah(t,e,i,l):(l++,Ah(t,e,l,r)),l<=n&&(i=l+1),n<=l&&(r=l-1)}}function Ah(t,e,n,i){wh(t,n,i),wh(e,2*n,2*i),wh(e,2*n+1,2*i+1)}function wh(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function Ch(t,e,n,i){const r=t-n,a=e-i;return r*r+a*a}var Eh;t.be=void 0,(Eh=t.be||(t.be={})).create="create",Eh.load="load",Eh.fullLoad="fullLoad";let Sh=null,Mh=[];const Th=1e3/60,Ih="loadTime",Bh="fullLoadTime",Lh={mark(t){performance.mark(t)},frame(t){const e=t;null!=Sh&&Mh.push(e-Sh),Sh=e},clearMetrics(){Sh=null,Mh=[],performance.clearMeasures(Ih),performance.clearMeasures(Bh);for(const e in t.be)performance.clearMarks(t.be[e])},getPerformanceMetrics(){performance.measure(Ih,t.be.create,t.be.load),performance.measure(Bh,t.be.create,t.be.fullLoad);const e=performance.getEntriesByName(Ih)[0].duration,n=performance.getEntriesByName(Bh)[0].duration,i=Mh.length,r=1/(Mh.reduce(((t,e)=>t+e),0)/i/1e3),a=Mh.filter((t=>t>Th)).reduce(((t,e)=>t+(e-Th)/Th),0);return{loadTime:e,fullLoadTime:n,fps:r,percentDroppedFrames:a/(i+a)*100,totalFrames:i}}};t.$=to,t.A=Jo,t.B=function(t){if(null==S){const e=t.navigator?t.navigator.userAgent:null;S=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return S},t.C=class{constructor(t,e){this.target=t,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new _u((()=>this.process())),this.subscription=function(t,e,n,i){return t.addEventListener(e,n,!1),{unsubscribe:()=>{t.removeEventListener(e,n,!1)}}}(this.target,"message",(t=>this.receive(t))),this.globalScope=E(self)?t:window}registerMessageHandler(t,e){this.messageHandlers[t]=e}sendAsync(t,e){return new Promise(((n,i)=>{const r=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[r]={resolve:n,reject:i},e&&e.signal.addEventListener("abort",(()=>{delete this.resolveRejects[r];const e={id:r,type:"<cancel>",origin:location.origin,targetMapId:t.targetMapId,sourceMapId:this.mapId};this.target.postMessage(e)}),{once:!0});const a=[],o=Object.assign(Object.assign({},t),{id:r,sourceMapId:this.mapId,origin:location.origin,data:Ar(t.data,a)});this.target.postMessage(o,{transfer:a})}))}receive(t){const e=t.data,n=e.id;if(!("file://"!==e.origin&&"file://"!==location.origin&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if("<cancel>"===e.type){delete this.tasks[n];const t=this.abortControllers[n];return delete this.abortControllers[n],void(t&&t.abort())}if(E(self)||e.mustQueue)return this.tasks[n]=e,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,e)}}process(){if(0===this.taskQueue.length)return;const t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(t,e)}processTask(t,n){return e(this,void 0,void 0,(function*(){if("<response>"===n.type){const e=this.resolveRejects[t];if(delete this.resolveRejects[t],!e)return;return void(n.error?e.reject(wr(n.error)):e.resolve(wr(n.data)))}if(!this.messageHandlers[n.type])return void this.completeTask(t,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const e=wr(n.data),i=new AbortController;this.abortControllers[t]=i;try{const r=yield this.messageHandlers[n.type](n.sourceMapId,e,i);this.completeTask(t,null,r)}catch(e){this.completeTask(t,e)}}))}completeTask(t,e,n){const i=[];delete this.abortControllers[t];const r={id:t,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Ar(e):null,data:Ar(n,i)};this.target.postMessage(r,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},t.D=jr,t.E=W,t.F=function(){var t=new Jo(16);return Jo!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.G=z,t.H=function(t,e,n){var i,r,a,o,s,l,c,u,h,d,p,m,f=n[0],g=n[1],v=n[2];return e===t?(t[12]=e[0]*f+e[4]*g+e[8]*v+e[12],t[13]=e[1]*f+e[5]*g+e[9]*v+e[13],t[14]=e[2]*f+e[6]*g+e[10]*v+e[14],t[15]=e[3]*f+e[7]*g+e[11]*v+e[15]):(r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],p=e[10],m=e[11],t[0]=i=e[0],t[1]=r,t[2]=a,t[3]=o,t[4]=s,t[5]=l,t[6]=c,t[7]=u,t[8]=h,t[9]=d,t[10]=p,t[11]=m,t[12]=i*f+s*g+h*v+e[12],t[13]=r*f+l*g+d*v+e[13],t[14]=a*f+c*g+p*v+e[14],t[15]=o*f+u*g+m*v+e[15]),t},t.I=Mc,t.J=function(t,e,n){var i=n[0],r=n[1],a=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.K=ts,t.L=function(t,e){const n={};for(let i=0;i<e.length;i++){const r=e[i];r in t&&(n[r]=t[r])}return n},t.M=bu,t.N=Cu,t.O=Eu,t.P=a,t.Q=Du,t.R=ps,t.S=h,t.T=Or,t.U=d,t.V=I,t.W=Mo,t.X=ea,t.Y=Tu,t.Z=class extends aa{},t._=e,t.a=R,t.a$=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.a0=Bu,t.a1=rt,t.a2=t=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((n=>{e.onloadstart=()=>{n(e)};for(const n of t){const t=window.document.createElement("source");U(n)||(e.crossOrigin="Anonymous"),t.src=n,e.appendChild(t)}}))},t.a3=function(){return y++},t.a4=Ma,t.a5=ou,t.a6=Ti,t.a7=Lo,t.a8=kr,t.a9=zu,t.aA=function(t){if("custom"===t.type)return new yu(t);switch(t.type){case"background":return new mu(t);case"circle":return new rs(t);case"fill":return new el(t);case"fill-extrusion":return new El(t);case"heatmap":return new fs(t);case"hillshade":return new ys(t);case"line":return new Vl(t);case"raster":return new vu(t);case"symbol":return new hu(t)}},t.aB=b,t.aC=function(t,e){if(!t)return[{command:"setStyle",args:[e]}];let n=[];try{if(!Y(t.version,e.version))return[{command:"setStyle",args:[e]}];Y(t.center,e.center)||n.push({command:"setCenter",args:[e.center]}),Y(t.zoom,e.zoom)||n.push({command:"setZoom",args:[e.zoom]}),Y(t.bearing,e.bearing)||n.push({command:"setBearing",args:[e.bearing]}),Y(t.pitch,e.pitch)||n.push({command:"setPitch",args:[e.pitch]}),Y(t.sprite,e.sprite)||n.push({command:"setSprite",args:[e.sprite]}),Y(t.glyphs,e.glyphs)||n.push({command:"setGlyphs",args:[e.glyphs]}),Y(t.transition,e.transition)||n.push({command:"setTransition",args:[e.transition]}),Y(t.light,e.light)||n.push({command:"setLight",args:[e.light]}),Y(t.terrain,e.terrain)||n.push({command:"setTerrain",args:[e.terrain]}),Y(t.sky,e.sky)||n.push({command:"setSky",args:[e.sky]}),Y(t.projection,e.projection)||n.push({command:"setProjection",args:[e.projection]});const i={},r=[];!function(t,e,n,i){let r;for(r in e=e||{},t=t||{})Object.prototype.hasOwnProperty.call(t,r)&&(Object.prototype.hasOwnProperty.call(e,r)||J(r,n,i));for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)?Y(t[r],e[r])||("geojson"===t[r].type&&"geojson"===e[r].type&&tt(t,e,r)?X(n,{command:"setGeoJSONSourceData",args:[r,e[r].data]}):K(r,e,n,i)):Q(r,e,n))}(t.sources,e.sources,r,i);const a=[];t.layers&&t.layers.forEach((t=>{"source"in t&&i[t.source]?n.push({command:"removeLayer",args:[t.id]}):a.push(t)})),n=n.concat(r),function(t,e,n){e=e||[];const i=(t=t||[]).map(nt),r=e.map(nt),a=t.reduce(it,{}),o=e.reduce(it,{}),s=i.slice(),l=Object.create(null);let c,u,h,d,p;for(let t=0,e=0;t<i.length;t++)c=i[t],Object.prototype.hasOwnProperty.call(o,c)?e++:(X(n,{command:"removeLayer",args:[c]}),s.splice(s.indexOf(c,e),1));for(let t=0,e=0;t<r.length;t++)c=r[r.length-1-t],s[s.length-1-t]!==c&&(Object.prototype.hasOwnProperty.call(a,c)?(X(n,{command:"removeLayer",args:[c]}),s.splice(s.lastIndexOf(c,s.length-e),1)):e++,d=s[s.length-t],X(n,{command:"addLayer",args:[o[c],d]}),s.splice(s.length-t,0,c),l[c]=!0);for(let t=0;t<r.length;t++)if(c=r[t],u=a[c],h=o[c],!l[c]&&!Y(u,h))if(Y(u.source,h.source)&&Y(u["source-layer"],h["source-layer"])&&Y(u.type,h.type)){for(p in et(u.layout,h.layout,n,c,null,"setLayoutProperty"),et(u.paint,h.paint,n,c,null,"setPaintProperty"),Y(u.filter,h.filter)||X(n,{command:"setFilter",args:[c,h.filter]}),Y(u.minzoom,h.minzoom)&&Y(u.maxzoom,h.maxzoom)||X(n,{command:"setLayerZoomRange",args:[c,h.minzoom,h.maxzoom]}),u)Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?et(u[p],h[p],n,c,p.slice(6),"setPaintProperty"):Y(u[p],h[p])||X(n,{command:"setLayerProperty",args:[c,p,h[p]]}));for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&!Object.prototype.hasOwnProperty.call(u,p)&&"layout"!==p&&"paint"!==p&&"filter"!==p&&"metadata"!==p&&"minzoom"!==p&&"maxzoom"!==p&&(0===p.indexOf("paint.")?et(u[p],h[p],n,c,p.slice(6),"setPaintProperty"):Y(u[p],h[p])||X(n,{command:"setLayerProperty",args:[c,p,h[p]]}))}else X(n,{command:"removeLayer",args:[c]}),d=s[s.lastIndexOf(c)+1],X(n,{command:"addLayer",args:[h,d]})}(a,e.layers,n)}catch(t){console.warn("Unable to compute style diff:",t),n=[{command:"setStyle",args:[e]}]}return n},t.aD=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},t.aE=function t(e,n){if(Array.isArray(e)){if(!Array.isArray(n)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(!t(e[i],n[i]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const i in e)if(!t(e[i],n[i]))return!1;return!0}return e===n},t.aF=_,t.aG=x,t.aH=class extends ho{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.aI=po,t.aJ=class extends ho{constructor(t,e){super(t,e),this.current=go}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.aK=mo,t.aL=class extends ho{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.aM=class extends ho{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.aN=fo,t.aO=function(t,e,n,i,r,a,o){var s=1/(e-n),l=1/(i-r),c=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*l,t[14]=(o+a)*c,t[15]=1,t},t.aP=Zt,t.aQ=ns,t.aR=class extends fa{},t.aS=Zl,t.aT=class extends va{},t.aU=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.aV=ms,t.aW=Oa,t.aX=class extends Ca{},t.aY=Xa,t.aZ=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},t.a_=function(t,e){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],m=t[12],f=t[13],g=t[14],v=t[15],y=e[0],_=e[1],x=e[2],b=e[3],A=e[4],w=e[5],C=e[6],E=e[7],S=e[8],M=e[9],T=e[10],I=e[11],B=e[12],L=e[13],D=e[14],P=e[15];return Math.abs(n-y)<=Qo*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-_)<=Qo*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(r-x)<=Qo*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(a-b)<=Qo*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-A)<=Qo*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-w)<=Qo*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-C)<=Qo*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(c-E)<=Qo*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-S)<=Qo*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-M)<=Qo*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-T)<=Qo*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-I)<=Qo*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(m-B)<=Qo*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(f-L)<=Qo*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(g-D)<=Qo*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(v-P)<=Qo*Math.max(1,Math.abs(v),Math.abs(P))},t.aa=function(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((t,n,i,r)=>{const a=i||r;return e[n]=!a||a.toLowerCase(),""})),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e},t.ab=function(t,e){const n=[];for(const i in t)i in e||n.push(i);return n},t.ac=f,t.ad=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[0],o=e[1],s=e[2],l=e[3],c=e[4],u=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*r+c*i,t[1]=o*r+u*i,t[2]=s*r+h*i,t[3]=l*r+d*i,t[4]=c*r-a*i,t[5]=u*r-o*i,t[6]=h*r-s*i,t[7]=d*r-l*i,t},t.ae=function(t){var e=new Jo(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.af=is,t.ag=function(t,e){let n=0,i=0;if("constant"===t.kind)i=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:a,maxZoom:o}=t,s=r?f(Be.interpolationFactor(r,e,a,o),0,1):0;"camera"===t.kind?i=Ie.number(t.minSize,t.maxSize,s):n=s}return{uSizeT:n,uSize:i}},t.ai=function(t,{uSize:e,uSizeT:n},{lowerSize:i,upperSize:r}){return"source"===t.kind?i/Yc:"composite"===t.kind?Ie.number(i/Yc,r/Yc,n):e},t.aj=nu,t.ak=function(t,e,n,i){const r=e.y-t.y,o=e.x-t.x,s=i.y-n.y,l=i.x-n.x,c=s*o-l*r;if(0===c)return null;const u=(l*(t.y-n.y)-s*(t.x-n.x))/c;return new a(t.x+u*o,t.y+u*r)},t.al=Vu,t.am=Ro,t.an=Ko,t.ao=function(t){let e=1/0,n=1/0,i=-1/0,r=-1/0;for(const a of t)e=Math.min(e,a.x),n=Math.min(n,a.y),i=Math.max(i,a.x),r=Math.max(r,a.y);return[e,n,i,r]},t.ap=Xl,t.ar=Jc,t.as=function(t,e){var n=e[0],i=e[1],r=e[2],a=e[3],o=e[4],s=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],p=e[11],m=e[12],f=e[13],g=e[14],v=e[15],y=n*s-i*o,_=n*l-r*o,x=n*c-a*o,b=i*l-r*s,A=i*c-a*s,w=r*c-a*l,C=u*f-h*m,E=u*g-d*m,S=u*v-p*m,M=h*g-d*f,T=h*v-p*f,I=d*v-p*g,B=y*I-_*T+x*M+b*S-A*E+w*C;return B?(t[0]=(s*I-l*T+c*M)*(B=1/B),t[1]=(r*T-i*I-a*M)*B,t[2]=(f*w-g*A+v*b)*B,t[3]=(d*A-h*w-p*b)*B,t[4]=(l*S-o*I-c*E)*B,t[5]=(n*I-r*S+a*E)*B,t[6]=(g*x-m*w-v*_)*B,t[7]=(u*w-d*x+p*_)*B,t[8]=(o*T-s*S+c*C)*B,t[9]=(i*S-n*T-a*C)*B,t[10]=(m*A-f*x+v*y)*B,t[11]=(h*x-u*A-p*y)*B,t[12]=(s*E-o*M-l*C)*B,t[13]=(n*M-i*E+r*C)*B,t[14]=(f*_-m*b-g*y)*B,t[15]=(u*b-h*_+d*y)*B,t):null},t.at=ph,t.au=Hc,t.av=_h,t.aw=function(){const t={},e=q.$version;for(const n in q.$root){const i=q.$root[n];if(i.required){let r=null;r="version"===n?e:"array"===i.type?[]:{},null!=r&&(t[n]=r)}}return t},t.ax=Cr,t.ay=O,t.az=function(t){t=t.slice();const e=Object.create(null);for(let n=0;n<t.length;n++)e[t[n].id]=t[n];for(let n=0;n<t.length;n++)"ref"in t[n]&&(t[n]=$(t[n],e[t[n].ref]));return t},t.b=M,t.b0=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},t.b1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.b2=g,t.b3=Lu,t.b4=Su,t.b5=function(t,e,n,i,r){var a,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+i)*(a=1/(i-r)),t[14]=2*r*i*a):(t[10]=-1,t[14]=-2*i),t},t.b6=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*r+c*i,t[5]=o*r+u*i,t[6]=s*r+h*i,t[7]=l*r+d*i,t[8]=c*r-a*i,t[9]=u*r-o*i,t[10]=h*r-s*i,t[11]=d*r-l*i,t},t.b7=p,t.b8=m,t.b9=function(t){return t*Math.PI/180},t.bA=xi,t.bB=Rr,t.ba=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.bb=class extends ra{},t.bc=xu,t.bd=Lh,t.bf=F,t.bg=function(t,e){R.REGISTERED_PROTOCOLS[t]=e},t.bh=function(t){delete R.REGISTERED_PROTOCOLS[t]},t.bi=function(t,e){const n={};for(let i=0;i<t.length;i++){const r=e&&e[t[i].id]||Fi(t[i]);e&&(e[t[i].id]=r);let a=n[r];a||(a=n[r]=[]),a.push(t[i])}const i=[];for(const t in n)i.push(n[t]);return i},t.bj=xr,t.bk=ku,t.bl=Fu,t.bm=Tc,t.bn=function(e){e.bucket.createArrays(),e.bucket.tilePixelRatio=Mo/(512*e.bucket.overscaling),e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;const n=e.bucket.layers[0],i=n.layout,r=n._unevaluatedLayout._values,a={layoutIconSize:r["icon-size"].possiblyEvaluate(new kr(e.bucket.zoom+1),e.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new kr(e.bucket.zoom+1),e.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new kr(18))};if("composite"===e.bucket.textSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.textSizeData;a.compositeTextSizes=[r["text-size"].possiblyEvaluate(new kr(t),e.canonical),r["text-size"].possiblyEvaluate(new kr(n),e.canonical)]}if("composite"===e.bucket.iconSizeData.kind){const{minZoom:t,maxZoom:n}=e.bucket.iconSizeData;a.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new kr(t),e.canonical),r["icon-size"].possiblyEvaluate(new kr(n),e.canonical)]}const o=i.get("text-line-height")*Xl,s="viewport"!==i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement"),l=i.get("text-keep-upright"),c=i.get("text-size");for(const r of e.bucket.features){const u=i.get("text-font").evaluate(r,{},e.canonical).join(","),h=c.evaluate(r,{},e.canonical),d=a.layoutTextSize.evaluate(r,{},e.canonical),p=a.layoutIconSize.evaluate(r,{},e.canonical),m={horizontal:{},vertical:void 0},f=r.text;let g,v=[0,0];if(f){const a=f.toString(),c=i.get("text-letter-spacing").evaluate(r,{},e.canonical)*Xl,p=Mr(a)?c:0,g=i.get("text-anchor").evaluate(r,{},e.canonical),y=dh(n,r,e.canonical);if(!y){const t=i.get("text-radial-offset").evaluate(r,{},e.canonical);v=t?hh(g,[t*Xl,uh]):i.get("text-offset").evaluate(r,{},e.canonical).map((t=>t*Xl))}let _=s?"center":i.get("text-justify").evaluate(r,{},e.canonical);const x="point"===i.get("symbol-placement")?i.get("text-max-width").evaluate(r,{},e.canonical)*Xl:1/0,b=()=>{e.bucket.allowVerticalPlacement&&Sr(a)&&(m.vertical=Pc(f,e.glyphMap,e.glyphPositions,e.imagePositions,u,x,o,g,"left",p,v,t.ah.vertical,!0,d,h))};if(!s&&y){const n=new Set;if("auto"===_)for(let t=0;t<y.values.length;t+=2)n.add(ph(y.values[t]));else n.add(_);let i=!1;for(const r of n)if(!m.horizontal[r])if(i)m.horizontal[r]=m.horizontal[0];else{const n=Pc(f,e.glyphMap,e.glyphPositions,e.imagePositions,u,x,o,"center",r,p,v,t.ah.horizontal,!1,d,h);n&&(m.horizontal[r]=n,i=1===n.positionedLines.length)}b()}else{"auto"===_&&(_=ph(g));const n=Pc(f,e.glyphMap,e.glyphPositions,e.imagePositions,u,x,o,g,_,p,v,t.ah.horizontal,!1,d,h);n&&(m.horizontal[_]=n),b(),Sr(a)&&s&&l&&(m.vertical=Pc(f,e.glyphMap,e.glyphPositions,e.imagePositions,u,x,o,g,_,p,v,t.ah.vertical,!1,d,h))}}let y=!1;if(r.icon&&r.icon.name){const t=e.imageMap[r.icon.name];t&&(g=Wc(e.imagePositions[r.icon.name],i.get("icon-offset").evaluate(r,{},e.canonical),i.get("icon-anchor").evaluate(r,{},e.canonical)),y=!!t.sdf,void 0===e.bucket.sdfIcons?e.bucket.sdfIcons=y:e.bucket.sdfIcons!==y&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.bucket.pixelRatio||0!==i.get("icon-rotate").constantOr(1))&&(e.bucket.iconsNeedLinear=!0))}const _=gh(m.horizontal)||m.vertical;e.bucket.iconsInText=!!_&&_.iconsInText,(_||g)&&mh(e.bucket,r,m,g,e.imageMap,a,d,p,v,y,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()},t.bo=kl,t.bp=Qs,t.bq=xl,t.br=al,t.bs=_c,t.bt=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return 0===t.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}},t.bu=function(t,n,i,r,a){return e(this,void 0,void 0,(function*(){if(d())try{return yield I(t,n,i,r,a)}catch(t){}return function(t,e,n,i,r){const a=t.width,o=t.height;B&&L||(B=new OffscreenCanvas(a,o),L=B.getContext("2d",{willReadFrequently:!0})),B.width=a,B.height=o,L.drawImage(t,0,0,a,o);const s=L.getImageData(e,n,i,r);return L.clearRect(0,0,a,o),s.data}(t,n,i,r,a)}))},t.bv=Ru,t.bw=n,t.bx=i,t.by=Ql,t.bz=function(t){return t.message===D},t.c=P,t.d=t=>e(void 0,void 0,void 0,(function*(){if(0===t.byteLength)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(t)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),t.e=v,t.f=t=>new Promise(((e,n)=>{const i=new Image;i.onload=()=>{e(i),URL.revokeObjectURL(i.src),i.onload=null,window.requestAnimationFrame((()=>{i.src=T}))},i.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const r=new Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?URL.createObjectURL(r):T})),t.g=k,t.h=(t,e)=>N(v(t,{type:"json"}),e),t.i=E,t.j=j,t.k=H,t.l=(t,e)=>N(v(t,{type:"arrayBuffer"}),e),t.m=N,t.n=function(t){return new _c(t).readFields(bc,[])},t.o=ds,t.p=Ec,t.q=Yr,t.r=mr,t.s=U,t.t=vr,t.u=Er,t.v=q,t.w=w,t.x=pr,t.y=function([t,e,n]){return e+=90,e*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(e)*Math.sin(n),y:t*Math.sin(e)*Math.sin(n),z:t*Math.cos(n)}},t.z=Ie})),n("worker",0,(function(t){class e{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,n){for(const n of e){this._layerConfigs[n.id]=n;const e=this._layers[n.id]=t.aA(n);e._featureFilter=t.a6(e.filter),this.keyCache[n.id]&&delete this.keyCache[n.id]}for(const t of n)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const i=t.bi(Object.values(this._layerConfigs),this.keyCache);for(const t of i){const e=t.map((t=>this._layers[t.id])),n=e[0];if("none"===n.visibility)continue;const i=n.source||"";let r=this.familiesBySource[i];r||(r=this.familiesBySource[i]={});const a=n.sourceLayer||"_geojsonTileLayer";let o=r[a];o||(o=r[a]=[]),o.push(e)}}}class n{constructor(e){const n={},i=[];for(const t in e){const r=e[t],a=n[t]={};for(const t in r){const e=r[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n={x:0,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2};i.push(n),a[t]={rect:n,metrics:e.metrics}}}const{w:r,h:a}=t.p(i),o=new t.o({width:r||1,height:a||1});for(const i in e){const r=e[i];for(const e in r){const a=r[+e];if(!a||0===a.bitmap.width||0===a.bitmap.height)continue;const s=n[i][e].rect;t.o.copy(a.bitmap,o,{x:0,y:0},{x:s.x+1,y:s.y+1},a.bitmap)}}this.image=o,this.positions=n}}t.bj("GlyphAtlas",n);class i{constructor(e){this.tileID=new t.Q(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.inFlightDependencies=[]}parse(e,i,a,o){return t._(this,void 0,void 0,(function*(){this.status="parsing",this.data=e,this.collisionBoxArray=new t.a4;const s=new t.bk(Object.keys(e.layers).sort()),l=new t.bl(this.tileID,this.promoteId);l.bucketLayerIDs=[];const c={},u={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},h=i.familiesBySource[this.source];for(const n in h){const i=e.layers[n];if(!i)continue;1===i.version&&t.w(`Vector tile source "${this.source}" layer "${n}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const o=s.encode(n),d=[];for(let t=0;t<i.length;t++){const e=i.feature(t),r=l.getId(e,n);d.push({feature:e,id:r,index:t,sourceLayerIndex:o})}for(const e of h[n]){const n=e[0];n.source!==this.source&&t.w(`layer.source = ${n.source} does not equal this.source = ${this.source}`),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(r(e,this.zoom,a),(c[n.id]=n.createBucket({index:l.bucketLayerIDs.length,layers:e,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(d,u,this.tileID.canonical),l.bucketLayerIDs.push(e.map((t=>t.id))))}}const d=t.aF(u.glyphDependencies,(t=>Object.keys(t).map(Number)));this.inFlightDependencies.forEach((t=>null==t?void 0:t.abort())),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(d).length){const t=new AbortController;this.inFlightDependencies.push(t),p=o.sendAsync({type:"GG",data:{stacks:d,source:this.source,tileID:this.tileID,type:"glyphs"}},t)}const m=Object.keys(u.iconDependencies);let f=Promise.resolve({});if(m.length){const t=new AbortController;this.inFlightDependencies.push(t),f=o.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"icons"}},t)}const g=Object.keys(u.patternDependencies);let v=Promise.resolve({});if(g.length){const t=new AbortController;this.inFlightDependencies.push(t),v=o.sendAsync({type:"GI",data:{icons:g,source:this.source,tileID:this.tileID,type:"patterns"}},t)}const[y,_,x]=yield Promise.all([p,f,v]),b=new n(y),A=new t.bm(_,x);for(const e in c){const n=c[e];n instanceof t.a5?(r(n.layers,this.zoom,a),t.bn({bucket:n,glyphMap:y,glyphPositions:b.positions,imageMap:_,imagePositions:A.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):n.hasPattern&&(n instanceof t.bo||n instanceof t.bp||n instanceof t.bq)&&(r(n.layers,this.zoom,a),n.addFeatures(u,this.tileID.canonical,A.patternPositions))}return this.status="done",{buckets:Object.values(c).filter((t=>!t.isEmpty())),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:b.image,imageAtlas:A,glyphMap:this.returnDependencies?y:null,iconMap:this.returnDependencies?_:null,glyphPositions:this.returnDependencies?b.positions:null}}))}}function r(e,n,i){const r=new t.a8(n);for(const t of e)t.recalculate(r,i)}class a{constructor(t,e,n){this.actor=t,this.layerIndex=e,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(e,n){return t._(this,void 0,void 0,(function*(){const i=yield t.l(e.request,n);try{return{vectorTile:new t.br.VectorTile(new t.bs(i.data)),rawData:i.data,cacheControl:i.cacheControl,expires:i.expires}}catch(t){const n=new Uint8Array(i.data);let r=`Unable to parse the tile at ${e.request.url}, `;throw r+=31===n[0]&&139===n[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${t.message}`,new Error(r)}}))}loadTile(e){return t._(this,void 0,void 0,(function*(){const n=e.uid,r=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bt(e.request),a=new i(e);this.loading[n]=a;const o=new AbortController;a.abort=o;try{const i=yield this.loadVectorTile(e,o);if(delete this.loading[n],!i)return null;const s=i.rawData,l={};i.expires&&(l.expires=i.expires),i.cacheControl&&(l.cacheControl=i.cacheControl);const c={};if(r){const t=r.finish();t&&(c.resourceTiming=JSON.parse(JSON.stringify(t)))}a.vectorTile=i.vectorTile;const u=a.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[n]=a,this.fetching[n]={rawTileData:s,cacheControl:l,resourceTiming:c};try{const e=yield u;return t.e({rawTileData:s.slice(0)},e,l,c)}finally{delete this.fetching[n]}}catch(t){throw delete this.loading[n],a.status="done",this.loaded[n]=a,t}}))}reloadTile(e){return t._(this,void 0,void 0,(function*(){const n=e.uid;if(!this.loaded||!this.loaded[n])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const i=this.loaded[n];if(i.showCollisionBoxes=e.showCollisionBoxes,"parsing"===i.status){const e=yield i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor);let r;if(this.fetching[n]){const{rawTileData:i,cacheControl:a,resourceTiming:o}=this.fetching[n];delete this.fetching[n],r=t.e({rawTileData:i.slice(0)},e,a,o)}else r=e;return r}if("done"===i.status&&i.vectorTile)return i.parse(i.vectorTile,this.layerIndex,this.availableImages,this.actor)}))}abortTile(e){return t._(this,void 0,void 0,(function*(){const t=this.loading,n=e.uid;t&&t[n]&&t[n].abort&&(t[n].abort.abort(),delete t[n])}))}removeTile(e){return t._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[e.uid]&&delete this.loaded[e.uid]}))}}class o{constructor(){this.loaded={}}loadTile(e){return t._(this,void 0,void 0,(function*(){const{uid:n,encoding:i,rawImageData:r,redFactor:a,greenFactor:o,blueFactor:s,baseShift:l}=e,c=r.width+2,u=r.height+2,h=t.b(r)?new t.R({width:c,height:u},yield t.bu(r,-1,-1,c,u)):r,d=new t.bv(n,h,i,a,o,s,l);return this.loaded=this.loaded||{},this.loaded[n]=d,d}))}removeTile(t){const e=this.loaded,n=t.uid;e&&e[n]&&delete e[n]}}function s(t,e){if(0!==t.length){l(t[0],e);for(var n=1;n<t.length;n++)l(t[n],!e)}}function l(t,e){for(var n=0,i=0,r=0,a=t.length,o=a-1;r<a;o=r++){var s=(t[r][0]-t[o][0])*(t[o][1]+t[r][1]),l=n+s;i+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+i>=0!=!!e&&t.reverse()}var c=t.bw((function t(e,n){var i,r=e&&e.type;if("FeatureCollection"===r)for(i=0;i<e.features.length;i++)t(e.features[i],n);else if("GeometryCollection"===r)for(i=0;i<e.geometries.length;i++)t(e.geometries[i],n);else if("Feature"===r)t(e.geometry,n);else if("Polygon"===r)s(e.coordinates,n);else if("MultiPolygon"===r)for(i=0;i<e.coordinates.length;i++)s(e.coordinates[i],n);return e}));const u=t.br.VectorTileFeature.prototype.toGeoJSON;var h={exports:{}},d=t.bx,p=t.br.VectorTileFeature,m=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function g(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new g(this.features[t],this.options.extent)},g.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var e=0;e<t.length;e++){for(var n=t[e],i=[],r=0;r<n.length;r++)i.push(new d(n[r][0],n[r][1]));this.geometry.push(i)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<t.length;a++)for(var o=t[a],s=0;s<o.length;s++){var l=o[s];e=Math.min(e,l.x),n=Math.max(n,l.x),i=Math.min(i,l.y),r=Math.max(r,l.y)}return[e,i,n,r]},g.prototype.toGeoJSON=p.prototype.toGeoJSON;var v=t.by,y=m;function _(t){var e=new v;return function(t,e){for(var n in t.layers)e.writeMessage(3,x,t.layers[n])}(t,e),e.finish()}function x(t,e){var n;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var i={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<t.length;n++)i.feature=t.feature(n),e.writeMessage(2,b,i);var r=i.keys;for(n=0;n<r.length;n++)e.writeStringField(3,r[n]);var a=i.values;for(n=0;n<a.length;n++)e.writeMessage(4,S,a[n])}function b(t,e){var n=t.feature;void 0!==n.id&&e.writeVarintField(1,n.id),e.writeMessage(2,A,t),e.writeVarintField(3,n.type),e.writeMessage(4,E,n)}function A(t,e){var n=t.feature,i=t.keys,r=t.values,a=t.keycache,o=t.valuecache;for(var s in n.properties){var l=n.properties[s],c=a[s];if(null!==l){void 0===c&&(i.push(s),a[s]=c=i.length-1),e.writeVarint(c);var u=typeof l;"string"!==u&&"boolean"!==u&&"number"!==u&&(l=JSON.stringify(l));var h=u+":"+l,d=o[h];void 0===d&&(r.push(l),o[h]=d=r.length-1),e.writeVarint(d)}}}function w(t,e){return(e<<3)+(7&t)}function C(t){return t<<1^t>>31}function E(t,e){for(var n=t.loadGeometry(),i=t.type,r=0,a=0,o=n.length,s=0;s<o;s++){var l=n[s],c=1;1===i&&(c=l.length),e.writeVarint(w(1,c));for(var u=3===i?l.length-1:l.length,h=0;h<u;h++){1===h&&1!==i&&e.writeVarint(w(2,u-1));var d=l[h].x-r,p=l[h].y-a;e.writeVarint(C(d)),e.writeVarint(C(p)),r+=d,a+=p}3===i&&e.writeVarint(w(7,1))}}function S(t,e){var n=typeof t;"string"===n?e.writeStringField(1,t):"boolean"===n?e.writeBooleanField(7,t):"number"===n&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}h.exports=_,h.exports.fromVectorTileJs=_,h.exports.fromGeojsonVt=function(t,e){e=e||{};var n={};for(var i in t)n[i]=new y(t[i].features,e),n[i].name=i,n[i].version=e.version,n[i].extent=e.extent;return _({layers:n})},h.exports.GeoJSONWrapper=y;var M=t.bw(h.exports);const T={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},I=Math.fround||(B=new Float32Array(1),t=>(B[0]=+t,B[0]));var B;const L=3,D=5,P=6;class R{constructor(t){this.options=Object.assign(Object.create(T),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:n,maxZoom:i}=this.options;e&&console.time("total time");const r=`prepare ${t.length} points`;e&&console.time(r),this.points=t;const a=[];for(let e=0;e<t.length;e++){const n=t[e];if(!n.geometry)continue;const[i,r]=n.geometry.coordinates,o=I(F(i)),s=I(O(r));a.push(o,s,1/0,e,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[i+1]=this._createTree(a);e&&console.timeEnd(r);for(let t=i;t>=n;t--){const n=+Date.now();o=this.trees[t]=this._createTree(this._cluster(o,t)),e&&console.log("z%d: %d clusters in %dms",t,o.numItems,+Date.now()-n)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let n=((t[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,r=180;else if(n>r){const t=this.getClusters([n,i,180,a],e),o=this.getClusters([-180,i,r,a],e);return t.concat(o)}const o=this.trees[this._limitZoom(e)],s=o.range(F(n),O(a),F(r),O(i)),l=o.data,c=[];for(const t of s){const e=this.stride*t;c.push(l[e+D]>1?k(l,e,this.clusterProps):this.points[l[e+L]])}return c}getChildren(t){const e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",r=this.trees[n];if(!r)throw new Error(i);const a=r.data;if(e*this.stride>=a.length)throw new Error(i);const o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=r.within(a[e*this.stride],a[e*this.stride+1],o),l=[];for(const e of s){const n=e*this.stride;a[n+4]===t&&l.push(a[n+D]>1?k(a,n,this.clusterProps):this.points[a[n+L]])}if(0===l.length)throw new Error(i);return l}getLeaves(t,e,n){const i=[];return this._appendLeaves(i,t,e=e||10,n=n||0,0),i}getTile(t,e,n){const i=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:a,radius:o}=this.options,s=o/a,l=(n-s)/r,c=(n+1+s)/r,u={features:[]};return this._addTileFeatures(i.range((e-s)/r,l,(e+1+s)/r,c),i.data,e,n,r,u),0===e&&this._addTileFeatures(i.range(1-s/r,l,1,c),i.data,r,n,r,u),e===r-1&&this._addTileFeatures(i.range(0,l,s/r,c),i.data,-1,n,r,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e}_appendLeaves(t,e,n,i,r){const a=this.getChildren(e);for(const e of a){const a=e.properties;if(a&&a.cluster?r+a.point_count<=i?r+=a.point_count:r=this._appendLeaves(t,a.cluster_id,n,i,r):r<i?r++:t.push(e),t.length===n)break}return r}_createTree(e){const n=new t.av(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let t=0;t<e.length;t+=this.stride)n.add(e[t],e[t+1]);return n.finish(),n.data=e,n}_addTileFeatures(t,e,n,i,r,a){for(const o of t){const t=o*this.stride,s=e[t+D]>1;let l,c,u;if(s)l=z(e,t,this.clusterProps),c=e[t],u=e[t+1];else{const n=this.points[e[t+L]];l=n.properties;const[i,r]=n.geometry.coordinates;c=F(i),u=O(r)}const h={type:1,geometry:[[Math.round(this.options.extent*(c*r-n)),Math.round(this.options.extent*(u*r-i))]],tags:l};let d;d=s||this.options.generateId?e[t+L]:this.points[e[t+L]].id,void 0!==d&&(h.id=d),a.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:n,extent:i,reduce:r,minPoints:a}=this.options,o=n/(i*Math.pow(2,e)),s=t.data,l=[],c=this.stride;for(let n=0;n<s.length;n+=c){if(s[n+2]<=e)continue;s[n+2]=e;const i=s[n],u=s[n+1],h=t.within(s[n],s[n+1],o),d=s[n+D];let p=d;for(const t of h){const n=t*c;s[n+2]>e&&(p+=s[n+D])}if(p>d&&p>=a){let t,a=i*d,o=u*d,m=-1;const f=(n/c<<5)+(e+1)+this.points.length;for(const i of h){const l=i*c;if(s[l+2]<=e)continue;s[l+2]=e;const u=s[l+D];a+=s[l]*u,o+=s[l+1]*u,s[l+4]=f,r&&(t||(t=this._map(s,n,!0),m=this.clusterProps.length,this.clusterProps.push(t)),r(t,this._map(s,l)))}s[n+4]=f,l.push(a/p,o/p,1/0,f,-1,p),r&&l.push(m)}else{for(let t=0;t<c;t++)l.push(s[n+t]);if(p>1)for(const t of h){const n=t*c;if(!(s[n+2]<=e)){s[n+2]=e;for(let t=0;t<c;t++)l.push(s[n+t])}}}}return l}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,n){if(t[e+D]>1){const i=this.clusterProps[t[e+P]];return n?Object.assign({},i):i}const i=this.points[t[e+L]].properties,r=this.options.map(i);return n&&r===i?Object.assign({},r):r}}function k(t,e,n){return{type:"Feature",id:t[e+L],properties:z(t,e,n),geometry:{type:"Point",coordinates:[(i=t[e],360*(i-.5)),N(t[e+1])]}};var i}function z(t,e,n){const i=t[e+D],r=i>=1e4?`${Math.round(i/1e3)}k`:i>=1e3?Math.round(i/100)/10+"k":i,a=t[e+P],o=-1===a?{}:Object.assign({},n[a]);return Object.assign(o,{cluster:!0,cluster_id:t[e+L],point_count:i,point_count_abbreviated:r})}function F(t){return t/360+.5}function O(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function N(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function U(t,e,n,i){for(var r,a=i,o=n-e>>1,s=n-e,l=t[e],c=t[e+1],u=t[n],h=t[n+1],d=e+3;d<n;d+=3){var p=V(t[d],t[d+1],l,c,u,h);if(p>a)r=d,a=p;else if(p===a){var m=Math.abs(d-o);m<s&&(r=d,s=m)}}a>i&&(r-e>3&&U(t,e,r,i),t[r+2]=a,n-r>3&&U(t,r,n,i))}function V(t,e,n,i,r,a){var o=r-n,s=a-i;if(0!==o||0!==s){var l=((t-n)*o+(e-i)*s)/(o*o+s*s);l>1?(n=r,i=a):l>0&&(n+=o*l,i+=s*l)}return(o=t-n)*o+(s=e-i)*s}function G(t,e,n,i){var r={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)H(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)H(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var r=0;r<e[i].length;r++)H(t,e[i][r])}(r),r}function H(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function j(t,e,n,i){if(e.geometry){var r=e.geometry.coordinates,a=e.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],l=e.id;if(n.promoteId?l=e.properties[n.promoteId]:n.generateId&&(l=i||0),"Point"===a)W(r,s);else if("MultiPoint"===a)for(var c=0;c<r.length;c++)W(r[c],s);else if("LineString"===a)q(r,s,o,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(c=0;c<r.length;c++)q(r[c],s=[],o,!1),t.push(G(l,"LineString",s,e.properties));return}Z(r,s,o,!1)}else if("Polygon"===a)Z(r,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(c=0;c<e.geometry.geometries.length;c++)j(t,{id:l,geometry:e.geometry.geometries[c],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<r.length;c++){var u=[];Z(r[c],u,o,!0),s.push(u)}}t.push(G(l,a,s,e.properties))}}function W(t,e){e.push($(t[0])),e.push(Y(t[1])),e.push(0)}function q(t,e,n,i){for(var r,a,o=0,s=0;s<t.length;s++){var l=$(t[s][0]),c=Y(t[s][1]);e.push(l),e.push(c),e.push(0),s>0&&(o+=i?(r*c-l*a)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(c-a,2))),r=l,a=c}var u=e.length-3;e[2]=1,U(e,0,u,n),e[u+2]=1,e.size=Math.abs(o),e.start=0,e.end=e.size}function Z(t,e,n,i){for(var r=0;r<t.length;r++){var a=[];q(t[r],a,n,i),e.push(a)}}function $(t){return t/360+.5}function Y(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function X(t,e,n,i,r,a,o,s){if(i/=e,a>=(n/=e)&&o<i)return t;if(o<n||a>=i)return null;for(var l=[],c=0;c<t.length;c++){var u=t[c],h=u.geometry,d=u.type,p=0===r?u.minX:u.minY,m=0===r?u.maxX:u.maxY;if(p>=n&&m<i)l.push(u);else if(!(m<n||p>=i)){var f=[];if("Point"===d||"MultiPoint"===d)Q(h,f,n,i,r);else if("LineString"===d)J(h,f,n,i,r,!1,s.lineMetrics);else if("MultiLineString"===d)tt(h,f,n,i,r,!1);else if("Polygon"===d)tt(h,f,n,i,r,!0);else if("MultiPolygon"===d)for(var g=0;g<h.length;g++){var v=[];tt(h[g],v,n,i,r,!0),v.length&&f.push(v)}if(f.length){if(s.lineMetrics&&"LineString"===d){for(g=0;g<f.length;g++)l.push(G(u.id,d,f[g],u.tags));continue}"LineString"!==d&&"MultiLineString"!==d||(1===f.length?(d="LineString",f=f[0]):d="MultiLineString"),"Point"!==d&&"MultiPoint"!==d||(d=3===f.length?"Point":"MultiPoint"),l.push(G(u.id,d,f,u.tags))}}}return l.length?l:null}function Q(t,e,n,i,r){for(var a=0;a<t.length;a+=3){var o=t[a+r];o>=n&&o<=i&&(e.push(t[a]),e.push(t[a+1]),e.push(t[a+2]))}}function J(t,e,n,i,r,a,o){for(var s,l,c=K(t),u=0===r?nt:it,h=t.start,d=0;d<t.length-3;d+=3){var p=t[d],m=t[d+1],f=t[d+2],g=t[d+3],v=t[d+4],y=0===r?p:m,_=0===r?g:v,x=!1;o&&(s=Math.sqrt(Math.pow(p-g,2)+Math.pow(m-v,2))),y<n?_>n&&(l=u(c,p,m,g,v,n),o&&(c.start=h+s*l)):y>i?_<i&&(l=u(c,p,m,g,v,i),o&&(c.start=h+s*l)):et(c,p,m,f),_<n&&y>=n&&(l=u(c,p,m,g,v,n),x=!0),_>i&&y<=i&&(l=u(c,p,m,g,v,i),x=!0),!a&&x&&(o&&(c.end=h+s*l),e.push(c),c=K(t)),o&&(h+=s)}var b=t.length-3;p=t[b],m=t[b+1],f=t[b+2],(y=0===r?p:m)>=n&&y<=i&&et(c,p,m,f),b=c.length-3,a&&b>=3&&(c[b]!==c[0]||c[b+1]!==c[1])&&et(c,c[0],c[1],c[2]),c.length&&e.push(c)}function K(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function tt(t,e,n,i,r,a){for(var o=0;o<t.length;o++)J(t[o],e,n,i,r,a,!1)}function et(t,e,n,i){t.push(e),t.push(n),t.push(i)}function nt(t,e,n,i,r,a){var o=(a-e)/(i-e);return t.push(a),t.push(n+(r-n)*o),t.push(1),o}function it(t,e,n,i,r,a){var o=(a-n)/(r-n);return t.push(e+(i-e)*o),t.push(a),t.push(1),o}function rt(t,e){for(var n=[],i=0;i<t.length;i++){var r,a=t[i],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)r=at(a.geometry,e);else if("MultiLineString"===o||"Polygon"===o){r=[];for(var s=0;s<a.geometry.length;s++)r.push(at(a.geometry[s],e))}else if("MultiPolygon"===o)for(r=[],s=0;s<a.geometry.length;s++){for(var l=[],c=0;c<a.geometry[s].length;c++)l.push(at(a.geometry[s][c],e));r.push(l)}n.push(G(a.id,o,r,a.tags))}return n}function at(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function ot(t,e){if(t.transformed)return t;var n,i,r,a=1<<t.z,o=t.x,s=t.y;for(n=0;n<t.features.length;n++){var l=t.features[n],c=l.geometry,u=l.type;if(l.geometry=[],1===u)for(i=0;i<c.length;i+=2)l.geometry.push(st(c[i],c[i+1],e,a,o,s));else for(i=0;i<c.length;i++){var h=[];for(r=0;r<c[i].length;r+=2)h.push(st(c[i][r],c[i][r+1],e,a,o,s));l.geometry.push(h)}}return t.transformed=!0,t}function st(t,e,n,i,r,a){return[Math.round(n*(t*i-r)),Math.round(n*(e*i-a))]}function lt(t,e,n,i,r){for(var a=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){o.numFeatures++,ct(o,t[s],a,r);var l=t[s].minX,c=t[s].minY,u=t[s].maxX,h=t[s].maxY;l<o.minX&&(o.minX=l),c<o.minY&&(o.minY=c),u>o.maxX&&(o.maxX=u),h>o.maxY&&(o.maxY=h)}return o}function ct(t,e,n,i){var r=e.geometry,a=e.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<r.length;s+=3)o.push(r[s]),o.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===a)ut(o,r,t,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<r.length;s++)ut(o,r[s],t,n,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<r.length;l++){var c=r[l];for(s=0;s<c.length;s++)ut(o,c[s],t,n,!0,0===s)}if(o.length){var u=e.tags||null;if("LineString"===a&&i.lineMetrics){for(var h in u={},e.tags)u[h]=e.tags[h];u.mapbox_clip_start=r.start/r.size,u.mapbox_clip_end=r.end/r.size}var d={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:u};null!==e.id&&(d.id=e.id),t.features.push(d)}}function ut(t,e,n,i,r,a){var o=i*i;if(i>0&&e.size<(r?o:i))n.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===i||e[l+2]>o)&&(n.numSimplified++,s.push(e[l]),s.push(e[l+1])),n.numPoints++;r&&function(t,e){for(var n=0,i=0,r=t.length,a=r-2;i<r;a=i,i+=2)n+=(t[i]-t[a])*(t[i+1]+t[a+1]);if(n>0===e)for(i=0,r=t.length;i<r/2;i+=2){var o=t[i],s=t[i+1];t[i]=t[r-2-i],t[i+1]=t[r-1-i],t[r-2-i]=o,t[r-1-i]=s}}(s,a),t.push(s)}}function ht(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)j(n,t.features[i],e,i);else j(n,"Feature"===t.type?t:{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),i=function(t,e){var n=e.buffer/e.extent,i=t,r=X(t,1,-1-n,n,0,-1,2,e),a=X(t,1,1-n,2+n,0,-1,2,e);return(r||a)&&(i=X(t,1,-n,1+n,0,-1,2,e)||[],r&&(i=rt(r,1).concat(i)),a&&(i=i.concat(rt(a,-1)))),i}(i,e),i.length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function dt(t,e,n){return 32*((1<<t)*n+e)+t}function pt(t,e){return e?t.properties[e]:t.id}function mt(t,e){if(null==t)return!0;if("Feature"===t.type)return null!=pt(t,e);if("FeatureCollection"===t.type){const n=new Set;for(const i of t.features){const t=pt(i,e);if(null==t)return!1;if(n.has(t))return!1;n.add(t)}return!0}return!1}function ft(t,e){const n=new Map;if(null==t);else if("Feature"===t.type)n.set(pt(t,e),t);else for(const i of t.features)n.set(pt(i,e),i);return n}ht.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ht.prototype.splitTile=function(t,e,n,i,r,a,o){for(var s=[t,e,n,i],l=this.options,c=l.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var u=1<<e,h=dt(e,n,i),d=this.tiles[h];if(!d&&(c>1&&console.time("creation"),d=this.tiles[h]=lt(t,e,n,i,l),this.tileCoords.push({z:e,x:n,y:i}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,d.numFeatures,d.numPoints,d.numSimplified),console.timeEnd("creation"));var p="z"+e;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(d.source=t,r){if(e===l.maxZoom||e===r)continue;var m=1<<r-e;if(n!==Math.floor(a/m)||i!==Math.floor(o/m))continue}else if(e===l.indexMaxZoom||d.numPoints<=l.indexMaxPoints)continue;if(d.source=null,0!==t.length){c>1&&console.time("clipping");var f,g,v,y,_,x,b=.5*l.buffer/l.extent,A=.5-b,w=.5+b,C=1+b;f=g=v=y=null,_=X(t,u,n-b,n+w,0,d.minX,d.maxX,l),x=X(t,u,n+A,n+C,0,d.minX,d.maxX,l),t=null,_&&(f=X(_,u,i-b,i+w,1,d.minY,d.maxY,l),g=X(_,u,i+A,i+C,1,d.minY,d.maxY,l),_=null),x&&(v=X(x,u,i-b,i+w,1,d.minY,d.maxY,l),y=X(x,u,i+A,i+C,1,d.minY,d.maxY,l),x=null),c>1&&console.timeEnd("clipping"),s.push(f||[],e+1,2*n,2*i),s.push(g||[],e+1,2*n,2*i+1),s.push(v||[],e+1,2*n+1,2*i),s.push(y||[],e+1,2*n+1,2*i+1)}}},ht.prototype.getTile=function(t,e,n){var i=this.options,r=i.extent,a=i.debug;if(t<0||t>24)return null;var o=1<<t,s=dt(t,e=(e%o+o)%o,n);if(this.tiles[s])return ot(this.tiles[s],r);a>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var l,c=t,u=e,h=n;!l&&c>0;)c--,u=Math.floor(u/2),h=Math.floor(h/2),l=this.tiles[dt(c,u,h)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",c,u,h),a>1&&console.time("drilling down"),this.splitTile(l.source,c,u,h,t,e,n),a>1&&console.timeEnd("drilling down"),this.tiles[s]?ot(this.tiles[s],r):null):null};class gt extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(e,n){return t._(this,void 0,void 0,(function*(){const n=e.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const i=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!i)return null;const r=new class{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.W,this.length=e.length,this._features=e}feature(e){return new class{constructor(e){this._feature=e,this.extent=t.W,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const n of this._feature.geometry)e.push([new t.P(n[0],n[1])]);return e}{const e=[];for(const n of this._feature.geometry){const i=[];for(const e of n)i.push(new t.P(e[0],e[1]));e.push(i)}return e}}toGeoJSON(t,e,n){return u.call(this,t,e,n)}}(this._features[e])}}(i.features);let a=M(r);return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),{vectorTile:r,rawData:a.buffer}}))}loadData(e){return t._(this,void 0,void 0,(function*(){var n;null===(n=this._pendingRequest)||void 0===n||n.abort();const i=!!(e&&e.request&&e.request.collectResourceTiming)&&new t.bt(e.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(e,this._pendingRequest),this._geoJSONIndex=e.cluster?new R(function({superclusterOptions:e,clusterProperties:n}){if(!n||!e)return e;const i={},r={},a={accumulated:null,zoom:0},o={properties:null},s=Object.keys(n);for(const e of s){const[a,o]=n[e],s=t.bA(o),l=t.bA("string"==typeof a?[a,["accumulated"],["get",e]]:a);i[e]=s.value,r[e]=l.value}return e.map=t=>{o.properties=t;const e={};for(const t of s)e[t]=i[t].evaluate(a,o);return e},e.reduce=(t,e)=>{o.properties=e;for(const e of s)a.accumulated=t[e],t[e]=r[e].evaluate(a,o)},e}(e)).load((yield this._pendingData).features):new ht(yield this._pendingData,e.geojsonVtOptions),this.loaded={};const n={};if(i){const t=i.finish();t&&(n.resourceTiming={},n.resourceTiming[e.source]=JSON.parse(JSON.stringify(t)))}return n}catch(e){if(delete this._pendingRequest,t.bz(e))return{abandoned:!0};throw e}}))}getData(){return t._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(t){const e=this.loaded;return e&&e[t.uid]?super.reloadTile(t):this.loadTile(t)}loadAndProcessGeoJSON(e,n){return t._(this,void 0,void 0,(function*(){let i=yield this.loadGeoJSON(e,n);if(delete this._pendingRequest,"object"!=typeof i)throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`);if(c(i,!0),e.filter){const n=t.bA(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map((t=>`${t.key}: ${t.message}`)).join(", "));const r=i.features.filter((t=>n.value.evaluate({zoom:0},t)));i={type:"FeatureCollection",features:r}}return i}))}loadGeoJSON(e,n){return t._(this,void 0,void 0,(function*(){const{promoteId:i}=e;if(e.request){const r=yield t.h(e.request,n);return this._dataUpdateable=mt(r.data,i)?ft(r.data,i):void 0,r.data}if("string"==typeof e.data)try{const t=JSON.parse(e.data);return this._dataUpdateable=mt(t,i)?ft(t,i):void 0,t}catch(t){throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`)}if(!e.dataDiff)throw new Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${e.source}`);return function(t,e,n){var i,r,a,o;if(e.removeAll&&t.clear(),e.remove)for(const n of e.remove)t.delete(n);if(e.add)for(const i of e.add){const e=pt(i,n);null!=e&&t.set(e,i)}if(e.update)for(const n of e.update){let e=t.get(n.id);if(null==e)continue;const s=!n.removeAllProperties&&((null===(i=n.removeProperties)||void 0===i?void 0:i.length)>0||(null===(r=n.addOrUpdateProperties)||void 0===r?void 0:r.length)>0);if((n.newGeometry||n.removeAllProperties||s)&&(e=Object.assign({},e),t.set(n.id,e),s&&(e.properties=Object.assign({},e.properties))),n.newGeometry&&(e.geometry=n.newGeometry),n.removeAllProperties)e.properties={};else if((null===(a=n.removeProperties)||void 0===a?void 0:a.length)>0)for(const t of n.removeProperties)Object.prototype.hasOwnProperty.call(e.properties,t)&&delete e.properties[t];if((null===(o=n.addOrUpdateProperties)||void 0===o?void 0:o.length)>0)for(const{key:t,value:i}of n.addOrUpdateProperties)e.properties[t]=i}}(this._dataUpdateable,e.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(e){return t._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(t){return this._geoJSONIndex.getClusterExpansionZoom(t.clusterId)}getClusterChildren(t){return this._geoJSONIndex.getChildren(t.clusterId)}getClusterLeaves(t){return this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset)}}class vt{constructor(e){this.self=e,this.actor=new t.C(e),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(t,e)=>{if(this.externalWorkerSourceTypes[t])throw new Error(`Worker source with name "${t}" already registered.`);this.externalWorkerSourceTypes[t]=e},this.self.addProtocol=t.bg,this.self.removeProtocol=t.bh,this.self.registerRTLTextPlugin=e=>{if(t.bB.isParsed())throw new Error("RTL text plugin already registered.");t.bB.setMethods(e)},this.actor.registerMessageHandler("LDT",((t,e)=>this._getDEMWorkerSource(t,e.source).loadTile(e))),this.actor.registerMessageHandler("RDT",((e,n)=>t._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(e,n.source).removeTile(n)})))),this.actor.registerMessageHandler("GCEZ",((e,n)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,n.type,n.source).getClusterExpansionZoom(n)})))),this.actor.registerMessageHandler("GCC",((e,n)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,n.type,n.source).getClusterChildren(n)})))),this.actor.registerMessageHandler("GCL",((e,n)=>t._(this,void 0,void 0,(function*(){return this._getWorkerSource(e,n.type,n.source).getClusterLeaves(n)})))),this.actor.registerMessageHandler("LD",((t,e)=>this._getWorkerSource(t,e.type,e.source).loadData(e))),this.actor.registerMessageHandler("GD",((t,e)=>this._getWorkerSource(t,e.type,e.source).getData())),this.actor.registerMessageHandler("LT",((t,e)=>this._getWorkerSource(t,e.type,e.source).loadTile(e))),this.actor.registerMessageHandler("RT",((t,e)=>this._getWorkerSource(t,e.type,e.source).reloadTile(e))),this.actor.registerMessageHandler("AT",((t,e)=>this._getWorkerSource(t,e.type,e.source).abortTile(e))),this.actor.registerMessageHandler("RMT",((t,e)=>this._getWorkerSource(t,e.type,e.source).removeTile(e))),this.actor.registerMessageHandler("RS",((e,n)=>t._(this,void 0,void 0,(function*(){if(!this.workerSources[e]||!this.workerSources[e][n.type]||!this.workerSources[e][n.type][n.source])return;const t=this.workerSources[e][n.type][n.source];delete this.workerSources[e][n.type][n.source],void 0!==t.removeSource&&t.removeSource(n)})))),this.actor.registerMessageHandler("RM",(e=>t._(this,void 0,void 0,(function*(){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e]})))),this.actor.registerMessageHandler("SR",((e,n)=>t._(this,void 0,void 0,(function*(){this.referrer=n})))),this.actor.registerMessageHandler("SRPS",((t,e)=>this._syncRTLPluginState(t,e))),this.actor.registerMessageHandler("IS",((e,n)=>t._(this,void 0,void 0,(function*(){this.self.importScripts(n)})))),this.actor.registerMessageHandler("SI",((t,e)=>this._setImages(t,e))),this.actor.registerMessageHandler("UL",((e,n)=>t._(this,void 0,void 0,(function*(){this._getLayerIndex(e).update(n.layers,n.removedIds)})))),this.actor.registerMessageHandler("SL",((e,n)=>t._(this,void 0,void 0,(function*(){this._getLayerIndex(e).replace(n)}))))}_setImages(e,n){return t._(this,void 0,void 0,(function*(){this.availableImages[e]=n;for(const t in this.workerSources[e]){const i=this.workerSources[e][t];for(const t in i)i[t].availableImages=n}}))}_syncRTLPluginState(e,n){return t._(this,void 0,void 0,(function*(){if(t.bB.isParsed())return t.bB.getState();if("loading"!==n.pluginStatus)return t.bB.setState(n),n;const e=n.pluginURL;if(this.self.importScripts(e),t.bB.isParsed()){const n={pluginStatus:"loaded",pluginURL:e};return t.bB.setState(n),n}throw t.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${e}`)}))}_getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}_getLayerIndex(t){let n=this.layerIndexes[t];return n||(n=this.layerIndexes[t]=new e),n}_getWorkerSource(t,e,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),!this.workerSources[t][e][n]){const i={sendAsync:(e,n)=>(e.targetMapId=t,this.actor.sendAsync(e,n))};switch(e){case"vector":this.workerSources[t][e][n]=new a(i,this._getLayerIndex(t),this._getAvailableImages(t));break;case"geojson":this.workerSources[t][e][n]=new gt(i,this._getLayerIndex(t),this._getAvailableImages(t));break;default:this.workerSources[t][e][n]=new this.externalWorkerSourceTypes[e](i,this._getLayerIndex(t),this._getAvailableImages(t))}}return this.workerSources[t][e][n]}_getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]}}return t.i(self)&&(self.worker=new vt(self)),vt})),n("index",0,(function(t,e){var n="4.4.1";let i,r;const a={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:t=>new Promise(((n,i)=>{const r=requestAnimationFrame(n);t.signal.addEventListener("abort",(()=>{cancelAnimationFrame(r),i(e.c())}))})),getImageData(t,e=0){return this.getImageCanvasContext(t).getImageData(-e,-e,t.width+2*e,t.height+2*e)},getImageCanvasContext(t){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0,t.width,t.height),n},resolveURL:t=>(i||(i=document.createElement("a")),i.href=t,i.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==r&&(r=matchMedia("(prefers-reduced-motion: reduce)")),r.matches)}};class o{static testProp(t){if(!o.docStyle)return t[0];for(let e=0;e<t.length;e++)if(t[e]in o.docStyle)return t[e];return t[0]}static create(t,e,n){const i=window.document.createElement(t);return void 0!==e&&(i.className=e),n&&n.appendChild(i),i}static createNS(t,e){return window.document.createElementNS(t,e)}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none")}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect)}static setTransform(t,e){t.style[o.transformProp]=e}static addEventListener(t,e,n,i={}){t.addEventListener(e,n,"passive"in i?i:i.capture)}static removeEventListener(t,e,n,i={}){t.removeEventListener(e,n,"passive"in i?i:i.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",o.suppressClickInternal,!0)}),0)}static getScale(t){const e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}static getPoint(t,n,i){const r=n.boundingClientRect;return new e.P((i.clientX-r.left)/n.x-t.clientLeft,(i.clientY-r.top)/n.y-t.clientTop)}static mousePos(t,e){const n=o.getScale(t);return o.getPoint(t,n,e)}static touchPos(t,e){const n=[],i=o.getScale(t);for(let r=0;r<e.length;r++)n.push(o.getPoint(t,i,e[r]));return n}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}o.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,o.selectProp=o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o.transformProp=o.testProp(["transform","WebkitTransform"]);const s={supported:!1,testSupport:function(t){!u&&c&&(h?d(t):l=t)}};let l,c,u=!1,h=!1;function d(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,c),t.isContextLost())return;s.supported=!0}catch(t){}t.deleteTexture(e),u=!0}var p;"undefined"!=typeof document&&(c=document.createElement("img"),c.onload=()=>{l&&d(l),l=null,h=!0},c.onerror=()=>{u=!0,l=null},c.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(t){let n,i,r,a;t.resetRequestQueue=()=>{n=[],i=0,r=0,a={}},t.addThrottleControl=t=>{const e=r++;return a[e]=t,e},t.removeThrottleControl=t=>{delete a[t],l()},t.getImage=(t,i,r=!0)=>new Promise(((a,o)=>{s.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),e.e(t,{type:"image"}),n.push({abortController:i,requestParameters:t,supportImageRefresh:r,state:"queued",onError:t=>{o(t)},onSuccess:t=>{a(t)}}),l()}));const o=t=>e._(this,void 0,void 0,(function*(){t.state="running";const{requestParameters:n,supportImageRefresh:r,onError:a,onSuccess:o,abortController:s}=t,u=!1===r&&!e.i(self)&&!e.g(n.url)&&(!n.headers||Object.keys(n.headers).reduce(((t,e)=>t&&"accept"===e),!0));i++;const h=u?c(n,s):e.m(n,s);try{const n=yield h;delete t.abortController,t.state="completed",n.data instanceof HTMLImageElement||e.b(n.data)?o(n):n.data&&o({data:yield(d=n.data,"function"==typeof createImageBitmap?e.d(d):e.f(d)),cacheControl:n.cacheControl,expires:n.expires})}catch(e){delete t.abortController,a(e)}finally{i--,l()}var d})),l=()=>{const t=(()=>{for(const t of Object.keys(a))if(a[t]())return!0;return!1})()?e.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:e.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let e=i;e<t&&n.length>0;e++){const t=n.shift();t.abortController.signal.aborted?e--:o(t)}},c=(t,n)=>new Promise(((i,r)=>{const a=new Image,o=t.url,s=t.credentials;s&&"include"===s?a.crossOrigin="use-credentials":(s&&"same-origin"===s||!e.s(o))&&(a.crossOrigin="anonymous"),n.signal.addEventListener("abort",(()=>{a.src="",r(e.c())})),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,i({data:a})},a.onerror=()=>{a.onerror=a.onload=null,n.signal.aborted||r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=o}))}(p||(p={})),p.resetRequestQueue();class m{constructor(t){this._transformRequestFn=t}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function f(t){var n=new e.A(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}var g,v=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t};g=new e.A(3),e.A!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0);var y=function(t){var e=t[0],n=t[1];return e*e+n*n};function _(t){const e=[];if("string"==typeof t)e.push({id:"default",url:t});else if(t&&t.length>0){const n=[];for(const{id:i,url:r}of t){const t=`${i}${r}`;-1===n.indexOf(t)&&(n.push(t),e.push({id:i,url:r}))}}return e}function x(t,e,n){const i=t.split("?");return i[0]+=`${e}${n}`,i.join("?")}!function(){var t=new e.A(2);e.A!=Float32Array&&(t[0]=0,t[1]=0)}();class b{constructor(t,e,n,i){this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(e,i)}update(t,n,i){const{width:r,height:a}=t,o=!(this.size&&this.size[0]===r&&this.size[1]===a||i),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(n&&n.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!n||!1!==n.premultiply)),o)this.size=[r,a],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.b(t)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,t):l.texImage2D(l.TEXTURE_2D,0,this.format,r,a,0,this.format,l.UNSIGNED_BYTE,t.data);else{const{x:n,y:o}=i||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||e.b(t)?l.texSubImage2D(l.TEXTURE_2D,0,n,o,l.RGBA,l.UNSIGNED_BYTE,t):l.texSubImage2D(l.TEXTURE_2D,0,n,o,r,a,l.RGBA,l.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(t,e,n){const{context:i}=this,{gl:r}=i;r.bindTexture(r.TEXTURE_2D,this.texture),n!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function A(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class w extends e.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,promiseResolve:e}of this.requestors)e(this._getImagesForIds(t));this.requestors=[]}}getImage(t){const n=this.images[t];if(n&&!n.data&&n.spriteData){const t=n.spriteData;n.data=new e.R({width:t.width,height:t.height},t.context.getImageData(t.x,t.y,t.width,t.height).data),n.spriteData=null}return n}addImage(t,e){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,e)&&(this.images[t]=e)}_validate(t,n){let i=!0;const r=n.data||n.spriteData;return this._validateStretch(n.stretchX,r&&r.width)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchX" value`))),i=!1),this._validateStretch(n.stretchY,r&&r.height)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "stretchY" value`))),i=!1),this._validateContent(n.content,n)||(this.fire(new e.j(new Error(`Image "${t}" has invalid "content" value`))),i=!1),i}_validateStretch(t,e){if(!t)return!0;let n=0;for(const i of t){if(i[0]<n||i[1]<i[0]||e<i[1])return!1;n=i[1]}return!0}_validateContent(t,e){if(!t)return!0;if(4!==t.length)return!1;const n=e.spriteData,i=n&&n.width||e.data.width,r=n&&n.height||e.data.height;return!(t[0]<0||i<t[0]||t[1]<0||r<t[1]||t[2]<0||i<t[2]||t[3]<0||r<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,e,n=!0){const i=this.getImage(t);if(n&&(i.data.width!==e.data.width||i.data.height!==e.data.height))throw new Error(`size mismatch between old image (${i.data.width}x${i.data.height}) and new image (${e.data.width}x${e.data.height}).`);e.version=i.version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((e,n)=>{let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?e(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:e})}))}_getImagesForIds(t){const n={};for(const i of t){let t=this.getImage(i);t||(this.fire(new e.k("styleimagemissing",{id:i})),t=this.getImage(i)),t?n[i]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,textFitWidth:t.textFitWidth,textFitHeight:t.textFitHeight,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.w(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(t){const n=this.patterns[t],i=this.getImage(t);if(!i)return null;if(n&&n.position.version===i.version)return n.position;if(n)n.position.version=i.version;else{const n={w:i.data.width+2,h:i.data.height+2,x:0,y:0},r=new e.I(n,i);this.patterns[t]={bin:n,position:r}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const e=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new b(t,this.atlasImage,e.RGBA),this.atlasTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:n,h:i}=e.p(t),r=this.atlasImage;r.resize({width:n||1,height:i||1});for(const t in this.patterns){const{bin:n}=this.patterns[t],i=n.x+1,a=n.y+1,o=this.getImage(t).data,s=o.width,l=o.height;e.R.copy(o,r,{x:0,y:0},{x:i,y:a},{width:s,height:l}),e.R.copy(o,r,{x:0,y:l-1},{x:i,y:a-1},{width:s,height:1}),e.R.copy(o,r,{x:0,y:0},{x:i,y:a+l},{width:s,height:1}),e.R.copy(o,r,{x:s-1,y:0},{x:i-1,y:a},{width:1,height:l}),e.R.copy(o,r,{x:0,y:0},{x:i+s,y:a},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const n of t){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const t=this.getImage(n);t||e.w(`Image with ID: "${n}" was not found`),A(t)&&this.updateImage(n,t)}}}const C=1e20;function E(t,e,n,i,r,a,o,s,l){for(let c=e;c<e+i;c++)S(t,n*a+c,a,r,o,s,l);for(let c=n;c<n+r;c++)S(t,c*a+e,1,i,o,s,l)}function S(t,e,n,i,r,a,o){a[0]=0,o[0]=-C,o[1]=C,r[0]=t[e];for(let s=1,l=0,c=0;s<i;s++){r[s]=t[e+s*n];const i=s*s;do{const t=a[l];c=(r[s]-r[t]+i-t*t)/(s-t)/2}while(c<=o[l]&&--l>-1);l++,a[l]=s,o[l]=c,o[l+1]=C}for(let s=0,l=0;s<i;s++){for(;o[l+1]<s;)l++;const i=a[l],c=s-i;t[e+s*n]=r[i]+c*c}}class M{constructor(t,e){this.requestManager=t,this.localIdeographFontFamily=e,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return e._(this,void 0,void 0,(function*(){const e=[];for(const n in t)for(const i of t[n])e.push(this._getAndCacheGlyphsPromise(n,i));const n=yield Promise.all(e),i={};for(const{stack:t,id:e,glyph:r}of n)i[t]||(i[t]={}),i[t][e]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};return i}))}_getAndCacheGlyphsPromise(t,n){return e._(this,void 0,void 0,(function*(){let e=this.entries[t];e||(e=this.entries[t]={glyphs:{},requests:{},ranges:{}});let i=e.glyphs[n];if(void 0!==i)return{stack:t,id:n,glyph:i};if(i=this._tinySDF(e,t,n),i)return e.glyphs[n]=i,{stack:t,id:n,glyph:i};const r=Math.floor(n/256);if(256*r>65535)throw new Error("glyphs > 65535 not supported");if(e.ranges[r])return{stack:t,id:n,glyph:i};if(!this.url)throw new Error("glyphsUrl is not set");if(!e.requests[r]){const n=M.loadGlyphRange(t,r,this.url,this.requestManager);e.requests[r]=n}const a=yield e.requests[r];for(const t in a)this._doesCharSupportLocalGlyph(+t)||(e.glyphs[+t]=a[+t]);return e.ranges[r]=!0,{stack:t,id:n,glyph:a[n]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(e.u["CJK Unified Ideographs"](t)||e.u["Hangul Syllables"](t)||e.u.Hiragana(t)||e.u.Katakana(t))}_tinySDF(t,n,i){const r=this.localIdeographFontFamily;if(!r)return;if(!this._doesCharSupportLocalGlyph(i))return;let a=t.tinySDF;if(!a){let e="400";/bold/i.test(n)?e="900":/medium/i.test(n)?e="500":/light/i.test(n)&&(e="200"),a=t.tinySDF=new M.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:r,fontWeight:e})}const o=a.draw(String.fromCharCode(i));return{id:i,bitmap:new e.o({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}}M.loadGlyphRange=function(t,n,i,r){return e._(this,void 0,void 0,(function*(){const a=256*n,o=a+255,s=r.transformRequest(i.replace("{fontstack}",t).replace("{range}",`${a}-${o}`),"Glyphs"),l=yield e.l(s,new AbortController);if(!l||!l.data)throw new Error(`Could not load glyph range. range: ${n}, ${a}-${o}`);const c={};for(const t of e.n(l.data))c[t.id]=t;return c}))},M.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const s=this.size=t+4*e,l=this._createCanvas(s),c=this.ctx=l.getContext("2d",{willReadFrequently:!0});c.font=`${o} ${a} ${t}px ${r}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:a}=this.ctx.measureText(t),o=Math.ceil(n),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-r))),l=Math.min(this.size-this.buffer,o+Math.ceil(i)),c=s+2*this.buffer,u=l+2*this.buffer,h=Math.max(c*u,0),d=new Uint8ClampedArray(h),p={data:d,width:c,height:u,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:e};if(0===s||0===l)return p;const{ctx:m,buffer:f,gridInner:g,gridOuter:v}=this;m.clearRect(f,f,s,l),m.fillText(t,f,f+o);const y=m.getImageData(f,f,s,l);v.fill(C,0,h),g.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<s;e++){const n=y.data[4*(t*s+e)+3]/255;if(0===n)continue;const i=(t+f)*c+e+f;if(1===n)v[i]=0,g[i]=C;else{const t=.5-n;v[i]=t>0?t*t:0,g[i]=t<0?t*t:0}}E(v,0,0,c,u,c,this.f,this.v,this.z),E(g,f,f,s,l,c,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(v[t])-Math.sqrt(g[t]);d[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return p}};class T{constructor(){this.specification=e.v.light.position}possiblyEvaluate(t,n){return e.y(t.expression.evaluate(n))}interpolate(t,n,i){return{x:e.z.number(t.x,n.x,i),y:e.z.number(t.y,n.y,i),z:e.z.number(t.z,n.z,i)}}}let I;class B extends e.E{constructor(t){super(),I=I||new e.q({anchor:new e.D(e.v.light.anchor),position:new T,color:new e.D(e.v.light.color),intensity:new e.D(e.v.light.intensity)}),this._transitionable=new e.T(I),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,n={}){if(!this._validate(e.r,t,n))for(const e in t){const n=t[e];e.endsWith("-transition")?this._transitionable.setTransition(e.slice(0,-11),n):this._transitionable.setValue(e,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,i){return(!i||!1!==i.validate)&&e.t(this,t.call(e.x,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:e.v}))}}class L{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,e){const n=t.join(",")+String(e);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(t,e)),this.dashEntry[n]}getDashRanges(t,e,n){const i=[];let r=t.length%2==1?-t[t.length-1]*n:0,a=t[0]*n,o=!0;i.push({left:r,right:a,isDash:o,zeroLength:0===t[0]});let s=t[0];for(let e=1;e<t.length;e++){o=!o;const l=t[e];r=s*n,s+=l,a=s*n,i.push({left:r,right:a,isDash:o,zeroLength:0===l})}return i}addRoundDash(t,e,n){const i=e/2;for(let e=-n;e<=n;e++){const r=this.width*(this.nextRow+n+e);let a=0,o=t[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=t[++a]);const l=Math.abs(s-o.left),c=Math.abs(s-o.right),u=Math.min(l,c);let h;const d=e/n*(i+1);if(o.isDash){const t=i-Math.abs(d);h=Math.sqrt(u*u+t*t)}else h=i-Math.sqrt(u*u+d*d);this.data[r+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t){for(let e=t.length-1;e>=0;--e){const n=t[e],i=t[e+1];n.zeroLength?t.splice(e,1):i&&i.isDash===n.isDash&&(i.left=n.left,t.splice(e,1))}const e=t[0],n=t[t.length-1];e.isDash===n.isDash&&(e.left=n.left-this.width,n.right=e.right+this.width);const i=this.width*this.nextRow;let r=0,a=t[r];for(let e=0;e<this.width;e++){e/a.right>1&&(a=t[++r]);const n=Math.abs(e-a.left),o=Math.abs(e-a.right),s=Math.min(n,o);this.data[i+e]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(t,n){const i=n?7:0,r=2*i+1;if(this.nextRow+r>this.height)return e.w("LineAtlas out of space"),null;let a=0;for(let e=0;e<t.length;e++)a+=t[e];if(0!==a){const e=this.width/a,r=this.getDashRanges(t,this.width,e);n?this.addRoundDash(r,e,i):this.addRegularDash(r)}const o={y:(this.nextRow+i+.5)/this.height,height:2*i/this.height,width:a};return this.nextRow+=r,this.dirty=!0,o}bind(t){const e=t.gl;this.texture?(e.bindTexture(e.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,e.texSubImage2D(e.TEXTURE_2D,0,0,0,this.width,this.height,e.ALPHA,e.UNSIGNED_BYTE,this.data))):(this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,this.width,this.height,0,e.ALPHA,e.UNSIGNED_BYTE,this.data))}}const D="maplibre_preloaded_worker_pool";class P{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<P.workerCount;)this.workers.push(new Worker(e.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach((t=>{t.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[D]}numActive(){return Object.keys(this.active).length}}const R=Math.floor(a.hardwareConcurrency/2);let k,z;function F(){return k||(k=new P),k}P.workerCount=e.B(globalThis)?Math.max(Math.min(R,3),1):1;class O{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n;const i=this.workerPool.acquire(n);for(let t=0;t<i.length;t++){const r=new e.C(i[t],n);r.name=`Worker ${t}`,this.actors.push(r)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,e){const n=[];for(const i of this.actors)n.push(i.sendAsync({type:t,data:e}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((t=>{t.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,e){for(const n of this.actors)n.registerMessageHandler(t,e)}}function N(){return z||(z=new O(F(),e.G),z.registerMessageHandler("GR",((t,n,i)=>e.m(n,i)))),z}function U(t,n){const i=e.F();return e.H(i,i,[1,1,0]),e.J(i,i,[.5*t.width,.5*t.height,1]),e.K(i,i,t.calculatePosMatrix(n.toUnwrapped()))}function V(t,e,n,i,r,a){const o=function(t,e,n){if(t)for(const i of t){const t=e[i];if(t&&t.source===n&&"fill-extrusion"===t.type)return!0}else for(const t in e){const i=e[t];if(i.source===n&&"fill-extrusion"===i.type)return!0}return!1}(r&&r.layers,e,t.id),s=a.maxPitchScaleFactor(),l=t.tilesIn(i,s,o);l.sort(G);const c=[];for(const i of l)c.push({wrappedTileID:i.tileID.wrapped().key,queryResults:i.tile.queryRenderedFeatures(e,n,t._state,i.queryGeometry,i.cameraQueryGeometry,i.scale,r,a,s,U(t.transform,i.tileID))});const u=function(t){const e={},n={};for(const i of t){const t=i.queryResults,r=i.wrappedTileID,a=n[r]=n[r]||{};for(const n in t){const i=t[n],r=a[n]=a[n]||{},o=e[n]=e[n]||[];for(const t of i)r[t.featureIndex]||(r[t.featureIndex]=!0,o.push(t))}}return e}(c);for(const e in u)u[e].forEach((e=>{const n=e.feature,i=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}));return u}function G(t,e){const n=t.tileID,i=e.tileID;return n.overscaledZ-i.overscaledZ||n.canonical.y-i.canonical.y||n.wrap-i.wrap||n.canonical.x-i.canonical.x}function H(t,n,i){return e._(this,void 0,void 0,(function*(){let r=t;if(t.url?r=(yield e.h(n.transformRequest(t.url,"Source"),i)).data:yield a.frameAsync(i),!r)return null;const o=e.L(e.e(r,t),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(o.vectorLayerIds=r.vector_layers.map((t=>t.id))),o}))}class j{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):Array.isArray(t)&&(4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof e.M?new e.M(t.lng,t.lat):e.M.convert(t),this}setSouthWest(t){return this._sw=t instanceof e.M?new e.M(t.lng,t.lat):e.M.convert(t),this}extend(t){const n=this._sw,i=this._ne;let r,a;if(t instanceof e.M)r=t,a=t;else{if(!(t instanceof j))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(j.convert(t)):this.extend(e.M.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(e.M.convert(t)):this;if(r=t._sw,a=t._ne,!r||!a)return this}return n||i?(n.lng=Math.min(r.lng,n.lng),n.lat=Math.min(r.lat,n.lat),i.lng=Math.max(a.lng,i.lng),i.lat=Math.max(a.lat,i.lat)):(this._sw=new e.M(r.lng,r.lat),this._ne=new e.M(a.lng,a.lat)),this}getCenter(){return new e.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new e.M(this.getWest(),this.getNorth())}getSouthEast(){return new e.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:i}=e.M.convert(t);let r=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(r=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&r}static convert(t){return t instanceof j?t:t?new j(t):t}static fromLngLat(t,n=0){const i=360*n/40075017,r=i/Math.cos(Math.PI/180*t.lat);return new j(new e.M(t.lng-r,t.lat-i),new e.M(t.lng+r,t.lat+i))}}class W{constructor(t,e,n){this.bounds=j.convert(this.validateBounds(t)),this.minzoom=e||0,this.maxzoom=n||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),i=Math.floor(e.N(this.bounds.getWest())*n),r=Math.floor(e.O(this.bounds.getNorth())*n),a=Math.ceil(e.N(this.bounds.getEast())*n),o=Math.ceil(e.O(this.bounds.getSouth())*n);return t.x>=i&&t.x<a&&t.y>=r&&t.y<o}}class q extends e.E{constructor(t,n,i,r){if(super(),this.id=t,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.e(this,e.L(n,["url","scheme","tileSize","promoteId"])),this._options=e.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r)}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield H(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(e.e(this,t),t.bounds&&(this.tileBounds=new W(t.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new e.j(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return e.e({},this._options)}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(e,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request.collectResourceTiming=this._collectResourceTiming;let i="RT";if(t.actor&&"expired"!==t.state){if("loading"===t.state)return new Promise(((e,n)=>{t.reloadPromise={resolve:e,reject:n}}))}else t.actor=this.dispatcher.getActor(),i="LT";t.abortController=new AbortController;try{const e=yield t.actor.sendAsync({type:i,data:n},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,e)}catch(e){if(delete t.abortController,t.aborted)return;if(e&&404!==e.status)throw e;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,e){if(e&&e.resourceTiming&&(t.resourceTiming=e.resourceTiming),e&&this.map._refreshExpiredTiles&&t.setExpiryData(e),t.loadVectorData(e,this.map.painter),t.reloadPromise){const e=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(e.resolve).catch(e.reject)}}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Z extends e.E{constructor(t,n,i,r){super(),this.id=t,this.dispatcher=i,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.e({type:"raster"},n),e.e(this,e.L(n,["url","scheme","tileSize"]))}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield H(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,t&&(e.e(this,t),t.bounds&&(this.tileBounds=new W(t.bounds,this.minzoom,this.maxzoom)),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new e.j(t))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return e.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const n=yield p.getImage(this.map._requestManager.transformRequest(e,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(n&&n.data){this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&t.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const e=this.map.painter.context,i=e.gl,r=n.data;t.texture=this.map.painter.getTileTexture(r.width),t.texture?t.texture.update(r,{useMipmap:!0}):(t.texture=new b(e,r,i.RGBA,{useMipmap:!0}),t.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE,i.LINEAR_MIPMAP_NEAREST),e.extTextureFilterAnisotropic&&i.texParameterf(i.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax)),t.state="loaded"}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}}))}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class $ extends Z{constructor(t,n,i,r){super(t,n,i,r),this.type="raster-dem",this.maxzoom=22,this._options=e.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(t){return e._(this,void 0,void 0,(function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),i=this.map._requestManager.transformRequest(n,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const n=yield p.getImage(i,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(n&&n.data){const i=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&t.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const r=e.b(i)&&e.S()?i:yield this.readImageNow(i),a={type:this.type,uid:t.uid,source:this.id,rawImageData:r,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||"expired"===t.state){t.actor=this.dispatcher.getActor();const e=yield t.actor.sendAsync({type:"LDT",data:a});t.dem=e,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(e){if(delete t.abortController,t.aborted)t.state="unloaded";else if(e)throw t.state="errored",e}}))}readImageNow(t){return e._(this,void 0,void 0,(function*(){if("undefined"!=typeof VideoFrame&&e.U()){const n=t.width+2,i=t.height+2;try{return new e.R({width:n,height:i},yield e.V(t,-1,-1,n,i))}catch(t){}}return a.getImageData(t,1)}))}_getNeighboringTiles(t){const n=t.canonical,i=Math.pow(2,n.z),r=(n.x-1+i)%i,a=0===n.x?t.wrap-1:t.wrap,o=(n.x+1+i)%i,s=n.x+1===i?t.wrap+1:t.wrap,l={};return l[new e.Q(t.overscaledZ,a,n.z,r,n.y).key]={backfilled:!1},l[new e.Q(t.overscaledZ,s,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new e.Q(t.overscaledZ,a,n.z,r,n.y-1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,s,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<i&&(l[new e.Q(t.overscaledZ,a,n.z,r,n.y+1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new e.Q(t.overscaledZ,s,n.z,o,n.y+1).key]={backfilled:!1}),l}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class Y extends e.E{constructor(t,n,i,r){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=i.getActor(),this.setEventedParent(r),this._data=n.data,this._options=e.e({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const a=e.W/this.tileSize;this.workerOptions=e.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:e.W,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:e.W,radius:(n.clusterRadius||50)*a,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return e._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return e._(this,void 0,void 0,(function*(){const t=e.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(void 0!==t.clusterRadius&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),void 0!==t.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,e,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:e,offset:n}})}_updateWorkerData(t){return e._(this,void 0,void 0,(function*(){const n=e.e({type:this.type},this.workerOptions);t?n.dataDiff=t:"string"==typeof this._data?(n.request=this.map._requestManager.transformRequest(a.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new e.k("dataloading",{dataType:"source"}));try{const t=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||t.abandoned)return void this.fire(new e.k("dataabort",{dataType:"source"}));let i=null;t.resourceTiming&&t.resourceTiming[this.id]&&(i=t.resourceTiming[this.id].slice(0));const r={dataType:"source"};this._collectResourceTiming&&i&&i.length>0&&e.e(r,{resourceTiming:i}),this.fire(new e.k("data",Object.assign(Object.assign({},r),{sourceDataType:"metadata"}))),this.fire(new e.k("data",Object.assign(Object.assign({},r),{sourceDataType:"content"})))}catch(t){if(this._pendingLoads--,this._removed)return void this.fire(new e.k("dataabort",{dataType:"source"}));this.fire(new e.j(t))}}))}loaded(){return 0===this._pendingLoads}loadTile(t){return e._(this,void 0,void 0,(function*(){const e=t.actor?"RT":"LT";t.actor=this.actor;const n={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.abortController=new AbortController;const i=yield this.actor.sendAsync({type:e,data:n},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(i,this.map.painter,"RT"===e)}))}abortTile(t){return e._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return e._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return e.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var X=e.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Q extends e.E{constructor(t,e,n,i){super(),this.id=t,this.dispatcher=n,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(i),this.options=e}load(t){return e._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new e.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const e=yield p.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,e&&e.data&&(this.image=e.data,t&&(this.coordinates=t),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new e.j(t))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const n=t.map(e.Y.fromLngLat);this.tileID=function(t){let n=1/0,i=1/0,r=-1/0,a=-1/0;for(const e of t)n=Math.min(n,e.x),i=Math.min(i,e.y),r=Math.max(r,e.x),a=Math.max(a,e.y);const o=Math.max(r-n,a-i),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,s);return new e.a0(s,Math.floor((n+r)/2*l),Math.floor((i+a)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const i=n.map((t=>this.tileID.getTilePoint(t)._round()));return this._boundsArray=new e.Z,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,e.W,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,e.W),this._boundsArray.emplaceBack(i[2].x,i[2].y,e.W,e.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,n=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new b(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return e._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class J extends Q{constructor(t,e,n,i){super(t,e,n,i),this.roundZoom=!0,this.type="video",this.options=e}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,"Source").url);try{const t=yield e.a2(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new e.j(t))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new e.j(new e.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new b(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class K extends Q{constructor(t,n,i,r){super(t,n,i,r),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some((t=>!Array.isArray(t)||2!==t.length||t.some((t=>"number"!=typeof t))))||this.fire(new e.j(new e.a1(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.j(new e.a1(`sources.${t}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.j(new e.a1(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new e.j(new e.a1(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.j(new e.a1(`sources.${t}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){return e._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,i=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.$.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new b(n,this.canvas,i.RGBA,{premultiply:!0});let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new e.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const tt={},et=t=>{switch(t){case"geojson":return Y;case"image":return Q;case"raster":return Z;case"raster-dem":return $;case"vector":return q;case"video":return J;case"canvas":return K}return tt[t]},nt="RTLPluginLoaded";class it extends e.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=N()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((t=>{throw this.status="error",t}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return e._(this,arguments,void 0,(function*(t,e=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=a.resolveURL(t),!this.url)throw new Error(`requested url ${t} is invalid`);if("unavailable"===this.status){if(!e)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()}))}_requestImport(){return e._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new e.k(nt))}))}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let rt=null;function at(){return rt||(rt=new it),rt}class ot{constructor(t,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=e.a3(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,n,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const n={};if(!e)return n;for(const i of t){const t=i.layerIds.map((t=>e.getLayer(t))).filter(Boolean);if(0!==t.length){i.layers=t,i.stateDependentLayerIds&&(i.stateDependentLayers=i.stateDependentLayerIds.map((e=>t.filter((t=>t.id===e))[0])));for(const e of t)n[e.id]=i}}return n}(t.buckets,n.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.a5){if(this.hasSymbolBuckets=!0,!i)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const n=this.buckets[t];if(n instanceof e.a5&&n.hasRTLText){this.hasRTLText=!0,at().lazyLoad();break}}this.queryPadding=0;for(const t in this.buckets){const e=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(t).queryRadius(e))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.a4}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const n=this.buckets[e];n.uploadPending()&&n.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new b(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new b(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,n,i,r,a,o,s,l,c){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:i,cameraQueryGeometry:r,scale:a,tileSize:this.tileSize,pixelPosMatrix:c,transform:s,params:o,queryPadding:this.queryPadding*l},t,e,n):{}}querySourceFeatures(t,n){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const r=i.loadVTLayers(),a=n&&n.sourceLayer?n.sourceLayer:"",o=r._geojsonTileLayer||r[a];if(!o)return;const s=e.a6(n&&n.filter),{z:l,x:c,y:u}=this.tileID.canonical,h={z:l,x:c,y:u};for(let n=0;n<o.length;n++){const r=o.feature(n);if(s.needGeometry){const t=e.a7(r,!0);if(!s.filter(new e.a8(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!s.filter(new e.a8(this.tileID.overscaledZ),r))continue;const d=i.getId(r,a),p=new e.a9(r,l,c,u,d);p.tile=h,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const n=e.aa(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let e=!1;if(this.expirationTime>t)e=!1;else if(n)if(this.expirationTime<n)e=!0;else{const i=this.expirationTime-n;i?this.expirationTime=t+Math.max(i,3e4):e=!0}else e=!0;e?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const i in this.buckets){if(!e.style.hasLayer(i))continue;const r=this.buckets[i],a=r.layers[0].sourceLayer||"_geojsonTileLayer",o=n[a],s=t[a];if(!o||!s||0===Object.keys(s).length)continue;r.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(i);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=a.now()+t}setDependencies(t,e){const n={};for(const t of e)n[t]=!0;this.dependencies[t]=n}hasDependency(t,e){for(const n of t){const t=this.dependencies[n];if(t)for(const n of e)if(t[n])return!0}return!1}}class st{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,n){const i=t.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);const r={value:e,timeout:void 0};if(void 0!==n&&(r.timeout=setTimeout((()=>{this.remove(t,r)}),n)),this.data[i].push(r),this.order.push(i),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const n=t.wrapped().key,i=void 0===e?0:this.data[n].indexOf(e),r=this.data[n][i];return this.data[n].splice(i,1),r.timeout&&clearTimeout(r.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(r.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const n in this.data)for(const i of this.data[n])t(i.value)||e.push(i);for(const t of e)this.remove(t.value.tileID,t)}}class lt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,i){const r=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][r]=this.stateChanges[t][r]||{},e.e(this.stateChanges[t][r],i),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==r&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][r]){this.deletedStates[t][r]={};for(const e in this.state[t][r])i[e]||(this.deletedStates[t][r][e]=null)}else for(const e in i)this.deletedStates[t]&&this.deletedStates[t][r]&&null===this.deletedStates[t][r][e]&&delete this.deletedStates[t][r][e]}removeFeatureState(t,e,n){if(null===this.deletedStates[t])return;const i=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},n&&void 0!==e)null!==this.deletedStates[t][i]&&(this.deletedStates[t][i]=this.deletedStates[t][i]||{},this.deletedStates[t][i][n]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][i])for(n in this.deletedStates[t][i]={},this.stateChanges[t][i])this.deletedStates[t][i][n]=null;else this.deletedStates[t][i]=null;else this.deletedStates[t]=null}getState(t,n){const i=String(n),r=e.e({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const e=this.deletedStates[t][n];if(null===e)return{};for(const t in e)delete r[t]}return r}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,n){const i={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const n={};for(const i in this.stateChanges[t])this.state[t][i]||(this.state[t][i]={}),e.e(this.state[t][i],this.stateChanges[t][i]),n[i]=this.state[t][i];i[t]=n}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const n={};if(null===this.deletedStates[t])for(const e in this.state[t])n[e]={},this.state[t][e]={};else for(const e in this.deletedStates[t]){if(null===this.deletedStates[t][e])this.state[t][e]={};else for(const n of Object.keys(this.deletedStates[t][e]))delete this.state[t][e][n];n[e]=this.state[t][e]}i[t]=i[t]||{},e.e(i[t],n)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const e in t)t[e].setFeatureState(i,n)}}class ct extends e.E{constructor(t,e,n){super(),this.id=t,this.dispatcher=n,this.on("data",(t=>this._dataHandler(t))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((t,e,n,i)=>{const r=new(et(e.type))(t,e,n,i);if(r.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${r.id}`);return r})(t,e,n,this),this._tiles={},this._cache=new st(0,(t=>this._unloadTile(t))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new lt,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,n,i){return e._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,n,i)}catch(n){t.state="errored",404!==n.status?this._source.fire(new e.j(n,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new e.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const n=this._tiles[e];n.upload(t),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(ut).map((t=>t.key))}getRenderableIds(t){const n=[];for(const e in this._tiles)this._isIdRenderable(e,t)&&n.push(this._tiles[e]);return t?n.sort(((t,n)=>{const i=t.tileID,r=n.tileID,a=new e.P(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),o=new e.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-r.overscaledZ||o.y-a.y||o.x-a.x})).map((t=>t.tileID.key)):n.map((t=>t.tileID)).sort(ut).map((t=>t.key))}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(t,"reloading")}}_reloadTile(t,n){return e._(this,void 0,void 0,(function*(){const e=this._tiles[t];e&&("loading"!==e.state&&(e.state=n),yield this._loadTile(e,t,n))}))}_tileLoaded(t,n,i){t.timeAdded=a.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new e.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const e=this.getRenderableIds();for(let i=0;i<e.length;i++){const r=e[i];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);n(t,e),n(e,t)}}function n(t,e){t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0;let n=e.tileID.canonical.x-t.tileID.canonical.x;const i=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),a=e.tileID.key;0===n&&0===i||Math.abs(i)>1||(Math.abs(n)>1&&(1===Math.abs(n+r)?n+=r:1===Math.abs(n-r)&&(n-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,n,i),t.neighboringTiles&&t.neighboringTiles[a]&&(t.neighboringTiles[a].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,n,i){for(const r in this._tiles){let a=this._tiles[r];if(i[r]||!a.hasData()||a.tileID.overscaledZ<=e||a.tileID.overscaledZ>n)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>e+1;){const t=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[t.key],a&&a.hasData()&&(o=t)}let s=o;for(;s.overscaledZ>e;)if(s=s.scaledTo(s.overscaledZ-1),t[s.key]){i[o.key]=o;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const n=this._loadedParentTiles[t.key];return n&&n.tileID.overscaledZ>=e?n:null}for(let n=t.overscaledZ-1;n>=e;n--){const e=t.scaledTo(n),i=this._getLoadedTile(e);if(i)return i}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const n=Math.ceil(t.width/this._source.tileSize)+1,i=Math.ceil(t.height/this._source.tileSize)+1,r=Math.floor(n*i*(null===this._maxTileCacheZoomLevels?e.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(a)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const n in this._tiles){const i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+e),t[i.tileID.key]=i}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}_updateCoveredAndRetainedTiles(t,e,n,i,r,o){const s={},l={},c=Object.keys(t),u=a.now();for(const n of c){const i=t[n],r=this._tiles[n];if(!r||0!==r.fadeEndTime&&r.fadeEndTime<=u)continue;const a=this.findLoadedParent(i,e),o=this.findLoadedSibling(i),c=a||o||null;c&&(this._addTile(c.tileID),s[c.tileID.key]=c.tileID),l[n]=i}this._retainLoadedChildren(l,i,n,t);for(const e in s)t[e]||(this._coveredTiles[e]=!0,t[e]=s[e]);if(o){const e={},n={};for(const t of r)this._tiles[t.key].hasData()?e[t.key]=t:n[t.key]=t;for(const i in n){const r=n[i].children(this._source.maxzoom);this._tiles[r[0].key]&&this._tiles[r[1].key]&&this._tiles[r[2].key]&&this._tiles[r[3].key]&&(e[r[0].key]=t[r[0].key]=r[0],e[r[1].key]=t[r[1].key]=r[1],e[r[2].key]=t[r[2].key]=r[2],e[r[3].key]=t[r[3].key]=r[3],delete n[i])}for(const i in n){const r=n[i],a=this.findLoadedParent(r,this._source.minzoom),o=this.findLoadedSibling(r),s=a||o||null;if(s){e[s.tileID.key]=t[s.tileID.key]=s.tileID;for(const t in e)e[t].isChildOf(s.tileID)&&delete e[t]}}for(const t in this._tiles)e[t]||(this._coveredTiles[t]=!0)}}update(t,n){if(!this._sourceLoaded||this._paused)return;let i;this.transform=t,this.terrain=n,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((t=>new e.Q(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y))):(i=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(i=i.filter((t=>this._source.hasTile(t))))):i=[];const r=t.coveringZoomLevel(this._source),a=Math.max(r-ct.maxOverzooming,this._source.minzoom),o=Math.max(r+ct.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const t={};for(const e of i)if(e.canonical.z>this._source.minzoom){const n=e.scaledTo(e.canonical.z-1);t[n.key]=n;const i=e.scaledTo(Math.max(this._source.minzoom,Math.min(e.canonical.z,5)));t[i.key]=i}i=i.concat(Object.values(t))}const s=0===i.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new e.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(i,r);ht(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,o,r,i,n);for(const t in l)this._tiles[t].clearFadeHold();const c=e.ab(this._tiles,l);for(const t of c){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,e){var n;const i={},r={},a=Math.max(e-ct.maxOverzooming,this._source.minzoom),o=Math.max(e+ct.maxUnderzooming,this._source.minzoom),s={};for(const n of t){const t=this._addTile(n);i[n.key]=n,t.hasData()||e<this._source.maxzoom&&(s[n.key]=n)}this._retainLoadedChildren(s,e,o,i);for(const o of t){let t=this._tiles[o.key];if(t.hasData())continue;if(e+1>this._source.maxzoom){const t=o.children(this._source.maxzoom)[0],e=this.getTile(t);if(e&&e.hasData()){i[t.key]=t;continue}}else{const t=o.children(this._source.maxzoom);if(i[t[0].key]&&i[t[1].key]&&i[t[2].key]&&i[t[3].key])continue}let s=t.wasRequested();for(let e=o.overscaledZ-1;e>=a;--e){const a=o.scaledTo(e);if(r[a.key])break;if(r[a.key]=!0,t=this.getTile(a),!t&&s&&(t=this._addTile(a)),t){const e=t.hasData();if((e||!(null===(n=this.map)||void 0===n?void 0:n.cancelPendingTileRequestsWhileZooming)||s)&&(i[a.key]=a),s=t.wasRequested(),e)break}}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let n,i=this._tiles[t].tileID;for(;i.overscaledZ>0;){if(i.key in this._loadedParentTiles){n=this._loadedParentTiles[i.key];break}e.push(i.key);const t=i.scaledTo(i.overscaledZ-1);if(n=this._getLoadedTile(t),n)break;i=t}for(const t of e)this._loadedParentTiles[t]=n}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const e=this._tiles[t].tileID,n=this._getLoadedTile(e);this._loadedSiblingTiles[e.key]=n}}_addTile(t){let n=this._tiles[t.key];if(n)return n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const i=n;return n||(n=new ot(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(n,t.key,n.state)),n.uses++,this._tiles[t.key]=n,i||this._source.fire(new e.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const n=e.getExpiryTimeout();n&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),n))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}_dataHandler(t){const e=t.sourceDataType;"source"===t.dataType&&"metadata"===e&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===e&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,n,i){const r=[],a=this.transform;if(!a)return r;const o=i?a.getCameraQueryGeometry(t):t,s=t.map((t=>a.pointCoordinate(t,this.terrain))),l=o.map((t=>a.pointCoordinate(t,this.terrain))),c=this.getIds();let u=1/0,h=1/0,d=-1/0,p=-1/0;for(const t of l)u=Math.min(u,t.x),h=Math.min(h,t.y),d=Math.max(d,t.x),p=Math.max(p,t.y);for(let t=0;t<c.length;t++){const i=this._tiles[c[t]];if(i.holdingForFade())continue;const o=i.tileID,m=Math.pow(2,a.zoom-i.tileID.overscaledZ),f=n*i.queryPadding*e.W/i.tileSize/m,g=[o.getTilePoint(new e.Y(u,h)),o.getTilePoint(new e.Y(d,p))];if(g[0].x-f<e.W&&g[0].y-f<e.W&&g[1].x+f>=0&&g[1].y+f>=0){const t=s.map((t=>o.getTilePoint(t))),e=l.map((t=>o.getTilePoint(t)));r.push({tile:i,tileID:o,queryGeometry:t,cameraQueryGeometry:e,scale:m})}}return r}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map((t=>this._tiles[t].tileID));for(const t of e)t.posMatrix=this.transform.calculatePosMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(ht(this._source.type)){const t=a.now();for(const e in this._tiles)if(this._tiles[e].fadeEndTime>=t)return!0}return!1}setFeatureState(t,e,n){this._state.updateState(t=t||"_geojsonTileLayer",e,n)}removeFeatureState(t,e,n){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,n)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,n){const i=this._tiles[t];i&&i.setDependencies(e,n)}reloadTilesForDependencies(t,e){for(const n in this._tiles)this._tiles[n].hasDependency(t,e)&&this._reloadTile(n,"reloading");this._cache.filter((n=>!n.hasDependency(t,e)))}}function ut(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function ht(t){return"raster"===t||"image"===t||"video"===t}ct.maxOverzooming=10,ct.maxUnderzooming=3;class dt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.ac(t,0,1);let n=1,i=this._distances[n];const r=t*this.paddedLength+this.padding;for(;i<r&&n<this._distances.length;)i=this._distances[++n];const a=n-1,o=this._distances[a],s=i-o,l=s>0?(r-o)/s:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))}}function pt(t,e){let n=!0;return"always"===t||"never"!==t&&"never"!==e||(n=!1),n}class mt{constructor(t,e,n){const i=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(e/n);for(let t=0;t<this.xCellCount*this.yCellCount;t++)i.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,n,i,r){this._forEachCell(e,n,i,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(r)}insertCircle(t,e,n,i){this._forEachCell(e-i,n-i,e+i,n+i,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(n),this.circles.push(i)}_insertBoxCell(t,e,n,i,r,a){this.boxCells[r].push(a)}_insertCircleCell(t,e,n,i,r,a){this.circleCells[r].push(a)}_query(t,e,n,i,r,a,o){if(n<0||t>this.width||i<0||e>this.height)return[];const s=[];if(t<=0&&e<=0&&this.width<=n&&this.height<=i){if(r)return[{key:null,x1:t,y1:e,x2:n,y2:i}];for(let t=0;t<this.boxKeys.length;t++)s.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],n=this.circles[3*t+1],i=this.circles[3*t+2];s.push({key:this.circleKeys[t],x1:e-i,y1:n-i,x2:e+i,y2:n+i})}}else this._forEachCell(t,e,n,i,this._queryCell,s,{hitTest:r,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(t,e,n,i){return this._query(t,e,n,i,!1,null)}hitTest(t,e,n,i,r,a){return this._query(t,e,n,i,!0,r,a).length>0}hitTestCircle(t,e,n,i,r){const a=t-n,o=t+n,s=e-n,l=e+n;if(o<0||a>this.width||l<0||s>this.height)return!1;const c=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,c,{hitTest:!0,overlapMode:i,circle:{x:t,y:e,radius:n},seenUids:{box:{},circle:{}}},r),c.length>0}_queryCell(t,e,n,i,r,a,o,s){const{seenUids:l,hitTest:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const r=this.bboxes;for(const o of h)if(!l.box[o]){l.box[o]=!0;const h=4*o,d=this.boxKeys[o];if(t<=r[h+2]&&e<=r[h+3]&&n>=r[h+0]&&i>=r[h+1]&&(!s||s(d))&&(!c||!pt(u,d.overlapMode))&&(a.push({key:d,x1:r[h],y1:r[h+1],x2:r[h+2],y2:r[h+3]}),c))return!0}}const d=this.circleCells[r];if(null!==d){const r=this.circles;for(const o of d)if(!l.circle[o]){l.circle[o]=!0;const h=3*o,d=this.circleKeys[o];if(this._circleAndRectCollide(r[h],r[h+1],r[h+2],t,e,n,i)&&(!s||s(d))&&(!c||!pt(u,d.overlapMode))){const t=r[h],e=r[h+1],n=r[h+2];if(a.push({key:d,x1:t-n,y1:e-n,x2:t+n,y2:e+n}),c)return!0}}}return!1}_queryCellCircle(t,e,n,i,r,a,o,s){const{circle:l,seenUids:c,overlapMode:u}=o,h=this.boxCells[r];if(null!==h){const t=this.bboxes;for(const e of h)if(!c.box[e]){c.box[e]=!0;const n=4*e,i=this.boxKeys[e];if(this._circleAndRectCollide(l.x,l.y,l.radius,t[n+0],t[n+1],t[n+2],t[n+3])&&(!s||s(i))&&!pt(u,i.overlapMode))return a.push(!0),!0}}const d=this.circleCells[r];if(null!==d){const t=this.circles;for(const e of d)if(!c.circle[e]){c.circle[e]=!0;const n=3*e,i=this.circleKeys[e];if(this._circlesCollide(t[n],t[n+1],t[n+2],l.x,l.y,l.radius)&&(!s||s(i))&&!pt(u,i.overlapMode))return a.push(!0),!0}}}_forEachCell(t,e,n,i,r,a,o,s){const l=this._convertToXCellCoord(t),c=this._convertToYCellCoord(e),u=this._convertToXCellCoord(n),h=this._convertToYCellCoord(i);for(let d=l;d<=u;d++)for(let l=c;l<=h;l++)if(r.call(this,t,e,n,i,this.xCellCount*l+d,a,o,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,n,i,r,a){const o=i-t,s=r-e,l=n+a;return l*l>o*o+s*s}_circleAndRectCollide(t,e,n,i,r,a,o){const s=(a-i)/2,l=Math.abs(t-(i+s));if(l>s+n)return!1;const c=(o-r)/2,u=Math.abs(e-(r+c));if(u>c+n)return!1;if(l<=s||u<=c)return!0;const h=l-s,d=u-c;return h*h+d*d<=n*n}}function ft(t,n,i,r,a){const o=e.F();return n?(e.J(o,o,[1/a,1/a,1]),i||e.ad(o,o,r.angle)):e.K(o,r.labelPlaneMatrix,t),o}function gt(t,n,i,r,a){if(n){const n=e.ae(t);return e.J(n,n,[a,a,1]),i||e.ad(n,n,-r.angle),n}return r.glCoordMatrix}function vt(t,n,i){let r;i?(r=[t.x,t.y,i(t.x,t.y),1],e.af(r,r,n)):(r=[t.x,t.y,0,1],function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t[3]=n[3]*i+n[7]*r+n[15]}(r,r,n));const a=r[3];return{point:new e.P(r[0]/a,r[1]/a),signedDistanceFromCamera:a,isOccluded:!1}}function yt(t,e){return.5+t/e*.5}function _t(t,e){return t.x>=-e[0]&&t.x<=e[0]&&t.y>=-e[1]&&t.y<=e[1]}function xt(t,n,i,r,a,o,s,l,c,u,h,d,p,m,f){const g=r?t.textSizeData:t.iconSizeData,v=e.ag(g,i.transform.zoom),y=[256/i.width*2+1,256/i.height*2+1],_=r?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;_.clear();const x=t.lineVertexArray,b=r?t.text.placedSymbolArray:t.icon.placedSymbolArray,A=i.transform.width/i.transform.height;let w=!1;for(let r=0;r<b.length;r++){const C=b.get(r);if(C.hidden||C.writingMode===e.ah.vertical&&!w){Lt(C.numGlyphs,_);continue}w=!1;const E=vt(new e.P(C.anchorX,C.anchorY),n,f);if(!_t(E.point,y)){Lt(C.numGlyphs,_);continue}const S=yt(i.transform.cameraToCenterDistance,E.signedDistanceFromCamera),M=e.ai(g,v,C),T=s?M/S:M*S,I={getElevation:f,labelPlaneMatrix:a,lineVertexArray:x,pitchWithMap:s,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:u,tileAnchorPoint:new e.P(C.anchorX,C.anchorY),unwrappedTileID:h,width:d,height:p,translation:m},B=wt(I,C,T,!1,l,n,o,t.glyphOffsetArray,_,A,c);w=B.useVertical,(B.notEnoughRoom||w||B.needsFlipping&&wt(I,C,T,!0,l,n,o,t.glyphOffsetArray,_,A,c).notEnoughRoom)&&Lt(C.numGlyphs,_)}r?t.text.dynamicLayoutVertexBuffer.updateData(_):t.icon.dynamicLayoutVertexBuffer.updateData(_)}function bt(t,e,n,i,r,a,o,s){const l=a.glyphStartIndex+a.numGlyphs,c=a.lineStartIndex,u=a.lineStartIndex+a.lineLength,h=e.getoffsetX(a.glyphStartIndex),d=e.getoffsetX(l-1),p=It(t*h,n,i,r,a.segment,c,u,s,o);if(!p)return null;const m=It(t*d,n,i,r,a.segment,c,u,s,o);return m?s.projectionCache.anyProjectionOccluded?null:{first:p,last:m}:null}function At(t,n,i,r){return t===e.ah.horizontal&&Math.abs(i.y-n.y)>Math.abs(i.x-n.x)*r?{useVertical:!0}:(t===e.ah.vertical?n.y<i.y:n.x>i.x)?{needsFlipping:!0}:null}function wt(t,n,i,r,a,o,s,l,c,u,h){const d=i/24,p=n.lineOffsetX*d,m=n.lineOffsetY*d;let f;if(n.numGlyphs>1){const e=n.glyphStartIndex+n.numGlyphs,i=n.lineStartIndex,o=n.lineStartIndex+n.lineLength,c=bt(d,l,p,m,r,n,h,t);if(!c)return{notEnoughRoom:!0};const g=vt(c.first.point,s,t.getElevation).point,v=vt(c.last.point,s,t.getElevation).point;if(a&&!r){const t=At(n.writingMode,g,v,u);if(t)return t}f=[c.first];for(let a=n.glyphStartIndex+1;a<e-1;a++)f.push(It(d*l.getoffsetX(a),p,m,r,n.segment,i,o,t,h));f.push(c.last)}else{if(a&&!r){const i=vt(t.tileAnchorPoint,o,t.getElevation).point,r=n.lineStartIndex+n.segment+1,a=new e.P(t.lineVertexArray.getx(r),t.lineVertexArray.gety(r)),s=vt(a,o,t.getElevation),l=s.signedDistanceFromCamera>0?s.point:function(t,e,n,i,r,a){return Ct(t,e,n,1,r,a)}(t.tileAnchorPoint,a,i,0,o,t),c=At(n.writingMode,i,l,u);if(c)return c}const i=It(d*l.getoffsetX(n.glyphStartIndex),p,m,r,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,t,h);if(!i||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};f=[i]}for(const t of f)e.aj(c,t.point,t.angle);return{}}function Ct(t,e,n,i,r,a){const o=t.add(t.sub(e)._unit()),s=void 0!==r?vt(o,r,a.getElevation).point:St(o.x,o.y,a).point,l=n.sub(s);return n.add(l._mult(i/l.mag()))}function Et(t,n,i){const r=n.projectionCache;if(r.projections[t])return r.projections[t];const a=new e.P(n.lineVertexArray.getx(t),n.lineVertexArray.gety(t)),o=St(a.x,a.y,n);if(o.signedDistanceFromCamera>0)return r.projections[t]=o.point,r.anyProjectionOccluded=r.anyProjectionOccluded||o.isOccluded,o.point;const s=t-i.direction;return function(t,e,n,i,r){return Ct(t,e,n,i,void 0,r)}(0===i.distanceFromAnchor?n.tileAnchorPoint:new e.P(n.lineVertexArray.getx(s),n.lineVertexArray.gety(s)),a,i.previousVertex,i.absOffsetX-i.distanceFromAnchor+1,n)}function St(t,n,i){const r=t+i.translation[0],a=n+i.translation[1];let o;return!i.pitchWithMap&&i.projection.useSpecialProjectionForSymbols?(o=i.projection.projectTileCoordinates(r,a,i.unwrappedTileID,i.getElevation),o.point.x=(.5*o.point.x+.5)*i.width,o.point.y=(.5*-o.point.y+.5)*i.height):(o=vt(new e.P(r,a),i.labelPlaneMatrix,i.getElevation),o.isOccluded=!1),o}function Mt(t,e,n){return t._unit()._perp()._mult(e*n)}function Tt(t,n,i,r,a,o,s,l,c){if(l.projectionCache.offsets[t])return l.projectionCache.offsets[t];const u=i.add(n);if(t+c.direction<r||t+c.direction>=a)return l.projectionCache.offsets[t]=u,u;const h=Et(t+c.direction,l,c),d=Mt(h.sub(i),s,c.direction),p=i.add(d),m=h.add(d);return l.projectionCache.offsets[t]=e.ak(o,u,p,m)||u,l.projectionCache.offsets[t]}function It(t,e,n,i,r,a,o,s,l){const c=i?t-e:t+e;let u=c>0?1:-1,h=0;i&&(u*=-1,h=Math.PI),u<0&&(h+=Math.PI);let d,p=u>0?a+r:a+r+1;s.projectionCache.cachedAnchorPoint?d=s.projectionCache.cachedAnchorPoint:(d=St(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=d);let m,f,g=d,v=d,y=0,_=0;const x=Math.abs(c),b=[];let A;for(;y+_<=x;){if(p+=u,p<a||p>=o)return null;y+=_,v=g,f=m;const t={absOffsetX:x,direction:u,distanceFromAnchor:y,previousVertex:v};if(g=Et(p,s,t),0===n)b.push(v),A=g.sub(v);else{let e;const i=g.sub(v);e=0===i.mag()?Mt(Et(p+u,s,t).sub(g),n,u):Mt(i,n,u),f||(f=v.add(e)),m=Tt(p,e,g,a,o,f,n,s,t),b.push(f),A=m.sub(f)}_=A.mag()}const w=A._mult((x-y)/_)._add(f||v),C=h+Math.atan2(g.y-v.y,g.x-v.x);return b.push(w),{point:w,angle:l?C:0,path:b}}const Bt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lt(t,e){for(let n=0;n<t;n++){const t=e.length;e.resize(t+4),e.float32.set(Bt,3*t)}}const Dt=100;class Pt{constructor(t,e,n=new mt(t.width+200,t.height+200,25),i=new mt(t.width+200,t.height+200,25)){this.transform=t,this.mapProjection=e,this.grid=n,this.ignoredGrid=i,this.pitchFactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Dt,this.screenBottomBoundary=t.height+Dt,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,e,n,i,r,a,o,s,l,c,u){const h=t.anchorPointX+s[0],d=t.anchorPointY+s[1],p=this.projectAndGetPerspectiveRatio(i,h,d,r,c),m=this._projectCollisionBox(t,n,i,r,a,o,s,p,c,u),[f,g,v,y]=m.box;return this.mapProjection.useSpecialProjectionForSymbols&&(a?m.allPointsOccluded:this.mapProjection.isOccluded(h,d,r))||p.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(f,g,v,y)||"always"!==e&&this.grid.hitTest(f,g,v,y,e,l)?{box:[f,g,v,y],placeable:!1,offscreen:!1}:{box:[f,g,v,y],placeable:!0,offscreen:this.isOffscreen(f,g,v,y)}}placeCollisionCircles(t,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g){const v=[],y=new e.P(n.anchorX,n.anchorY),_=this.getPerspectiveRatio(o,y.x,y.y,s,g),x=(h?a/_:a*_)/e.ap,b={getElevation:g,labelPlaneMatrix:l,lineVertexArray:i,pitchWithMap:h,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:y,unwrappedTileID:s,width:this.transform.width,height:this.transform.height,translation:f},A=bt(x,r,n.lineOffsetX*x,n.lineOffsetY*x,!1,n,!1,b);let w=!1,C=!1,E=!0;if(A){const n=.5*p*_+m,i=new e.P(-100,-100),r=new e.P(this.screenRightBoundary,this.screenBottomBoundary),a=new dt,o=A.first,s=A.last;let l=[];for(let t=o.path.length-1;t>=1;t--)l.push(o.path[t]);for(let t=1;t<s.path.length;t++)l.push(s.path[t]);const h=2.5*n;if(c){const t=this.projectPathToScreenSpace(l,b,c);l=t.some((t=>t.signedDistanceFromCamera<=0))?[]:t.map((t=>t.point))}let f=[];if(l.length>0){const t=l[0].clone(),n=l[0].clone();for(let e=1;e<l.length;e++)t.x=Math.min(t.x,l[e].x),t.y=Math.min(t.y,l[e].y),n.x=Math.max(n.x,l[e].x),n.y=Math.max(n.y,l[e].y);f=t.x>=i.x&&n.x<=r.x&&t.y>=i.y&&n.y<=r.y?[l]:n.x<i.x||t.x>r.x||n.y<i.y||t.y>r.y?[]:e.al([l],i.x,i.y,r.x,r.y)}for(const e of f){a.reset(e,.25*n);let i=0;i=a.length<=.5*n?1:Math.ceil(a.paddedLength/h)+1;for(let e=0;e<i;e++){const r=e/Math.max(i-1,1),o=a.lerp(r),s=o.x+Dt,l=o.y+Dt;v.push(s,l,n,0);const c=s-n,h=l-n,p=s+n,m=l+n;if(E=E&&this.isOffscreen(c,h,p,m),C=C||this.isInsideGrid(c,h,p,m),"always"!==t&&this.grid.hitTestCircle(s,l,n,t,d)&&(w=!0,!u))return{circles:[],offscreen:!1,collisionDetected:w}}}}return{circles:!u&&w||!C||_<this.perspectiveRatioCutoff?[]:v,offscreen:E,collisionDetected:w}}projectPathToScreenSpace(t,e,n){return t.map((t=>vt(t,n,e.getElevation)))}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let i=1/0,r=1/0,a=-1/0,o=-1/0;for(const s of t){const t=new e.P(s.x+Dt,s.y+Dt);i=Math.min(i,t.x),r=Math.min(r,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y),n.push(t)}const s=this.grid.query(i,r,a,o).concat(this.ignoredGrid.query(i,r,a,o)),l={},c={};for(const t of s){const i=t.key;if(void 0===l[i.bucketInstanceId]&&(l[i.bucketInstanceId]={}),l[i.bucketInstanceId][i.featureIndex])continue;const r=[new e.P(t.x1,t.y1),new e.P(t.x2,t.y1),new e.P(t.x2,t.y2),new e.P(t.x1,t.y2)];e.am(n,r)&&(l[i.bucketInstanceId][i.featureIndex]=!0,void 0===c[i.bucketInstanceId]&&(c[i.bucketInstanceId]=[]),c[i.bucketInstanceId].push(i.featureIndex))}return c}insertCollisionBox(t,e,n,i,r,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:e},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,n,i,r,a){const o=n?this.ignoredGrid:this.grid,s={bucketInstanceId:i,featureIndex:r,collisionGroupID:a,overlapMode:e};for(let e=0;e<t.length;e+=4)o.insertCircle(s,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(t,n,i,r,a){const o=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(n,i,r,a):vt(new e.P(n,i),t,a);return{point:new e.P((o.point.x+1)/2*this.transform.width+Dt,(1-o.point.y)/2*this.transform.height+Dt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/o.signedDistanceFromCamera*.5,isOccluded:o.isOccluded,signedDistanceFromCamera:o.signedDistanceFromCamera}}getPerspectiveRatio(t,n,i,r,a){const o=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(n,i,r,a):vt(new e.P(n,i),t,a);return.5+this.transform.cameraToCenterDistance/o.signedDistanceFromCamera*.5}isOffscreen(t,e,n,i){return n<Dt||t>=this.screenRightBoundary||i<Dt||e>this.screenBottomBoundary}isInsideGrid(t,e,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const t=e.an([]);return e.H(t,t,[-100,-100,0]),t}_projectCollisionBox(t,n,i,r,a,o,s,l,c,u){const h=n*l.perspectiveRatio;let d=new e.P(1,0),p=new e.P(0,1);const m=new e.P(t.anchorPointX+s[0],t.anchorPointY+s[1]);if(o&&!a){const t=this.projectAndGetPerspectiveRatio(i,m.x+1,m.y,r,c).point.sub(l.point).unit(),n=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0),a=Math.sin(n),o=Math.cos(n);d=new e.P(o,a),p=new e.P(-a,o)}else if(!o&&a){const t=-this.transform.angle,n=Math.sin(t),i=Math.cos(t);d=new e.P(i,n),p=new e.P(-n,i)}let f=l.point,g=h;if(a){f=m;const t=this.transform.zoom-Math.floor(this.transform.zoom);g=Math.pow(2,-t),g*=this.mapProjection.getPitchedTextCorrection(this.transform,m,r),u||(g*=e.ac(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}u&&(f=f.add(d.mult(u.x*g)).add(p.mult(u.y*g)));const v=t.x1*g,y=t.x2*g,_=(v+y)/2,x=t.y1*g,b=t.y2*g,A=(x+b)/2,w=[{offsetX:v,offsetY:x},{offsetX:_,offsetY:x},{offsetX:y,offsetY:x},{offsetX:y,offsetY:A},{offsetX:y,offsetY:b},{offsetX:_,offsetY:b},{offsetX:v,offsetY:b},{offsetX:v,offsetY:A}];let C=[];for(const{offsetX:t,offsetY:n}of w)C.push(new e.P(f.x+d.x*t+p.x*n,f.y+d.y*t+p.y*n));let E=!1;if(a){const t=C.map((t=>this.projectAndGetPerspectiveRatio(i,t.x,t.y,r,c)));E=t.some((t=>!t.isOccluded)),C=t.map((t=>t.point))}else E=!0;return{box:e.ao(C),allPointsOccluded:!E}}}function Rt(t,n,i){return n*(e.W/(t.tileSize*Math.pow(2,i-t.tileID.overscaledZ)))}class kt{constructor(t,e,n,i){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):i&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class zt{constructor(t,e,n,i,r){this.text=new kt(t?t.text:null,e,n,r),this.icon=new kt(t?t.icon:null,e,i,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ft{constructor(t,e,n){this.text=t,this.icon=e,this.skipFade=n}}class Ot{constructor(){this.invProjMatrix=e.F(),this.viewportMatrix=e.F(),this.circles=[]}}class Nt{constructor(t,e,n,i,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=r}}class Ut{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function Vt(t,n,i,r,a){const{horizontalAlign:o,verticalAlign:s}=e.au(t);return new e.P(-(o-.5)*n+r[0]*a,-(s-.5)*i+r[1]*a)}class Gt{constructor(t,e,n,i,r,a){this.transform=t.clone(),this.terrain=n,this.collisionIndex=new Pt(this.transform,e),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=i,this.retainedQueryData={},this.collisionGroups=new Ut(r),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const e=this.terrain;return e?(n,i)=>e.getElevation(t,n,i):null}getBucketParts(t,n,i,r){const a=i.getBucket(n),o=i.latestFeatureIndex;if(!a||!o||n.id!==a.layerIds[0])return;const s=i.collisionBoxArray,l=a.layers[0].layout,c=a.layers[0].paint,u=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),h=i.tileSize/e.W,d=i.tileID.toUnwrapped(),p=this.transform.calculatePosMatrix(d),m="map"===l.get("text-pitch-alignment"),f="map"===l.get("text-rotation-alignment"),g=Rt(i,1,this.transform.zoom),v=this.collisionIndex.mapProjection.translatePosition(this.transform,i,c.get("text-translate"),c.get("text-translate-anchor")),y=this.collisionIndex.mapProjection.translatePosition(this.transform,i,c.get("icon-translate"),c.get("icon-translate-anchor")),_=ft(p,m,f,this.transform,g);let x=null;if(m){const t=gt(p,m,f,this.transform,g);x=e.K([],this.transform.labelPlaneMatrix,t)}this.retainedQueryData[a.bucketInstanceId]=new Nt(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,i.tileID);const b={bucket:a,layout:l,translationText:v,translationIcon:y,posMatrix:p,unwrappedTileID:d,textLabelPlaneMatrix:_,labelToScreenMatrix:x,scale:u,textPixelRatio:h,holdingForFade:i.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.ag(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(r)for(const e of a.sortKeyRanges){const{sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r}=e;t.push({sortKey:n,symbolInstanceStart:i,symbolInstanceEnd:r,parameters:b})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:b})}attemptAnchorPlacement(t,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v,y,_){const x=e.aq[t.textAnchor],b=[t.textOffset0,t.textOffset1],A=Vt(x,i,r,b,a),w=this.collisionIndex.placeCollisionBox(n,d,l,c,u,s,o,g,h.predicate,_,A);if((!y||this.collisionIndex.placeCollisionBox(y,d,l,c,u,s,o,v,h.predicate,_,A).placeable)&&w.placeable){let t;if(this.prevPlacement&&this.prevPlacement.variableOffsets[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID]&&this.prevPlacement.placements[p.crossTileID].text&&(t=this.prevPlacement.variableOffsets[p.crossTileID].anchor),0===p.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[p.crossTileID]={textOffset:b,width:i,height:r,anchor:x,textBoxScale:a,prevAnchor:t},this.markUsedJustification(m,x,p,f),m.allowVerticalPlacement&&(this.markUsedOrientation(m,f,p),this.placedOrientations[p.crossTileID]=f),{shift:A,placedGlyphBoxes:w}}}placeLayerBucketPart(t,n,i){const{bucket:r,layout:a,translationText:o,translationIcon:s,posMatrix:l,unwrappedTileID:c,textLabelPlaneMatrix:u,labelToScreenMatrix:h,textPixelRatio:d,holdingForFade:p,collisionBoxArray:m,partiallyEvaluatedTextSize:f,collisionGroup:g}=t.parameters,v=a.get("text-optional"),y=a.get("icon-optional"),_=e.ar(a,"text-overlap","text-allow-overlap"),x="always"===_,b=e.ar(a,"icon-overlap","icon-allow-overlap"),A="always"===b,w="map"===a.get("text-rotation-alignment"),C="map"===a.get("text-pitch-alignment"),E="none"!==a.get("icon-text-fit"),S="viewport-y"===a.get("symbol-z-order"),M=x&&(A||!r.hasIconData()||y),T=A&&(x||!r.hasTextData()||v);!r.collisionArrays&&m&&r.deserializeCollisionBoxes(m);const I=this._getTerrainElevationFunc(this.retainedQueryData[r.bucketInstanceId].tileID),B=(t,m,A)=>{var S,B;if(n[t.crossTileID])return;if(p)return void(this.placements[t.crossTileID]=new Ft(!1,!1,!1));let L=!1,D=!1,P=!0,R=null,k={box:null,placeable:!1,offscreen:null},z={box:null,placeable:!1,offscreen:null},F=null,O=null,N=null,U=0,V=0,G=0;m.textFeatureIndex?U=m.textFeatureIndex:t.useRuntimeCollisionCircles&&(U=t.featureIndex),m.verticalTextFeatureIndex&&(V=m.verticalTextFeatureIndex);const H=m.textBox;if(H){const n=n=>{let i=e.ah.horizontal;if(r.allowVerticalPlacement&&!n&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[t.crossTileID];e&&(this.placedOrientations[t.crossTileID]=e,i=e,this.markUsedOrientation(r,i,t))}return i},a=(n,i)=>{if(r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&m.verticalTextBox){for(const t of r.writingModes)if(t===e.ah.vertical?(k=i(),z=k):k=n(),k&&k.placeable)break}else k=n()},u=t.textAnchorOffsetStartIndex,h=t.textAnchorOffsetEndIndex;if(h===u){const i=(e,n)=>{const i=this.collisionIndex.placeCollisionBox(e,_,d,l,c,C,w,o,g.predicate,I);return i&&i.placeable&&(this.markUsedOrientation(r,n,t),this.placedOrientations[t.crossTileID]=n),i};a((()=>i(H,e.ah.horizontal)),(()=>{const n=m.verticalTextBox;return r.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&n?i(n,e.ah.vertical):{box:null,offscreen:null}})),n(k&&k.placeable)}else{let p=e.aq[null===(B=null===(S=this.prevPlacement)||void 0===S?void 0:S.variableOffsets[t.crossTileID])||void 0===B?void 0:B.anchor];const f=(n,a,m)=>{const f=n.x2-n.x1,v=n.y2-n.y1,y=t.textBoxScale,x=E&&"never"===b?a:null;let A=null,S="never"===_?1:2,M="never";p&&S++;for(let e=0;e<S;e++){for(let e=u;e<h;e++){const i=r.textAnchorOffsets.get(e);if(p&&i.textAnchor!==p)continue;const a=this.attemptAnchorPlacement(i,n,f,v,y,w,C,d,l,c,g,M,t,r,m,o,s,x,I);if(a&&(A=a.placedGlyphBoxes,A&&A.placeable))return L=!0,R=a.shift,A}p?p=null:M=_}return i&&!A&&(A={box:this.collisionIndex.placeCollisionBox(H,"always",d,l,c,C,w,o,g.predicate,I,new e.P(0,0)).box,offscreen:!1,placeable:!1}),A};a((()=>f(H,m.iconBox,e.ah.horizontal)),(()=>{const n=m.verticalTextBox;return r.allowVerticalPlacement&&(!k||!k.placeable)&&t.numVerticalGlyphVertices>0&&n?f(n,m.verticalIconBox,e.ah.vertical):{box:null,occluded:!0,offscreen:null}})),k&&(L=k.placeable,P=k.offscreen);const v=n(k&&k.placeable);if(!L&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[t.crossTileID];e&&(this.variableOffsets[t.crossTileID]=e,this.markUsedJustification(r,e.anchor,t,v))}}}if(F=k,L=F&&F.placeable,P=F&&F.offscreen,t.useRuntimeCollisionCircles){const n=r.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex),s=e.ai(r.textSizeData,f,n),d=a.get("text-padding");O=this.collisionIndex.placeCollisionCircles(_,n,r.lineVertexArray,r.glyphOffsetArray,s,l,c,u,h,i,C,g.predicate,t.collisionCircleDiameter,d,o,I),O.circles.length&&O.collisionDetected&&!i&&e.w("Collisions detected, but collision boxes are not shown"),L=x||O.circles.length>0&&!O.collisionDetected,P=P&&O.offscreen}if(m.iconFeatureIndex&&(G=m.iconFeatureIndex),m.iconBox){const t=t=>this.collisionIndex.placeCollisionBox(t,b,d,l,c,C,w,s,g.predicate,I,E&&R?R:void 0);z&&z.placeable&&m.verticalIconBox?(N=t(m.verticalIconBox),D=N.placeable):(N=t(m.iconBox),D=N.placeable),P=P&&N.offscreen}const j=v||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,W=y||0===t.numIconVertices;j||W?W?j||(D=D&&L):L=D&&L:D=L=D&&L;const q=D&&N.placeable;if(L&&F.placeable&&this.collisionIndex.insertCollisionBox(F.box,_,a.get("text-ignore-placement"),r.bucketInstanceId,z&&z.placeable&&V?V:U,g.ID),q&&this.collisionIndex.insertCollisionBox(N.box,b,a.get("icon-ignore-placement"),r.bucketInstanceId,G,g.ID),O&&L&&this.collisionIndex.insertCollisionCircles(O.circles,_,a.get("text-ignore-placement"),r.bucketInstanceId,U,g.ID),i&&this.storeCollisionData(r.bucketInstanceId,A,m,F,N,O),0===t.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===r.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[t.crossTileID]=new Ft(L||M,D||T,P||r.justReloaded),n[t.crossTileID]=!0};if(S){if(0!==t.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const e=r.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const n=e[t];B(r.symbolInstances.get(n),r.collisionArrays[n],n)}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)B(r.symbolInstances.get(e),r.collisionArrays[e],e);if(i&&r.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[r.bucketInstanceId];e.as(t.invProjMatrix,l),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}storeCollisionData(t,e,n,i,r,a){if(n.textBox||n.iconBox){let a,o;this.collisionBoxArrays.has(t)?a=this.collisionBoxArrays.get(t):(a=new Map,this.collisionBoxArrays.set(t,a)),a.has(e)?o=a.get(e):(o={text:null,icon:null},a.set(e,o)),n.textBox&&(o.text=i.box),n.iconBox&&(o.icon=r.box)}if(a){let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new Ot);for(let t=0;t<a.circles.length;t+=4)e.circles.push(a.circles[t+0]),e.circles.push(a.circles[t+1]),e.circles.push(a.circles[t+2]),e.circles.push(a.collisionDetected?1:0)}}markUsedJustification(t,n,i,r){let a;a=r===e.ah.vertical?i.verticalPlacedTextSymbolIndex:{left:i.leftJustifiedTextSymbolIndex,center:i.centerJustifiedTextSymbolIndex,right:i.rightJustifiedTextSymbolIndex}[e.at(n)];const o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex,i.verticalPlacedTextSymbolIndex];for(const e of o)e>=0&&(t.text.placedSymbolArray.get(e).crossTileID=a>=0&&e!==a?0:i.crossTileID)}markUsedOrientation(t,n,i){const r=n===e.ah.horizontal||n===e.ah.horizontalOnly?n:0,a=n===e.ah.vertical?n:0,o=[i.leftJustifiedTextSymbolIndex,i.centerJustifiedTextSymbolIndex,i.rightJustifiedTextSymbolIndex];for(const e of o)t.text.placedSymbolArray.get(e).placedOrientation=r;i.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(i.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let n=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const i=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},a=e?e.variableOffsets:{},o=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],a=r[t];a?(this.opacities[t]=new zt(a,i,e.text,e.icon),n=n||e.text!==a.text.placed||e.icon!==a.icon.placed):(this.opacities[t]=new zt(null,i,e.text,e.icon,e.skipFade),n=n||e.text||e.icon)}for(const t in r){const e=r[t];if(!this.opacities[t]){const r=new zt(e,i,!1,!1);r.isHidden()||(this.opacities[t]=r,n=n||e.text.placed||e.icon.placed)}}for(const t in a)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=a[t]);for(const t in o)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=o[t]);if(e&&void 0===e.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const n={};for(const i of e){const e=i.getBucket(t);e&&i.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i.tileID,n,i.collisionBoxArray)}}updateBucketOpacities(t,n,i,r){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const a=t.layers[0],o=a.layout,s=new zt(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),c=o.get("icon-allow-overlap"),u=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),h="map"===o.get("text-rotation-alignment"),d="map"===o.get("text-pitch-alignment"),p="none"!==o.get("icon-text-fit"),m=new zt(null,0,l&&(c||!t.hasIconData()||o.get("icon-optional")),c&&(l||!t.hasTextData()||o.get("text-optional")),!0);!t.collisionArrays&&r&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(r);const f=(t,e,n)=>{for(let i=0;i<e/4;i++)t.opacityVertexArray.emplaceBack(n);t.hasVisibleVertices=t.hasVisibleVertices||n!==Jt},g=this.collisionBoxArrays.get(t.bucketInstanceId);for(let n=0;n<t.symbolInstances.length;n++){const r=t.symbolInstances.get(n),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:o,crossTileID:l}=r;let c=this.opacities[l];i[l]?c=s:c||(c=m,this.opacities[l]=c),i[l]=!0;const v=r.numIconVertices>0,y=this.placedOrientations[r.crossTileID],_=y===e.ah.vertical,x=y===e.ah.horizontal||y===e.ah.horizontalOnly;if(a>0||o>0){const e=Qt(c.text);f(t.text,a,_?Jt:e),f(t.text,o,x?Jt:e);const n=c.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((e=>{e>=0&&(t.text.placedSymbolArray.get(e).hidden=n||_?1:0)})),r.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=n||x?1:0);const i=this.variableOffsets[r.crossTileID];i&&this.markUsedJustification(t,i.anchor,r,y);const s=this.placedOrientations[r.crossTileID];s&&(this.markUsedJustification(t,"left",r,s),this.markUsedOrientation(t,s,r))}if(v){const e=Qt(c.icon),n=!(p&&r.verticalPlacedIconSymbolIndex&&_);r.placedIconSymbolIndex>=0&&(f(t.icon,r.numIconVertices,n?e:Jt),t.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=c.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(f(t.icon,r.numVerticalIconVertices,n?Jt:e),t.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=c.icon.isHidden())}const b=g&&g.has(n)?g.get(n):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const i=t.collisionArrays[n];if(i){let n=new e.P(0,0);if(i.textBox||i.verticalTextBox){let e=!0;if(u){const t=this.variableOffsets[l];t?(n=Vt(t.anchor,t.width,t.height,t.textOffset,t.textBoxScale),h&&n._rotate(d?this.transform.angle:-this.transform.angle)):e=!1}if(i.textBox||i.verticalTextBox){let r;i.textBox&&(r=_),i.verticalTextBox&&(r=x),Ht(t.textCollisionBox.collisionVertexArray,c.text.placed,!e||r,b.text,n.x,n.y)}}if(i.iconBox||i.verticalIconBox){const e=Boolean(!x&&i.verticalIconBox);let r;i.iconBox&&(r=e),i.verticalIconBox&&(r=!e),Ht(t.iconCollisionBox.collisionVertexArray,c.icon.placed,r,b.icon,p?n.x:0,p?n.y:0)}}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const n=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*n>t}setStale(){this.stale=!0}}function Ht(t,e,n,i,r,a){i&&0!==i.length||(i=[0,0,0,0]);const o=i[0]-Dt,s=i[1]-Dt,l=i[2]-Dt,c=i[3]-Dt;t.emplaceBack(e?1:0,n?1:0,r||0,a||0,o,s),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,l,s),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,l,c),t.emplaceBack(e?1:0,n?1:0,r||0,a||0,o,c)}const jt=Math.pow(2,25),Wt=Math.pow(2,24),qt=Math.pow(2,17),Zt=Math.pow(2,16),$t=Math.pow(2,9),Yt=Math.pow(2,8),Xt=Math.pow(2,1);function Qt(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,n=Math.floor(127*t.opacity);return n*jt+e*Wt+n*qt+e*Zt+n*$t+e*Yt+n*Xt+e}const Jt=0;function Kt(){return{isOccluded:(t,e,n)=>!1,getPitchedTextCorrection:(t,e,n)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(t,e,n,i){throw new Error("Not implemented.")},translatePosition:(t,e,n,i)=>function(t,e,n,i,r=!1){if(!n[0]&&!n[1])return[0,0];const a=r?"map"===i?t.angle:0:"viewport"===i?-t.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);n=[n[0]*e-n[1]*t,n[0]*t+n[1]*e]}return[r?n[0]:Rt(e,n[0],t.zoom),r?n[1]:Rt(e,n[1],t.zoom)]}(t,e,n,i),getCircleRadiusCorrection:t=>1}}class te{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,n,i,r){const a=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(a,i,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort(((t,e)=>t.sortKey-e.sortKey)));this._currentPartIndex<a.length;)if(e.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,r())return!0;return!1}}class ee{constructor(t,e,n,i,r,a,o,s){this.placement=new Gt(t,Kt(),e,a,o,s),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=r,this._done=!1}isDone(){return this._done}continuePlacement(t,e,n){const i=a.now(),r=()=>!this._forceFullPlacement&&a.now()-i>2;for(;this._currentPlacementIndex>=0;){const i=e[t[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===i.type&&(!i.minzoom||i.minzoom<=a)&&(!i.maxzoom||i.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new te(i)),this._inProgressLayer.continuePlacement(n[i.source],this.placement,this._showCollisionBoxes,i,r))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const ne=512/e.W/2;class ie{constructor(t,n,i){this.tileID=t,this.bucketInstanceId=i,this._symbolsByKey={};const r=new Map;for(let t=0;t<n.length;t++){const e=n.get(t),i=e.key,a=r.get(i);a?a.push(e):r.set(i,[e])}for(const[t,n]of r){const i={positions:n.map((t=>({x:Math.floor(t.anchorX*ne),y:Math.floor(t.anchorY*ne)}))),crossTileIDs:n.map((t=>t.crossTileID))};if(i.positions.length>128){const t=new e.av(i.positions.length,16,Uint16Array);for(const{x:e,y:n}of i.positions)t.add(e,n);t.finish(),delete i.positions,i.index=t}this._symbolsByKey[t]=i}}getScaledCoordinates(t,n){const{x:i,y:r,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=n.canonical,c=ne/Math.pow(2,l-a),u=(s*e.W+t.anchorY)*c,h=r*e.W*ne;return{x:Math.floor((o*e.W+t.anchorX)*c-i*e.W*ne),y:Math.floor(u-h)}}findMatches(t,e,n){const i=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const a=t.get(r);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,e);if(o.index){const t=o.index.range(s.x-i,s.y-i,s.x+i,s.y+i).sort();for(const e of t){const t=o.crossTileIDs[e];if(!n[t]){n[t]=!0,a.crossTileID=t;break}}}else if(o.positions)for(let t=0;t<o.positions.length;t++){const e=o.positions[t],r=o.crossTileIDs[t];if(Math.abs(e.x-s.x)<=i&&Math.abs(e.y-s.y)<=i&&!n[r]){n[r]=!0,a.crossTileID=r;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class re{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ae{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const n=this.indexes[t],i={};for(const t in n){const r=n[t];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),i[r.tileID.key]=r}this.indexes[t]=i}this.lng=t}addBucket(t,e,n){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const i=this.usedCrossTileIDs[t.overscaledZ];for(const n in this.indexes){const r=this.indexes[n];if(Number(n)>t.overscaledZ)for(const n in r){const a=r[n];a.tileID.isChildOf(t)&&a.findMatches(e.symbolInstances,t,i)}else{const a=r[t.scaledTo(Number(n)).key];a&&a.findMatches(e.symbolInstances,t,i)}}for(let t=0;t<e.symbolInstances.length;t++){const r=e.symbolInstances.get(t);r.crossTileID||(r.crossTileID=n.generate(),i[r.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ie(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const n of e.getCrossTileIDsLists())for(const e of n)delete this.usedCrossTileIDs[t][e]}removeStaleBuckets(t){let e=!1;for(const n in this.indexes){const i=this.indexes[n];for(const r in i)t[i[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,i[r]),delete i[r],e=!0)}return e}}class oe{constructor(){this.layerIndexes={},this.crossTileIDs=new re,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,n){let i=this.layerIndexes[t.id];void 0===i&&(i=this.layerIndexes[t.id]=new ae);let r=!1;const a={};i.handleWrapJump(n);for(const n of e){const e=n.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(n.tileID,e,this.crossTileIDs)&&(r=!0),a[e.bucketInstanceId]=!0)}return i.removeStaleBuckets(a)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach((t=>{e[t]=!0}));for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const se=(t,n)=>e.t(t,n&&n.filter((t=>"source.canvas"!==t.identifier))),le=e.aw();class ce extends e.E{constructor(t,n={}){super(),this._rtlPluginLoaded=()=>{for(const t in this.sourceCaches){const e=this.sourceCaches[t].getSource().type;"vector"!==e&&"geojson"!==e||this.sourceCaches[t].reload()}},this.map=t,this.dispatcher=new O(F(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((t,e)=>this.getGlyphs(t,e))),this.dispatcher.registerMessageHandler("GI",((t,e)=>this.getImages(t,e))),this.imageManager=new w,this.imageManager.setEventedParent(this),this.glyphManager=new M(t._requestManager,n.localIdeographFontFamily),this.lineAtlas=new L(256,512),this.crossTileSymbolIndex=new oe,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",e.ay()),at().on(nt,this._rtlPluginLoaded),this.on("data",(t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.sourceCaches[t.sourceId];if(!e)return;const n=e.getSource();if(n&&n.vectorLayerIds)for(const t in this._layers){const e=this._layers[t];e.source===n.id&&this._validateLayer(e)}}))}loadURL(t,n={},i){this.fire(new e.k("dataloading",{dataType:"style"})),n.validate="boolean"!=typeof n.validate||n.validate;const r=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController,e.h(r,this._loadStyleRequest).then((t=>{this._loadStyleRequest=null,this._load(t.data,n,i)})).catch((t=>{this._loadStyleRequest=null,t&&this.fire(new e.j(t))}))}loadJSON(t,n={},i){this.fire(new e.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,n.validate=!1!==n.validate,this._load(t,n,i)})).catch((()=>{}))}loadEmpty(){this.fire(new e.k("dataloading",{dataType:"style"})),this._load(le,{validate:!1})}_load(t,n,i){var r;const a=n.transformStyle?n.transformStyle(i,t):t;if(!n.validate||!se(this,e.x(a))){this._loaded=!0,this.stylesheet=a;for(const t in a.sources)this.addSource(t,a.sources[t],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new B(this.stylesheet.light),this.map.setTerrain(null!==(r=this.stylesheet.terrain)&&void 0!==r?r:null),this.fire(new e.k("data",{dataType:"style"})),this.fire(new e.k("style.load"))}}_createLayers(){const t=e.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map((t=>t.id)),this._layers={},this._serializedLayers=null;for(const n of t){const t=e.aA(n);t.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=t}}_loadSprite(t,n=!1,i=void 0){let r;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(t,n,i,r){return e._(this,void 0,void 0,(function*(){const o=_(t),s=i>1?"@2x":"",l={},c={};for(const{id:t,url:i}of o){const a=n.transformRequest(x(i,s,".json"),"SpriteJSON");l[t]=e.h(a,r);const o=n.transformRequest(x(i,s,".png"),"SpriteImage");c[t]=p.getImage(o,r)}return yield Promise.all([...Object.values(l),...Object.values(c)]),function(t,n){return e._(this,void 0,void 0,(function*(){const e={};for(const i in t){e[i]={};const r=a.getImageCanvasContext((yield n[i]).data),o=(yield t[i]).data;for(const t in o){const{width:n,height:a,x:s,y:l,sdf:c,pixelRatio:u,stretchX:h,stretchY:d,content:p,textFitWidth:m,textFitHeight:f}=o[t];e[i][t]={data:null,pixelRatio:u,sdf:c,stretchX:h,stretchY:d,content:p,textFitWidth:m,textFitHeight:f,spriteData:{width:n,height:a,x:s,y:l,context:r}}}}return e}))}(l,c)}))}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((t=>{if(this._spriteRequest=null,t)for(const e in t){this._spritesImagesIds[e]=[];const i=this._spritesImagesIds[e]?this._spritesImagesIds[e].filter((e=>!(e in t))):[];for(const t of i)this.imageManager.removeImage(t),this._changedImages[t]=!0;for(const i in t[e]){const r="default"===e?i:`${e}:${i}`;this._spritesImagesIds[e].push(r),r in this.imageManager.images?this.imageManager.updateImage(r,t[e][i],!1):this.imageManager.addImage(r,t[e][i]),n&&(this._changedImages[r]=!0)}}})).catch((t=>{this._spriteRequest=null,r=t,this.fire(new e.j(r))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"})),i&&i(r)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}_validateLayer(t){const n=this.sourceCaches[t.source];if(!n)return;const i=t.sourceLayer;if(!i)return;const r=n.getSource();("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(i))&&this.fire(new e.j(new Error(`Source layer "${i}" does not exist on source "${r.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const e=this._serializedAllLayers();if(!t||0===t.length)return Object.values(e);const n=[];for(const i of t)e[i]&&n.push(e[i]);return n}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const e=Object.keys(this._layers);for(const n of e){const e=this._layers[n];"custom"!==e.type&&(t[n]=e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const n=this._changed;if(n){const e=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(e.length||n.length)&&this._updateWorkerLayers(e,n);for(const t in this._updatedSources){const e=this._updatedSources[t];if("reload"===e)this._reloadSource(t);else{if("clear"!==e)throw new Error(`Invalid action ${e}`);this._clearSource(t)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const e in this._updatedPaintProps)this._layers[e].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const i={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];i[t]=e.used,e.used=!1}for(const e of this._order){const n=this._layers[e];n.recalculate(t,this._availableImages),!n.isHidden(t.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(const t in i){const n=this.sourceCaches[t];!!i[t]!=!!n.used&&n.fire(new e.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:t}))}this.light.recalculate(t),this.z=t.zoom,n&&this.fire(new e.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,n={}){var i;this._checkLoaded();const r=this.serialize();if(t=n.transformStyle?n.transformStyle(r,t):t,(null===(i=n.validate)||void 0===i||i)&&se(this,e.x(t)))return!1;(t=e.aB(t)).layers=e.az(t.layers);const a=e.aC(r,t),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(0===o.operations.length)return!1;for(const t of o.operations)t();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const e=[],n=[];for(const i of t)switch(i.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":e.push((()=>this.addLayer.apply(this,i.args)));break;case"removeLayer":e.push((()=>this.removeLayer.apply(this,i.args)));break;case"setPaintProperty":e.push((()=>this.setPaintProperty.apply(this,i.args)));break;case"setLayoutProperty":e.push((()=>this.setLayoutProperty.apply(this,i.args)));break;case"setFilter":e.push((()=>this.setFilter.apply(this,i.args)));break;case"addSource":e.push((()=>this.addSource.apply(this,i.args)));break;case"removeSource":e.push((()=>this.removeSource.apply(this,i.args)));break;case"setLayerZoomRange":e.push((()=>this.setLayerZoomRange.apply(this,i.args)));break;case"setLight":e.push((()=>this.setLight.apply(this,i.args)));break;case"setGeoJSONSourceData":e.push((()=>this.setGeoJSONSourceData.apply(this,i.args)));break;case"setGlyphs":e.push((()=>this.setGlyphs.apply(this,i.args)));break;case"setSprite":e.push((()=>this.setSprite.apply(this,i.args)));break;case"setTerrain":e.push((()=>this.map.setTerrain.apply(this,i.args)));break;case"setTransition":e.push((()=>{}));break;default:n.push(i.command)}return{operations:e,unimplemented:n}}addImage(t,n){if(this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,n),this._afterImageUpdated(t)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new e.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,n,i={}){if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error(`Source "${t}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(e.x.source,`sources.${t}`,n,null,i))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const r=this.sourceCaches[t]=new ct(t,n,this.dispatcher);r.style=this,r.setEventedParent(this,(()=>({isSourceLoaded:r.loaded(),source:r.serialize(),sourceId:t}))),r.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(const n in this._layers)if(this._layers[n].source===t)return this.fire(new e.j(new Error(`Source "${t}" cannot be removed while layer "${n}" is using it.`)));const n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new e.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error(`There is no source with this ID=${t}`);const n=this.sourceCaches[t].getSource();if("geojson"!==n.type)throw new Error(`geojsonSource.type is ${n.type}, which is !== 'geojson`);n.setData(e),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,n,i={}){this._checkLoaded();const r=t.id;if(this.getLayer(r))return void this.fire(new e.j(new Error(`Layer "${r}" already exists on this map.`)));let a;if("custom"===t.type){if(se(this,e.aD(t)))return;a=e.aA(t)}else{if("source"in t&&"object"==typeof t.source&&(this.addSource(r,t.source),t=e.aB(t),t=e.e(t,{source:r})),this._validate(e.x.layer,`layers.${r}`,t,{arrayIndex:-1},i))return;a=e.aA(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:r}})}const o=n?this._order.indexOf(n):this._order.length;if(n&&-1===o)this.fire(new e.j(new Error(`Cannot add layer "${r}" before non-existing layer "${n}".`)));else{if(this._order.splice(o,0,r),this._layerOrderChanged=!0,this._layers[r]=a,this._removedLayers[r]&&a.source&&"custom"!==a.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(t,n){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===n)return;const i=this._order.indexOf(t);this._order.splice(i,1);const r=n?this._order.indexOf(n):this._order.length;n&&-1===r?this.fire(new e.j(new Error(`Cannot move layer "${t}" before non-existing layer "${n}".`))):(this._order.splice(r,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const n=this._layers[t];if(!n)return void this.fire(new e.j(new Error(`Cannot remove non-existing layer "${t}".`)));n.setEventedParent(null);const i=this._order.indexOf(t);this._order.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,n,i){this._checkLoaded();const r=this.getLayer(t);r?r.minzoom===n&&r.maxzoom===i||(null!=n&&(r.minzoom=n),null!=i&&(r.maxzoom=i),this._updateLayer(r)):this.fire(new e.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,n,i={}){this._checkLoaded();const r=this.getLayer(t);if(r){if(!e.aE(r.filter,n))return null==n?(r.filter=void 0,void this._updateLayer(r)):void(this._validate(e.x.filter,`layers.${r.id}.filter`,n,null,i)||(r.filter=e.aB(n),this._updateLayer(r)))}else this.fire(new e.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return e.aB(this.getLayer(t).filter)}setLayoutProperty(t,n,i,r={}){this._checkLoaded();const a=this.getLayer(t);a?e.aE(a.getLayoutProperty(n),i)||(a.setLayoutProperty(n,i,r),this._updateLayer(a)):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,n){const i=this.getLayer(t);if(i)return i.getLayoutProperty(n);this.fire(new e.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,n,i,r={}){this._checkLoaded();const a=this.getLayer(t);a?e.aE(a.getPaintProperty(n),i)||(a.setPaintProperty(n,i,r)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new e.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(t,n){this._checkLoaded();const i=t.source,r=t.sourceLayer,a=this.sourceCaches[i];if(void 0===a)return void this.fire(new e.j(new Error(`The source '${i}' does not exist in the map's style.`)));const o=a.getSource().type;"geojson"===o&&r?this.fire(new e.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||r?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(r,t.id,n)):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,n){this._checkLoaded();const i=t.source,r=this.sourceCaches[i];if(void 0===r)return void this.fire(new e.j(new Error(`The source '${i}' does not exist in the map's style.`)));const a=r.getSource().type,o="vector"===a?t.sourceLayer:void 0;"vector"!==a||o?n&&"string"!=typeof t.id&&"number"!=typeof t.id?this.fire(new e.j(new Error("A feature id is required to remove its specific state property."))):r.removeFeatureState(o,t.id,n):this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const n=t.source,i=t.sourceLayer,r=this.sourceCaches[n];if(void 0!==r)return"vector"!==r.getSource().type||i?(void 0===t.id&&this.fire(new e.j(new Error("The feature id parameter must be provided."))),r.getFeatureState(i,t.id)):void this.fire(new e.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new e.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return e.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=e.aF(this.sourceCaches,(t=>t.serialize())),n=this._serializeByIds(this._order),i=this.map.getTerrain()||void 0,r=this.stylesheet;return e.aG({version:r.version,name:r.name,metadata:r.metadata,light:r.light,center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch,sprite:r.sprite,glyphs:r.glyphs,transition:r.transition,sources:t,layers:n,terrain:i},(t=>void 0!==t))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&"raster"!==this.sourceCaches[t.source].getSource().type&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,n={},i=[];for(let r=this._order.length-1;r>=0;r--){const a=this._order[r];if(e(a)){n[a]=r;for(const e of t){const t=e[a];if(t)for(const e of t)i.push(e)}}}i.sort(((t,e)=>e.intersectionZ-t.intersectionZ));const r=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(e(o))for(let t=i.length-1;t>=0;t--){const e=i[t].feature;if(n[e.layer.id]<a)break;r.push(e),i.pop()}else for(const e of t){const t=e[o];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(t,n,i){n&&n.filter&&this._validate(e.x.filter,"queryRenderedFeatures.filter",n.filter,null,n);const r={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new e.j(new Error("parameters.layers must be an Array."))),[];for(const t of n.layers){const n=this._layers[t];if(!n)return this.fire(new e.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];r[n.source]=!0}}const a=[];n.availableImages=this._availableImages;const o=this._serializedAllLayers();for(const e in this.sourceCaches)n.layers&&!r[e]||a.push(V(this.sourceCaches[e],this._layers,o,t,n,i));return this.placement&&a.push(function(t,e,n,i,r,a,o){const s={},l=a.queryRenderedSymbols(i),c=[];for(const t of Object.keys(l).map(Number))c.push(o[t]);c.sort(G);for(const n of c){const i=n.featureIndex.lookupSymbolFeatures(l[n.bucketInstanceId],e,n.bucketIndex,n.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in i){const e=s[t]=s[t]||[],r=i[t];r.sort(((t,e)=>{const i=n.featureSortOrder;if(i){const n=i.indexOf(t.featureIndex);return i.indexOf(e.featureIndex)-n}return e.featureIndex-t.featureIndex}));for(const t of r)e.push(t)}}for(const e in s)s[e].forEach((i=>{const r=i.feature,a=n[t[e].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=a}));return s}(this._layers,o,this.sourceCaches,t,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(t,n){n&&n.filter&&this._validate(e.x.filter,"querySourceFeatures.filter",n.filter,null,n);const i=this.sourceCaches[t];return i?function(t,e){const n=t.getRenderableIds().map((e=>t.getTileByID(e))),i=[],r={};for(let t=0;t<n.length;t++){const a=n[t],o=a.tileID.canonical.key;r[o]||(r[o]=!0,a.querySourceFeatures(i,e))}return i}(i,n):[]}getLight(){return this.light.getLight()}setLight(t,n={}){this._checkLoaded();const i=this.light.getLight();let r=!1;for(const n in t)if(!e.aE(t[n],i[n])){r=!0;break}if(!r)return;const o={now:a.now(),transition:e.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,n),this.light.updateTransitions(o)}_validate(t,n,i,r,a={}){return(!a||!1!==a.validate)&&se(this,t.call(e.x,e.e({key:n,style:this.serialize(),value:i,styleSpec:e.v},r)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),at().off(nt,this._rtlPluginLoaded);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const e in this.sourceCaches)this.sourceCaches[e].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,e,n,i,r=!1){let o=!1,s=!1;const l={};for(const e of this._order){const n=this._layers[e];if("symbol"!==n.type)continue;if(!l[n.source]){const t=this.sourceCaches[n.source];l[n.source]=t.getRenderableIds(!0).map((e=>t.getTileByID(e))).sort(((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1)))}const i=this.crossTileSymbolIndex.addLayer(n,l[n.source],t.center.lng);o=o||i}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((r=r||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now(),t.zoom))&&(this.pauseablePlacement=new ee(t,this.map.terrain,this._order,r,e,n,i,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,n){return e._(this,void 0,void 0,(function*(){const t=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const e=this.sourceCaches[n.source];return e&&e.setDependencies(n.tileID.key,n.type,n.icons),t}))}getGlyphs(t,n){return e._(this,void 0,void 0,(function*(){const t=yield this.glyphManager.getGlyphs(n.stacks),e=this.sourceCaches[n.source];return e&&e.setDependencies(n.tileID.key,n.type,[""]),t}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,n={}){this._checkLoaded(),t&&this._validate(e.x.glyphs,"glyphs",t,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,n,i={},r){this._checkLoaded();const a=[{id:t,url:n}],o=[..._(this.stylesheet.sprite),...a];this._validate(e.x.sprite,"sprite",o,null,i)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,r))}removeSprite(t){this._checkLoaded();const n=_(this.stylesheet.sprite);if(n.find((e=>e.id===t))){if(this._spritesImagesIds[t])for(const e of this._spritesImagesIds[t])this.imageManager.removeImage(e),this._changedImages[e]=!0;n.splice(n.findIndex((e=>e.id===t)),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new e.k("data",{dataType:"style"}))}else this.fire(new e.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return _(this.stylesheet.sprite)}setSprite(t,n={},i){this._checkLoaded(),t&&this._validate(e.x.sprite,"sprite",t,null,n)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,i):(this._unloadSprite(),i&&i(null)))}}var ue=e.X([{name:"a_pos",type:"Int16",components:2}]),he="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const de={prelude:pe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:pe("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:pe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:pe("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:pe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:pe("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:pe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:pe("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:pe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:pe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:pe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:pe("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:pe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:pe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:pe("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:pe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:pe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:pe("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:pe("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:pe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:pe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:pe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:pe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:pe("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:pe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:pe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:pe("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",he),terrainDepth:pe("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",he),terrainCoords:pe("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",he)};function pe(t,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=e.match(/attribute ([\w]+) ([\w]+)/g),r=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(r):r,s={};return{fragmentSource:t=t.replace(n,((t,e,n,i,r)=>(s[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = u_${r};\n#endif\n`))),vertexSource:e=e.replace(n,((t,e,n,i,r)=>{const a="float"===i?"vec2":"vec4",o=r.match(/color/)?"color":a;return s[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${a} a_${r};\nvarying ${n} ${i} ${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${n} ${a} a_${r};\n#else\nuniform ${n} ${i} u_${r};\n#endif\n`:"vec4"===o?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = a_${r};\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${n} ${i} ${r} = unpack_mix_${o}(a_${r}, u_${r}_t);\n#else\n    ${n} ${i} ${r} = u_${r};\n#endif\n`})),staticAttributes:i,staticUniforms:o}}class me{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,n,i,r,a,o,s,l){this.context=t;let c=this.boundPaintVertexBuffers.length!==i.length;for(let t=0;!c&&t<i.length;t++)this.boundPaintVertexBuffers[t]!==i[t]&&(c=!0);!this.vao||this.boundProgram!==e||this.boundLayoutVertexBuffer!==n||c||this.boundIndexBuffer!==r||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(e,n,i,r,a,o,s,l):(t.bindVertexArray.set(this.vao),o&&o.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind(),l&&l.bind())}freshBind(t,e,n,i,r,a,o,s){const l=t.numAttributes,c=this.context,u=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=i,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,e.enableAttributes(u,t);for(const e of n)e.enableAttributes(u,t);a&&a.enableAttributes(u,t),o&&o.enableAttributes(u,t),s&&s.enableAttributes(u,t),e.bind(),e.setVertexAttribPointers(u,t,r);for(const e of n)e.bind(),e.setVertexAttribPointers(u,t,r);a&&(a.bind(),a.setVertexAttribPointers(u,t,r)),i&&i.bind(),o&&(o.bind(),o.setVertexAttribPointers(u,t,r)),s&&(s.bind(),s.setVertexAttribPointers(u,t,r)),c.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function fe(t){const e=[];for(let n=0;n<t.length;n++){if(null===t[n])continue;const i=t[n].split(" ");e.push(i.pop())}return e}class ge{constructor(t,n,i,r,a,o){const s=t.gl;this.program=s.createProgram();const l=fe(n.staticAttributes),c=i?i.getBinderAttributes():[],u=l.concat(c),h=de.prelude.staticUniforms?fe(de.prelude.staticUniforms):[],d=n.staticUniforms?fe(n.staticUniforms):[],p=i?i.getBinderUniforms():[],m=h.concat(d).concat(p),f=[];for(const t of m)f.indexOf(t)<0&&f.push(t);const g=i?i.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),o&&g.push("#define TERRAIN3D;");const v=g.concat(de.prelude.fragmentSource,n.fragmentSource).join("\n"),y=g.concat(de.prelude.vertexSource,n.vertexSource).join("\n"),_=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(_,v),s.compileShader(_),!s.getShaderParameter(_,s.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${s.getShaderInfoLog(_)}`);s.attachShader(this.program,_);const x=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(x,y),s.compileShader(x),!s.getShaderParameter(x,s.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${s.getShaderInfoLog(x)}`);s.attachShader(this.program,x),this.attributes={};const b={};this.numAttributes=u.length;for(let t=0;t<this.numAttributes;t++)u[t]&&(s.bindAttribLocation(this.program,t,u[t]),this.attributes[u[t]]=t);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error(`Program failed to link: ${s.getProgramInfoLog(this.program)}`);s.deleteShader(x),s.deleteShader(_);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!b[e]){const t=s.getUniformLocation(this.program,e);t&&(b[e]=t)}}this.fixedUniforms=r(t,b),this.terrainUniforms=((t,n)=>({u_depth:new e.aH(t,n.u_depth),u_terrain:new e.aH(t,n.u_terrain),u_terrain_dim:new e.aI(t,n.u_terrain_dim),u_terrain_matrix:new e.aJ(t,n.u_terrain_matrix),u_terrain_unpack:new e.aK(t,n.u_terrain_unpack),u_terrain_exaggeration:new e.aI(t,n.u_terrain_exaggeration)}))(t,b),this.binderUniforms=i?i.getUniforms(t,b):[]}draw(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f,g,v){const y=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(n),t.setStencilMode(i),t.setColorMode(r),t.setCullFace(a),s){t.activeTexture.set(y.TEXTURE2),y.bindTexture(y.TEXTURE_2D,s.depthTexture),t.activeTexture.set(y.TEXTURE3),y.bindTexture(y.TEXTURE_2D,s.texture);for(const t in this.terrainUniforms)this.terrainUniforms[t].set(s[t])}for(const t in this.fixedUniforms)this.fixedUniforms[t].set(o[t]);m&&m.setUniforms(t,this.binderUniforms,d,{zoom:p});let _=0;switch(e){case y.LINES:_=2;break;case y.TRIANGLES:_=3;break;case y.LINE_STRIP:_=1}for(const n of h.get()){const i=n.vaos||(n.vaos={});(i[l]||(i[l]=new me)).bind(t,this,c,m?m.getPaintVertexBuffers():[],u,n.vertexOffset,f,g,v),y.drawElements(e,n.primitiveLength*_,y.UNSIGNED_SHORT,n.primitiveOffset*_*2)}}}function ve(t,e,n){const i=1/Rt(n,1,e.transform.tileZoom),r=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,e.transform.tileZoom)/r,o=a*(n.tileID.canonical.x+n.tileID.wrap*r),s=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[i,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const ye=(t,n,i,r)=>{const a=n.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=function(){var t=new e.A(9);return e.A!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}();"viewport"===a.properties.get("anchor")&&function(t,e){var n=Math.sin(e),i=Math.cos(e);t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1}(l,-n.transform.angle),function(t,e,n){var i=e[0],r=e[1],a=e[2];t[0]=i*n[0]+r*n[3]+a*n[6],t[1]=i*n[1]+r*n[4]+a*n[7],t[2]=i*n[2]+r*n[5]+a*n[8]}(s,s,l);const c=a.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[c.r,c.g,c.b],u_vertical_gradient:+i,u_opacity:r}},_e=(t,n,i,r,a,o,s)=>e.e(ye(t,n,i,r),ve(o,n,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),xe=t=>({u_matrix:t}),be=(t,n,i,r)=>e.e(xe(t),ve(i,n,r)),Ae=(t,e)=>({u_matrix:t,u_world:e}),we=(t,n,i,r,a)=>e.e(be(t,n,i,r),{u_world:a}),Ce=(t,e,n,i)=>{const r=t.transform;let a,o;if("map"===i.paint.get("circle-pitch-alignment")){const t=Rt(n,1,r.zoom);a=!0,o=[t,t]}else a=!1,o=r.pixelsToGLUnits;return{u_camera_to_center_distance:r.cameraToCenterDistance,u_scale_with_map:+("map"===i.paint.get("circle-pitch-scale")),u_matrix:t.translatePosMatrix(e.posMatrix,n,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:t.pixelRatio,u_extrude_scale:o}},Ee=(t,e,n)=>({u_matrix:t,u_inv_matrix:e,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}),Se=(t,e,n=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:n}),Me=t=>({u_matrix:t}),Te=(t,e,n,i)=>({u_matrix:t,u_extrude_scale:Rt(e,1,n),u_intensity:i});function Ie(t,n){const i=Math.pow(2,n.canonical.z),r=n.canonical.y;return[new e.Y(0,r/i).toLngLat().lat,new e.Y(0,(r+1)/i).toLngLat().lat]}const Be=(t,e,n,i)=>{const r=t.transform;return{u_matrix:ke(t,e,n,i),u_ratio:1/Rt(e,1,r.zoom),u_device_pixel_ratio:t.pixelRatio,u_units_to_pixels:[1/r.pixelsToGLUnits[0],1/r.pixelsToGLUnits[1]]}},Le=(t,n,i,r,a)=>e.e(Be(t,n,i,a),{u_image:0,u_image_height:r}),De=(t,e,n,i,r)=>{const a=t.transform,o=Re(e,a);return{u_matrix:ke(t,e,n,r),u_texsize:e.imageAtlasTexture.size,u_ratio:1/Rt(e,1,a.zoom),u_device_pixel_ratio:t.pixelRatio,u_image:0,u_scale:[o,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Pe=(t,n,i,r,a,o)=>{const s=t.lineAtlas,l=Re(n,t.transform),c="round"===i.layout.get("line-cap"),u=s.getDash(r.from,c),h=s.getDash(r.to,c),d=u.width*a.fromScale,p=h.width*a.toScale;return e.e(Be(t,n,i,o),{u_patternscale_a:[l/d,-u.height/2],u_patternscale_b:[l/p,-h.height/2],u_sdfgamma:s.width/(256*Math.min(d,p)*t.pixelRatio)/2,u_image:0,u_tex_y_a:u.y,u_tex_y_b:h.y,u_mix:a.t})};function Re(t,e){return 1/Rt(t,1,e.tileZoom)}function ke(t,e,n,i){return t.translatePosMatrix(i?i.posMatrix:e.tileID.posMatrix,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const ze=(t,e,n,i,r)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:n,u_buffer_scale:1,u_fade_t:i.mix,u_opacity:i.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(o=r.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=r.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Fe(r.paint.get("raster-hue-rotate"))};var a,o};function Fe(t){t*=Math.PI/180;const e=Math.sin(t),n=Math.cos(t);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Oe=(t,e,n,i,r,a,o,s,l,c,u,h,d,p)=>{const m=o.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:m.cameraToCenterDistance,u_pitch:m.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:m.width/m.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:l,u_coord_matrix:c,u_is_text:+h,u_pitch_with_map:+i,u_is_along_line:r,u_is_variable_anchor:a,u_texsize:d,u_texture:0,u_translation:u,u_pitched_scale:p}},Ne=(t,n,i,r,a,o,s,l,c,u,h,d,p,m,f)=>{const g=s.transform;return e.e(Oe(t,n,i,r,a,o,s,l,c,u,h,d,p,f),{u_gamma_scale:r?Math.cos(g._pitch)*g.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:+m})},Ue=(t,n,i,r,a,o,s,l,c,u,h,d,p,m)=>e.e(Ne(t,n,i,r,a,o,s,l,c,u,h,!0,d,!0,m),{u_texsize_icon:p,u_texture_icon:1}),Ve=(t,e,n)=>({u_matrix:t,u_opacity:e,u_color:n}),Ge=(t,n,i,r,a,o)=>e.e(function(t,e,n,i){const r=n.imageManager.getPattern(t.from.toString()),a=n.imageManager.getPattern(t.to.toString()),{width:o,height:s}=n.imageManager.getPixelSize(),l=Math.pow(2,i.tileID.overscaledZ),c=i.tileSize*Math.pow(2,n.transform.tileZoom)/l,u=c*(i.tileID.canonical.x+i.tileID.wrap*l),h=c*i.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/Rt(i,1,n.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}(r,o,i,a),{u_matrix:t,u_opacity:n}),He={fillExtrusion:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_lightpos:new e.aL(t,n.u_lightpos),u_lightintensity:new e.aI(t,n.u_lightintensity),u_lightcolor:new e.aL(t,n.u_lightcolor),u_vertical_gradient:new e.aI(t,n.u_vertical_gradient),u_opacity:new e.aI(t,n.u_opacity)}),fillExtrusionPattern:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_lightpos:new e.aL(t,n.u_lightpos),u_lightintensity:new e.aI(t,n.u_lightintensity),u_lightcolor:new e.aL(t,n.u_lightcolor),u_vertical_gradient:new e.aI(t,n.u_vertical_gradient),u_height_factor:new e.aI(t,n.u_height_factor),u_image:new e.aH(t,n.u_image),u_texsize:new e.aM(t,n.u_texsize),u_pixel_coord_upper:new e.aM(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,n.u_pixel_coord_lower),u_scale:new e.aL(t,n.u_scale),u_fade:new e.aI(t,n.u_fade),u_opacity:new e.aI(t,n.u_opacity)}),fill:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix)}),fillPattern:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_image:new e.aH(t,n.u_image),u_texsize:new e.aM(t,n.u_texsize),u_pixel_coord_upper:new e.aM(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,n.u_pixel_coord_lower),u_scale:new e.aL(t,n.u_scale),u_fade:new e.aI(t,n.u_fade)}),fillOutline:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_world:new e.aM(t,n.u_world)}),fillOutlinePattern:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_world:new e.aM(t,n.u_world),u_image:new e.aH(t,n.u_image),u_texsize:new e.aM(t,n.u_texsize),u_pixel_coord_upper:new e.aM(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,n.u_pixel_coord_lower),u_scale:new e.aL(t,n.u_scale),u_fade:new e.aI(t,n.u_fade)}),circle:(t,n)=>({u_camera_to_center_distance:new e.aI(t,n.u_camera_to_center_distance),u_scale_with_map:new e.aH(t,n.u_scale_with_map),u_pitch_with_map:new e.aH(t,n.u_pitch_with_map),u_extrude_scale:new e.aM(t,n.u_extrude_scale),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_matrix:new e.aJ(t,n.u_matrix)}),collisionBox:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_pixel_extrude_scale:new e.aM(t,n.u_pixel_extrude_scale)}),collisionCircle:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_inv_matrix:new e.aJ(t,n.u_inv_matrix),u_camera_to_center_distance:new e.aI(t,n.u_camera_to_center_distance),u_viewport_size:new e.aM(t,n.u_viewport_size)}),debug:(t,n)=>({u_color:new e.aN(t,n.u_color),u_matrix:new e.aJ(t,n.u_matrix),u_overlay:new e.aH(t,n.u_overlay),u_overlay_scale:new e.aI(t,n.u_overlay_scale)}),clippingMask:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix)}),heatmap:(t,n)=>({u_extrude_scale:new e.aI(t,n.u_extrude_scale),u_intensity:new e.aI(t,n.u_intensity),u_matrix:new e.aJ(t,n.u_matrix)}),heatmapTexture:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_world:new e.aM(t,n.u_world),u_image:new e.aH(t,n.u_image),u_color_ramp:new e.aH(t,n.u_color_ramp),u_opacity:new e.aI(t,n.u_opacity)}),hillshade:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_image:new e.aH(t,n.u_image),u_latrange:new e.aM(t,n.u_latrange),u_light:new e.aM(t,n.u_light),u_shadow:new e.aN(t,n.u_shadow),u_highlight:new e.aN(t,n.u_highlight),u_accent:new e.aN(t,n.u_accent)}),hillshadePrepare:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_image:new e.aH(t,n.u_image),u_dimension:new e.aM(t,n.u_dimension),u_zoom:new e.aI(t,n.u_zoom),u_unpack:new e.aK(t,n.u_unpack)}),line:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_ratio:new e.aI(t,n.u_ratio),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,n.u_units_to_pixels)}),lineGradient:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_ratio:new e.aI(t,n.u_ratio),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,n.u_units_to_pixels),u_image:new e.aH(t,n.u_image),u_image_height:new e.aI(t,n.u_image_height)}),linePattern:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_texsize:new e.aM(t,n.u_texsize),u_ratio:new e.aI(t,n.u_ratio),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_image:new e.aH(t,n.u_image),u_units_to_pixels:new e.aM(t,n.u_units_to_pixels),u_scale:new e.aL(t,n.u_scale),u_fade:new e.aI(t,n.u_fade)}),lineSDF:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_ratio:new e.aI(t,n.u_ratio),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_units_to_pixels:new e.aM(t,n.u_units_to_pixels),u_patternscale_a:new e.aM(t,n.u_patternscale_a),u_patternscale_b:new e.aM(t,n.u_patternscale_b),u_sdfgamma:new e.aI(t,n.u_sdfgamma),u_image:new e.aH(t,n.u_image),u_tex_y_a:new e.aI(t,n.u_tex_y_a),u_tex_y_b:new e.aI(t,n.u_tex_y_b),u_mix:new e.aI(t,n.u_mix)}),raster:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_tl_parent:new e.aM(t,n.u_tl_parent),u_scale_parent:new e.aI(t,n.u_scale_parent),u_buffer_scale:new e.aI(t,n.u_buffer_scale),u_fade_t:new e.aI(t,n.u_fade_t),u_opacity:new e.aI(t,n.u_opacity),u_image0:new e.aH(t,n.u_image0),u_image1:new e.aH(t,n.u_image1),u_brightness_low:new e.aI(t,n.u_brightness_low),u_brightness_high:new e.aI(t,n.u_brightness_high),u_saturation_factor:new e.aI(t,n.u_saturation_factor),u_contrast_factor:new e.aI(t,n.u_contrast_factor),u_spin_weights:new e.aL(t,n.u_spin_weights)}),symbolIcon:(t,n)=>({u_is_size_zoom_constant:new e.aH(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,n.u_is_size_feature_constant),u_size_t:new e.aI(t,n.u_size_t),u_size:new e.aI(t,n.u_size),u_camera_to_center_distance:new e.aI(t,n.u_camera_to_center_distance),u_pitch:new e.aI(t,n.u_pitch),u_rotate_symbol:new e.aH(t,n.u_rotate_symbol),u_aspect_ratio:new e.aI(t,n.u_aspect_ratio),u_fade_change:new e.aI(t,n.u_fade_change),u_matrix:new e.aJ(t,n.u_matrix),u_label_plane_matrix:new e.aJ(t,n.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,n.u_coord_matrix),u_is_text:new e.aH(t,n.u_is_text),u_pitch_with_map:new e.aH(t,n.u_pitch_with_map),u_is_along_line:new e.aH(t,n.u_is_along_line),u_is_variable_anchor:new e.aH(t,n.u_is_variable_anchor),u_texsize:new e.aM(t,n.u_texsize),u_texture:new e.aH(t,n.u_texture),u_translation:new e.aM(t,n.u_translation),u_pitched_scale:new e.aI(t,n.u_pitched_scale)}),symbolSDF:(t,n)=>({u_is_size_zoom_constant:new e.aH(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,n.u_is_size_feature_constant),u_size_t:new e.aI(t,n.u_size_t),u_size:new e.aI(t,n.u_size),u_camera_to_center_distance:new e.aI(t,n.u_camera_to_center_distance),u_pitch:new e.aI(t,n.u_pitch),u_rotate_symbol:new e.aH(t,n.u_rotate_symbol),u_aspect_ratio:new e.aI(t,n.u_aspect_ratio),u_fade_change:new e.aI(t,n.u_fade_change),u_matrix:new e.aJ(t,n.u_matrix),u_label_plane_matrix:new e.aJ(t,n.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,n.u_coord_matrix),u_is_text:new e.aH(t,n.u_is_text),u_pitch_with_map:new e.aH(t,n.u_pitch_with_map),u_is_along_line:new e.aH(t,n.u_is_along_line),u_is_variable_anchor:new e.aH(t,n.u_is_variable_anchor),u_texsize:new e.aM(t,n.u_texsize),u_texture:new e.aH(t,n.u_texture),u_gamma_scale:new e.aI(t,n.u_gamma_scale),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_is_halo:new e.aH(t,n.u_is_halo),u_translation:new e.aM(t,n.u_translation),u_pitched_scale:new e.aI(t,n.u_pitched_scale)}),symbolTextAndIcon:(t,n)=>({u_is_size_zoom_constant:new e.aH(t,n.u_is_size_zoom_constant),u_is_size_feature_constant:new e.aH(t,n.u_is_size_feature_constant),u_size_t:new e.aI(t,n.u_size_t),u_size:new e.aI(t,n.u_size),u_camera_to_center_distance:new e.aI(t,n.u_camera_to_center_distance),u_pitch:new e.aI(t,n.u_pitch),u_rotate_symbol:new e.aH(t,n.u_rotate_symbol),u_aspect_ratio:new e.aI(t,n.u_aspect_ratio),u_fade_change:new e.aI(t,n.u_fade_change),u_matrix:new e.aJ(t,n.u_matrix),u_label_plane_matrix:new e.aJ(t,n.u_label_plane_matrix),u_coord_matrix:new e.aJ(t,n.u_coord_matrix),u_is_text:new e.aH(t,n.u_is_text),u_pitch_with_map:new e.aH(t,n.u_pitch_with_map),u_is_along_line:new e.aH(t,n.u_is_along_line),u_is_variable_anchor:new e.aH(t,n.u_is_variable_anchor),u_texsize:new e.aM(t,n.u_texsize),u_texsize_icon:new e.aM(t,n.u_texsize_icon),u_texture:new e.aH(t,n.u_texture),u_texture_icon:new e.aH(t,n.u_texture_icon),u_gamma_scale:new e.aI(t,n.u_gamma_scale),u_device_pixel_ratio:new e.aI(t,n.u_device_pixel_ratio),u_is_halo:new e.aH(t,n.u_is_halo),u_translation:new e.aM(t,n.u_translation),u_pitched_scale:new e.aI(t,n.u_pitched_scale)}),background:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_opacity:new e.aI(t,n.u_opacity),u_color:new e.aN(t,n.u_color)}),backgroundPattern:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_opacity:new e.aI(t,n.u_opacity),u_image:new e.aH(t,n.u_image),u_pattern_tl_a:new e.aM(t,n.u_pattern_tl_a),u_pattern_br_a:new e.aM(t,n.u_pattern_br_a),u_pattern_tl_b:new e.aM(t,n.u_pattern_tl_b),u_pattern_br_b:new e.aM(t,n.u_pattern_br_b),u_texsize:new e.aM(t,n.u_texsize),u_mix:new e.aI(t,n.u_mix),u_pattern_size_a:new e.aM(t,n.u_pattern_size_a),u_pattern_size_b:new e.aM(t,n.u_pattern_size_b),u_scale_a:new e.aI(t,n.u_scale_a),u_scale_b:new e.aI(t,n.u_scale_b),u_pixel_coord_upper:new e.aM(t,n.u_pixel_coord_upper),u_pixel_coord_lower:new e.aM(t,n.u_pixel_coord_lower),u_tile_units_to_pixels:new e.aI(t,n.u_tile_units_to_pixels)}),terrain:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_texture:new e.aH(t,n.u_texture),u_ele_delta:new e.aI(t,n.u_ele_delta)}),terrainDepth:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_ele_delta:new e.aI(t,n.u_ele_delta)}),terrainCoords:(t,n)=>({u_matrix:new e.aJ(t,n.u_matrix),u_texture:new e.aH(t,n.u_texture),u_terrain_coords_id:new e.aI(t,n.u_terrain_coords_id),u_ele_delta:new e.aI(t,n.u_ele_delta)})};class je{constructor(t,e,n){this.context=t;const i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const We={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qe{constructor(t,e,n,i){this.length=e.length,this.attributes=n,this.itemSize=e.bytesPerElement,this.dynamicDraw=i,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let n=0;n<this.attributes.length;n++){const i=e.attributes[this.attributes[n].name];void 0!==i&&t.enableVertexAttribArray(i)}}setVertexAttribPointers(t,e,n){for(let i=0;i<this.attributes.length;i++){const r=this.attributes[i],a=e.attributes[r.name];void 0!==a&&t.vertexAttribPointer(a,r.components,t[We[r.type]],!1,this.itemSize,r.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ze=new WeakMap;function $e(t){var e;if(Ze.has(t))return Ze.get(t);{const n=null===(e=t.getParameter(t.VERSION))||void 0===e?void 0:e.startsWith("WebGL 2.0");return Ze.set(t,n),n}}class Ye{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xe extends Ye{getDefault(){return e.aP.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Qe extends Ye{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Je extends Ye{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Ke extends Ye{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class tn extends Ye{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class en extends Ye{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class nn extends Ye{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class rn extends Ye{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class an extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class on extends Ye{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class sn extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class ln extends Ye{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class cn extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class un extends Ye{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class hn extends Ye{getDefault(){return e.aP.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class dn extends Ye{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class pn extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class mn extends Ye{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class fn extends Ye{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class gn extends Ye{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class vn extends Ye{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class yn extends Ye{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class _n extends Ye{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class xn extends Ye{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class bn extends Ye{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class An extends Ye{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class wn extends Ye{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Cn extends Ye{getDefault(){return null}set(t){var e;if(t===this.current&&!this.dirty)return;const n=this.gl;$e(n)?n.bindVertexArray(t):null===(e=n.getExtension("OES_vertex_array_object"))||void 0===e||e.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class En extends Ye{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Sn extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Mn extends Ye{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Tn extends Ye{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class In extends Tn{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Bn extends Tn{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ln extends Tn{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Dn{constructor(t,e,n,i,r){this.context=t,this.width=e,this.height=n;const a=t.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new In(t,o),i)this.depthAttachment=r?new Ln(t,o):new Bn(t,o);else if(r)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class Pn{constructor(t,e,n){this.blendFunction=t,this.blendColor=e,this.mask=n}}Pn.Replace=[1,0],Pn.disabled=new Pn(Pn.Replace,e.aP.transparent,[!1,!1,!1,!1]),Pn.unblended=new Pn(Pn.Replace,e.aP.transparent,[!0,!0,!0,!0]),Pn.alphaBlended=new Pn([1,771],e.aP.transparent,[!0,!0,!0,!0]);class Rn{constructor(t){var e,n;if(this.gl=t,this.clearColor=new Xe(this),this.clearDepth=new Qe(this),this.clearStencil=new Je(this),this.colorMask=new Ke(this),this.depthMask=new tn(this),this.stencilMask=new en(this),this.stencilFunc=new nn(this),this.stencilOp=new rn(this),this.stencilTest=new an(this),this.depthRange=new on(this),this.depthTest=new sn(this),this.depthFunc=new ln(this),this.blend=new cn(this),this.blendFunc=new un(this),this.blendColor=new hn(this),this.blendEquation=new dn(this),this.cullFace=new pn(this),this.cullFaceSide=new mn(this),this.frontFace=new fn(this),this.program=new gn(this),this.activeTexture=new vn(this),this.viewport=new yn(this),this.bindFramebuffer=new _n(this),this.bindRenderbuffer=new xn(this),this.bindTexture=new bn(this),this.bindVertexBuffer=new An(this),this.bindElementBuffer=new wn(this),this.bindVertexArray=new Cn(this),this.pixelStoreUnpack=new En(this),this.pixelStoreUnpackPremultiplyAlpha=new Sn(this),this.pixelStoreUnpackFlipY=new Mn(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),$e(t)){this.HALF_FLOAT=t.HALF_FLOAT;const i=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(e=t.RGBA16F)&&void 0!==e?e:null==i?void 0:i.RGBA16F_EXT,this.RGB16F=null!==(n=t.RGB16F)&&void 0!==n?n:null==i?void 0:i.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const e=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==e?void 0:e.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new je(this,t,e)}createVertexBuffer(t,e,n){return new qe(this,t,e,n)}createRenderbuffer(t,e,n){const i=this.gl,r=i.createRenderbuffer();return this.bindRenderbuffer.set(r),i.renderbufferStorage(i.RENDERBUFFER,t,e,n),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,n,i){return new Dn(this,t,e,n,i)}clear({color:t,depth:e,stencil:n}){const i=this.gl;let r=0;t&&(r|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==n&&(r|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){e.aE(t.blendFunction,Pn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return $e(this.gl)?this.gl.createVertexArray():null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var e;return $e(this.gl)?this.gl.deleteVertexArray(t):null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}class kn{constructor(t,e,n){this.func=t,this.mask=e,this.range=n}}kn.ReadOnly=!1,kn.ReadWrite=!0,kn.disabled=new kn(519,kn.ReadOnly,[0,1]);const zn=7680;class Fn{constructor(t,e,n,i,r,a){this.test=t,this.ref=e,this.mask=n,this.fail=i,this.depthFail=r,this.pass=a}}Fn.disabled=new Fn({func:519,mask:0},0,0,zn,zn,zn);class On{constructor(t,e,n){this.enable=t,this.mode=e,this.frontFace=n}}let Nn;function Un(t,n,i,r,a){const o=t.context,s=o.gl,l=t.useProgram("collisionBox"),c=[];let u=0,h=0;for(let p=0;p<r.length;p++){const m=r[p],f=n.getTile(m).getBucket(i);if(!f)continue;const g=a?f.textCollisionBox:f.iconCollisionBox,v=f.collisionCircleArray;if(v.length>0){const n=e.F();e.aQ(n,f.placementInvProjMatrix,t.transform.glCoordMatrix),e.aQ(n,n,f.placementViewportMatrix),c.push({circleArray:v,circleOffset:h,transform:m.posMatrix,invTransform:n,coord:m}),u+=v.length/4,h=u}g&&l.draw(o,s.LINES,kn.disabled,Fn.disabled,t.colorModeForRenderPass(),On.disabled,{u_matrix:m.posMatrix,u_pixel_extrude_scale:[1/(d=t.transform).width,1/d.height]},t.style.map.terrain&&t.style.map.terrain.getTerrainData(m),i.id,g.layoutVertexBuffer,g.indexBuffer,g.segments,null,t.transform.zoom,null,null,g.collisionVertexBuffer)}var d;if(!a||!c.length)return;const p=t.useProgram("collisionCircle"),m=new e.aR;m.resize(4*u),m._trim();let f=0;for(const t of c)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,i=t.circleArray[n+0],r=t.circleArray[n+1],a=t.circleArray[n+2],o=t.circleArray[n+3];m.emplace(f++,i,r,a,o,0),m.emplace(f++,i,r,a,o,1),m.emplace(f++,i,r,a,o,2),m.emplace(f++,i,r,a,o,3)}(!Nn||Nn.length<2*u)&&(Nn=function(t){const n=2*t,i=new e.aT;i.resize(n),i._trim();for(let t=0;t<n;t++){const e=6*t;i.uint16[e+0]=4*t+0,i.uint16[e+1]=4*t+1,i.uint16[e+2]=4*t+2,i.uint16[e+3]=4*t+2,i.uint16[e+4]=4*t+3,i.uint16[e+5]=4*t+0}return i}(u));const g=o.createIndexBuffer(Nn,!0),v=o.createVertexBuffer(m,e.aS.members,!0);for(const n of c){const r=Ee(n.transform,n.invTransform,t.transform);p.draw(o,s.TRIANGLES,kn.disabled,Fn.disabled,t.colorModeForRenderPass(),On.disabled,r,t.style.map.terrain&&t.style.map.terrain.getTerrainData(n.coord),i.id,v,g,e.$.simpleSegment(0,2*n.circleOffset,n.circleArray.length,n.circleArray.length/2),null,t.transform.zoom,null,null,null)}v.destroy(),g.destroy()}On.disabled=new On(!1,1029,2305),On.backCCW=new On(!0,1029,2305);const Vn=e.an(new Float32Array(16));function Gn(t,n,i,r,a,o){const{horizontalAlign:s,verticalAlign:l}=e.au(t);return new e.P((-(s-.5)*n/a+r[0])*o,(-(l-.5)*i/a+r[1])*o)}function Hn(t,n,i,r,a,o){const s=n.tileAnchorPoint.add(new e.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let t=r.mult(o);return i||(t=t.rotate(-a)),vt(s.add(t),n.labelPlaneMatrix,n.getElevation).point}if(i){const e=St(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(t),i=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0);return t.add(r.rotate(i))}return t.add(r)}function jn(t,n,i,r,a,o,s,l,c,u,h,d,p,m){const f=t.text.placedSymbolArray,g=t.text.dynamicLayoutVertexArray,v=t.icon.dynamicLayoutVertexArray,y={};g.clear();for(let v=0;v<f.length;v++){const _=f.get(v),x=_.hidden||!_.crossTileID||t.allowVerticalPlacement&&!_.placedOrientation?null:r[_.crossTileID];if(x){const r=new e.P(_.anchorX,_.anchorY),f={getElevation:m,width:a.width,height:a.height,labelPlaneMatrix:o,lineVertexArray:null,pitchWithMap:i,projection:h,projectionCache:null,tileAnchorPoint:r,translation:d,unwrappedTileID:p},v=i?vt(r,s,m):St(r.x,r.y,f),b=yt(a.cameraToCenterDistance,v.signedDistanceFromCamera);let A=e.ai(t.textSizeData,c,_)*b/e.ap;i&&(A*=t.tilePixelRatio/l);const{width:w,height:C,anchor:E,textOffset:S,textBoxScale:M}=x,T=Gn(E,w,C,S,M,A),I=h.getPitchedTextCorrection(a,r.add(new e.P(d[0],d[1])),p),B=Hn(v.point,f,n,T,a.angle,I),L=t.allowVerticalPlacement&&_.placedOrientation===e.ah.vertical?Math.PI/2:0;for(let t=0;t<_.numGlyphs;t++)e.aj(g,B,L);u&&_.associatedIconIndex>=0&&(y[_.associatedIconIndex]={shiftedAnchor:B,angle:L})}else Lt(_.numGlyphs,g)}if(u){v.clear();const n=t.icon.placedSymbolArray;for(let t=0;t<n.length;t++){const i=n.get(t);if(i.hidden)Lt(i.numGlyphs,v);else{const n=y[t];if(n)for(let t=0;t<i.numGlyphs;t++)e.aj(v,n.shiftedAnchor,n.angle);else Lt(i.numGlyphs,v)}}t.icon.dynamicLayoutVertexBuffer.updateData(v)}t.text.dynamicLayoutVertexBuffer.updateData(g)}function Wn(t,e,n){return n.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function qn(t,n,i,r,a,o,s,l,c,u,h,d){const p=t.context,m=p.gl,f=t.transform,g=Kt(),v="map"===l,y="map"===c,_="viewport"!==l&&"point"!==i.layout.get("symbol-placement"),x=v&&!y&&!_,b=!y&&_,A=!i.layout.get("symbol-sort-key").isConstant();let w=!1;const C=t.depthModeForSublayer(0,kn.ReadOnly),E=i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"),S=[],M=g.getCircleRadiusCorrection(f);for(const l of r){const r=n.getTile(l),c=r.getBucket(i);if(!c)continue;const h=a?c.text:c.icon;if(!h||!h.segments.get().length||!h.hasVisibleVertices)continue;const d=h.programConfigurations.get(i.id),p=a||c.sdfIcons,C=a?c.textSizeData:c.iconSizeData,T=y||0!==f.pitch,I=t.useProgram(Wn(p,a,c),d),B=e.ag(C,f.zoom),L=t.style.map.terrain&&t.style.map.terrain.getTerrainData(l);let D,P,R,k,z=[0,0],F=null;if(a)P=r.glyphAtlasTexture,R=m.LINEAR,D=r.glyphAtlasTexture.size,c.iconsInText&&(z=r.imageAtlasTexture.size,F=r.imageAtlasTexture,k=T||t.options.rotating||t.options.zooming||"composite"===C.kind||"camera"===C.kind?m.LINEAR:m.NEAREST);else{const e=1!==i.layout.get("icon-size").constantOr(0)||c.iconsNeedLinear;P=r.imageAtlasTexture,R=p||t.options.rotating||t.options.zooming||e||T?m.LINEAR:m.NEAREST,D=r.imageAtlasTexture.size}const O=Rt(r,1,t.transform.zoom),N=b?l.posMatrix:Vn,U=ft(N,y,v,t.transform,O),V=gt(N,y,v,t.transform,O),G=gt(l.posMatrix,y,v,t.transform,O),H=g.translatePosition(t.transform,r,o,s),j=E&&c.hasTextData(),W="none"!==i.layout.get("icon-text-fit")&&j&&c.hasIconData();if(_){const e=t.style.map.terrain?(e,n)=>t.style.map.terrain.getElevation(l,e,n):null,n="map"===i.layout.get("text-rotation-alignment");xt(c,l.posMatrix,t,a,U,G,y,u,n,g,l.toUnwrapped(),f.width,f.height,H,e)}const q=l.posMatrix,Z=a&&E||W,$=_||Z?Vn:U,Y=V,X=p&&0!==i.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let Q;Q=p?c.iconsInText?Ue(C.kind,B,x,y,_,Z,t,q,$,Y,H,D,z,M):Ne(C.kind,B,x,y,_,Z,t,q,$,Y,H,a,D,!0,M):Oe(C.kind,B,x,y,_,Z,t,q,$,Y,H,a,D,M);const J={program:I,buffers:h,uniformValues:Q,atlasTexture:P,atlasTextureIcon:F,atlasInterpolation:R,atlasInterpolationIcon:k,isSDF:p,hasHalo:X};if(A&&c.canOverlap){w=!0;const t=h.segments.get();for(const n of t)S.push({segments:new e.$([n]),sortKey:n.sortKey,state:J,terrainData:L})}else S.push({segments:h.segments,sortKey:0,state:J,terrainData:L})}w&&S.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of S){const n=e.state;if(p.activeTexture.set(m.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,m.CLAMP_TO_EDGE),n.atlasTextureIcon&&(p.activeTexture.set(m.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),n.isSDF){const r=n.uniformValues;n.hasHalo&&(r.u_is_halo=1,Zn(n.buffers,e.segments,i,t,n.program,C,h,d,r,e.terrainData)),r.u_is_halo=0}Zn(n.buffers,e.segments,i,t,n.program,C,h,d,n.uniformValues,e.terrainData)}}function Zn(t,e,n,i,r,a,o,s,l,c){const u=i.context;r.draw(u,u.gl.TRIANGLES,a,o,s,On.disabled,l,c,n.id,t.layoutVertexBuffer,t.indexBuffer,e,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function $n(t,e,n,i,r){if(!n||!i||!i.imageAtlas)return;const a=i.imageAtlas.patternPositions;let o=a[n.to.toString()],s=a[n.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const t=r.getPaintProperty(e);o=a[t],s=a[t]}o&&s&&t.setConstantPatternPositions(o,s)}function Yn(t,e,n,i,r,a,o){const s=t.context.gl,l="fill-pattern",c=n.paint.get(l),u=c&&c.constantOr(1),h=n.getCrossfadeParameters();let d,p,m,f,g;o?(p=u&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(p=u?"fillPattern":"fill",d=s.TRIANGLES);const v=c.constantOr(null);for(const c of i){const i=e.getTile(c);if(u&&!i.patternsLoaded())continue;const y=i.getBucket(n);if(!y)continue;const _=y.programConfigurations.get(n.id),x=t.useProgram(p,_),b=t.style.map.terrain&&t.style.map.terrain.getTerrainData(c);u&&(t.context.activeTexture.set(s.TEXTURE0),i.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),_.updatePaintBuffers(h)),$n(_,l,v,i,n);const A=b?c:null,w=t.translatePosMatrix(A?A.posMatrix:c.posMatrix,i,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(o){f=y.indexBuffer2,g=y.segments2;const e=[s.drawingBufferWidth,s.drawingBufferHeight];m="fillOutlinePattern"===p&&u?we(w,t,h,i,e):Ae(w,e)}else f=y.indexBuffer,g=y.segments,m=u?be(w,t,h,i):xe(w);x.draw(t.context,d,r,t.stencilModeForClipping(c),a,On.disabled,m,b,n.id,y.layoutVertexBuffer,f,g,n.paint,t.transform.zoom,_)}}function Xn(t,e,n,i,r,a,o){const s=t.context,l=s.gl,c="fill-extrusion-pattern",u=n.paint.get(c),h=u.constantOr(1),d=n.getCrossfadeParameters(),p=n.paint.get("fill-extrusion-opacity"),m=u.constantOr(null);for(const u of i){const i=e.getTile(u),f=i.getBucket(n);if(!f)continue;const g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(u),v=f.programConfigurations.get(n.id),y=t.useProgram(h?"fillExtrusionPattern":"fillExtrusion",v);h&&(t.context.activeTexture.set(l.TEXTURE0),i.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),v.updatePaintBuffers(d)),$n(v,c,m,i,n);const _=t.translatePosMatrix(u.posMatrix,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),x=n.paint.get("fill-extrusion-vertical-gradient"),b=h?_e(_,t,x,p,u,d,i):ye(_,t,x,p);y.draw(s,s.gl.TRIANGLES,r,a,o,On.backCCW,b,g,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,n.paint,t.transform.zoom,v,t.style.map.terrain&&f.centroidVertexBuffer)}}function Qn(t,e,n,i,r,a,o){const s=t.context,l=s.gl,c=n.fbo;if(!c)return;const u=t.useProgram("hillshade"),h=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get()),u.draw(s,l.TRIANGLES,r,a,o,On.disabled,((t,e,n,i)=>{const r=n.paint.get("hillshade-shadow-color"),a=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color");let s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);const l=!t.options.moving;return{u_matrix:i?i.posMatrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Ie(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:a,u_accent:o}})(t,n,i,h?e:null),h,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}function Jn(t,n,i,r,a,o){const s=t.context,l=s.gl,c=n.dem;if(c&&c.data){const u=c.dim,h=c.stride,d=c.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||t.getTileTexture(h),n.demTexture){const t=n.demTexture;t.update(d,{premultiply:!1}),t.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else n.demTexture=new b(s,d,l.RGBA,{premultiply:!1}),n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let p=n.fbo;if(!p){const t=new b(s,{width:u,height:u,data:null},l.RGBA);t.bind(l.LINEAR,l.CLAMP_TO_EDGE),p=n.fbo=s.createFramebuffer(u,u,!0,!1),p.colorAttachment.set(t.texture)}s.bindFramebuffer.set(p.framebuffer),s.viewport.set([0,0,u,u]),t.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,a,o,On.disabled,((t,n)=>{const i=n.stride,r=e.F();return e.aO(r,0,e.W,-e.W,0,0,1),e.H(r,r,[0,-e.W,0]),{u_matrix:r,u_image:1,u_dimension:[i,i],u_zoom:t.overscaledZ,u_unpack:n.getUnpackVector()}})(n.tileID,c),null,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function Kn(t,n,i,r,o,s){const l=r.paint.get("raster-fade-duration");if(!s&&l>0){const r=a.now(),s=(r-t.timeAdded)/l,c=n?(r-n.timeAdded)/l:-1,u=i.getSource(),h=o.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),d=!n||Math.abs(n.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),p=d&&t.refreshedUponExpiration?1:e.ac(d?s:1-c,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),n?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}const ti=new e.aP(1,0,0,1),ei=new e.aP(0,1,0,1),ni=new e.aP(0,0,1,1),ii=new e.aP(1,0,1,1),ri=new e.aP(0,1,1,1);function ai(t,e,n,i){si(t,0,e+n/2,t.transform.width,n,i)}function oi(t,e,n,i){si(t,e-n/2,0,n,t.transform.height,i)}function si(t,e,n,i,r,a){const o=t.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*t.pixelRatio,n*t.pixelRatio,i*t.pixelRatio,r*t.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function li(t,n,i){const r=t.context,a=r.gl,o=i.posMatrix,s=t.useProgram("debug"),l=kn.disabled,c=Fn.disabled,u=t.colorModeForRenderPass(),h="$debug",d=t.style.map.terrain&&t.style.map.terrain.getTerrainData(i);r.activeTexture.set(a.TEXTURE0);const p=n.getTileByID(i.key).latestRawTileData,m=Math.floor((p&&p.byteLength||0)/1024),f=n.getTile(i).tileSize,g=512/Math.min(f,512)*(i.overscaledZ/t.transform.zoom)*.5;let v=i.canonical.toString();i.overscaledZ!==i.canonical.z&&(v+=` => ${i.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const n=t.debugOverlayCanvas,i=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,n.width,n.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(n),t.debugOverlayTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}(t,`${v} ${m}kB`),s.draw(r,a.TRIANGLES,l,c,Pn.alphaBlended,On.disabled,Se(o,e.aP.transparent,g),null,h,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments),s.draw(r,a.LINE_STRIP,l,c,u,On.disabled,Se(o,e.aP.red),d,h,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments)}function ci(t,e,n){const i=t.context,r=i.gl,a=t.colorModeForRenderPass(),o=new kn(r.LEQUAL,kn.ReadWrite,t.depthRangeFor3D),s=t.useProgram("terrain"),l=e.getTerrainMesh();i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height]);for(const c of n){const n=t.renderToTexture.getTexture(c),u=e.getTerrainData(c.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.texture);const h={u_matrix:t.transform.calculatePosMatrix(c.tileID.toUnwrapped()),u_texture:0,u_ele_delta:e.getMeshFrameDelta(t.transform.zoom)};s.draw(i,r.TRIANGLES,o,Fn.disabled,a,On.backCCW,h,u,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class ui{constructor(t,n){this.context=new Rn(t),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:e.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ct.maxUnderzooming+ct.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new oe}resize(t,e,n){if(this.width=Math.floor(t*n),this.height=Math.floor(e*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style._order)this.style._layers[t].resize()}setup(){const t=this.context,n=new e.aW;n.emplaceBack(0,0),n.emplaceBack(e.W,0),n.emplaceBack(0,e.W),n.emplaceBack(e.W,e.W),this.tileExtentBuffer=t.createVertexBuffer(n,ue.members),this.tileExtentSegments=e.$.simpleSegment(0,0,4,2);const i=new e.aW;i.emplaceBack(0,0),i.emplaceBack(e.W,0),i.emplaceBack(0,e.W),i.emplaceBack(e.W,e.W),this.debugBuffer=t.createVertexBuffer(i,ue.members),this.debugSegments=e.$.simpleSegment(0,0,4,5);const r=new e.Z;r.emplaceBack(0,0,0,0),r.emplaceBack(e.W,0,e.W,0),r.emplaceBack(0,e.W,0,e.W),r.emplaceBack(e.W,e.W,e.W,e.W),this.rasterBoundsBuffer=t.createVertexBuffer(r,X.members),this.rasterBoundsSegments=e.$.simpleSegment(0,0,4,2);const a=new e.aW;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(a,ue.members),this.viewportSegments=e.$.simpleSegment(0,0,4,2);const o=new e.aX;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);const s=new e.aY;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s);const l=this.context.gl;this.stencilClearMode=new Fn({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const i=e.F();e.aO(i,0,this.width,this.height,0,0,1),e.J(i,i,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,n.TRIANGLES,kn.disabled,this.stencilClearMode,Pn.disabled,On.disabled,Me(i),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,e){if(this.currentStencilSource===t.source||!t.isTileClipped()||!e||!e.length)return;this.currentStencilSource=t.source;const n=this.context,i=n.gl;this.nextStencilID+e.length>256&&this.clearStencil(),n.setColorMode(Pn.disabled),n.setDepthMode(kn.disabled);const r=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const t of e){const e=this._tileClippingMaskIDs[t.key]=this.nextStencilID++,a=this.style.map.terrain&&this.style.map.terrain.getTerrainData(t);r.draw(n,i.TRIANGLES,kn.disabled,new Fn({func:i.ALWAYS,mask:0},e,255,i.KEEP,i.KEEP,i.REPLACE),Pn.disabled,On.disabled,Me(t.posMatrix),a,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,e=this.context.gl;return new Fn({func:e.NOTEQUAL,mask:255},t,255,e.KEEP,e.KEEP,e.REPLACE)}stencilModeForClipping(t){const e=this.context.gl;return new Fn({func:e.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,e.KEEP,e.KEEP,e.REPLACE)}stencilConfigForOverlap(t){const e=this.context.gl,n=t.sort(((t,e)=>e.overscaledZ-t.overscaledZ)),i=n[n.length-1].overscaledZ,r=n[0].overscaledZ-i+1;if(r>1){this.currentStencilSource=void 0,this.nextStencilID+r>256&&this.clearStencil();const t={};for(let n=0;n<r;n++)t[n+i]=new Fn({func:e.GEQUAL,mask:255},n+this.nextStencilID,255,e.KEEP,e.KEEP,e.REPLACE);return this.nextStencilID+=r,[t,n]}return[{[i]:Fn.disabled},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new Pn([t.CONSTANT_COLOR,t.ONE],new e.aP(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Pn.unblended:Pn.alphaBlended}depthModeForSublayer(t,e,n){if(!this.opaquePassEnabledForLayer())return kn.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new kn(n||this.context.gl.LEQUAL,e,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){this.style=t,this.options=n,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(a.now()),this.imageManager.beginFrame();const i=this.style._order,r=this.style.sourceCaches,o={},s={},l={};for(const t in r){const e=r[t];e.used&&e.prepare(this.context),o[t]=e.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),l[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<i.length;t++)if(this.style._layers[i[t]].is3D()){this.opaquePassCutoff=t;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of i){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const n=s[e.source];("custom"===e.type||n.length)&&this.renderLayer(this,r[e.source],e,n)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?e.aP.black:e.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[i[this.currentLayer]],e=r[t.source],n=o[t.source];this._renderTileClippingMasks(t,n),this.renderLayer(this,e,t,n)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){const t=this.style._layers[i[this.currentLayer]],e=r[t.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(t))continue;const n=("symbol"===t.type?l:s)[t.source];this._renderTileClippingMasks(t,o[t.source]),this.renderLayer(this,e,t,n)}if(this.options.showTileBoundaries){const t=function(t,e){let n=null;const i=Object.values(t._layers).flatMap((n=>n.source&&!n.isHidden(e)?[t.sourceCaches[n.source]]:[])),r=i.filter((t=>"vector"===t.getSource().type)),a=i.filter((t=>"vector"!==t.getSource().type)),o=t=>{(!n||n.getSource().maxzoom<t.getSource().maxzoom)&&(n=t)};return r.forEach((t=>o(t))),n||a.forEach((t=>o(t))),n}(this.style,this.transform.zoom);t&&function(t,e,n){for(let i=0;i<n.length;i++)li(t,e,n[i])}(this,t,t.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;ai(t,t.transform.height-(e.top||0),3,ti),ai(t,e.bottom||0,3,ei),oi(t,e.left||0,3,ni),oi(t,t.transform.width-(e.right||0),3,ii);const n=t.transform.centerPoint;!function(t,e,n,i){si(t,e-1,n-10,2,20,i),si(t,e-10,n-1,20,2,i)}(t,n.x,t.transform.height-n.y,ri)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,i=this.transform.modelViewProjectionMatrix;let r=this.terrainFacilitator.dirty;r||(r=t?!e.aZ(n,i):!e.a_(n,i)),r||(r=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),r&&(e.a$(n,i),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(t,n){const i=t.context,r=i.gl,a=Pn.unblended,o=new kn(r.LEQUAL,kn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.sourceCache.getRenderableTiles(),c=t.useProgram("terrainDepth");i.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:e.aP.transparent,depth:1});for(const e of l){const l=n.getTerrainData(e.tileID),u={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_ele_delta:n.getMeshFrameDelta(t.transform.zoom)};c.draw(i,r.TRIANGLES,o,Fn.disabled,a,On.backCCW,u,l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain),function(t,n){const i=t.context,r=i.gl,a=Pn.unblended,o=new kn(r.LEQUAL,kn.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.getCoordsTexture(),c=n.sourceCache.getRenderableTiles(),u=t.useProgram("terrainCoords");i.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),i.viewport.set([0,0,t.width/devicePixelRatio,t.height/devicePixelRatio]),i.clear({color:e.aP.transparent,depth:1}),n.coordsIndex=[];for(const e of c){const c=n.getTerrainData(e.tileID);i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,l.texture);const h={u_matrix:t.transform.calculatePosMatrix(e.tileID.toUnwrapped()),u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0,u_ele_delta:n.getMeshFrameDelta(t.transform.zoom)};u.draw(i,r.TRIANGLES,o,Fn.disabled,a,On.backCCW,h,c,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),n.coordsIndex.push(e.tileID.key)}i.bindFramebuffer.set(null),i.viewport.set([0,0,t.width,t.height])}(this,this.style.map.terrain))}renderLayer(t,n,i,r){if(!i.isHidden(this.transform.zoom)&&("background"===i.type||"custom"===i.type||(r||[]).length))switch(this.id=i.id,i.type){case"symbol":!function(t,n,i,r,a){if("translucent"!==t.renderPass)return;const o=Fn.disabled,s=t.colorModeForRenderPass();(i._unevaluatedLayout.hasValue("text-variable-anchor")||i._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(t,n,i,r,a,o,s,l,c){const u=n.transform,h=Kt(),d="map"===a,p="map"===o;for(const a of t){const t=r.getTile(a),o=t.getBucket(i);if(!o||!o.text||!o.text.segments.get().length)continue;const m=e.ag(o.textSizeData,u.zoom),f=Rt(t,1,n.transform.zoom),g=ft(a.posMatrix,p,d,n.transform,f),v="none"!==i.layout.get("icon-text-fit")&&o.hasIconData();if(m){const e=Math.pow(2,u.zoom-t.tileID.overscaledZ),i=n.style.map.terrain?(t,e)=>n.style.map.terrain.getElevation(a,t,e):null,r=h.translatePosition(u,t,s,l);jn(o,d,p,c,u,g,a.posMatrix,e,m,v,h,r,a.toUnwrapped(),i)}}}(r,t,i,n,i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),a),0!==i.paint.get("icon-opacity").constantOr(1)&&qn(t,n,i,r,!1,i.paint.get("icon-translate"),i.paint.get("icon-translate-anchor"),i.layout.get("icon-rotation-alignment"),i.layout.get("icon-pitch-alignment"),i.layout.get("icon-keep-upright"),o,s),0!==i.paint.get("text-opacity").constantOr(1)&&qn(t,n,i,r,!0,i.paint.get("text-translate"),i.paint.get("text-translate-anchor"),i.layout.get("text-rotation-alignment"),i.layout.get("text-pitch-alignment"),i.layout.get("text-keep-upright"),o,s),n.map.showCollisionBoxes&&(Un(t,n,i,r,!0),Un(t,n,i,r,!1))}(t,n,i,r,this.style.placement.variableOffsets);break;case"circle":!function(t,n,i,r){if("translucent"!==t.renderPass)return;const a=i.paint.get("circle-opacity"),o=i.paint.get("circle-stroke-width"),s=i.paint.get("circle-stroke-opacity"),l=!i.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const c=t.context,u=c.gl,h=t.depthModeForSublayer(0,kn.ReadOnly),d=Fn.disabled,p=t.colorModeForRenderPass(),m=[];for(let a=0;a<r.length;a++){const o=r[a],s=n.getTile(o),c=s.getBucket(i);if(!c)continue;const u=c.programConfigurations.get(i.id),h=t.useProgram("circle",u),d=c.layoutVertexBuffer,p=c.indexBuffer,f=t.style.map.terrain&&t.style.map.terrain.getTerrainData(o),g={programConfiguration:u,program:h,layoutVertexBuffer:d,indexBuffer:p,uniformValues:Ce(t,o,s,i),terrainData:f};if(l){const t=c.segments.get();for(const n of t)m.push({segments:new e.$([n]),sortKey:n.sortKey,state:g})}else m.push({segments:c.segments,sortKey:0,state:g})}l&&m.sort(((t,e)=>t.sortKey-e.sortKey));for(const e of m){const{programConfiguration:n,program:r,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l}=e.state;r.draw(c,u.TRIANGLES,h,d,p,On.disabled,s,l,i.id,a,o,e.segments,i.paint,t.transform.zoom,n)}}(t,n,i,r);break;case"heatmap":!function(t,n,i,r){if(0!==i.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const a=t.context,o=a.gl,s=Fn.disabled,l=new Pn([o.ONE,o.ONE],e.aP.transparent,[!0,!0,!0,!0]);!function(t,e,n){const i=t.gl;t.activeTexture.set(i.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=n.heatmapFbo;if(r)i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{const a=i.createTexture();i.bindTexture(i.TEXTURE_2D,a),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),r=n.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1,!1),function(t,e,n,i){var r,a;const o=t.gl,s=null!==(r=t.HALF_FLOAT)&&void 0!==r?r:o.UNSIGNED_BYTE,l=null!==(a=t.RGBA16F)&&void 0!==a?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,e.width/4,e.height/4,0,o.RGBA,s,null),i.colorAttachment.set(n)}(t,e,a,r)}}(a,t,i),a.clear({color:e.aP.transparent});for(let e=0;e<r.length;e++){const c=r[e];if(n.hasRenderableParent(c))continue;const u=n.getTile(c),h=u.getBucket(i);if(!h)continue;const d=h.programConfigurations.get(i.id),p=t.useProgram("heatmap",d),{zoom:m}=t.transform;p.draw(a,o.TRIANGLES,kn.disabled,s,l,On.disabled,Te(c.posMatrix,u,m,i.paint.get("heatmap-intensity")),null,i.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,i.paint,t.transform.zoom,d)}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,n){const i=t.context,r=i.gl,a=n.heatmapFbo;if(!a)return;i.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a.colorAttachment.get()),i.activeTexture.set(r.TEXTURE1);let o=n.colorRampTexture;o||(o=n.colorRampTexture=new b(i,n.colorRamp,r.RGBA)),o.bind(r.LINEAR,r.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(i,r.TRIANGLES,kn.disabled,Fn.disabled,t.colorModeForRenderPass(),On.disabled,((t,n,i,r)=>{const a=e.F();e.aO(a,0,t.width,t.height,0,0,1);const o=t.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:n.paint.get("heatmap-opacity")}})(t,n),null,n.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,n.paint,t.transform.zoom)}(t,i))}(t,n,i,r);break;case"line":!function(t,n,i,r){if("translucent"!==t.renderPass)return;const a=i.paint.get("line-opacity"),o=i.paint.get("line-width");if(0===a.constantOr(1)||0===o.constantOr(1))return;const s=t.depthModeForSublayer(0,kn.ReadOnly),l=t.colorModeForRenderPass(),c=i.paint.get("line-dasharray"),u=i.paint.get("line-pattern"),h=u.constantOr(1),d=i.paint.get("line-gradient"),p=i.getCrossfadeParameters(),m=h?"linePattern":c?"lineSDF":d?"lineGradient":"line",f=t.context,g=f.gl;let v=!0;for(const a of r){const r=n.getTile(a);if(h&&!r.patternsLoaded())continue;const o=r.getBucket(i);if(!o)continue;const y=o.programConfigurations.get(i.id),_=t.context.program.get(),x=t.useProgram(m,y),A=v||x.program!==_,w=t.style.map.terrain&&t.style.map.terrain.getTerrainData(a),C=u.constantOr(null);if(C&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[C.to.toString()],n=t.patternPositions[C.from.toString()];e&&n&&y.setConstantPatternPositions(e,n)}const E=w?a:null,S=h?De(t,r,i,p,E):c?Pe(t,r,i,c,p,E):d?Le(t,r,i,o.lineClipsArray.length,E):Be(t,r,i,E);if(h)f.activeTexture.set(g.TEXTURE0),r.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),y.updatePaintBuffers(p);else if(c&&(A||t.lineAtlas.dirty))f.activeTexture.set(g.TEXTURE0),t.lineAtlas.bind(f);else if(d){const r=o.gradients[i.id];let s=r.texture;if(i.gradientVersion!==r.version){let l=256;if(i.stepInterpolant){const i=n.getSource().maxzoom,r=a.canonical.z===i?Math.ceil(1<<t.transform.maxZoom-a.canonical.z):1;l=e.ac(e.aU(o.maxLineLength/e.W*1024*r),256,f.maxTextureSize)}r.gradient=e.aV({expression:i.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:r.gradient||void 0,clips:o.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new b(f,r.gradient,g.RGBA),r.version=i.gradientVersion,s=r.texture}f.activeTexture.set(g.TEXTURE0),s.bind(i.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}x.draw(f,g.TRIANGLES,s,t.stencilModeForClipping(a),l,On.disabled,S,w,i.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,i.paint,t.transform.zoom,y,o.layoutVertexBuffer2),v=!1}}(t,n,i,r);break;case"fill":!function(t,n,i,r){const a=i.paint.get("fill-color"),o=i.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=t.colorModeForRenderPass(),l=i.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(e.aP.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const e=t.depthModeForSublayer(1,"opaque"===t.renderPass?kn.ReadWrite:kn.ReadOnly);Yn(t,n,i,r,e,s,!1)}if("translucent"===t.renderPass&&i.paint.get("fill-antialias")){const e=t.depthModeForSublayer(i.getPaintProperty("fill-outline-color")?2:0,kn.ReadOnly);Yn(t,n,i,r,e,s,!0)}}(t,n,i,r);break;case"fill-extrusion":!function(t,e,n,i){const r=n.paint.get("fill-extrusion-opacity");if(0!==r&&"translucent"===t.renderPass){const a=new kn(t.context.gl.LEQUAL,kn.ReadWrite,t.depthRangeFor3D);if(1!==r||n.paint.get("fill-extrusion-pattern").constantOr(1))Xn(t,e,n,i,a,Fn.disabled,Pn.disabled),Xn(t,e,n,i,a,t.stencilModeFor3D(),t.colorModeForRenderPass());else{const r=t.colorModeForRenderPass();Xn(t,e,n,i,a,Fn.disabled,r)}}}(t,n,i,r);break;case"hillshade":!function(t,e,n,i){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const r=t.context,a=t.depthModeForSublayer(0,kn.ReadOnly),o=t.colorModeForRenderPass(),[s,l]="translucent"===t.renderPass?t.stencilConfigForOverlap(i):[{},i];for(const i of l){const r=e.getTile(i);void 0!==r.needsHillshadePrepare&&r.needsHillshadePrepare&&"offscreen"===t.renderPass?Jn(t,r,n,a,Fn.disabled,o):"translucent"===t.renderPass&&Qn(t,i,r,n,a,s[i.overscaledZ],o)}r.viewport.set([0,0,t.width,t.height])}(t,n,i,r);break;case"raster":!function(t,e,n,i){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!i.length)return;const r=t.context,a=r.gl,o=e.getSource(),s=t.useProgram("raster"),l=t.colorModeForRenderPass(),[c,u]=o instanceof Q?[{},i]:t.stencilConfigForOverlap(i),h=u[u.length-1].overscaledZ,d=!t.options.moving;for(const i of u){const u=t.depthModeForSublayer(i.overscaledZ-h,1===n.paint.get("raster-opacity")?kn.ReadWrite:kn.ReadOnly,a.LESS),p=e.getTile(i);p.registerFadeDuration(n.paint.get("raster-fade-duration"));const m=e.findLoadedParent(i,0),f=e.findLoadedSibling(i),g=Kn(p,m||f||null,e,n,t.transform,t.style.map.terrain);let v,y;const _="nearest"===n.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;r.activeTexture.set(a.TEXTURE0),p.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),r.activeTexture.set(a.TEXTURE1),m?(m.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),v=Math.pow(2,m.tileID.overscaledZ-p.tileID.overscaledZ),y=[p.tileID.canonical.x*v%1,p.tileID.canonical.y*v%1]):p.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);const x=t.style.map.terrain&&t.style.map.terrain.getTerrainData(i),b=x?i:null,A=b?b.posMatrix:t.transform.calculatePosMatrix(i.toUnwrapped(),d),w=ze(A,y||[0,0],v||1,g,n);o instanceof Q?s.draw(r,a.TRIANGLES,u,Fn.disabled,l,On.disabled,w,x,n.id,o.boundsBuffer,t.quadTriangleIndexBuffer,o.boundsSegments):s.draw(r,a.TRIANGLES,u,c[i.overscaledZ],l,On.disabled,w,x,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}(t,n,i,r);break;case"background":!function(t,e,n,i){const r=n.paint.get("background-color"),a=n.paint.get("background-opacity");if(0===a)return;const o=t.context,s=o.gl,l=t.transform,c=l.tileSize,u=n.paint.get("background-pattern");if(t.isPatternMissing(u))return;const h=!u&&1===r.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==h)return;const d=Fn.disabled,p=t.depthModeForSublayer(0,"opaque"===h?kn.ReadWrite:kn.ReadOnly),m=t.colorModeForRenderPass(),f=t.useProgram(u?"backgroundPattern":"background"),g=i||l.coveringTiles({tileSize:c,terrain:t.style.map.terrain});u&&(o.activeTexture.set(s.TEXTURE0),t.imageManager.bind(t.context));const v=n.getCrossfadeParameters();for(const e of g){const l=i?e.posMatrix:t.transform.calculatePosMatrix(e.toUnwrapped()),h=u?Ge(l,a,t,u,{tileID:e,tileSize:c},v):Ve(l,a,r),g=t.style.map.terrain&&t.style.map.terrain.getTerrainData(e);f.draw(o,s.TRIANGLES,p,d,m,On.disabled,h,g,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}(t,0,i,r);break;case"custom":!function(t,e,n){const i=t.context,r=n.implementation;if("offscreen"===t.renderPass){const e=r.prerender;e&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),e.call(r,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(Fn.disabled);const e="3d"===r.renderingMode?new kn(t.context.gl.LEQUAL,kn.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,kn.ReadOnly);i.setDepthMode(e),r.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}(t,0,i)}}translatePosMatrix(t,n,i,r,a){if(!i[0]&&!i[1])return t;const o=a?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(o){const t=Math.sin(o),e=Math.cos(o);i=[i[0]*e-i[1]*t,i[0]*t+i[1]*e]}const s=[a?i[0]:Rt(n,i[0],this.transform.zoom),a?i[1]:Rt(n,i[1],this.transform.zoom),0],l=new Float32Array(16);return e.H(l,t,s),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),n=this.imageManager.getPattern(t.to.toString());return!e||!n}useProgram(t,e){this.cache=this.cache||{};const n=t+(e?e.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new ge(this.context,de[t],e,He[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new b(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:e}=this.context.gl;return this.width!==t||this.height!==e}}class hi{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(t,n,i){const r=Math.pow(2,i),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((i=>{const a=1/(i=e.af([],i,t))[3]/n*r;return e.b0(i,i,[a,a,1/i[3],a])})),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((t=>{const e=function(t,e){var n=e[0],i=e[1],r=e[2],a=n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}([],function(t,e,n){var i=e[0],r=e[1],a=e[2],o=n[0],s=n[1],l=n[2];return t[0]=r*l-a*s,t[1]=a*o-i*l,t[2]=i*s-r*o,t}([],v([],a[t[0]],a[t[1]]),v([],a[t[2]],a[t[1]]))),n=-((i=e)[0]*(r=a[t[1]])[0]+i[1]*r[1]+i[2]*r[2]);var i,r;return e.concat(n)}));return new hi(a,o)}}class di{constructor(t,e){this.min=t,this.max=e,this.center=function(t,e,n){return t[0]=.5*e[0],t[1]=.5*e[1],t[2]=.5*e[2],t}([],function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}([],this.min,this.max))}quadrant(t){const e=[t%2==0,t<2],n=f(this.min),i=f(this.max);for(let t=0;t<e.length;t++)n[t]=e[t]?this.min[t]:this.center[t],i[t]=e[t]?this.center[t]:this.max[t];return i[2]=this.max[2],new di(n,i)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let i=!0;for(let r=0;r<t.planes.length;r++){const a=t.planes[r];let o=0;for(let t=0;t<n.length;t++)e.b1(a,n[t])>=0&&o++;if(0===o)return 0;o!==n.length&&(i=!1)}if(i)return 2;for(let e=0;e<3;e++){let n=Number.MAX_VALUE,i=-Number.MAX_VALUE;for(let r=0;r<t.points.length;r++){const a=t.points[r][e]-this.min[e];n=Math.min(n,a),i=Math.max(i,a)}if(i<0||n>this.max[e]-this.min[e])return 0}return 1}}class pi{constructor(t=0,e=0,n=0,i=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=n,this.right=i}interpolate(t,n,i){return null!=n.top&&null!=t.top&&(this.top=e.z.number(t.top,n.top,i)),null!=n.bottom&&null!=t.bottom&&(this.bottom=e.z.number(t.bottom,n.bottom,i)),null!=n.left&&null!=t.left&&(this.left=e.z.number(t.left,n.left,i)),null!=n.right&&null!=t.right&&(this.right=e.z.number(t.right,n.right,i)),this}getCenter(t,n){const i=e.ac((this.left+t-this.right)/2,0,t),r=e.ac((this.top+n-this.bottom)/2,0,n);return new e.P(i,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new pi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const mi=85.051129;class fi{constructor(t,n,i,r,a){this.tileSize=512,this._renderWorldCopies=void 0===a||!!a,this._minZoom=t||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new pi,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const t=new fi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.minElevationForCurrentTile=t.minElevationForCurrentTile,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const n=-e.b2(t,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=function(){var t=new e.A(4);return e.A!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}(),function(t,e,n){var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(n),l=Math.cos(n);t[0]=i*l+a*s,t[1]=r*l+o*s,t[2]=i*-s+a*l,t[3]=r*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const n=e.ac(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._zoom=e,this.tileZoom=Math.max(0,Math.floor(e)),this.scale=this.zoomScale(e),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,n){this._unmodified=!1,this._edgeInsets.interpolate(t,e,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(t){const n=[new e.b3(0,t)];if(this._renderWorldCopies){const i=this.pointCoordinate(new e.P(0,0)),r=this.pointCoordinate(new e.P(this.width,0)),a=this.pointCoordinate(new e.P(this.width,this.height)),o=this.pointCoordinate(new e.P(0,this.height)),s=Math.floor(Math.min(i.x,r.x,a.x,o.x)),l=Math.floor(Math.max(i.x,r.x,a.x,o.x)),c=1;for(let i=s-c;i<=l+c;i++)0!==i&&n.push(new e.b3(i,t))}return n}coveringTiles(t){var n,i;let r=this.coveringZoomLevel(t);const a=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const o=this.pointCoordinate(this.getCameraPoint()),s=e.Y.fromLngLat(this.center),l=Math.pow(2,r),c=[l*o.x,l*o.y,0],u=[l*s.x,l*s.y,0],h=hi.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,r);let d=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=r);const p=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,m=t=>({aabb:new di([t*l,0,0],[(t+1)*l,l,0]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),f=[],g=[],v=r,_=t.reparseOverscaled?a:r;if(this._renderWorldCopies)for(let t=1;t<=3;t++)f.push(m(-t)),f.push(m(t));for(f.push(m(0));f.length>0;){const r=f.pop(),a=r.x,o=r.y;let s=r.fullyVisible;if(!s){const t=r.aabb.intersects(h);if(0===t)continue;s=2===t}const l=t.terrain?c:u,m=r.aabb.distanceX(l),x=r.aabb.distanceY(l),b=Math.max(Math.abs(m),Math.abs(x));if(r.zoom===v||b>p+(1<<v-r.zoom)-2&&r.zoom>=d){const t=v-r.zoom,n=c[0]-.5-(a<<t),i=c[1]-.5-(o<<t);g.push({tileID:new e.Q(r.zoom===v?_:r.zoom,r.wrap,r.zoom,a,o),distanceSq:y([u[0]-.5-a,u[1]-.5-o]),tileDistanceToCamera:Math.sqrt(n*n+i*i)})}else for(let l=0;l<4;l++){const c=(a<<1)+l%2,u=(o<<1)+(l>>1),h=r.zoom+1;let d=r.aabb.quadrant(l);if(t.terrain){const a=new e.Q(h,r.wrap,h,c,u),o=t.terrain.getMinMaxElevation(a),s=null!==(n=o.minElevation)&&void 0!==n?n:this.elevation,l=null!==(i=o.maxElevation)&&void 0!==i?i:this.elevation;d=new di([d.min[0],d.min[1],s],[d.max[0],d.max[1],l])}f.push({aabb:d,zoom:h,x:c,y:u,wrap:r.wrap,fullyVisible:s})}}return g.sort(((t,e)=>t.distanceSq-e.distanceSq)).map((t=>t.tileID))}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const n=e.ac(t.lat,-85.051129,mi);return new e.P(e.N(t.lng)*this.worldSize,e.O(n)*this.worldSize)}unproject(t){return new e.Y(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const n=this.elevation,i=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,r=this.pointLocation(this.centerPoint,t),a=t.getElevationForLngLatZoom(r,this.tileZoom);if(!(this.elevation-a))return;const o=i+n-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/e.b4(1,r.lat),l=this.scaleZoom(s/this.tileSize);this._elevation=a,this._center=r,this.zoom=l}setLocationAtPoint(t,n){const i=this.pointCoordinate(n),r=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(t),o=new e.Y(a.x-(i.x-r.x),a.y-(i.y-r.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,e){return e?this.coordinatePoint(this.locationCoordinate(t),e.getElevationForLngLatZoom(t,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,e){return this.coordinateLocation(this.pointCoordinate(t,e))}locationCoordinate(t){return e.Y.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,n){if(n){const e=n.pointCoordinate(t);if(null!=e)return e}const i=[t.x,t.y,0,1],r=[t.x,t.y,1,1];e.af(i,i,this.pixelMatrixInverse),e.af(r,r,this.pixelMatrixInverse);const a=i[3],o=r[3],s=i[1]/a,l=r[1]/o,c=i[2]/a,u=r[2]/o,h=c===u?0:(0-c)/(u-c);return new e.Y(e.z.number(i[0]/a,r[0]/o,h)/this.worldSize,e.z.number(s,l,h)/this.worldSize)}coordinatePoint(t,n=0,i=this.pixelMatrix){const r=[t.x*this.worldSize,t.y*this.worldSize,n,1];return e.af(r,r,i),new e.P(r[0]/r[3],r[1]/r[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return(new j).extend(this.pointLocation(new e.P(0,t))).extend(this.pointLocation(new e.P(this.width,t))).extend(this.pointLocation(new e.P(this.width,this.height))).extend(this.pointLocation(new e.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new j([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,mi])}calculatePosMatrix(t,n=!1){const i=t.key,r=n?this._alignedPosMatrixCache:this._posMatrixCache;if(r[i])return r[i];const a=t.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*t.wrap,l=e.an(new Float64Array(16));return e.H(l,l,[s*o,a.y*o,0]),e.J(l,l,[o/e.W,o/e.W,1]),e.K(l,n?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,l),r[i]=new Float32Array(l),r[i]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(t,n){n=e.ac(+n,this.minZoom,this.maxZoom);const i={center:new e.M(t.lng,t.lat),zoom:n};let r=this.lngRange;if(!this._renderWorldCopies&&null===r){const t=180-1e-10;r=[-t,t]}const a=this.tileSize*this.zoomScale(i.zoom);let o=0,s=a,l=0,c=a,u=0,h=0;const{x:d,y:p}=this.size;if(this.latRange){const t=this.latRange;o=e.O(t[1])*a,s=e.O(t[0])*a,s-o<p&&(u=p/(s-o))}r&&(l=e.b2(e.N(r[0])*a,0,a),c=e.b2(e.N(r[1])*a,0,a),c<l&&(c+=a),c-l<d&&(h=d/(c-l)));const{x:m,y:f}=this.project.call({worldSize:a},t);let g,v;const y=Math.max(h||0,u||0);if(y){const t=new e.P(h?(c+l)/2:m,u?(s+o)/2:f);return i.center=this.unproject.call({worldSize:a},t).wrap(),i.zoom+=this.scaleZoom(y),i}if(this.latRange){const t=p/2;f-t<o&&(v=o+t),f+t>s&&(v=s-t)}if(r){const t=(l+c)/2;let n=m;this._renderWorldCopies&&(n=e.b2(m,t-a/2,t+a/2));const i=d/2;n-i<l&&(g=l+i),n+i>c&&(g=c-i)}if(void 0!==g||void 0!==v){const t=new e.P(null!=g?g:m,null!=v?v:f);i.center=this.unproject.call({worldSize:a},t).wrap()}return i}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:e,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=e,this.zoom=n,this._unmodified=t,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,n=this.point.x,i=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=e.b4(1,this.center.lat)*this.worldSize;let r=e.an(new Float64Array(16));e.J(r,r,[this.width/2,-this.height/2,1]),e.H(r,r,[1,-1,0]),this.labelPlaneMatrix=r,r=e.an(new Float64Array(16)),e.J(r,r,[1,-1,1]),e.H(r,r,[-1,-1,0]),e.J(r,r,[2/this.width,2/this.height,1]),this.glCoordMatrix=r;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),o=Math.min(this.elevation,this.minElevationForCurrentTile),s=a-o*this._pixelPerMeter/Math.cos(this._pitch),l=o<0?s:a,c=Math.PI/2+this._pitch,u=this._fov*(.5+t.y/this.height),h=Math.sin(u)*l/Math.sin(e.ac(Math.PI-c-u,.01,Math.PI-.01)),d=this.getHorizon(),p=2*Math.atan(d/this.cameraToCenterDistance)*(.5+t.y/(2*d)),m=Math.sin(p)*l/Math.sin(e.ac(Math.PI-c-p,.01,Math.PI-.01)),f=Math.min(h,m),g=1.01*(Math.cos(Math.PI/2-this._pitch)*f+l),v=this.height/50;r=new Float64Array(16),e.b5(r,this._fov,this.width/this.height,v,g),r[8]=2*-t.x/this.width,r[9]=2*t.y/this.height,e.J(r,r,[1,-1,1]),e.H(r,r,[0,0,-this.cameraToCenterDistance]),e.b6(r,r,this._pitch),e.ad(r,r,this.angle),e.H(r,r,[-n,-i,0]),this.mercatorMatrix=e.J([],r,[this.worldSize,this.worldSize,this.worldSize]),e.J(r,r,[1,1,this._pixelPerMeter]),this.pixelMatrix=e.K(new Float64Array(16),this.labelPlaneMatrix,r),e.H(r,r,[0,0,-this.elevation]),this.modelViewProjectionMatrix=r,this.invModelViewProjectionMatrix=e.as([],r),this.pixelMatrix3D=e.K(new Float64Array(16),this.labelPlaneMatrix,r);const y=this.width%2/2,_=this.height%2/2,x=Math.cos(this.angle),b=Math.sin(this.angle),A=n-Math.round(n)+x*y+b*_,w=i-Math.round(i)+x*_+b*y,C=new Float64Array(r);if(e.H(C,C,[A>.5?A-1:A,w>.5?w-1:w,0]),this.alignedModelViewProjectionMatrix=C,r=e.as(new Float64Array(16),this.pixelMatrix),!r)throw new Error("failed to invert matrix");this.pixelMatrixInverse=r,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new e.P(0,0)),n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return e.af(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.P(0,t))}getCameraQueryGeometry(t){const n=this.getCameraPoint();if(1===t.length)return[t[0],n];{let i=n.x,r=n.y,a=n.x,o=n.y;for(const e of t)i=Math.min(i,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y);return[new e.P(i,r),new e.P(a,r),new e.P(a,o),new e.P(i,o),new e.P(i,r)]}}lngLatToCameraDepth(t,n){const i=this.locationCoordinate(t),r=[i.x*this.worldSize,i.y*this.worldSize,n,1];return e.af(r,r,this.modelViewProjectionMatrix),r[2]/r[3]}}function gi(t,e){let n,i=!1,r=null,a=null;const o=()=>{r=null,i&&(t.apply(a,n),r=setTimeout(o,e),i=!1)};return(...t)=>(i=!0,a=this,n=t,r||o(),r)}class vi{constructor(t){this._getCurrentHash=()=>{const t=window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((t=>t.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{const t=this._getCurrentHash();if(t.length>=3&&!t.some((t=>isNaN(t)))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch(t){}},this._updateHash=gi(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const e=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),r=Math.pow(10,i),a=Math.round(e.lng*r)/r,o=Math.round(e.lat*r)/r,s=this._map.getBearing(),l=this._map.getPitch();let c="";if(c+=t?`/${a}/${o}/${n}`:`${n}/${o}/${a}`,(s||l)&&(c+="/"+Math.round(10*s)/10),l&&(c+=`/${Math.round(l)}`),this._hashName){const t=this._hashName;let e=!1;const n=window.location.hash.slice(1).split("&").map((n=>{const i=n.split("=")[0];return i===t?(e=!0,`${i}=${c}`):n})).filter((t=>t));return e||n.push(`${t}=${c}`),`#${n.join("&")}`}return`#${c}`}}const yi={linearity:.3,easing:e.b7(0,0,.3,1)},_i=e.e({deceleration:2500,maxSpeed:1400},yi),xi=e.e({deceleration:20,maxSpeed:1400},yi),bi=e.e({deceleration:1e3,maxSpeed:360},yi),Ai=e.e({deceleration:1e3,maxSpeed:90},yi);class wi{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,e=a.now();for(;t.length>0&&e-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new e.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(n.pan.mag()){const a=Ei(n.pan.mag(),i,e.e({},_i,t||{}));r.offset=n.pan.mult(a.amount/n.pan.mag()),r.center=this._map.transform.center,Ci(r,a)}if(n.zoom){const t=Ei(n.zoom,i,xi);r.zoom=this._map.transform.zoom+t.amount,Ci(r,t)}if(n.bearing){const t=Ei(n.bearing,i,bi);r.bearing=this._map.transform.bearing+e.ac(t.amount,-179,179),Ci(r,t)}if(n.pitch){const t=Ei(n.pitch,i,Ai);r.pitch=this._map.transform.pitch+t.amount,Ci(r,t)}if(r.zoom||r.bearing){const t=void 0===n.pinchAround?n.around:n.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),e.e(r,{noMoveStart:!0})}}function Ci(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Ei(t,n,i){const{maxSpeed:r,linearity:a,deceleration:o}=i,s=e.ac(t*a/(n/1e3),-r,r),l=Math.abs(s)/(o*a);return{easing:i.easing,duration:1e3*l,amount:s*(l/2)}}class Si extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i,r={}){const a=o.mousePos(n.getCanvas(),i),s=n.unproject(a);super(t,e.e({point:a,lngLat:s,originalEvent:i},r)),this._defaultPrevented=!1,this.target=n}}class Mi extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,i){const r="touchend"===t?i.changedTouches:i.touches,a=o.touchPos(n.getCanvasContainer(),r),s=a.map((t=>n.unproject(t))),l=a.reduce(((t,e,n,i)=>t.add(e.div(i.length))),new e.P(0,0));super(t,{points:a,point:l,lngLats:s,lngLat:n.unproject(l),originalEvent:i}),this._defaultPrevented=!1}}class Ti extends e.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,n){super(t,{originalEvent:n}),this._defaultPrevented=!1}}class Ii{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ti(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Si(t.type,this._map,t))}mouseup(t){this._map.fire(new Si(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Si(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Si(t.type,this._map,t))}mouseover(t){this._map.fire(new Si(t.type,this._map,t))}mouseout(t){this._map.fire(new Si(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Mi(t.type,this._map,t))}touchmove(t){this._map.fire(new Mi(t.type,this._map,t))}touchend(t){this._map.fire(new Mi(t.type,this._map,t))}touchcancel(t){this._map.fire(new Mi(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bi{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Si(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Si("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Si(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Li{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(e.P.convert(t),this._map.terrain)}}class Di{constructor(t,e){this._map=t,this._tr=new Li(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const n=e;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const i=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(i.x,n.x),a=Math.max(i.x,n.x),s=Math.min(i.y,n.y),l=Math.max(i.y,n.y);o.setTransform(this._box,`translate(${r}px,${s}px)`),this._box.style.width=a-r+"px",this._box.style.height=l-s+"px"}mouseupWindow(t,n){if(!this._active)return;if(0!==t.button)return;const i=this._startPos,r=n;if(this.reset(),o.suppressClick(),i.x!==r.x||i.y!==r.y)return this._map.fire(new e.k("boxzoomend",{originalEvent:t})),{cameraAnimation:t=>t.fitScreenCoordinates(i,r,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new e.k(t,{originalEvent:n}))}}function Pi(t,e){if(t.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${t.length}, points ${e.length}`);const n={};for(let i=0;i<t.length;i++)n[t[i].identifier]=e[i];return n}class Ri{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,n,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),i.length===this.numTouches&&(this.centroid=function(t){const n=new e.P(0,0);for(const e of t)n._add(e);return n.div(t.length)}(n),this.touches=Pi(i,n)))}touchmove(t,e,n){if(this.aborted||!this.centroid)return;const i=Pi(n,e);for(const t in this.touches){const e=i[t];(!e||e.dist(this.touches[t])>30)&&(this.aborted=!0)}}touchend(t,e,n){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class ki{constructor(t){this.singleTap=new Ri(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,n){this.singleTap.touchstart(t,e,n)}touchmove(t,e,n){this.singleTap.touchmove(t,e,n)}touchend(t,e,n){const i=this.singleTap.touchend(t,e,n);if(i){const e=t.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(i)<30;if(e&&n||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=i,this.count===this.numTaps)return this.reset(),i}}}class zi{constructor(t){this._tr=new Li(t),this._zoomIn=new ki({numTouches:1,numTaps:2}),this._zoomOut=new ki({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,n){this._zoomIn.touchstart(t,e,n),this._zoomOut.touchstart(t,e,n)}touchmove(t,e,n){this._zoomIn.touchmove(t,e,n),this._zoomOut.touchmove(t,e,n)}touchend(t,e,n){const i=this._zoomIn.touchend(t,e,n),r=this._zoomOut.touchend(t,e,n),a=this._tr;return i?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(i)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fi{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const e=this._moveFunction(...t);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(t,e){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=e.length?e[0]:e,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,e){if(!this.isEnabled())return;const n=this._lastPoint;if(!n)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const i=e.length?e[0]:e;return!this._moved&&i.dist(n)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=i,this._move(n,i))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&o.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Oi={0:1,2:2};class Ni{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const e=o.mouseButton(t);this._eventButton=e}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(t,e){const n=Oi[e];return void 0===t.buttons||(t.buttons&n)!==n}(t,this._eventButton)}isValidEndEvent(t){return o.mouseButton(t)===this._eventButton}}class Ui{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return 1===t.targetTouches.length}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const Vi=t=>{t.mousedown=t.dragStart,t.mousemoveWindow=t.dragMove,t.mouseup=t.dragEnd,t.contextmenu=t=>{t.preventDefault()}},Gi=({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:n=.8})=>{const i=new Ni({checkCorrectEvent:t=>0===o.mouseButton(t)&&t.ctrlKey||2===o.mouseButton(t)});return new Fi({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*n}),moveStateManager:i,enable:t,assignEvents:Vi})},Hi=({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:n=-.5})=>{const i=new Ni({checkCorrectEvent:t=>0===o.mouseButton(t)&&t.ctrlKey||2===o.mouseButton(t)});return new Fi({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*n}),moveStateManager:i,enable:t,assignEvents:Vi})};class ji{constructor(t,e){this._clickTolerance=t.clickTolerance||1,this._map=e,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new e.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(t,e,n){return this._calculateTransform(t,e,n)}touchmove(t,e,n){if(this._active&&!(n.length<this.minTouchs()))return t.preventDefault(),this._calculateTransform(t,e,n)}touchend(t,e,n){this._calculateTransform(t,e,n),this._active&&n.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,i){i.length>0&&(this._active=!0);const r=Pi(i,n),a=new e.P(0,0),o=new e.P(0,0);let s=0;for(const t in r){const e=r[t],n=this._touches[t];n&&(a._add(e),o._add(e.sub(n)),s++,r[t]=e)}if(this._touches=r,s<this.minTouchs()||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,e,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,n){if(!this._firstTwoTouches)return;t.preventDefault();const[i,r]=this._firstTwoTouches,a=qi(n,e,i),o=qi(n,e,r);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,t)}touchend(t,e,n){if(!this._firstTwoTouches)return;const[i,r]=this._firstTwoTouches,a=qi(n,e,i),s=qi(n,e,r);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function qi(t,e,n){for(let i=0;i<t.length;i++)if(t[i].identifier===n)return e[i]}function Zi(t,e){return Math.log(t/e)/Math.LN2}class $i extends Wi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const n=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Zi(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zi(this._distance,n),pinchAround:e}}}function Yi(t,e){return 180*t.angleWith(e)/Math.PI}class Xi extends Wi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e,n){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Yi(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,n=Yi(t,this._startVector);return Math.abs(n)<e}}function Qi(t){return Math.abs(t.y)>Math.abs(t.x)}class Ji extends Wi{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,e,n){super.touchstart(t,e,n),this._currentTouchCount=n.length}_start(t){this._lastPoints=t,Qi(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const i=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(i,r,n.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(i.y+r.y)/2*-.5}):void 0}gestureBeginsVertically(t,e,n){if(void 0!==this._valid)return this._valid;const i=t.mag()>=2,r=e.mag()>=2;if(!i&&!r)return;if(!i||!r)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const a=t.y>0==e.y>0;return Qi(t)&&Qi(e)&&a}}const Ki={panStep:100,bearingStep:15,pitchStep:10};class tr{constructor(t){this._tr=new Li(t);const e=Ki;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,n=0,i=0,r=0,a=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?n=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?n=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?i=1:(t.preventDefault(),a=-1);break;case 40:t.shiftKey?i=-1:(t.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:er,zoom:e?Math.round(s.zoom)+e*(t.shiftKey?2:1):s.zoom,bearing:s.bearing+n*this._bearingStep,pitch:s.pitch+i*this._pitchStep,offset:[-r*this._panStep,-a*this._panStep],center:s.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function er(t){return t*(2-t)}const nr=4.000244140625;class ir{constructor(t,e){this._onTimeout=t=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)},this._map=t,this._tr=new Li(t),this._triggerRenderFrame=e,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map.cooperativeGestures.isEnabled()&&!t[this._map.cooperativeGestures._bypassKey])return;let e=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=a.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==e&&e%nr==0?this._type="wheel":0!==e&&Math.abs(e)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=e,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*e)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,e+=this._lastValue)),t.shiftKey&&e&&(e/=4),this._type&&(this._lastWheelEvent=t,this._delta-=e,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=o.mousePos(this._map.getCanvas(),t),i=this._tr;this._around=n.y>i.transform.height/2-i.transform.getHorizon()?e.M.convert(this._aroundCenter?i.center:i.unproject(n)):e.M.convert(i.center),this._aroundPoint=i.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._tr.transform;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>nr?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);const i="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(i*n))),"wheel"===this._type&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:t.zoom,i=this._startZoom,r=this._easing;let o,s=!1;if("wheel"===this._type&&i&&r){const t=Math.min((a.now()-this._lastWheelEventTime)/200,1),l=r(t);o=e.z.number(i,n,l),t<1?this._frameId||(this._frameId=!0):s=!0}else o=n,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:o-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=e.b8;if(this._prevEase){const t=this._prevEase,i=(a.now()-t.start)/t.duration,r=t.easing(i+.01)-t.easing(i),o=.27/Math.sqrt(r*r+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=e.b7(o,s,.25,1)}return this._prevEase={start:a.now(),duration:t,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class rr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ar{constructor(t){this._tr=new Li(t),this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class or{constructor(){this._tap=new ki({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,e,n){if(!this._swipePoint)if(this._tapTime){const i=e[0],r=t.timeStamp-this._tapTime<500,a=this._tapPoint.dist(i)<30;r&&a?n.length>0&&(this._swipePoint=i,this._swipeTouch=n[0].identifier):this.reset()}else this._tap.touchstart(t,e,n)}touchmove(t,e,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const i=e[0],r=i.y-this._swipePoint.y;return this._swipePoint=i,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,n)}touchend(t,e,n){if(this._tapTime)this._swipePoint&&0===n.length&&this.reset();else{const i=this._tap.touchend(t,e,n);i&&(this._tapTime=t.timeStamp,this._tapPoint=i)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sr{constructor(t,e,n){this._el=t,this._mousePan=e,this._touchPan=n}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lr{constructor(t,e,n){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cr{constructor(t,e,n,i){this._el=t,this._touchZoom=e,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ur{constructor(t,e){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=t,this._options=e,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=o.create("div","maplibregl-cooperative-gesture-screen",t);let e=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(e=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),i=document.createElement("div");i.className="maplibregl-desktop-message",i.textContent=e,this._container.appendChild(i);const r=document.createElement("div");r.className="maplibregl-mobile-message",r.textContent=n,this._container.appendChild(r),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(o.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(t){this._onCooperativeGesture(1===t.touches.length)}wheel(t){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!t[this._bypassKey])}_onCooperativeGesture(t){this._enabled&&t&&(this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const hr=t=>t.zoom||t.drag||t.pitch||t.rotate;class dr extends e.k{}function pr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class mr{constructor(t,e){this.handleWindowEvent=t=>{this.handleEvent(t,`${t.type}Window`)},this.handleEvent=(t,e)=>{if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===t.type?void 0:t,i={needsRenderFrame:!1},r={},a={},s=t.touches,l=s?this._getMapTouches(s):void 0,c=l?o.touchPos(this._map.getCanvas(),l):o.mousePos(this._map.getCanvas(),t);for(const{handlerName:o,handler:s,allowed:u}of this._handlers){if(!s.isEnabled())continue;let h;this._blockedByActive(a,u,o)?s.reset():s[e||t.type]&&(h=s[e||t.type](t,c,l),this.mergeHandlerResult(i,r,h,o,n),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||s.isActive())&&(a[o]=s)}const u={};for(const t in this._previousActiveHandlers)a[t]||(u[t]=n);this._previousActiveHandlers=a,(Object.keys(u).length||pr(i))&&(this._changes.push([i,r,u]),this._triggerRenderFrame()),(Object.keys(a).length||pr(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=i;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new wi(t),this._bearingSnap=e.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(e);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[t,e,n]of this._listeners)o.addEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,n)}destroy(){for(const[t,e,n]of this._listeners)o.removeEventListener(t,e,t===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(t){const e=this._map,n=e.getCanvasContainer();this._add("mapEvent",new Ii(e,t));const i=e.boxZoom=new Di(e,t);this._add("boxZoom",i),t.interactive&&t.boxZoom&&i.enable();const r=e.cooperativeGestures=new ur(e,t.cooperativeGestures);this._add("cooperativeGestures",r),t.cooperativeGestures&&r.enable();const a=new zi(e),s=new ar(e);e.doubleClickZoom=new rr(s,a),this._add("tapZoom",a),this._add("clickZoom",s),t.interactive&&t.doubleClickZoom&&e.doubleClickZoom.enable();const l=new or;this._add("tapDragZoom",l);const c=e.touchPitch=new Ji(e);this._add("touchPitch",c),t.interactive&&t.touchPitch&&e.touchPitch.enable(t.touchPitch);const u=Gi(t),h=Hi(t);e.dragRotate=new lr(t,u,h),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",h,["mouseRotate"]),t.interactive&&t.dragRotate&&e.dragRotate.enable();const d=(({enable:t,clickTolerance:e})=>{const n=new Ni({checkCorrectEvent:t=>0===o.mouseButton(t)&&!t.ctrlKey});return new Fi({clickTolerance:e,move:(t,e)=>({around:e,panDelta:e.sub(t)}),activateOnStart:!0,moveStateManager:n,enable:t,assignEvents:Vi})})(t),p=new ji(t,e);e.dragPan=new sr(n,d,p),this._add("mousePan",d),this._add("touchPan",p,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&e.dragPan.enable(t.dragPan);const m=new Xi,f=new $i;e.touchZoomRotate=new cr(n,f,m,l),this._add("touchRotate",m,["touchPan","touchZoom"]),this._add("touchZoom",f,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&e.touchZoomRotate.enable(t.touchZoomRotate);const g=e.scrollZoom=new ir(e,(()=>this._triggerRenderFrame()));this._add("scrollZoom",g,["mousePan"]),t.interactive&&t.scrollZoom&&e.scrollZoom.enable(t.scrollZoom);const v=e.keyboard=new tr(e);this._add("keyboard",v),t.interactive&&t.keyboard&&e.keyboard.enable(),this._add("blockableMapEvent",new Bi(e))}_add(t,e,n){this._handlers.push({handlerName:t,handler:e,allowed:n}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(hr(this._eventsInProgress))||this.isZooming()}_blockedByActive(t,e,n){for(const i in t)if(i!==n&&(!e||e.indexOf(i)<0))return!0;return!1}_getMapTouches(t){const e=[];for(const n of t)this._el.contains(n.target)&&e.push(n);return e}mergeHandlerResult(t,n,i,r,a){if(!i)return;e.e(t,i);const o={handlerName:r,originalEvent:i.originalEvent||a};void 0!==i.zoomDelta&&(n.zoom=o),void 0!==i.panDelta&&(n.drag=o),void 0!==i.pitchDelta&&(n.pitch=o),void 0!==i.bearingDelta&&(n.rotate=o)}_applyChanges(){const t={},n={},i={};for(const[r,a,o]of this._changes)r.panDelta&&(t.panDelta=(t.panDelta||new e.P(0,0))._add(r.panDelta)),r.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(t.around=r.around),void 0!==r.pinchAround&&(t.pinchAround=r.pinchAround),r.noInertia&&(t.noInertia=r.noInertia),e.e(n,a),e.e(i,o);this._updateMapTransform(t,n,i),this._changes=[]}_updateMapTransform(t,e,n){const i=this._map,r=i._getTransformForUpdate(),a=i.terrain;if(!(pr(t)||a&&this._terrainMovement))return this._fireEvents(e,n,!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:c,around:u,pinchAround:h}=t;void 0!==h&&(u=h),i._stop(!0),u=u||i.transform.centerPoint;const d=r.pointLocation(o?u.sub(o):u);l&&(r.bearing+=l),c&&(r.pitch+=c),s&&(r.zoom+=s),a?this._terrainMovement||!e.drag&&!e.zoom?e.drag&&this._terrainMovement?r.center=r.pointLocation(r.centerPoint.sub(o)):r.setLocationAtPoint(d,u):(this._terrainMovement=!0,this._map._elevationFreeze=!0,r.setLocationAtPoint(d,u)):r.setLocationAtPoint(d,u),i._applyUpdatedTransform(r),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(e,n,!0)}_fireEvents(t,n,i){const r=hr(this._eventsInProgress),o=hr(t),s={};for(const e in t){const{originalEvent:n}=t[e];this._eventsInProgress[e]||(s[`${e}start`]=n),this._eventsInProgress[e]=t[e]}!r&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const e in t){const{originalEvent:n}=t[e];this._fireEvent(e,n)}const l={};let c;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:i}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],c=n[e]||i,l[`${t}end`]=c)}for(const t in l)this._fireEvent(t,l[t]);const u=hr(this._eventsInProgress),h=(r||o)&&!u;if(h&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),i&&h){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;!t||!t.essential&&a.prefersReducedMotion?(this._map.fire(new e.k("moveend",{originalEvent:c})),n(this._map.getBearing())&&this._map.resetNorth()):(n(t.bearing||this._map.getBearing())&&(t.bearing=0),t.freezeElevation=!0,this._map.easeTo(t,{originalEvent:c})),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new e.k(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new dr("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class fr extends e.E{constructor(t,e){super(),this._renderFrameCallback=()=>{const t=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=e.bearingSnap,this.on("moveend",(()=>{delete this._requestedCameraState}))}getCenter(){return new e.M(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(t,n,i){return t=e.P.convert(t).mult(-1),this.panTo(this.transform.center,e.e({offset:t},n),i)}panTo(t,n,i){return this.easeTo(e.e({center:t},n),i)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(t,n,i){return this.easeTo(e.e({zoom:t},n),i)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(t,n,i){return this.easeTo(e.e({bearing:t},n),i)}resetNorth(t,n){return this.rotateTo(0,e.e({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(e.e({bearing:0,pitch:0,duration:1e3},t),n),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(t,e){t=j.convert(t);const n=e&&e.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,e)}_cameraForBoxAndBearing(t,n,i,r){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(r=e.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){const t=r.padding;r.padding={top:t,bottom:t,right:t,left:t}}r.padding=e.e(a,r.padding);const o=this.transform,s=o.padding,l=new j(t,n),c=o.project(l.getNorthWest()),u=o.project(l.getNorthEast()),h=o.project(l.getSouthEast()),d=o.project(l.getSouthWest()),p=e.b9(-i),m=c.rotate(p),f=u.rotate(p),g=h.rotate(p),v=d.rotate(p),y=new e.P(Math.max(m.x,f.x,v.x,g.x),Math.max(m.y,f.y,v.y,g.y)),_=new e.P(Math.min(m.x,f.x,v.x,g.x),Math.min(m.y,f.y,v.y,g.y)),x=y.sub(_),b=(o.width-(s.left+s.right+r.padding.left+r.padding.right))/x.x,A=(o.height-(s.top+s.bottom+r.padding.top+r.padding.bottom))/x.y;if(A<0||b<0)return void e.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const w=Math.min(o.scaleZoom(o.scale*Math.min(b,A)),r.maxZoom),C=e.P.convert(r.offset),E=new e.P((r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2).rotate(e.b9(i)),S=C.add(E).mult(o.scale/o.zoomScale(w));return{center:o.unproject(c.add(h).div(2).sub(S)),zoom:w,bearing:i}}fitBounds(t,e,n){return this._fitInternal(this.cameraForBounds(t,e),e,n)}fitScreenCoordinates(t,n,i,r,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.P.convert(t)),this.transform.pointLocation(e.P.convert(n)),i,r),r,a)}_fitInternal(t,n,i){return t?(delete(n=e.e(t,n)).padding,n.linear?this.easeTo(n,i):this.flyTo(n,i)):this}jumpTo(t,n){this.stop();const i=this._getTransformForUpdate();let r=!1,a=!1,o=!1;return"zoom"in t&&i.zoom!==+t.zoom&&(r=!0,i.zoom=+t.zoom),void 0!==t.center&&(i.center=e.M.convert(t.center)),"bearing"in t&&i.bearing!==+t.bearing&&(a=!0,i.bearing=+t.bearing),"pitch"in t&&i.pitch!==+t.pitch&&(o=!0,i.pitch=+t.pitch),null==t.padding||i.isPaddingEqual(t.padding)||(i.padding=t.padding),this._applyUpdatedTransform(i),this.fire(new e.k("movestart",n)).fire(new e.k("move",n)),r&&this.fire(new e.k("zoomstart",n)).fire(new e.k("zoom",n)).fire(new e.k("zoomend",n)),a&&this.fire(new e.k("rotatestart",n)).fire(new e.k("rotate",n)).fire(new e.k("rotateend",n)),o&&this.fire(new e.k("pitchstart",n)).fire(new e.k("pitch",n)).fire(new e.k("pitchend",n)),this.fire(new e.k("moveend",n))}calculateCameraOptionsFromTo(t,n,i,r=0){const a=e.Y.fromLngLat(t,n),o=e.Y.fromLngLat(i,r),s=o.x-a.x,l=o.y-a.y,c=o.z-a.z,u=Math.hypot(s,l,c);if(0===u)throw new Error("Can't calculate camera options with same From and To");const h=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/u/this.transform.tileSize),p=180*Math.atan2(s,-l)/Math.PI;let m=180*Math.acos(h/u)/Math.PI;return m=c<0?90-m:90+m,{center:o.toLngLat(),zoom:d,pitch:m,bearing:p}}easeTo(t,n){var i;this._stop(!1,t.easeId),(!1===(t=e.e({offset:[0,0],duration:500,easing:e.b8},t)).animate||!t.essential&&a.prefersReducedMotion)&&(t.duration=0);const r=this._getTransformForUpdate(),o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:l,d="padding"in t?t.padding:r.padding,p=e.P.convert(t.offset);let m=r.centerPoint.add(p);const f=r.pointLocation(m),{center:g,zoom:v}=r.getConstrained(e.M.convert(t.center||f),null!==(i=t.zoom)&&void 0!==i?i:o);this._normalizeCenter(g);const y=r.project(f),_=r.project(g).sub(y),x=r.zoomScale(v-o);let b,A;t.around&&(b=e.M.convert(t.around),A=r.locationPoint(b));const w={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||v!==o,this._rotating=this._rotating||s!==u,this._pitching=this._pitching||h!==l,this._padding=!r.isPaddingEqual(d),this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,w),this.terrain&&this._prepareElevation(g),this._ease((i=>{if(this._zooming&&(r.zoom=e.z.number(o,v,i)),this._rotating&&(r.bearing=e.z.number(s,u,i)),this._pitching&&(r.pitch=e.z.number(l,h,i)),this._padding&&(r.interpolatePadding(c,d,i),m=r.centerPoint.add(p)),this.terrain&&!t.freezeElevation&&this._updateElevation(i),b)r.setLocationAtPoint(b,A);else{const t=r.zoomScale(r.zoom-o),e=v>o?Math.min(2,x):Math.max(.5,x),n=Math.pow(e,1-i),a=r.unproject(y.add(_.mult(i*n)).mult(t));r.setLocationAtPoint(r.renderWorldCopies?a.wrap():a,m)}this._applyUpdatedTransform(r),this._fireMoveEvents(n)}),(e=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n,e)}),t),this}_prepareEase(t,n,i={}){this._moving=!0,n||i.moving||this.fire(new e.k("movestart",t)),this._zooming&&!i.zooming&&this.fire(new e.k("zoomstart",t)),this._rotating&&!i.rotating&&this.fire(new e.k("rotatestart",t)),this._pitching&&!i.pitching&&this.fire(new e.k("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&n!==this._elevationTarget){const e=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(e-(n-(e*t+this._elevationStart))/(1-t)),this._elevationTarget=n}this.transform.elevation=e.z.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const e=t.clone(),{center:n,zoom:i,pitch:r,bearing:a,elevation:o}=this.transformCameraUpdate(e);n&&(e.center=n),void 0!==i&&(e.zoom=i),void 0!==r&&(e.pitch=r),void 0!==a&&(e.bearing=a),void 0!==o&&(e.elevation=o),this.transform.apply(e)}_fireMoveEvents(t){this.fire(new e.k("move",t)),this._zooming&&this.fire(new e.k("zoom",t)),this._rotating&&this.fire(new e.k("rotate",t)),this._pitching&&this.fire(new e.k("pitch",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const i=this._zooming,r=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new e.k("zoomend",t)),r&&this.fire(new e.k("rotateend",t)),a&&this.fire(new e.k("pitchend",t)),this.fire(new e.k("moveend",t))}flyTo(t,n){var i;if(!t.essential&&a.prefersReducedMotion){const i=e.L(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,n)}this.stop(),t=e.e({offset:[0,0],speed:1.2,curve:1.42,easing:e.b8},t);const r=this._getTransformForUpdate(),o=this.getZoom(),s=this.getBearing(),l=this.getPitch(),c=this.getPadding(),u="bearing"in t?this._normalizeBearing(t.bearing,s):s,h="pitch"in t?+t.pitch:l,d="padding"in t?t.padding:r.padding,p=e.P.convert(t.offset);let m=r.centerPoint.add(p);const f=r.pointLocation(m),{center:g,zoom:v}=r.getConstrained(e.M.convert(t.center||f),null!==(i=t.zoom)&&void 0!==i?i:o);this._normalizeCenter(g);const y=r.zoomScale(v-o),_=r.project(f),x=r.project(g).sub(_);let b=t.curve;const A=Math.max(r.width,r.height),w=A/y,C=x.mag();if("minZoom"in t){const n=e.ac(Math.min(t.minZoom,o,v),r.minZoom,r.maxZoom),i=A/r.zoomScale(n-o);b=Math.sqrt(i/C*2)}const E=b*b;function S(t){const e=(w*w-A*A+(t?-1:1)*E*E*C*C)/(2*(t?w:A)*E*C);return Math.log(Math.sqrt(e*e+1)-e)}function M(t){return(Math.exp(t)-Math.exp(-t))/2}function T(t){return(Math.exp(t)+Math.exp(-t))/2}const I=S(!1);let B=function(t){return T(I)/T(I+b*t)},L=function(t){return A*((T(I)*(M(e=I+b*t)/T(e))-M(I))/E)/C;var e},D=(S(!0)-I)/b;if(Math.abs(C)<1e-6||!isFinite(D)){if(Math.abs(A-w)<1e-6)return this.easeTo(t,n);const e=w<A?-1:1;D=Math.abs(Math.log(w/A))/b,L=()=>0,B=t=>Math.exp(e*b*t)}return t.duration="duration"in t?+t.duration:1e3*D/("screenSpeed"in t?+t.screenSpeed/b:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==u,this._pitching=h!==l,this._padding=!r.isPaddingEqual(d),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(g),this._ease((i=>{const a=i*D,f=1/B(a);r.zoom=1===i?v:o+r.scaleZoom(f),this._rotating&&(r.bearing=e.z.number(s,u,i)),this._pitching&&(r.pitch=e.z.number(l,h,i)),this._padding&&(r.interpolatePadding(c,d,i),m=r.centerPoint.add(p)),this.terrain&&!t.freezeElevation&&this._updateElevation(i);const y=1===i?g:r.unproject(_.add(x.mult(L(a))).mult(f));r.setLocationAtPoint(r.renderWorldCopies?y.wrap():y,m),this._applyUpdatedTransform(r),this._fireMoveEvents(n)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){var n;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}return t||null===(n=this.handlers)||void 0===n||n.stop(!1),this}_ease(t,e,n){!1===n.animate||0===n.duration?(t(1),e()):(this._easeStart=a.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=e,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,n){t=e.b2(t,-180,180);const i=Math.abs(t-n);return Math.abs(t-360-n)<i&&(t-=360),Math.abs(t+360-n)<i&&(t+=360),t}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const n=t.lng-e.center.lng;t.lng+=n>180?-360:n<-180?360:0}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(e.M.convert(t),this.transform.tileZoom)-this.transform.elevation:null}}const gr={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class vr{constructor(t=gr){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType&&"terrain"!==t.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=o.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=o.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const n=this._map._getUIString(`AttributionControl.${e}`);t.title=n,t.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((t=>"string"!=typeof t?"":t))):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style.sourceCaches;for(const n in e){const i=e[n];if(i.used||i.usedForTerrain){const e=i.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t=t.filter((t=>String(t).trim())),t.sort(((t,e)=>t.length-e.length)),t=t.filter(((e,n)=>{for(let i=n+1;i<t.length;i++)if(t[i].indexOf(e)>=0)return!1;return!0}));const n=t.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,t.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class yr{constructor(t={}){this._updateCompact=()=>{const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&e.classList.add("maplibregl-compact"):e.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=o.create("div","maplibregl-ctrl");const e=o.create("a","maplibregl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://maplibre.org/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class _r{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,n=e?this._queue.concat(e):this._queue;for(const e of n)if(e.id===t)return void(e.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const e=this._currentlyRunning=this._queue;this._queue=[];for(const n of e)if(!n.cancelled&&(n.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var xr=e.X([{name:"a_pos3d",type:"Int16",components:3}]);class br extends e.E{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,n){this.sourceCache.update(t,n),this._renderableTilesKeys=[];const i={};for(const r of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n}))i[r.key]=!0,this._renderableTilesKeys.push(r.key),this._tiles[r.key]||(r.posMatrix=new Float64Array(16),e.aO(r.posMatrix,0,e.W,0,e.W,0,1),this._tiles[r.key]=new ot(r,this.tileSize));for(const t in this._tiles)i[t]||delete this._tiles[t]}freeRtt(t){for(const e in this._tiles){const n=this._tiles[e];(!t||n.tileID.equals(t)||n.tileID.isChildOf(t)||t.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const n={};for(const i of this._renderableTilesKeys){const r=this._tiles[i].tileID;if(r.canonical.equals(t.canonical)){const r=t.clone();r.posMatrix=new Float64Array(16),e.aO(r.posMatrix,0,e.W,0,e.W,0,1),n[i]=r}else if(r.canonical.isChildOf(t.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const o=r.canonical.z-t.canonical.z,s=r.canonical.x-(r.canonical.x>>o<<o),l=r.canonical.y-(r.canonical.y>>o<<o),c=e.W>>o;e.aO(a.posMatrix,0,c,0,c,0,1),e.H(a.posMatrix,a.posMatrix,[-s*c,-l*c,0]),n[i]=a}else if(t.canonical.isChildOf(r.canonical)){const a=t.clone();a.posMatrix=new Float64Array(16);const o=t.canonical.z-r.canonical.z,s=t.canonical.x-(t.canonical.x>>o<<o),l=t.canonical.y-(t.canonical.y>>o<<o),c=e.W>>o;e.aO(a.posMatrix,0,e.W,0,e.W,0,1),e.H(a.posMatrix,a.posMatrix,[s*c,l*c,0]),e.J(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),n[i]=a}}return n}getSourceTile(t,e){const n=this.sourceCache._source;let i=t.overscaledZ-this.deltaZoom;if(i>n.maxzoom&&(i=n.maxzoom),i<n.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(i).key);let r=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!r||!r.dem)&&e)for(;i>=n.minzoom&&(!r||!r.dem);)r=this.sourceCache.getTileByID(t.scaledTo(i--).key);return r}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter((e=>e.timeAdded>=t))}}class Ar{constructor(t,e,n){this.painter=t,this.sourceCache=new br(e),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,n,i,r=e.W){var a;if(!(n>=0&&n<r&&i>=0&&i<r))return 0;const o=this.getTerrainData(t),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}([],[n/r*e.W,i/r*e.W],o.u_terrain_matrix),c=[l[0]*s.dim,l[1]*s.dim],u=Math.floor(c[0]),h=Math.floor(c[1]),d=c[0]-u,p=c[1]-h;return s.get(u,h)*(1-d)*(1-p)+s.get(u+1,h)*d*(1-p)+s.get(u,h+1)*(1-d)*p+s.get(u+1,h+1)*d*p}getElevationForLngLatZoom(t,n){const{tileID:i,mercatorX:r,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(t,n);return this.getElevation(i,r%e.W,a%e.W,e.W)}getElevation(t,n,i,r=e.W){return this.getDEMElevation(t,n,i,r)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const t=this.painter.context,n=new e.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new b(t,n,t.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new b(t,new e.R({width:1,height:1}),t.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=e.an([])}const n=this.sourceCache.getSourceTile(t,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const t=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new b(t,n.dem.getPixels(),t.gl.RGBA,{premultiply:!1}),n.demTexture.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const i=n&&n+n.tileID.key+t.key;if(i&&!this._demMatrixCache[i]){const i=this.sourceCache.sourceCache._source.maxzoom;let r=t.canonical.z-n.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=i?r=t.canonical.z-i:e.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=t.canonical.x-(t.canonical.x>>r<<r),o=t.canonical.y-(t.canonical.y>>r<<r),s=e.ba(new Float64Array(16),[1/(e.W<<r),1/(e.W<<r),0]);e.H(s,s,[a*e.W,o*e.W,0]),this._demMatrixCache[t.key]={matrix:s,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:i?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(t){const e=this.painter,n=e.width/devicePixelRatio,i=e.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===i||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new b(e.context,{width:n,height:i,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new b(e.context,{width:n,height:i,data:null},e.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(e.context.gl.NEAREST,e.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=e.context.createFramebuffer(n,i,!0,!1),this._fbo.depthAttachment.set(e.context.createRenderbuffer(e.context.gl.DEPTH_COMPONENT16,n,i))),this._fbo.colorAttachment.set("coords"===t?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,e=0;t<this._coordsTextureSize;t++)for(let i=0;i<this._coordsTextureSize;i++,e+=4)n[e+0]=255&i,n[e+1]=255&t,n[e+2]=i>>8<<4|t>>8,n[e+3]=0;const i=new e.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),r=new b(t,i,t.gl.RGBA,{premultiply:!1});return r.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=r,r}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),i=this.painter.context,r=i.gl,a=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);i.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),r.readPixels(a,s-o-1,1,1,r.RGBA,r.UNSIGNED_BYTE,n),i.bindFramebuffer.set(null);const l=n[0]+(n[2]>>4<<8),c=n[1]+((15&n[2])<<8),u=this.coordsIndex[255-n[3]],h=u&&this.sourceCache.getTileByID(u);if(!h)return null;const d=this._coordsTextureSize,p=(1<<h.tileID.canonical.z)*d;return new e.Y((h.tileID.canonical.x*d+l)/p+h.tileID.wrap,(h.tileID.canonical.y*d+c)/p,this.getElevation(h.tileID,l,c,d))}depthAtPoint(t){const e=new Uint8Array(4),n=this.painter.context,i=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),i.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,i.RGBA,i.UNSIGNED_BYTE,e),n.bindFramebuffer.set(null),(e[0]/16777216+e[1]/65536+e[2]/256+e[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,n=new e.bb,i=new e.aY,r=this.meshSize,a=e.W/r,o=r*r;for(let t=0;t<=r;t++)for(let e=0;e<=r;e++)n.emplaceBack(e*a,t*a,0);for(let t=0;t<o;t+=r+1)for(let e=0;e<r;e++)i.emplaceBack(e+t,r+e+t+1,r+e+t+2),i.emplaceBack(e+t,r+e+t+2,e+t+1);const s=n.length,l=s+2*(r+1);for(const t of[0,1])for(let i=0;i<=r;i++)for(const r of[0,1])n.emplaceBack(i*a,t*e.W,r);for(let t=0;t<2*r;t+=2)i.emplaceBack(l+t,l+t+1,l+t+3),i.emplaceBack(l+t,l+t+3,l+t+2),i.emplaceBack(s+t,s+t+3,s+t+1),i.emplaceBack(s+t,s+t+2,s+t+3);const c=n.length,u=c+2*(r+1);for(const t of[0,1])for(let i=0;i<=r;i++)for(const r of[0,1])n.emplaceBack(t*e.W,i*a,r);for(let t=0;t<2*r;t+=2)i.emplaceBack(c+t,c+t+1,c+t+3),i.emplaceBack(c+t,c+t+3,c+t+2),i.emplaceBack(u+t,u+t+3,u+t+1),i.emplaceBack(u+t,u+t+2,u+t+3);return this._mesh={indexBuffer:t.createIndexBuffer(i),vertexBuffer:t.createVertexBuffer(n,xr.members),segments:e.$.simpleSegment(0,0,n.length,i.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*e.bc/Math.pow(2,t)/5}getMinTileElevationForLngLatZoom(t,e){var n;const{tileID:i}=this._getOverscaledTileIDFromLngLatZoom(t,e);return null!==(n=this.getMinMaxElevation(i).minElevation)&&void 0!==n?n:0}getMinMaxElevation(t){const e=this.getTerrainData(t).tile,n={minElevation:null,maxElevation:null};return e&&e.dem&&(n.minElevation=e.dem.min*this.exaggeration,n.maxElevation=e.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(t,n){const i=e.Y.fromLngLat(t.wrap()),r=(1<<n)*e.W,a=i.x*r,o=i.y*r,s=Math.floor(a/e.W),l=Math.floor(o/e.W);return{tileID:new e.Q(n,0,n,s,l),mercatorX:a,mercatorY:o}}}class wr{constructor(t,e,n){this._context=t,this._size=e,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const e=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new b(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),e.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),e.colorAttachment.set(n.texture),{id:t,fbo:e,texture:n,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((e=>t.id!==e)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some((t=>!t.inUse))}}const Cr={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Er{constructor(t,e){this.painter=t,this.terrain=e,this.pool=new wr(t.context,30,e.sourceCache.tileSize*e.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,e){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((n=>!t._layers[n].isHidden(e))),this._coordsDescendingInv={};for(const e in t.sourceCaches){this._coordsDescendingInv[e]={};const n=t.sourceCaches[e].getVisibleCoordinates();for(const t of n){const n=this.terrain.sourceCache.getTerrainCoords(t);for(const t in n)this._coordsDescendingInv[e][t]||(this._coordsDescendingInv[e][t]=[]),this._coordsDescendingInv[e][t].push(n[t])}}this._coordsDescendingInvStr={};for(const e of t._order){const n=t._layers[e],i=n.source;if(Cr[n.type]&&!this._coordsDescendingInvStr[i]){this._coordsDescendingInvStr[i]={};for(const t in this._coordsDescendingInv[i])this._coordsDescendingInvStr[i][t]=this._coordsDescendingInv[i][t].map((t=>t.key)).sort().join()}}for(const t of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const n=this._coordsDescendingInvStr[e][t.tileID.key];n&&n!==t.rttCoords[e]&&(t.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const n=t.type,i=this.painter,r=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Cr[n]&&(this._prevType&&Cr[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(t.id),!r))return!0;if(Cr[this._prevType]||Cr[n]&&r){this._prevType=n;const t=this._stacks.length-1,r=this._stacks[t]||[];for(const n of this._renderableTiles){if(this.pool.isFull()&&(ci(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(n),n.rtt[t]){const e=this.pool.getObjectForId(n.rtt[t].id);if(e.stamp===n.rtt[t].stamp){this.pool.useObject(e);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),n.rtt[t]={id:a.id,stamp:a.stamp},i.context.bindFramebuffer.set(a.fbo.framebuffer),i.context.clear({color:e.aP.transparent,stencil:0}),i.currentStencilSource=void 0;for(let t=0;t<r.length;t++){const e=i.style._layers[r[t]],o=e.source?this._coordsDescendingInv[e.source][n.tileID.key]:[n.tileID];i.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),i._renderTileClippingMasks(e,o),i.renderLayer(i,i.style.sourceCaches[e.source],e,o),e.source&&(n.rttCoords[e.source]=this._coordsDescendingInvStr[e.source][n.tileID.key])}}return ci(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Cr[n]}return!1}}const Sr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Mr=n,Tr={hash:!1,interactive:!0,bearingSnap:7,attributionControl:gr,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:e.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Ir=t=>{t.touchstart=t.dragStart,t.touchmoveWindow=t.dragMove,t.touchend=t.dragEnd},Br={showCompass:!0,showZoom:!0,visualizePitch:!1};class Lr{constructor(t,n,i=!1){this.mousedown=t=>{this.startMouse(e.e({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),o.mousePos(this.element,t)),o.addEventListener(window,"mousemove",this.mousemove),o.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=t=>{this.moveMouse(t,o.mousePos(this.element,t))},this.mouseup=t=>{this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()},this.touchstart=t=>{1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),o.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.addEventListener(window,"touchend",this.touchend))},this.touchmove=t=>{1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))},this.touchend=t=>{0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const r=t.dragRotate._mouseRotate.getClickTolerance(),a=t.dragRotate._mousePitch.getClickTolerance();this.element=n,this.mouseRotate=Gi({clickTolerance:r,enable:!0}),this.touchRotate=(({enable:t,clickTolerance:e,bearingDegreesPerPixelMoved:n=.8})=>{const i=new Ui;return new Fi({clickTolerance:e,move:(t,e)=>({bearingDelta:(e.x-t.x)*n}),moveStateManager:i,enable:t,assignEvents:Ir})})({clickTolerance:r,enable:!0}),this.map=t,i&&(this.mousePitch=Hi({clickTolerance:a,enable:!0}),this.touchPitch=(({enable:t,clickTolerance:e,pitchDegreesPerPixelMoved:n=-.5})=>{const i=new Ui;return new Fi({clickTolerance:e,move:(t,e)=>({pitchDelta:(e.y-t.y)*n}),moveStateManager:i,enable:t,assignEvents:Ir})})({clickTolerance:a,enable:!0})),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchcancel",this.reset)}startMouse(t,e){this.mouseRotate.dragStart(t,e),this.mousePitch&&this.mousePitch.dragStart(t,e),o.disableDrag()}startTouch(t,e){this.touchRotate.dragStart(t,e),this.touchPitch&&this.touchPitch.dragStart(t,e),o.disableDrag()}moveMouse(t,e){const n=this.map,{bearingDelta:i}=this.mouseRotate.dragMove(t,e)||{};if(i&&n.setBearing(n.getBearing()+i),this.mousePitch){const{pitchDelta:i}=this.mousePitch.dragMove(t,e)||{};i&&n.setPitch(n.getPitch()+i)}}moveTouch(t,e){const n=this.map,{bearingDelta:i}=this.touchRotate.dragMove(t,e)||{};if(i&&n.setBearing(n.getBearing()+i),this.touchPitch){const{pitchDelta:i}=this.touchPitch.dragMove(t,e)||{};i&&n.setPitch(n.getPitch()+i)}}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(window,"mousemove",this.mousemove),o.removeEventListener(window,"mouseup",this.mouseup),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend)}}let Dr;function Pr(t,n,i){const r=new e.M(t.lng,t.lat);if(t=new e.M(t.lng,t.lat),n){const r=new e.M(t.lng-360,t.lat),a=new e.M(t.lng+360,t.lat),o=i.locationPoint(t).distSqr(n);i.locationPoint(r).distSqr(n)<o?t=r:i.locationPoint(a).distSqr(n)<o&&(t=a)}for(;Math.abs(t.lng-i.center.lng)>180;){const e=i.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=i.width&&e.y<=i.height)break;t.lng>i.center.lng?t.lng-=360:t.lng+=360}return t.lng!==r.lng&&i.locationPoint(t).y>i.height/2-i.getHorizon()?t:r}const Rr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function kr(t,e,n){const i=t.classList;for(const t in Rr)i.remove(`maplibregl-${n}-anchor-${t}`);i.add(`maplibregl-${n}-anchor-${e}`)}class zr extends e.E{constructor(t){if(super(),this._onKeyPress=t=>{const e=t.code,n=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==n&&13!==n||this.togglePopup()},this._onMapClick=t=>{const e=t.originalEvent.target,n=this._element;this._popup&&(e===n||n.contains(e))&&this.togglePopup()},this._update=t=>{var e;if(!this._map)return;const n=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==t?void 0:t.type)||"render"===(null==t?void 0:t.type)&&!n)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Pr(this._lngLat,this._flatPos,this._map.transform):null===(e=this._lngLat)||void 0===e?void 0:e.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let i="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?i=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(i=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let r="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?r="rotateX(0deg)":"map"===this._pitchAlignment&&(r=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),o.setTransform(this._element,`${Rr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${r} ${i}`),a.frameAsync(new AbortController).then((()=>{this._updateOpacity(t&&"moveend"===t.type)})).catch((()=>{}))},this._onMove=t=>{if(!this._isDragging){const e=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=e}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.k("dragstart"))),this.fire(new e.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.k("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==t?void 0:t.opacity,null==t?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=e.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div");const n=o.createNS("http://www.w3.org/2000/svg","svg"),i=41,r=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${i}px`),n.setAttributeNS(null,"width",`${r}px`),n.setAttributeNS(null,"viewBox",`0 0 ${r} ${i}`);const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const c=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of c){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const u=o.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(h);const d=o.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"opacity","0.25"),d.setAttributeNS(null,"fill","#000000");const p=o.createNS("http://www.w3.org/2000/svg","path");p.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),d.appendChild(p);const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");const f=o.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const v=o.createNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"fill","#FFFFFF"),v.setAttributeNS(null,"cx","5.5"),v.setAttributeNS(null,"cy","5.5"),v.setAttributeNS(null,"r","5.4999962"),f.appendChild(g),f.appendChild(v),s.appendChild(l),s.appendChild(u),s.appendChild(d),s.appendChild(m),s.appendChild(f),n.appendChild(s),n.setAttributeNS(null,"height",i*this._scale+"px"),n.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(n),this._offset=e.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(t=>{t.preventDefault()})),this._element.addEventListener("mousedown",(t=>{t.preventDefault()})),kr(this._element,this._anchor,"marker"),t&&t.className)for(const e of t.className.split(" "))this._element.classList.add(e);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.M.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,n=13.5,i=Math.abs(n)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[i,-1*(e-n+i)],"bottom-right":[-i,-1*(e-n+i)],left:[n,-1*(e-n)],right:[-n,-1*(e-n)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var n,i;if(!(null===(n=this._map)||void 0===n?void 0:n.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const r=this._map,a=r.terrain.depthAtPoint(this._pos),o=r.terrain.getElevationForLngLatZoom(this._lngLat,r.transform.tileZoom);if(r.transform.lngLatToCameraDepth(this._lngLat,o)-a<.006)return void(this._element.style.opacity=this._opacity);const s=-this._offset.y/r.transform._pixelPerMeter,l=Math.sin(r.getPitch()*Math.PI/180)*s,c=r.terrain.depthAtPoint(new e.P(this._pos.x,this._pos.y-this._offset.y)),u=r.transform.lngLatToCameraDepth(this._lngLat,o+l)-c>.006;(null===(i=this._popup)||void 0===i?void 0:i.isOpen())&&u&&this._popup.remove(),this._element.style.opacity=u?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=e.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,e){return void 0===t&&void 0===e&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==t&&(this._opacity=t),void 0!==e&&(this._opacityWhenCovered=e),this._map&&this._updateOpacity(!0),this}}const Fr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Or=0,Nr=!1;const Ur={maxWidth:100,unit:"metric"};function Vr(t,e,n){const i=n&&n.maxWidth||100,r=t._container.clientHeight/2,a=t.unproject([0,r]),o=t.unproject([i,r]),s=a.distanceTo(o);if(n&&"imperial"===n.unit){const n=3.2808*s;n>5280?Gr(e,i,n/5280,t._getUIString("ScaleControl.Miles")):Gr(e,i,n,t._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?Gr(e,i,s/1852,t._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Gr(e,i,s/1e3,t._getUIString("ScaleControl.Kilometers")):Gr(e,i,s,t._getUIString("ScaleControl.Meters"))}function Gr(t,e,n,i){const r=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(n),e*n}(n);t.style.width=e*(r/n)+"px",t.innerHTML=`${r}&nbsp;${i}`}const Hr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},jr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wr(t){if(t){if("number"==typeof t){const n=Math.round(Math.abs(t)/Math.SQRT2);return{center:new e.P(0,0),top:new e.P(0,t),"top-left":new e.P(n,n),"top-right":new e.P(-n,n),bottom:new e.P(0,-t),"bottom-left":new e.P(n,-n),"bottom-right":new e.P(-n,-n),left:new e.P(t,0),right:new e.P(-t,0)}}if(t instanceof e.P||Array.isArray(t)){const n=e.P.convert(t);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:e.P.convert(t.center||[0,0]),top:e.P.convert(t.top||[0,0]),"top-left":e.P.convert(t["top-left"]||[0,0]),"top-right":e.P.convert(t["top-right"]||[0,0]),bottom:e.P.convert(t.bottom||[0,0]),"bottom-left":e.P.convert(t["bottom-left"]||[0,0]),"bottom-right":e.P.convert(t["bottom-right"]||[0,0]),left:e.P.convert(t.left||[0,0]),right:e.P.convert(t.right||[0,0])}}return Wr(new e.P(0,0))}const qr=n;t.AJAXError=e.bf,t.Evented=e.E,t.LngLat=e.M,t.MercatorCoordinate=e.Y,t.Point=e.P,t.addProtocol=e.bg,t.config=e.a,t.removeProtocol=e.bh,t.AttributionControl=vr,t.BoxZoomHandler=Di,t.CanvasSource=K,t.CooperativeGesturesHandler=ur,t.DoubleClickZoomHandler=rr,t.DragPanHandler=sr,t.DragRotateHandler=lr,t.EdgeInsets=pi,t.FullscreenControl=class extends e.E{constructor(t={}){super(),this._onFullscreenChange=()=>{var t;let e=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(t=null==e?void 0:e.shadowRoot)||void 0===t?void 0:t.fullscreenElement;)e=e.shadowRoot.fullscreenElement;e===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,t&&t.container&&(t.container instanceof HTMLElement?this._container=t.container:e.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const t=this._fullscreenButton=o.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);o.create("span","maplibregl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new e.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new e.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},t.GeoJSONSource=Y,t.GeolocateControl=class extends e.E{constructor(t){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new e.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const n=new e.M(t.coords.longitude,t.coords.latitude),i=t.coords.accuracy,r=this._map.getBearing(),a=e.e({bearing:r},this.options.fitBoundsOptions),o=j.fromLngLat(n,i);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const n=new e.M(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&Nr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new e.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=o.create("button","maplibregl-ctrl-geolocate",this._container),o.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.w("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new zr({element:this._dotElement}),this._circleElement=o.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new zr({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new e.k("trackuserlocationend")),this.fire(new e.k("userlocationlostfocus")))}))}},this.options=e.e({},Fr,t)}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return e._(this,arguments,void 0,(function*(t=!1){if(void 0!==Dr&&!t)return Dr;if(void 0===window.navigator.permissions)return Dr=!!window.navigator.geolocation,Dr;try{const t=yield window.navigator.permissions.query({name:"geolocation"});Dr="denied"!==t.state}catch(t){Dr=!!window.navigator.geolocation}return Dr}))}().then((t=>this._setupUI(t))),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Or=0,Nr=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),n=t.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const t=this._map.getBounds(),e=t.getSouthEast(),n=t.getNorthEast(),i=e.distanceTo(n),r=Math.ceil(this._accuracy/(i/this._map._container.clientHeight)*2);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}trigger(){if(!this._setup)return e.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Or--,Nr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new e.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.k("trackuserlocationstart")),this.fire(new e.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let t;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Or++,Or>1?(t={maximumAge:6e5,timeout:0},Nr=!0):(t=this.options.positionOptions,Nr=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},t.Hash=vi,t.ImageSource=Q,t.KeyboardHandler=tr,t.LngLatBounds=j,t.LogoControl=yr,t.Map=class extends fr{constructor(t){e.bd.mark(e.be.create);const n=Object.assign(Object.assign({},Tr),t);if(null!=n.minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=n.minPitch&&null!=n.maxPitch&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=n.minPitch&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=n.maxPitch&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new fi(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new _r,this._controls=[],this._mapId=e.a3(),this._contextLost=t=>{t.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new e.k("webglcontextlost",{originalEvent:t}))},this._contextRestored=t=>{this._setupPainter(),this.resize(),this._update(),this.fire(new e.k("webglcontextrestored",{originalEvent:t}))},this._onMapScroll=t=>{if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===n.preserveDrawingBuffer,this._antialias=!0===n.antialias,this._trackResize=!0===n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=!0===n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=!0===n.crossSourceCollisions,this._collectResourceTiming=!0===n.collectResourceTiming,this._locale=Object.assign(Object.assign({},Sr),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===n.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=p.addThrottleControl((()=>this.isMoving())),this._requestManager=new m(n.transformRequest),"string"==typeof n.container){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))).on("moveend",(()=>this._update(!1))).on("zoom",(()=>this._update(!0))).on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})).once("idle",(()=>{this._idleTriggered=!0})),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let t=!1;const e=gi((t=>{this._trackResize&&!this._removed&&this.resize(t)._update()}),50);this._resizeObserver=new ResizeObserver((n=>{t?e(n):t=!0})),this._resizeObserver.observe(this._container)}this.handlers=new mr(this,n),this._hash=n.hash&&new vi("string"==typeof n.hash&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,e.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new vr("boolean"==typeof n.attributionControl?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new yr,n.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.k(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.k(`${t.dataType}dataloading`,t))})),this.on("dataabort",(t=>{this.fire(new e.k("sourcedataabort",t))}))}_getMapId(){return this._mapId}addControl(t,n){if(void 0===n&&(n=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const i=t.onAdd(this);this._controls.push(t);const r=this._controlPositions[n];return-1!==n.indexOf("bottom")?r.insertBefore(i,r.firstChild):r.appendChild(i),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(t);return n>-1&&this._controls.splice(n,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}calculateCameraOptionsFromTo(t,e,n,i){return null==i&&this.terrain&&(i=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(t,e,n,i)}resize(t){var n;const i=this._containerDimensions(),r=i[0],a=i[1],o=this._getClampedPixelRatio(r,a);if(this._resizeCanvas(r,a,o),this.painter.resize(r,a,o),this.painter.overLimit()){const t=this.painter.context.gl;this._maxCanvasSize=[t.drawingBufferWidth,t.drawingBufferHeight];const e=this._getClampedPixelRatio(r,a);this._resizeCanvas(r,a,e),this.painter.resize(r,a,e)}this.transform.resize(r,a),null===(n=this._requestedCameraState)||void 0===n||n.resize(r,a);const s=!this._moving;return s&&(this.stop(),this.fire(new e.k("movestart",t)).fire(new e.k("move",t))),this.fire(new e.k("resize",t)),s&&this.fire(new e.k("moveend",t)),this}_getClampedPixelRatio(t,e){const{0:n,1:i}=this._maxCanvasSize,r=this.getPixelRatio(),a=t*r,o=e*r;return Math.min(a>n?n/a:1,o>i?i/o:1)*r}getPixelRatio(){var t;return null!==(t=this._overridePixelRatio)&&void 0!==t?t:devicePixelRatio}setPixelRatio(t){this._overridePixelRatio=t,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(t){return this.transform.setMaxBounds(j.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?60:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(t){return this.transform.locationPoint(e.M.convert(t),this.style&&this.terrain)}unproject(t){return this.transform.pointLocation(e.P.convert(t),this.terrain)}isMoving(){var t;return this._moving||(null===(t=this.handlers)||void 0===t?void 0:t.isMoving())}isZooming(){var t;return this._zooming||(null===(t=this.handlers)||void 0===t?void 0:t.isZooming())}isRotating(){var t;return this._rotating||(null===(t=this.handlers)||void 0===t?void 0:t.isRotating())}_createDelegatedListener(t,e,n){if("mouseenter"===t||"mouseover"===t){let i=!1;const r=r=>{const a=this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[];a.length?i||(i=!0,n.call(this,new Si(t,this,r.originalEvent,{features:a}))):i=!1};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:()=>{i=!1}}}}if("mouseleave"===t||"mouseout"===t){let i=!1;const r=r=>{(this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?i=!0:i&&(i=!1,n.call(this,new Si(t,this,r.originalEvent)))},a=e=>{i&&(i=!1,n.call(this,new Si(t,this,e.originalEvent)))};return{layer:e,listener:n,delegates:{mousemove:r,mouseout:a}}}{const i=t=>{const i=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];i.length&&(t.features=i,n.call(this,t),delete t.features)};return{layer:e,listener:n,delegates:{[t]:i}}}}on(t,e,n){if(void 0===n)return super.on(t,e);const i=this._createDelegatedListener(t,e,n);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const t in i.delegates)this.on(t,i.delegates[t]);return this}once(t,e,n){if(void 0===n)return super.once(t,e);const i=this._createDelegatedListener(t,e,n);for(const t in i.delegates)this.once(t,i.delegates[t]);return this}off(t,e,n){return void 0===n?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(i=>{const r=this._delegatedListeners[t];for(let t=0;t<r.length;t++){const i=r[t];if(i.layer===e&&i.listener===n){for(const t in i.delegates)this.off(t,i.delegates[t]);return r.splice(t,1),this}}})(),this)}queryRenderedFeatures(t,n){if(!this.style)return[];let i;const r=t instanceof e.P||Array.isArray(t),a=r?t:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(r?{}:t)||{},a instanceof e.P||"number"==typeof a[0])i=[e.P.convert(a)];else{const t=e.P.convert(a[0]),n=e.P.convert(a[1]);i=[t,new e.P(n.x,t.y),n,new e.P(t.x,n.y),t]}return this.style.queryRenderedFeatures(i,n,this.transform)}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(t,n){return!1!==(n=e.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&t?(this._diffStyle(t,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(t,n))}setTransformRequest(t){return this._requestManager.setTransformRequest(t),this}_getUIString(t){const e=this._locale[t];if(null==e)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(t,e)));const n=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!t)),t?(this.style=new ce(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t,e,n):this.style.loadJSON(t,e,n),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ce(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,n){if("string"==typeof t){const i=this._requestManager.transformRequest(t,"Style");e.h(i,new AbortController).then((t=>{this._updateDiff(t.data,n)})).catch((t=>{t&&this.fire(new e.j(t))}))}else"object"==typeof t&&this._updateDiff(t,n)}_updateDiff(t,n){try{this.style.setState(t,n)&&this._update(!0)}catch(i){e.w(`Unable to perform style diff: ${i.message||i.error||i}.  Rebuilding the style from scratch.`),this._updateStyle(t,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():e.w("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){const n=this.style&&this.style.sourceCaches[t];if(void 0!==n)return n.loaded();this.fire(new e.j(new Error(`There is no source with ID '${t}'`)))}setTerrain(t){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),t){const n=this.style.sourceCaches[t.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${t.source}`);null===this.terrain&&n.reload();for(const n in this.style._layers){const i=this.style._layers[n];"hillshade"===i.type&&i.source===t.source&&e.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ar(this.painter,n,t),this.painter.renderToTexture=new Er(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=e=>{"style"===e.dataType?this.terrain.sourceCache.freeRtt():"source"===e.dataType&&e.tile&&(e.sourceId!==t.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(e.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new e.k("terrain",{terrain:t})),this}getTerrain(){var t,e;return null!==(e=null===(t=this.terrain)||void 0===t?void 0:t.options)&&void 0!==e?e:null}areTilesLoaded(){const t=this.style&&this.style.sourceCaches;for(const e in t){const n=t[e]._tiles;for(const t in n){const e=n[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}removeSource(t){return this.style.removeSource(t),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(t,n,i={}){const{pixelRatio:r=1,sdf:o=!1,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h}=i;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||e.b(n))){if(void 0===n.width||void 0===n.height)return this.fire(new e.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:i,height:a,data:d}=n,p=n;return this.style.addImage(t,{data:new e.R({width:i,height:a},new Uint8Array(d)),pixelRatio:r,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0,userImage:p}),p.onAdd&&p.onAdd(this,t),this}}{const{width:i,height:d,data:p}=a.getImageData(n);this.style.addImage(t,{data:new e.R({width:i,height:d},p),pixelRatio:r,stretchX:s,stretchY:l,content:c,textFitWidth:u,textFitHeight:h,sdf:o,version:0})}}updateImage(t,n){const i=this.style.getImage(t);if(!i)return this.fire(new e.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=n instanceof HTMLImageElement||e.b(n)?a.getImageData(n):n,{width:o,height:s,data:l}=r;if(void 0===o||void 0===s)return this.fire(new e.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==i.data.width||s!==i.data.height)return this.fire(new e.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const c=!(n instanceof HTMLImageElement||e.b(n));return i.data.replace(l,c),this.style.updateImage(t,i),this}getImage(t){return this.style.getImage(t)}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.j(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t){return p.getImage(this._requestManager.transformRequest(t,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(t,e,n){return this.style.setLayerZoomRange(t,e,n),this._update(!0)}setFilter(t,e,n={}){return this.style.setFilter(t,e,n),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,n,i={}){return this.style.setPaintProperty(t,e,n,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,n,i={}){return this.style.setLayoutProperty(t,e,n,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setGlyphs(t,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(t,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(t,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(t,e,n,(t=>{t||this._update(!0)})),this}removeSprite(t){return this._lazyInitEmptyStyle(),this.style.removeSprite(t),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(t,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(t,e,(t=>{t||this._update(!0)})),this}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_setupContainer(){const t=this._container;t.classList.add("maplibregl-map");const e=this._canvasContainer=o.create("div","maplibregl-canvas-container",t);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=o.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),i=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],i);const r=this._controlContainer=o.create("div","maplibregl-control-container",t),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((t=>{a[t]=o.create("div",`maplibregl-ctrl-${t} `,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,e,n){this._canvas.width=Math.floor(n*t),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const t={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let e=null;this._canvas.addEventListener("webglcontextcreationerror",(n=>{e={requestedAttributes:t},n&&(e.statusMessage=n.statusMessage,e.type=n.type)}),{once:!0});const n=this._canvas.getContext("webgl2",t)||this._canvas.getContext("webgl",t);if(!n){const t="Failed to initialize WebGL";throw e?(e.message=t,new Error(JSON.stringify(e))):new Error(t)}this.painter=new ui(n,this.transform),s.testSupport(n)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_render(t){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._removed)return;let i=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,r=a.now();this.style.zoomHistory.update(t,r);const o=new e.a8(t,{now:r,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),s=o.crossFadingFactor();1===s&&s===this._crossFadingFactor||(i=!0,this._crossFadingFactor=s),this.style.update(o)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new e.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,e.bd.mark(e.be.load),this.fire(new e.k("load"))),this.style&&(this.style.hasTransitions()||i)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const r=this._sourcesDirty||this._styleDirty||this._placementDirty;return r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new e.k("idle")),!this._loaded||this._fullyLoaded||r||(this._fullyLoaded=!0,e.bd.mark(e.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var t;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),p.removeThrottleControl(this._imageQueueHandle),null===(t=this._resizeObserver)||void 0===t||t.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==n?void 0:n.loseContext)&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),o.remove(this._canvasContainer),o.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),e.bd.clearMetrics(),this._removed=!0,this.fire(new e.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then((t=>{e.bd.frame(t),this._frameRequest=null,this._render(t)})).catch((()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get version(){return Mr}getCameraTargetElevation(){return this.transform.elevation}},t.MapMouseEvent=Si,t.MapTouchEvent=Mi,t.MapWheelEvent=Ti,t.Marker=zr,t.NavigationControl=class{constructor(t){this._updateZoomButtons=()=>{const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,e)=>{const n=this._map._getUIString(`NavigationControl.${e}`);t.title=n,t.setAttribute("aria-label",n)},this.options=e.e({},Br,t),this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),o.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),o.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=o.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Lr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const n=o.create("button",t,this._container);return n.type="button",n.addEventListener("click",e),n}},t.Popup=class extends e.E{constructor(t){super(),this.remove=()=>(this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new e.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var e;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=o.create("div","maplibregl-popup",this._map.getContainer()),this._tip=o.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const t of this.options.className.split(" "))this._container.classList.add(t);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Pr(this._lngLat,this._flatPos,this._map.transform):null===(e=this._lngLat)||void 0===e?void 0:e.wrap(),this._trackPointer&&!t)return;const n=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let i=this.options.anchor;const r=Wr(this.options.offset);if(!i){const t=this._container.offsetWidth,e=this._container.offsetHeight;let a;a=n.y+r.bottom.y<e?["top"]:n.y>this._map.transform.height-e?["bottom"]:[],n.x<t/2?a.push("left"):n.x>this._map.transform.width-t/2&&a.push("right"),i=0===a.length?"bottom":a.join("-")}let a=n.add(r[i]);this.options.subpixelPositioning||(a=a.round()),o.setTransform(this._container,`${Rr[i]} translate(${a.x}px,${a.y}px)`),kr(this._container,i,"popup")},this._onClose=()=>{this.remove()},this.options=e.e(Object.create(Hr),t)}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new e.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.M.convert(t),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(document.createTextNode(t))}setHTML(t){const e=document.createDocumentFragment(),n=document.createElement("body");let i;for(n.innerHTML=t;i=n.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){var t;return null===(t=this._container)||void 0===t?void 0:t.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){return this._container&&this._container.classList.add(t),this}removeClassName(t){return this._container&&this._container.classList.remove(t),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}setSubpixelPositioning(t){this.options.subpixelPositioning=t}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(jr);t&&t.focus()}},t.RasterDEMTileSource=$,t.RasterTileSource=Z,t.ScaleControl=class{constructor(t){this._onMove=()=>{Vr(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,Vr(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ur),t)}getDefaultPosition(){return"bottom-left"}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},t.ScrollZoomHandler=ir,t.Style=ce,t.TerrainControl=class{constructor(t){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=t}onAdd(t){return this._map=t,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=o.create("button","maplibregl-ctrl-terrain",this._container),o.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},t.TwoFingersTouchPitchHandler=Ji,t.TwoFingersTouchRotateHandler=Xi,t.TwoFingersTouchZoomHandler=$i,t.TwoFingersTouchZoomRotateHandler=cr,t.VectorTileSource=q,t.VideoSource=J,t.addSourceType=(t,n)=>e._(void 0,void 0,void 0,(function*(){if(et(t))throw new Error(`A source type called "${t}" already exists.`);((t,e)=>{tt[t]=e})(t,n)})),t.clearPrewarmedResources=function(){const t=k;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(D),k=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},t.getMaxParallelImageRequests=function(){return e.a.MAX_PARALLEL_IMAGE_REQUESTS},t.getRTLTextPluginStatus=function(){return at().getRTLTextPluginStatus()},t.getVersion=function(){return qr},t.getWorkerCount=function(){return P.workerCount},t.getWorkerUrl=function(){return e.a.WORKER_URL},t.importScriptInWorkers=function(t){return N().broadcast("IS",t)},t.prewarm=function(){F().acquire(D)},t.setMaxParallelImageRequests=function(t){e.a.MAX_PARALLEL_IMAGE_REQUESTS=t},t.setRTLTextPlugin=function(t,e){return at().setRTLTextPlugin(t,e)},t.setWorkerCount=function(t){P.workerCount=t},t.setWorkerUrl=function(t){e.a.WORKER_URL=t}})),t}()}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,n.nc=void 0,(()=>{"use strict";var t=n(5072),e=n.n(t),i=n(7825),r=n.n(i),a=n(7659),o=n.n(a),s=n(5056),l=n.n(s),c=n(540),u=n.n(c),h=n(1113),d=n.n(h),p=n(1719),m={};m.styleTagTransform=d(),m.setAttributes=l(),m.insert=o().bind(null,"head"),m.domAPI=r(),m.insertStyleElement=u(),e()(p.A,m),p.A&&p.A.locals&&p.A.locals;var f=n(1123),g={};g.styleTagTransform=d(),g.setAttributes=l(),g.insert=o().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=u(),e()(f.A,g),f.A&&f.A.locals&&f.A.locals;var v=n(7458),y={};y.styleTagTransform=d(),y.setAttributes=l(),y.insert=o().bind(null,"head"),y.domAPI=r(),y.insertStyleElement=u(),e()(v.A,y),v.A&&v.A.locals&&v.A.locals;var _=n(3927),x={};x.styleTagTransform=d(),x.setAttributes=l(),x.insert=o().bind(null,"head"),x.domAPI=r(),x.insertStyleElement=u(),e()(_.A,x),_.A&&_.A.locals&&_.A.locals;var b=n(9863),A={};A.styleTagTransform=d(),A.setAttributes=l(),A.insert=o().bind(null,"head"),A.domAPI=r(),A.insertStyleElement=u(),e()(b.A,A),b.A&&b.A.locals&&b.A.locals;var w=n(6745),C={};C.styleTagTransform=d(),C.setAttributes=l(),C.insert=o().bind(null,"head"),C.domAPI=r(),C.insertStyleElement=u(),e()(w.A,C),w.A&&w.A.locals&&w.A.locals;var E=n(6403),S={};S.styleTagTransform=d(),S.setAttributes=l(),S.insert=o().bind(null,"head"),S.domAPI=r(),S.insertStyleElement=u(),e()(E.A,S),E.A&&E.A.locals&&E.A.locals;var M=n(4224),T={};T.styleTagTransform=d(),T.setAttributes=l(),T.insert=o().bind(null,"head"),T.domAPI=r(),T.insertStyleElement=u(),e()(M.A,T),M.A&&M.A.locals&&M.A.locals;var I=n(1442),B={};B.styleTagTransform=d(),B.setAttributes=l(),B.insert=o().bind(null,"head"),B.domAPI=r(),B.insertStyleElement=u(),e()(I.A,B),I.A&&I.A.locals&&I.A.locals;var L=n(3516),D={};D.styleTagTransform=d(),D.setAttributes=l(),D.insert=o().bind(null,"head"),D.domAPI=r(),D.insertStyleElement=u(),e()(L.A,D),L.A&&L.A.locals&&L.A.locals;var P=n(3643),R={};R.styleTagTransform=d(),R.setAttributes=l(),R.insert=o().bind(null,"head"),R.domAPI=r(),R.insertStyleElement=u(),e()(P.A,R),P.A&&P.A.locals&&P.A.locals;var k=n(6153),z={};z.styleTagTransform=d(),z.setAttributes=l(),z.insert=o().bind(null,"head"),z.domAPI=r(),z.insertStyleElement=u(),e()(k.A,z),k.A&&k.A.locals&&k.A.locals;const F=(t,e)=>{localStorage.setItem(t,JSON.stringify(e))},O=t=>JSON.parse(localStorage.getItem(t));let N;function U(){return N||(null===O("savedLocations")?(N=[{city:"Melbourne",latitude:-37.8136276,longitude:144.9630576,locationId:"ChIJ90260rVG1moRkM2MIXVWBAQ"},{city:"Los Angeles",latitude:34.0549076,longitude:-118.242643,locationId:"ChIJE9on3F3HwoAR9AhGJW_fL-I"},{city:"Ljubljana",latitude:46.0569465,longitude:14.5057515,locationId:"ChIJ0YaYlvUxZUcRIOw_ghz4AAQ"}],F("savedLocations",N)):N=O("savedLocations")),{exists:t=>0!==N.length&&!!N.filter((e=>e.locationId===t)).length,add:(t,e,n,i)=>(N.push({city:t,latitude:e,longitude:n,locationId:i}),F("savedLocations",N)),remove:t=>(N.splice(t,1),F("savedLocations",N)),get:()=>O("savedLocations")}}var V=n(1133);function G(t,e=new Date){const n={timeZone:t,year:"numeric"},i={timeZone:t,month:"2-digit"},r={timeZone:t,day:"2-digit"},a={timeZone:t,hour:"numeric",minute:"numeric",second:"numeric",hour12:!1};let o=`${new Intl.DateTimeFormat([],n).format(e)}/${new Intl.DateTimeFormat([],i).format(e)}/${new Intl.DateTimeFormat([],r).format(e)}T${new Intl.DateTimeFormat([],a).format(e)}`;return o=new Date(Date.parse(o.replaceAll("/","-"))),o}const H=n(2543),j=async t=>{try{const e=await fetch(`https://api.geoapify.com/v1/geocode/search?text=${t}&format=json&apiKey=5304fcb38d6444b4bcdbe7ee4f12f2bd`,{mode:"cors"});return(await e.json()).results[0]}catch(t){return t}},W=async(t,e)=>{try{const n=await fetch(`https://api.geoapify.com/v1/geocode/reverse?lat=${t}&lon=${e}&format=json&apiKey=5304fcb38d6444b4bcdbe7ee4f12f2bd`,{mode:"cors"});return(await n.json()).results[0]}catch(t){return t}};async function q(t,e,n,i,r){const a={latitude:[...e],longitude:[...n],current:["temperature_2m","relative_humidity_2m","apparent_temperature","precipitation","weather_code","is_day","wind_speed_10m","wind_direction_10m","wind_gusts_10m","pressure_msl"],hourly:["temperature_2m","precipitation","weather_code","uv_index","is_day"],daily:["weather_code","temperature_2m_max","temperature_2m_min","uv_index_max"],timezone:"auto",past_days:7,forecast_days:14,forecast_hours:24,temperature_unit:0===r?"celsius":"fahrenheit"},o=await(0,V.fetchWeatherApi)("https://api.open-meteo.com/v1/forecast",a),s=[];return o.forEach(((r,a)=>{const o=r.timezone(),l=r.current(),c=r.hourly(),u=r.daily();s.push({location:{city:t[a],timezone:o,latitude:e[a],longitude:n[a],locationId:i[a]},current:{time:G(o,new Date),temperature2m:l.variables(0).value(),relativeHumidity2m:l.variables(1).value(),apparentTemperature:l.variables(2).value(),precipitation:l.variables(3).value(),weatherCode:l.variables(4).value(),isDay:l.variables(5).value(),windSpeed10m:l.variables(6).value(),windDirection10m:l.variables(7).value(),windGusts10m:l.variables(8).value(),pressureMsl:l.variables(9).value()},hourly:{time:H.range(Number(c.time()),Number(c.timeEnd()),c.interval()).map((t=>G(o,new Date(1e3*t)))),temperature2m:c.variables(0).valuesArray(),precipitation:c.variables(1).valuesArray(),weatherCode:c.variables(2).valuesArray(),uvIndex:c.variables(3).valuesArray(),isDay:c.variables(4).valuesArray()},daily:{time:H.range(Number(u.time()),Number(u.timeEnd()),u.interval()).map((t=>G(o,new Date(1e3*t)))),weatherCode:u.variables(0).valuesArray(),temperature2mMax:u.variables(1).valuesArray(),temperature2mMin:u.variables(2).valuesArray(),uvIndexMax:u.variables(3).valuesArray()}})})),s}function Z(t,e){const n=document.querySelector(":root"),i=getComputedStyle(n),r=document.createElement("div");r.classList.add("js-temp-bar");const a=document.createElement("div");let o,s;a.classList.add("js-bar"),t>=29?(o=29,s=40,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--90-perc")}, ${i.getPropertyValue("--100-perc")}`):t>=21?(o=21,e>33?(s=39,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--70-perc")}, ${i.getPropertyValue("--80-perc")}, ${i.getPropertyValue("--90-perc")}, ${i.getPropertyValue("--100-perc")}`):(s=33,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--70-perc")}, ${i.getPropertyValue("--80-perc")}, ${i.getPropertyValue("--90-perc")}`)):t>=10?(o=10,e>28?(s=32,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--50-perc")}, ${i.getPropertyValue("--60-perc")}, ${i.getPropertyValue("--70-perc")}, ${i.getPropertyValue("--80-perc")}, ${i.getPropertyValue("--90-perc")}`):(s=28,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--50-perc")}, ${i.getPropertyValue("--60-perc")}, ${i.getPropertyValue("--70-perc")}, ${i.getPropertyValue("--80-perc")}`)):t<=9?(o=0,e>15?(s=27,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--20-perc")}, ${i.getPropertyValue("--30-perc")}, ${i.getPropertyValue("--40-perc")}, ${i.getPropertyValue("--50-perc")}, ${i.getPropertyValue("--60-perc")}`):(s=15,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--20-perc")}, ${i.getPropertyValue("--30-perc")}, ${i.getPropertyValue("--40-perc")}, ${i.getPropertyValue("--50-perc")}`)):t<=-1&&(o=-15,e>0?(s=0,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--0-perc")}, ${i.getPropertyValue("--10-perc")}, ${i.getPropertyValue("--20-perc")}, ${i.getPropertyValue("--30-perc")}`):(s=-5,a.style.background=`linear-gradient(90deg, ${i.getPropertyValue("--0-perc")}, ${i.getPropertyValue("--10-perc")}, ${i.getPropertyValue("--20-perc")}`));const l=t<=o?0:Math.round(100*(t-o)/(s-o)),c=e>=s?0:Math.round(100-100*(e-o)/(s-o));return a.style.left=`${l}%`,a.style.right=`${c}%`,r.append(a),r}var $=n(2395),Y=n.n($),X=n(2589),Q={};Q.styleTagTransform=d(),Q.setAttributes=l(),Q.insert=o().bind(null,"head"),Q.domAPI=r(),Q.insertStyleElement=u(),e()(X.A,Q),X.A&&X.A.locals&&X.A.locals;var J=n(8896),K={};K.styleTagTransform=d(),K.setAttributes=l(),K.insert=o().bind(null,"head"),K.domAPI=r(),K.insertStyleElement=u(),e()(J.A,K),J.A&&J.A.locals&&J.A.locals;var tt=n(6443);const et="function"==typeof Buffer,nt=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=")),it=((t=>{let e={};t.forEach(((t,n)=>e[t]=n))})(nt),String.fromCharCode.bind(String)),rt=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,(t=>"+"==t?"-":"_"))),at="function"==typeof btoa?t=>btoa(t):et?t=>Buffer.from(t,"binary").toString("base64"):t=>{let e,n,i,r,a="";const o=t.length%3;for(let o=0;o<t.length;){if((n=t.charCodeAt(o++))>255||(i=t.charCodeAt(o++))>255||(r=t.charCodeAt(o++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|r,a+=nt[e>>18&63]+nt[e>>12&63]+nt[e>>6&63]+nt[63&e]}return o?a.slice(0,o-3)+"===".substring(o):a},ot=et?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,i=t.length;n<i;n+=4096)e.push(it.apply(null,t.subarray(n,n+4096)));return at(e.join(""))},st=(t,e=!1)=>e?rt(ot(t)):ot(t);var lt=n(7007);Map,Symbol.iterator,Symbol.toStringTag;const ct=new class{constructor(){this._apiKey="",this._fetch="undefined"!=typeof self?fetch.bind(self):"undefined"!=typeof global&&global.fetch?global.fetch:null,this.tileCacheSize=200}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}set fetch(t){this._fetch=t}get fetch(){return this._fetch}};new Set(Object.values({AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"}));const ut={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(ut);class ht extends Error{constructor(t,e=""){super(`Call to enpoint ${t.url} failed with the status code ${t.status}. ${e}`),this.res=t}}const dt={403:"Key is missing, invalid or restricted"},pt=async function(t={}){const e=new URL("geolocation/ip.json",ut.maptilerApiURL);e.searchParams.set("key",t.apiKey??ct.apiKey);const n=e.toString(),i=await async function(t,e={}){if(null===ct.fetch)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(""===new URL(t).searchParams.get("key").trim())throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return ct.fetch(t,e)}(n);if(!i.ok)throw new ht(i,i.status in dt?dt[i.status]:"");return await i.json()};function mt(t){let e;const n=t.trim();let i;return i=n.startsWith("http://")||n.startsWith("https://")?n:null!==(e=/^maptiler:\/\/(.*)/.exec(n))?`https://api.maptiler.com/maps/${e[1]}/style.json`:`https://api.maptiler.com/maps/${n}/style.json`,i}class ft{constructor(t,e,n,i,r,a){this.name=t,this.variantType=e,this.id=n,this.referenceStyle=i,this.description=r,this.imageURL=a}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(t){return this.referenceStyle.hasVariant(t)}getVariant(t){return this.referenceStyle.getVariant(t)}getVariants(){return this.referenceStyle.getVariants().filter((t=>t!==this))}getImageURL(){return this.imageURL}getExpandedStyleURL(){return mt(this.getId())}}class gt{constructor(t,e){this.name=t,this.id=e,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(t){this.variants[t.getType()]=t,this.orderedVariants.push(t)}hasVariant(t){return t in this.variants}getVariant(t){return t in this.variants?this.variants[t]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const vt=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function yt(t){return new Proxy(t,{get:(e,n,i)=>e.hasVariant(n)?e.getVariant(n):n.toString().toUpperCase()===n?t.getDefaultVariant():Reflect.get(e,n,i)})}const _t=function(){const t={};for(let e=0;e<vt.length;e+=1){const n=vt[e],i=yt(new gt(n.name,n.referenceStyleID));for(let t=0;t<n.variants.length;t+=1){const e=n.variants[t],r=new ft(e.name,e.variantType,e.id,i,e.description,e.imageURL);i.addVariant(r)}t[n.referenceStyleID]=i}return t}();Math.PI;const xt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let bt;const At=new Uint8Array(16);function wt(){if(!bt&&(bt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!bt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return bt(At)}const Ct=[];for(let t=0;t<256;++t)Ct.push((t+256).toString(16).slice(1));const Et={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},St=new Set(Object.values(Et));function Mt(t){return St.has(t)}const Tt=new Set(Object.values(Et));function It(){if("undefined"==typeof navigator)return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const t=Array.from(new Set(navigator.languages.map((t=>`name:${t.split("-")[0]}`)))).filter((t=>Tt.has(t)));return t.length?t[0]:Et.LOCAL}const Bt={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:Et.STYLE,secondaryLanguage:Et.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Bt);var Lt=Object.defineProperty,Dt=(t,e,n)=>(((t,e,n)=>{e in t?Lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);const Pt=function(t,e,n){if(xt.randomUUID&&!e&&!t)return xt.randomUUID();const i=(t=t||{}).random||(t.rng||wt)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(let t=0;t<16;++t)e[n+t]=i[t];return e}return function(t,e=0){return Ct[t[e+0]]+Ct[t[e+1]]+Ct[t[e+2]]+Ct[t[e+3]]+"-"+Ct[t[e+4]]+Ct[t[e+5]]+"-"+Ct[t[e+6]]+Ct[t[e+7]]+"-"+Ct[t[e+8]]+Ct[t[e+9]]+"-"+Ct[t[e+10]]+Ct[t[e+11]]+Ct[t[e+12]]+Ct[t[e+13]]+Ct[t[e+14]]+Ct[t[e+15]]}(i)}(),Rt=new class extends lt{constructor(){super(),Dt(this,"primaryLanguage",Bt.primaryLanguage),Dt(this,"secondaryLanguage"),Dt(this,"session",!0),Dt(this,"caching",!0),Dt(this,"_unit","metric"),Dt(this,"_apiKey","")}set unit(t){this._unit=t,this.emit("unit",t)}get unit(){return this._unit}set apiKey(t){this._apiKey=t,ct.apiKey=t,this.emit("apiKey",t)}get apiKey(){return this._apiKey}set fetch(t){ct.fetch=t}get fetch(){return ct.fetch}};class kt extends tt.LogoControl{onAdd(t){return super.onAdd(t)}}var zt=Object.defineProperty,Ft=(t,e,n)=>(((t,e,n)=>{e in t?zt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class Ot extends kt{constructor(t={}){var e,n;super(t),Ft(this,"logoURL",""),Ft(this,"linkURL",""),this.logoURL=null!=(e=t.logoURL)?e:Bt.maptilerLogoURL,this.linkURL=null!=(n=t.linkURL)?n:Bt.maptilerURL}onAdd(t){var e;this._map=t,this._compact=null!=(e=this.options.compact)&&e,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const n=window.document.createElement("a");return n.style.backgroundRepeat="no-repeat",n.style.cursor="pointer",n.style.display="block",n.style.height="23px",n.style.margin="0 0 -4px -4px",n.style.overflow="hidden",n.style.width="88px",n.style.backgroundImage=`url(${this.logoURL})`,n.style.backgroundSize="100px 30px",n.style.width="100px",n.style.height="30px",n.target="_blank",n.rel="noopener",n.href=this.linkURL,n.setAttribute("aria-label","MapTiler logo"),n.setAttribute("rel","noopener"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var Nt=(t,e,n)=>new Promise(((i,r)=>{var a=t=>{try{s(n.next(t))}catch(t){r(t)}},o=t=>{try{s(n.throw(t))}catch(t){r(t)}},s=t=>t.done?i(t.value):Promise.resolve(t.value).then(a,o);s((n=n.apply(t,e)).next())}));const Ut="localcache_source",Vt="localcache",Gt="maptiler_sdk";function Ht(t,e){if(Rt.caching&&Rt.session&&t.host===Bt.maptilerApiHost){if("Source"==e&&t.href.includes("tiles.json"))return t.href.replace("https://",`${Ut}://`);if("Tile"==e||"Glyphs"==e)return t.href.replace("https://",`${Vt}://`)}return t.href}let jt;function Wt(){return Nt(this,null,(function*(){return jt||(jt=yield caches.open(Gt)),jt}))}let qt=0;var Zt=Object.defineProperty,$t=Object.getOwnPropertySymbols,Yt=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,Qt=(t,e,n)=>e in t?Zt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jt=(t,e)=>{for(var n in e||(e={}))Yt.call(e,n)&&Qt(t,n,e[n]);if($t)for(var n of $t(e))Xt.call(e,n)&&Qt(t,n,e[n]);return t};function Kt(t,e,n){const i=window.document.createElement(t);return void 0!==e&&(i.className=e),n&&n.appendChild(i),i}function te(t){t.parentNode&&t.parentNode.removeChild(t)}function ee(t,e){let n=null;try{n=new URL(t)}catch(e){return{url:t}}return n.host===Bt.maptilerApiHost&&(n.searchParams.has("key")||n.searchParams.append("key",Rt.apiKey),Rt.session&&n.searchParams.append("mtsid",Pt)),{url:Ht(n,e)}}function ne(t){return function(e,n){var i;if(null!=t){const r=t(e,n),a=ee(null!=(i=null==r?void 0:r.url)?i:"",n);return Jt(Jt({},r),a)}return ee(e,n)}}function ie(t){return t?"string"==typeof t||t instanceof String?!t.startsWith("http")&&t.toLowerCase().includes(".json")?t:mt(t):t instanceof ft?t.getExpandedStyleURL():t instanceof gt?t.getDefaultVariant().getExpandedStyleURL():t:_t[vt[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}var re=Object.defineProperty,ae=(t,e,n)=>(((t,e,n)=>{e in t?re(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);class oe{constructor(){var t;ae(this,"_map"),ae(this,"_container"),ae(this,"_terrainButton"),t=this,["_toggleTerrain","_updateTerrainIcon"].forEach((e=>{"function"==typeof t[e]&&(t[e]=t[e].bind(t))}))}onAdd(t){return this._map=t,this._container=Kt("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Kt("button","maplibregl-ctrl-terrain",this._container),Kt("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){te(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class se extends tt.NavigationControl{onAdd(t){return super.onAdd(t)}}var le=Object.defineProperty;class ce extends se{constructor(){var t;super({showCompass:!0,showZoom:!0,visualizePitch:!0}),((t,e,n)=>{e in t?le(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(this,"symbol"!=typeof(t="_rotateCompassArrow")?t+"":t,(()=>{const t=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5))}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t})),this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",(t=>{0===this._map.getPitch()?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}))}_createButton(t,e){const n=super._createButton(t,e);return n.clickFunction=e,n}}class ue extends tt.GeolocateControl{onAdd(t){return super.onAdd(t)}}var he=Object.defineProperty,de=Object.defineProperties,pe=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertySymbols,fe=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable,ve=(t,e,n)=>e in t?he(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ye=(t,e,n)=>(ve(t,"symbol"!=typeof e?e+"":e,n),n);const _e=tt.Marker,xe=tt.LngLat,be=tt.LngLatBounds;class Ae extends ue{constructor(){super(...arguments),ye(this,"lastUpdatedCenter",new xe(0,0)),ye(this,"_updateCamera",(t=>{var e,n,i;const r=new xe(t.coords.longitude,t.coords.latitude),a=t.coords.accuracy,o=(l=((t,e)=>{for(var n in e||(e={}))fe.call(e,n)&&ve(t,n,e[n]);if(me)for(var n of me(e))ge.call(e,n)&&ve(t,n,e[n]);return t})({bearing:this._map.getBearing()},this.options.fitBoundsOptions),de(l,pe({linear:!0}))),s=this._map.getZoom();var l;s>(null!=(i=null==(n=null==(e=this.options)?void 0:e.fitBoundsOptions)?void 0:n.maxZoom)?i:30)&&(o.zoom=s),this._map.fitBounds(be.fromLngLat(r,a),o,{geolocateSource:!0});let c=!1;const u=()=>{c=!0};this._map.once("click",u),this._map.once("dblclick",u),this._map.once("dragstart",u),this._map.once("mousedown",u),this._map.once("touchstart",u),this._map.once("wheel",u),this._map.once("moveend",(()=>{this._map.off("click",u),this._map.off("dblclick",u),this._map.off("dragstart",u),this._map.off("mousedown",u),this._map.off("touchstart",u),this._map.off("wheel",u),c||(this.lastUpdatedCenter=this._map.getCenter())}))})),ye(this,"_setupUI",(t=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=Kt("button","maplibregl-ctrl-geolocate",this._container),Kt("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Kt("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new _e({element:this._dotElement}),this._circleElement=Kt("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new _e({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",(t=>{const e=t.originalEvent&&"resize"===t.originalEvent.type,n=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!t.geolocateSource&&"ACTIVE_LOCK"===this._watchState&&!e&&n>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))}))})),ye(this,"_onZoom",(()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}))}_updateCircleRadius(){if("BACKGROUND"!==this._watchState&&"ACTIVE_LOCK"!==this._watchState)return;const t=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],e=this._map.project(t),n=this._map.unproject([e.x,e.y]),i=this._map.unproject([e.x+20,e.y]),r=n.distanceTo(i)/20,a=Math.ceil(2*this._accuracy/r);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}}class we extends tt.ScaleControl{onAdd(t){return super.onAdd(t)}}class Ce extends tt.FullscreenControl{onAdd(t){return super.onAdd(t)}}var Ee,Se,Me,Te,Ie,Be,Le,De,Pe,Re,ke,ze,Fe,Oe=Object.defineProperty,Ne=Object.defineProperties,Ue=Object.getOwnPropertyDescriptors,Ve=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,je=(t,e,n)=>e in t?Oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,We=(t,e)=>{for(var n in e||(e={}))Ge.call(e,n)&&je(t,n,e[n]);if(Ve)for(var n of Ve(e))He.call(e,n)&&je(t,n,e[n]);return t},qe=(t,e)=>Ne(t,Ue(e)),Ze=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},$e=(t,e,n)=>(Ze(t,e,"read from private field"),n?n.call(t):e.get(t)),Ye=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Xe=(t,e,n,i)=>(Ze(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Qe=(t,e,n)=>(Ze(t,e,"access private method"),n);class Je{constructor(t,e){var n;Ye(this,De),Ye(this,Re),Ye(this,ze),Ye(this,Ee,void 0),je(this,"map",undefined),Ye(this,Se,void 0),Ye(this,Me,void 0),Ye(this,Te,void 0),Ye(this,Ie,void 0),Ye(this,Be,!1),Ye(this,Le,void 0),void 0!==t.style&&Xe(this,Be,!0),Xe(this,Ee,qe(We(qe(We({zoomAdjust:-4,position:"top-right"},e),{forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1}),t),{containerStyle:We({border:"1px solid #000",width:"400px",height:"300px"},null!=(n=t.containerStyle)?n:{})})),void 0!==t.lockZoom&&($e(this,Ee).minZoom=t.lockZoom,$e(this,Ee).maxZoom=t.lockZoom)}setStyle(t,e){$e(this,Be)||this.map.setStyle(t,e),Qe(this,Re,ke).call(this)}addLayer(t,e){return $e(this,Be)||this.map.addLayer(t,e),Qe(this,Re,ke).call(this),this.map}moveLayer(t,e){return $e(this,Be)||this.map.moveLayer(t,e),Qe(this,Re,ke).call(this),this.map}removeLayer(t){return $e(this,Be)||this.map.removeLayer(t),Qe(this,Re,ke).call(this),this}setLayerZoomRange(t,e,n){return $e(this,Be)||this.map.setLayerZoomRange(t,e,n),Qe(this,Re,ke).call(this),this}setFilter(t,e,n){return $e(this,Be)||this.map.setFilter(t,e,n),Qe(this,Re,ke).call(this),this}setPaintProperty(t,e,n,i){return $e(this,Be)||this.map.setPaintProperty(t,e,n,i),Qe(this,Re,ke).call(this),this}setLayoutProperty(t,e,n,i){return $e(this,Be)||this.map.setLayoutProperty(t,e,n,i),Qe(this,Re,ke).call(this),this}setGlyphs(t,e){return $e(this,Be)||this.map.setGlyphs(t,e),Qe(this,Re,ke).call(this),this}onAdd(t){Xe(this,Se,t),Xe(this,Me,Kt("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[t,e]of Object.entries($e(this,Ee).containerStyle))$e(this,Me).style.setProperty(t,e);return $e(this,Ee).container=$e(this,Me),$e(this,Ee).zoom=t.getZoom()+$e(this,Ee).zoomAdjust,this.map=new un($e(this,Ee)),this.map.once("style.load",(()=>{this.map.resize()})),this.map.once("load",(()=>{Qe(this,De,Pe).call(this,$e(this,Ee).parentRect),Xe(this,Le,Qe(this,ze,Fe).call(this))})),$e(this,Me)}onRemove(){var t;null==(t=$e(this,Le))||t.call(this),te($e(this,Me))}}Ee=new WeakMap,Se=new WeakMap,Me=new WeakMap,Te=new WeakMap,Ie=new WeakMap,Be=new WeakMap,Le=new WeakMap,De=new WeakSet,Pe=function(t){void 0===t||void 0===t.linePaint&&void 0===t.fillPaint||(Xe(this,Ie,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:$e(this,Ie)}),void 0===t.lineLayout&&void 0===t.linePaint||this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:We({},t.lineLayout),paint:We({"line-color":"#FFF","line-width":1,"line-opacity":.85},t.linePaint)}),void 0!==t.fillPaint&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:We({"fill-color":"#08F","fill-opacity":.135},t.fillPaint)}),Qe(this,Re,ke).call(this))},Re=new WeakSet,ke=function(){if(void 0===$e(this,Ie))return;const{devicePixelRatio:t}=window,e=$e(this,Se).getCanvas(),n=e.width/t,i=e.height/t,r=$e(this,Se).unproject.bind($e(this,Se)),a=r([0,0]),o=r([n,0]),s=r([0,i]),l=r([n,i]);$e(this,Ie).geometry.coordinates=[[s.toArray(),l.toArray(),o.toArray(),a.toArray(),s.toArray()]],this.map.getSource("parentRect").setData($e(this,Ie))},ze=new WeakSet,Fe=function(){const{pitchAdjust:t}=$e(this,Ee),e=()=>{a("parent")},n=()=>{a("minimap")},i=()=>{$e(this,Se).on("move",e),this.map.on("move",n)},r=()=>{$e(this,Se).off("move",e),this.map.off("move",n)},a=e=>{var n;r();const a="parent"===e?$e(this,Se):this.map,o="parent"===e?this.map:$e(this,Se),s=a.getCenter(),l=a.getZoom()+(null!=(n=$e(this,Ee).zoomAdjust)?n:-4)*("parent"===e?1:-1),c=a.getBearing(),u=a.getPitch();o.jumpTo({center:s,zoom:l,bearing:c,pitch:t?u:0}),Qe(this,Re,ke).call(this),i()};return i(),()=>{r()}};var Ke=Object.defineProperty,tn=Object.defineProperties,en=Object.getOwnPropertyDescriptors,nn=Object.getOwnPropertySymbols,rn=Object.prototype.hasOwnProperty,an=Object.prototype.propertyIsEnumerable,on=(t,e,n)=>e in t?Ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sn=(t,e)=>{for(var n in e||(e={}))rn.call(e,n)&&on(t,n,e[n]);if(nn)for(var n of nn(e))an.call(e,n)&&on(t,n,e[n]);return t},ln=(t,e,n)=>(on(t,"symbol"!=typeof e?e+"":e,n),n),cn=(t,e,n)=>new Promise(((i,r)=>{var a=t=>{try{s(n.next(t))}catch(t){r(t)}},o=t=>{try{s(n.throw(t))}catch(t){r(t)}},s=t=>t.done?i(t.value):Promise.resolve(t.value).then(a,o);s((n=n.apply(t,e)).next())}));class un extends tt.Map{constructor(t){var e,n,i;t.apiKey&&(Rt.apiKey=t.apiKey);const r=ie(t.style),a=location.hash;Rt.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let o={compact:!1};t.customAttribution?o.customAttribution=t.customAttribution:t.attributionControl&&"object"==typeof t.attributionControl&&(o=sn(sn({},o),t.attributionControl)),super(((t,e)=>tn(t,en(e)))(sn({},t),{style:r,maplibreLogo:!1,transformRequest:ne(t.transformRequest),attributionControl:!0!==t.forceNoAttributionControl&&o})),ln(this,"isTerrainEnabled",!1),ln(this,"terrainExaggeration",1),ln(this,"primaryLanguage"),ln(this,"terrainGrowing",!1),ln(this,"terrainFlattening",!1),ln(this,"minimap"),ln(this,"forceLanguageUpdate"),ln(this,"languageAlwaysBeenStyle"),ln(this,"isReady",!1),Rt.caching&&function(){Cn(Ut,((t,e)=>Nt(this,null,(function*(){if(!t.url)throw new Error("");t.url=t.url.replace(`${Ut}://`,"https://");const n=t;n.signal=e.signal;const i=yield fetch(t.url,n),r=yield i.json();return r.tiles&&r.tiles.length>0&&(r.tiles[0]+="&last-modified="+i.headers.get("Last-Modified")),{data:r,cacheControl:i.headers.get("Cache-Control"),expires:i.headers.get("Expires")}})))),Cn(Vt,((t,e)=>Nt(this,null,(function*(){if(!t.url)throw new Error("");t.url=t.url.replace(`${Vt}://`,"https://");const n=new URL(t.url),i=new URL(n);i.searchParams.delete("mtsid"),i.searchParams.delete("key");const r=i.toString(),a=new URL(n);a.searchParams.delete("last-modified");const o=a.toString(),s=t=>Nt(this,null,(function*(){return{data:yield t.arrayBuffer(),cacheControl:t.headers.get("Cache-Control"),expires:t.headers.get("Expires")}})),l=yield Wt(),c=yield l.match(r);if(c)return s(c);{const n=t;n.signal=e.signal;const i=yield fetch(o,n);return i.status>=200&&i.status<300&&(l.put(r,i.clone()).catch((()=>{})),++qt>100&&(function(){Nt(this,null,(function*(){const t=yield Wt(),e=yield t.keys(),n=e.slice(0,Math.max(e.length-1e3,0));for(const e of n)t.delete(e)}))}(),qt=0)),s(i)}}))))}(),this.primaryLanguage=null!=(e=t.language)?e:Rt.primaryLanguage,this.forceLanguageUpdate=this.primaryLanguage!==Et.STYLE&&this.primaryLanguage!==Et.STYLE_LOCK,this.languageAlwaysBeenStyle=this.primaryLanguage===Et.STYLE,this.terrainExaggeration=null!=(n=t.terrainExaggeration)?n:this.terrainExaggeration,this.once("styledata",(()=>cn(this,null,(function*(){if(!t.geolocate)return;if(t.center)return;if(t.hash&&a)return;try{if("COUNTRY"===t.geolocate)return void(yield this.fitToIpBounds())}catch(t){console.warn(t.message)}let e;try{yield this.centerOnIpPoint(t.zoom),e=this.getCameraHash()}catch(t){console.warn(t.message)}"granted"===(yield navigator.permissions.query({name:"geolocation"})).state&&navigator.geolocation.getCurrentPosition((n=>{e===this.getCameraHash()&&(this.terrain?this.easeTo({center:[n.coords.longitude,n.coords.latitude],zoom:t.zoom||12,duration:2e3}):this.once("terrain",(()=>{this.easeTo({center:[n.coords.longitude,n.coords.latitude],zoom:t.zoom||12,duration:2e3})})))}),null,{maximumAge:864e5,timeout:5e3,enableHighAccuracy:!1})})))),this.on("styledata",(()=>{this.setPrimaryLanguage(this.primaryLanguage)})),this.on("styledata",(()=>{null===this.getTerrain()&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)})),this.once("load",(()=>cn(this,null,(function*(){"unavailable"===tt.getRTLTextPluginStatus()&&tt.setRTLTextPlugin(Bt.rtlPluginURL,(t=>{t&&console.error(t)}),!0)})))),this.once("load",(()=>cn(this,null,(function*(){let e={logo:null};try{const t=Object.keys(this.style.sourceCaches).map((t=>this.getSource(t))).filter((t=>t&&"url"in t&&"string"==typeof t.url&&(null==t?void 0:t.url.includes("tiles.json")))),n=new URL(t[0].url);n.searchParams.has("key")||n.searchParams.append("key",Rt.apiKey);const i=yield fetch(n.href);e=yield i.json()}catch(t){}if(!0!==t.forceNoAttributionControl)if("logo"in e&&e.logo){const n=e.logo;this.addControl(new Ot({logoURL:n}),t.logoPosition)}else t.maptilerLogo&&this.addControl(new Ot,t.logoPosition);if(t.scaleControl){const e=!0===t.scaleControl||void 0===t.scaleControl?"bottom-right":t.scaleControl,n=new we({unit:Rt.unit});this.addControl(n,e),Rt.on("unit",(t=>{n.setUnit(t)}))}if(!1!==t.navigationControl){const e=!0===t.navigationControl||void 0===t.navigationControl?"top-right":t.navigationControl;this.addControl(new ce,e)}if(!1!==t.geolocateControl){const e=!0===t.geolocateControl||void 0===t.geolocateControl?"top-right":t.geolocateControl;this.addControl(new Ae({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),e)}if(t.terrainControl){const e=!0===t.terrainControl||void 0===t.terrainControl?"top-right":t.terrainControl;this.addControl(new oe,e)}if(t.fullscreenControl){const e=!0===t.fullscreenControl||void 0===t.fullscreenControl?"top-right":t.fullscreenControl;this.addControl(new Ce({}),e)}this.isReady=!0,this.fire("ready",{target:this})}))));let s,l=!1,c=!1;this.once("ready",(()=>{l=!0,c&&this.fire("loadWithTerrain",s)})),this.once("style.load",(()=>{var e;const{minimap:n}=t;if("object"==typeof n){const{zoom:i,center:r,style:a,language:o,apiKey:s,maptilerLogo:l,antialias:c,refreshExpiredTiles:u,maxBounds:h,scrollZoom:d,minZoom:p,maxZoom:m,boxZoom:f,locale:g,fadeDuration:v,crossSourceCollisions:y,clickTolerance:_,bounds:x,fitBoundsOptions:b,pixelRatio:A,validateStyle:w}=t;this.minimap=new Je(n,{zoom:i,center:r,style:a,language:o,apiKey:s,container:"null",maptilerLogo:l,antialias:c,refreshExpiredTiles:u,maxBounds:h,scrollZoom:d,minZoom:p,maxZoom:m,boxZoom:f,locale:g,fadeDuration:v,crossSourceCollisions:y,clickTolerance:_,bounds:x,fitBoundsOptions:b,pixelRatio:A,validateStyle:w}),this.addControl(this.minimap,null!=(e=n.position)?e:"bottom-left")}else!0===n?(this.minimap=new Je({},t),this.addControl(this.minimap,"bottom-left")):void 0!==n&&!1!==n&&(this.minimap=new Je({},t),this.addControl(this.minimap,n))}));const u=t=>{t.terrain&&(c=!0,s={type:"loadWithTerrain",target:this,terrain:t.terrain},this.off("terrain",u),l&&this.fire("loadWithTerrain",s))};this.on("terrain",u),t.terrain&&this.enableTerrain(null!=(i=t.terrainExaggeration)?i:this.terrainExaggeration)}onLoadAsync(){return cn(this,null,(function*(){return new Promise((t=>{if(this.loaded())return t(this);this.once("load",(()=>{t(this)}))}))}))}onReadyAsync(){return cn(this,null,(function*(){return new Promise((t=>{if(this.isReady)return t(this);this.once("ready",(()=>{t(this)}))}))}))}onLoadWithTerrainAsync(){return cn(this,null,(function*(){return new Promise((t=>{if(this.isReady&&this.terrain)return t(this);this.once("loadWithTerrain",(()=>{t(this)}))}))}))}setStyle(t,e){var n;return null==(n=this.minimap)||n.setStyle(t),this.forceLanguageUpdate=!0,this.once("idle",(()=>{this.forceLanguageUpdate=!1})),super.setStyle(ie(t),e)}addLayer(t,e){var n;return null==(n=this.minimap)||n.addLayer(t,e),super.addLayer(t,e)}moveLayer(t,e){var n;return null==(n=this.minimap)||n.moveLayer(t,e),super.moveLayer(t,e)}removeLayer(t){var e;return null==(e=this.minimap)||e.removeLayer(t),super.removeLayer(t)}setLayerZoomRange(t,e,n){var i;return null==(i=this.minimap)||i.setLayerZoomRange(t,e,n),super.setLayerZoomRange(t,e,n)}setFilter(t,e,n){var i;return null==(i=this.minimap)||i.setFilter(t,e,n),super.setFilter(t,e,n)}setPaintProperty(t,e,n,i){var r;return null==(r=this.minimap)||r.setPaintProperty(t,e,n,i),super.setPaintProperty(t,e,n,i)}setLayoutProperty(t,e,n,i){var r;return null==(r=this.minimap)||r.setLayoutProperty(t,e,n,i),super.setLayoutProperty(t,e,n,i)}setGlyphs(t,e){var n;return null==(n=this.minimap)||n.setGlyphs(t,e),super.setGlyphs(t,e)}getStyleLanguage(){return this.style.stylesheet.metadata?"object"!=typeof this.style.stylesheet.metadata?null:"maptiler:language"in this.style.stylesheet.metadata&&"string"==typeof this.style.stylesheet.metadata["maptiler:language"]?this.style.stylesheet.metadata["maptiler:language"]:null:null}setLanguage(t){var e,n;null==(n=null==(e=this.minimap)?void 0:e.map)||n.setLanguage(t),this.onStyleReady((()=>{this.setPrimaryLanguage(t)}))}setPrimaryLanguage(t){const e=this.getStyleLanguage();if(t!==Et.STYLE||e!==Et.AUTO&&e!==Et.VISITOR){if(t!==Et.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle)return;if(this.primaryLanguage===t&&!this.forceLanguageUpdate)return}if(!Mt(t))return void console.warn(`The language "${t}" is not supported.`);if(this.primaryLanguage===Et.STYLE_LOCK)return void console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");this.primaryLanguage=t;let n=t;if(t===Et.STYLE){if(!e)return void console.warn("The style has no default languages.");if(!Mt(e))return void console.warn("The language defined in the style is not valid.");n=e}let i=Et.LOCAL,r=`{${i}}`;n==Et.VISITOR?(i=It(),r=["case",["all",["has",i],["has",Et.LOCAL]],["case",["==",["get",i],["get",Et.LOCAL]],["get",Et.LOCAL],["format",["get",i],{"font-scale":.8},"\n",["get",Et.LOCAL],{"font-scale":1.1}]],["get",Et.LOCAL]]):n==Et.VISITOR_ENGLISH?(i=Et.ENGLISH,r=["case",["all",["has",i],["has",Et.LOCAL]],["case",["==",["get",i],["get",Et.LOCAL]],["get",Et.LOCAL],["format",["get",i],{"font-scale":.8},"\n",["get",Et.LOCAL],{"font-scale":1.1}]],["get",Et.LOCAL]]):n===Et.AUTO?(i=It(),r=["case",["has",i],["get",i],["get",Et.LOCAL]]):n===Et.LOCAL?(i=Et.LOCAL,r=`{${i}}`):(i=n,r=["case",["has",i],["get",i],["get",Et.LOCAL]]);const{layers:a}=this.getStyle();for(const t of a){if("symbol"!==t.type)continue;const e=t,n=this.getSource(e.source);if(!n)continue;if(!("url"in n)||"string"!=typeof n.url)continue;if(new URL(n.url).host!==Bt.maptilerApiHost)continue;const{id:i,layout:a}=e;if(!a)continue;if(!("text-field"in a))continue;const o=this.getLayoutProperty(i,"text-field");"string"==typeof o&&(o.toLowerCase().includes("ref")||o.toLowerCase().includes("housenumber"))||this.setLayoutProperty(i,"text-field",r)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(t,e=1e3){if(!this.terrain)return;const n=performance.now(),i=this.terrain.exaggeration,r=t-i,a=()=>{if(!this.terrain)return;if(this.terrainFlattening)return;const o=(performance.now()-n)/e;if(o<.99){const t=1-Math.pow(1-o,4),e=i+t*r;this.terrain.exaggeration=e,requestAnimationFrame(a)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=t;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(a)}enableTerrain(t=this.terrainExaggeration){if(t<0)return void console.warn("Terrain exaggeration cannot be negative.");const e=n=>cn(this,null,(function*(){this.terrain&&"data"===n.type&&"source"===n.dataType&&"source"in n&&"maptiler-terrain"===n.sourceId&&"raster-dem"===n.source.type&&n.isSourceLoaded&&(this.off("data",e),this.growTerrain(t))})),n=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=t,this.on("data",e),this.addSource(Bt.terrainSourceId,{type:"raster-dem",url:Bt.terrainSourceURL}),this.setTerrain({source:Bt.terrainSourceId,exaggeration:0})};if(this.getTerrain())return this.isTerrainEnabled=!0,void this.growTerrain(t);this.loaded()||this.isTerrainEnabled?n():this.once("load",(()=>{this.getTerrain()&&this.getSource(Bt.terrainSourceId)||n()}))}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=performance.now(),e=this.terrain.exaggeration,n=()=>{if(!this.terrain)return;if(this.terrainGrowing)return;const i=(performance.now()-t)/1e3;if(i<.99){const t=Math.pow(1-i,4),r=e*t;this.terrain.exaggeration=r,requestAnimationFrame(n)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Bt.terrainSourceId)&&this.removeSource(Bt.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(n)}setTerrainExaggeration(t,e=!0){!e&&this.terrain?(this.terrainExaggeration=t,this.terrain.exaggeration=t,this.triggerRepaint()):this.enableTerrain(t)}onStyleReady(t){this.isStyleLoaded()?t():this.once("styledata",(()=>{t()}))}fitToIpBounds(){return cn(this,null,(function*(){const t=yield pt();this.fitBounds(t.country_bounds,{duration:0,padding:100})}))}centerOnIpPoint(t){return cn(this,null,(function*(){var e,n;const i=yield pt();this.jumpTo({center:[null!=(e=null==i?void 0:i.longitude)?e:0,null!=(n=null==i?void 0:i.latitude)?n:0],zoom:t||11})}))}getCameraHash(){const t=new Float32Array(5),e=this.getCenter();return t[0]=e.lng,t[1]=e.lat,t[2]=this.getZoom(),t[3]=this.getPitch(),t[4]=this.getBearing(),st(new Uint8Array(t.buffer))}getSdkConfig(){return Rt}getMaptilerSessionId(){return Pt}setTransformRequest(t){return super.setTransformRequest(ne(t)),this}}tt.Marker,tt.Popup,tt.Style,tt.CanvasSource,tt.GeoJSONSource,tt.ImageSource,tt.RasterTileSource,tt.RasterDEMTileSource,tt.VectorTileSource,tt.VideoSource,tt.AttributionControl,tt.TerrainControl,tt.BoxZoomHandler,tt.ScrollZoomHandler,tt.CooperativeGesturesHandler,tt.KeyboardHandler,tt.TwoFingersTouchPitchHandler,tt.MapWheelEvent,tt.MapTouchEvent,tt.MapMouseEvent,Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var hn=Object.defineProperty,dn=(t,e,n)=>(((t,e,n)=>{e in t?hn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n);function pn(t){const e=t.toString(16);return 1==e.length?"0"+e:e}class mn extends Array{constructor(t={}){super(),dn(this,"min",0),dn(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(t){return new mn({stops:t.map((t=>({value:t[0],color:t[1]})))})}setStops(t,e={clone:!0}){const n=e.clone?this.clone():this;n.length=0;let i=1/0,r=-1/0;for(let e=0;e<t.length;e+=1)i=Math.min(i,t[e].value),r=Math.max(r,t[e].value),n.push({value:t[e].value,color:t[e].color.slice()});return n.sort(((t,e)=>t.value<e.value?-1:1)),this.min=i,this.max=r,n}scale(t,e,n={clone:!0}){const i=n.clone,r=this[0].value,a=this.at(-1).value-r,o=e-t,s=[];for(let e=0;e<this.length;e+=1){const n=(this[e].value-r)/a*o+t;i?s.push({value:n,color:this[e].color.slice()}):this[e].value=n}return i?new mn({stops:s}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new mn({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let e=0;e<this.length;e+=1)t.push({value:this[e].value,color:this[e].color});return t}reverse(t={clone:!0}){const e=t.clone?this.clone():this;for(let t=0;t<~~(e.length/2);t+=1){const n=e[t].color;e[t].color=e.at(-(t+1)).color,e.at(-(t+1)).color=n}return e}getBounds(){return{min:this.min,max:this.max}}getColor(t,e={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let n=0;n<this.length-1;n+=1){if(t>this[n+1].value)continue;const i=this[n].color;if(!e.smooth)return i.slice();const r=this[n].value,a=this[n+1].value,o=this[n+1].color,s=(a-t)/(a-r);return i.map(((t,e)=>Math.round(t*s+o[e]*(1-s))))}return[0,0,0]}getColorHex(t,e={smooth:!0,withAlpha:!1}){return"#"+pn((n=this.getColor(t,e))[0])+pn(n[1])+pn(n[2])+(4===n.length?pn(n[3]):"");var n}getColorRelative(t,e={smooth:!0}){const n=this.getBounds();return this.getColor(n.min+t*(n.max-n.min),e)}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const e=document.createElement("canvas");e.width=t.horizontal?t.size:1,e.height=t.horizontal?1:t.size;const n=e.getContext("2d");if(!n)throw new Error("Canvs context is missing");const i=n.getImageData(0,0,e.width,e.height),r=i.data,a=t.size,o=this[0].value,s=(this.at(-1).value-o)/a;for(let e=0;e<a;e+=1){const n=this.getColor(o+e*s,{smooth:t.smooth});r[4*e]=n[0],r[4*e+1]=n[1],r[4*e+2]=n[2],r[4*e+3]=n.length>3?n[3]:255}return n.putImageData(i,0,0),e}resample(t,e=15){const n=this.getBounds(),i=this.scale(0,1),r=1/(e-1);let a;if("ease-in-square"===t)a=Array.from({length:e},((t,e)=>{const n=e*r,a=Math.pow(n,2);return{value:n,color:i.getColor(a)}}));else if("ease-out-square"===t)a=Array.from({length:e},((t,e)=>{const n=e*r,a=1-Math.pow(1-n,2);return{value:n,color:i.getColor(a)}}));else if("ease-out-sqrt"===t)a=Array.from({length:e},((t,e)=>{const n=e*r,a=Math.pow(n,.5);return{value:n,color:i.getColor(a)}}));else if("ease-in-sqrt"===t)a=Array.from({length:e},((t,e)=>{const n=e*r,a=1-Math.pow(1-n,.5);return{value:n,color:i.getColor(a)}}));else if("ease-out-exp"===t)a=Array.from({length:e},((t,e)=>{const n=e*r,a=1-Math.pow(2,-10*n);return{value:n,color:i.getColor(a)}}));else{if("ease-in-exp"!==t)throw new Error("Invalid ressampling method.");a=Array.from({length:e},((t,e)=>{const n=e*r,a=Math.pow(2,10*n-10);return{value:n,color:i.getColor(a)}}))}return new mn({stops:a}).scale(n.min,n.max)}transparentStart(){const t=this.getRawColorStops();return t.unshift({value:t[0].value,color:t[0].color.slice()}),t[1].value+=.001,t.forEach((t=>{3===t.color.length&&t.color.push(255)})),t[0].color[3]=0,new mn({stops:t})}hasTransparentStart(){return 4===this[0].color.length&&0===this[0].color[3]}}new mn({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new mn({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new mn({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new mn({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new mn({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new mn({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new mn({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new mn({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new mn({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new mn({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new mn({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new mn({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new mn({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new mn({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new mn({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new mn({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new mn({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new mn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new mn({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new mn({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new mn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new mn({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new mn({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new mn({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new mn({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new mn({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new mn({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new mn({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new mn({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new mn({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new mn({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new mn({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new mn({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new mn({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new mn({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new mn({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new mn({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new mn({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new mn({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new mn({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new mn({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new mn({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]}),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const{setRTLTextPlugin:fn,getRTLTextPluginStatus:gn,LngLat:vn,LngLatBounds:yn,MercatorCoordinate:_n,Evented:xn,AJAXError:bn,prewarm:An,clearPrewarmedResources:wn,addProtocol:Cn,removeProtocol:En,Hash:Sn,Point:Mn,config:Tn,EdgeInsets:In,DragRotateHandler:Bn,DragPanHandler:Ln,TwoFingersTouchZoomRotateHandler:Dn,DoubleClickZoomHandler:Pn,TwoFingersTouchZoomHandler:Rn,TwoFingersTouchRotateHandler:kn,getWorkerCount:zn,setWorkerCount:Fn,getMaxParallelImageRequests:On,setMaxParallelImageRequests:Nn,getWorkerUrl:Un,setWorkerUrl:Vn,addSourceType:Gn,importScriptInWorkers:Hn}=tt;tt.Map,tt.Marker,tt.Popup,tt.Style,tt.CanvasSource,tt.GeoJSONSource,tt.ImageSource,tt.RasterTileSource,tt.RasterDEMTileSource,tt.VectorTileSource,tt.VideoSource,tt.NavigationControl,tt.GeolocateControl,tt.AttributionControl,tt.LogoControl,tt.ScaleControl,tt.FullscreenControl,tt.TerrainControl,tt.BoxZoomHandler,tt.ScrollZoomHandler,tt.CooperativeGesturesHandler,tt.KeyboardHandler,tt.TwoFingersTouchPitchHandler,tt.MapWheelEvent,tt.MapTouchEvent,tt.MapMouseEvent;const jn={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Wn(t,e){const n=t[0],i=t[1],r=t[2],a=t[3],o=e[0],s=e[1];let l=jn.UNKNOWN;return o<n?l|=jn.LEFT:o>r&&(l|=jn.RIGHT),s<i?l|=jn.BELOW:s>a&&(l|=jn.ABOVE),l===jn.UNKNOWN&&(l=jn.INTERSECTING),l}function qn(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function Zn(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function $n(t){let e=0;return function(t){return t[2]<t[0]||t[3]<t[1]}(t)||(e=Qn(t)*Yn(t)),e}function Yn(t){return t[3]-t[1]}function Xn(t,e,n){const i=n||[1/0,1/0,-1/0,-1/0];return Jn(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):function(t){qn(1/0,1/0,-1/0,-1/0,t)}(i),i}function Qn(t){return t[2]-t[0]}function Jn(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}class Kn{constructor(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function ti(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new Kn(t,e,n,i)}const ei=Kn,ni={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class ii extends Error{constructor(t){const e=ni[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const ri=ii;function ai(t,e){if(!t)throw new ri(e)}function oi(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function si(t,e){return Math.floor(oi(t,e))}function li(t,e){return Math.ceil(oi(t,e))}function ci(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function ui(t,e,n,i,r,a){let o=0,s=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];l<=a?i>a&&(n-s)*(a-l)-(r-s)*(i-l)>0&&o++:i<=a&&(n-s)*(a-l)-(r-s)*(i-l)<0&&o--,s=n,l=i}return 0!==o}function hi(t,e,n,i,r){const a=function(t,e,n,i,r){for(;n<i;n+=r)Zn(t,e[n],e[n+1]);return t}([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!Jn(r,a)&&(s=a,(o=r)[0]<=s[0]&&s[2]<=o[2]&&o[1]<=s[1]&&s[3]<=o[3]||a[0]>=r[0]&&a[2]<=r[2]||a[1]>=r[1]&&a[3]<=r[3]||function(t,e,n,i,a){let o;for(e+=i;e<n;e+=i)if(s=t.slice(e-i,e),l=t.slice(e,e+i),o=function(t,e,n){let i=!1;const r=Wn(t,e),a=Wn(t,n);if(r===jn.INTERSECTING||a===jn.INTERSECTING)i=!0;else{const o=t[0],s=t[1],l=t[2],c=t[3],u=e[0],h=e[1],d=n[0],p=n[1],m=(p-h)/(d-u);let f,g;a&jn.ABOVE&&!(r&jn.ABOVE)&&(f=d-(p-c)/m,i=f>=o&&f<=l),i||!(a&jn.RIGHT)||r&jn.RIGHT||(g=p-(d-l)*m,i=g>=s&&g<=c),i||!(a&jn.BELOW)||r&jn.BELOW||(f=d-(p-s)/m,i=f>=o&&f<=l),i||!(a&jn.LEFT)||r&jn.LEFT||(g=p-(d-o)*m,i=g>=s&&g<=c)}return i}(r,s,l),o)return o;var s,l;return!1}(t,e,n,i));var o,s}function di(t,e){return t>e?1:t<e?-1:0}function pi(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}const mi=[0,0,0],fi=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,ai(function(t,e,n){const i=function(t,e){return e-t}||di;return t.every((function(e,n){if(0===n)return!0;const r=i(t[n-1],e);return!(r>0||0===r)}))}(this.resolutions_),17),!t.origins)for(let t=0,n=this.resolutions_.length-1;t<n;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,ai(this.origins_.length==this.resolutions_.length,20));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=function(t){return[t[0],t[3]]}(n)),ai(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,ai(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,ai(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map((function(t,e){const i=new ei(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);i.minX=Math.max(t.minX,i.minX),i.maxX=Math.min(t.maxX,i.maxX),i.minY=Math.max(t.minY,i.minY),i.maxY=Math.min(t.maxY,i.maxY)}return i}),this):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const i=this.getTileRangeForExtentAndZ(t,e);for(let t=i.minX,r=i.maxX;t<=r;++t)for(let r=i.minY,a=i.maxY;r<=a;++r)n([e,t,r])}forEachTileCoordParentTileRange(t,e,n,i){let r,a,o,s=null,l=t[0]-1;for(2===this.zoomFactor_?(a=t[1],o=t[2]):s=this.getTileCoordExtent(t,i);l>=this.minZoom;){if(2===this.zoomFactor_?(a=Math.floor(a/2),o=Math.floor(o/2),r=ti(a,a,o,o,n)):r=this.getTileRangeForExtentAndZ(s,l,n),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const n=2*t[1],i=2*t[2];return ti(n,n+1,i,i+1,e)}const i=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const i=t[0],r=t[1],a=t[2];if(e===i)return ti(r,a,r,a,n);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-i),o=Math.floor(r*t),s=Math.floor(a*t);return e<i?ti(o,o,s,s,n):ti(o,Math.floor(t*(r+1))-1,s,Math.floor(t*(a+1))-1,n)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,mi);const i=mi[1],r=mi[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,mi),ti(i,mi[1],r,mi[2],n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=pi(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=pi(this.getTileSize(t[0]),this.tmpSize_),a=n[0]+t[1]*r[0]*i,o=n[1]-(t[2]+1)*r[1]*i;return qn(a,o,a+r[0]*i,o+r[1]*i,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,i,r){const a=this.getZForResolution(n),o=n/this.getResolution(a),s=this.getOrigin(a),l=pi(this.getTileSize(a),this.tmpSize_);let c=o*(t-s[0])/n/l[0],u=o*(s[1]-e)/n/l[1];return i?(c=li(c,5)-1,u=li(u,5)-1):(c=si(c,5),u=si(u,5)),ci(a,c,u,r)}getTileCoordForXYAndZ_(t,e,n,i,r){const a=this.getOrigin(n),o=this.getResolution(n),s=pi(this.getTileSize(n),this.tmpSize_);let l=(t-a[0])/o/s[0],c=(a[1]-e)/o/s[1];return i?(l=li(l,5)-1,c=li(c,5)-1):(l=si(l,5),c=si(c,5)),ci(n,l,c,r)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=function(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if("function"==typeof n){for(let r=1;r<i;++r){const i=t[r];if(i===e)return r;if(i<e)return n(e,t[r-1],i)>0?r-1:r}return i-1}if(n>0){for(let n=1;n<i;++n)if(t[n]<e)return n-1;return i-1}if(n<0){for(let n=1;n<i;++n)if(t[n]<=e)return n;return i-1}for(let n=1;n<i;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return i-1}(this.resolutions_,t,e||0);return i=n,r=this.minZoom,a=this.maxZoom,Math.min(Math.max(i,r),a);var i,r,a}tileCoordIntersectsViewport(t,e){return n=e,i=0,r=e.length,a=2,o=this.getTileCoordExtent(t),!!(hi(n,i,r,a,o)||ui(n,i,r,a,o[0],o[1])||ui(n,i,r,a,o[0],o[3])||ui(n,i,r,a,o[2],o[1])||ui(n,i,r,a,o[2],o[3]));var n,i,r,a,o}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}},gi={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},vi=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||gi[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},yi=6378137,_i=Math.PI*yi,xi=[-_i,-_i,_i,_i],bi=[-180,-85,180,85],Ai=yi*Math.log(Math.tan(Math.PI/2));class wi extends vi{constructor(t){super({code:t,units:"m",extent:xi,global:!0,worldExtent:bi,getPointResolution:function(t,e){return t/Math.cosh(e[1]/yi)}})}}const Ci=[new wi("EPSG:3857"),new wi("EPSG:102100"),new wi("EPSG:102113"),new wi("EPSG:900913"),new wi("http://www.opengis.net/def/crs/EPSG/0/3857"),new wi("http://www.opengis.net/gml/srs/epsg.xml#3857")];const Ei=[-180,-90,180,90],Si=6378137*Math.PI/180;class Mi extends vi{constructor(t,e){super({code:t,units:"degrees",extent:Ei,axisOrientation:e,global:!0,metersPerUnit:Si,worldExtent:Ei})}}const Ti=[new Mi("CRS:84"),new Mi("EPSG:4326","neu"),new Mi("urn:ogc:def:crs:OGC:1.3:CRS84"),new Mi("urn:ogc:def:crs:OGC:2:84"),new Mi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Mi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Mi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ii={},Bi={};function Li(t,e,n){const i=t.getCode(),r=e.getCode();i in Bi||(Bi[i]={}),Bi[i][r]=n}function Di(t,e){if(void 0!==e)for(let n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function Pi(t){!function(t,e){Ii[t]=e}(t.getCode(),t),Li(t,t,Di)}function Ri(t){!function(t){t.forEach(Pi)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Li(e,t,Di)}))}))}var ki,zi,Fi;function Oi(t,e,n,i){e=void 0!==e?e:42,n=pi(void 0!==n?n:256);const r=Yn(t),a=Qn(t);i=i>0?i:Math.max(a/n[0],r/n[1]);const o=e+1,s=new Array(o);for(let t=0;t<o;++t)s[t]=i/Math.pow(2,t);return s}Ri(Ci),Ri(Ti),ki=Ci,zi=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n){e[r]=_i*t[r]/180;let n=yi*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));n>Ai?n=Ai:n<-Ai&&(n=-Ai),e[r+1]=n}return e},Fi=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n)e[r]=180*t[r]/_i,e[r+1]=360*Math.atan(Math.exp(t[r+1]/yi))/Math.PI-90;return e},Ti.forEach((function(t){ki.forEach((function(e){Li(t,e,zi),Li(e,t,Fi)}))}));const Ni="135",Ui=0,Vi=1,Gi=2,Hi=1,ji=2,Wi=3,qi=0,Zi=1,$i=2,Yi=0,Xi=1,Qi=2,Ji=3,Ki=4,tr=5,er=100,nr=101,ir=102,rr=103,ar=104,or=200,sr=201,lr=202,cr=203,ur=204,hr=205,dr=206,pr=207,mr=208,fr=209,gr=210,vr=0,yr=1,_r=2,xr=3,br=4,Ar=5,wr=6,Cr=7,Er=0,Sr=1,Mr=2,Tr=0,Ir=1,Br=2,Lr=3,Dr=4,Pr=5,Rr=301,kr=302,zr=303,Fr=304,Or=306,Nr=307,Ur=1e3,Vr=1001,Gr=1002,Hr=1003,jr=1004,Wr=1005,qr=1006,Zr=1007,$r=1008,Yr=1009,Xr=1010,Qr=1011,Jr=1012,Kr=1013,ta=1014,ea=1015,na=1016,ia=1017,ra=1018,aa=1019,oa=1020,sa=1021,la=1022,ca=1023,ua=1024,ha=1025,da=ca,pa=1026,ma=1027,fa=1028,ga=1029,va=1030,ya=1031,_a=1032,xa=1033,ba=33776,Aa=33777,wa=33778,Ca=33779,Ea=35840,Sa=35841,Ma=35842,Ta=35843,Ia=36196,Ba=37492,La=37496,Da=37808,Pa=37809,Ra=37810,ka=37811,za=37812,Fa=37813,Oa=37814,Na=37815,Ua=37816,Va=37817,Ga=37818,Ha=37819,ja=37820,Wa=37821,qa=36492,Za=37840,$a=37841,Ya=37842,Xa=37843,Qa=37844,Ja=37845,Ka=37846,to=37847,eo=37848,no=37849,io=37850,ro=37851,ao=37852,oo=37853,so=2300,lo=2301,co=2302,uo=2400,ho=2401,po=2402,mo=3e3,fo=3001,go=3007,vo=3002,yo=3004,_o=3005,xo=3006,bo=3201,Ao=0,wo=1,Co=7680,Eo=35044,So=35048,Mo="300 es";class To{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const Io=[];for(let t=0;t<256;t++)Io[t]=(t<16?"0":"")+t.toString(16);const Bo=Math.PI/180,Lo=180/Math.PI;function Do(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Io[255&t]+Io[t>>8&255]+Io[t>>16&255]+Io[t>>24&255]+"-"+Io[255&e]+Io[e>>8&255]+"-"+Io[e>>16&15|64]+Io[e>>24&255]+"-"+Io[63&n|128]+Io[n>>8&255]+"-"+Io[n>>16&255]+Io[n>>24&255]+Io[255&i]+Io[i>>8&255]+Io[i>>16&255]+Io[i>>24&255]).toUpperCase()}function Po(t,e,n){return Math.max(e,Math.min(n,t))}function Ro(t,e,n){return(1-n)*t+n*e}function ko(t){return!(t&t-1)&&0!==t}function zo(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}class Fo{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*n-a*i+t.x,this.y=r*i+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Fo.prototype.isVector2=!0;class Oo{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,a,o,s,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=r,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],m=i[0],f=i[3],g=i[6],v=i[1],y=i[4],_=i[7],x=i[2],b=i[5],A=i[8];return r[0]=a*m+o*v+s*x,r[3]=a*f+o*y+s*b,r[6]=a*g+o*_+s*A,r[1]=l*m+c*v+u*x,r[4]=l*f+c*y+u*b,r[7]=l*g+c*_+u*A,r[2]=h*m+d*v+p*x,r[5]=h*f+d*y+p*b,r[8]=h*g+d*_+p*A,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8];return e*a*c-e*o*l-n*r*c+n*o*s+i*r*l-i*a*s}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=c*a-o*l,h=o*s-c*r,d=l*r-a*s,p=e*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return t[0]=u*m,t[1]=(i*l-c*n)*m,t[2]=(o*n-i*a)*m,t[3]=h*m,t[4]=(c*e-i*s)*m,t[5]=(i*r-o*e)*m,t[6]=d*m,t[7]=(n*s-l*e)*m,t[8]=(a*e-n*r)*m,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,a,o){const s=Math.cos(r),l=Math.sin(r);return this.set(n*s,n*l,-n*(s*a+l*o)+a+t,-i*l,i*s,-i*(-l*a+s*o)+o+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],c=i[7];return i[0]=e*r+n*s,i[3]=e*a+n*l,i[6]=e*o+n*c,i[1]=-n*r+e*s,i[4]=-n*a+e*l,i[7]=-n*o+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<9;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}function No(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}function Uo(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Vo(t,e=0){let n=3735928559^e,i=1103547991^e;for(let e,r=0;r<t.length;r++)e=t.charCodeAt(r),n=Math.imul(n^e,2654435761),i=Math.imul(i^e,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&i)+(n>>>0)}let Go;Oo.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;class Ho{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===Go&&(Go=Uo("canvas")),Go.width=t.width,Go.height=t.height;const n=Go.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Go}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let jo=0;class Wo extends To{constructor(t=Wo.DEFAULT_IMAGE,e=Wo.DEFAULT_MAPPING,n=Vr,i=Vr,r=qr,a=$r,o=ca,s=Yr,l=1,c=mo){super(),Object.defineProperty(this,"id",{value:jo++}),this.uuid=Do(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new Fo(0,0),this.repeat=new Fo(1,1),this.center=new Fo(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Oo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=Do()),!e&&void 0===t.images[i.uuid]){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(qo(i[t].image)):e.push(qo(i[t]))}else e=qo(i);t.images[i.uuid]={uuid:i.uuid,url:e}}n.image=i.uuid}return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ur:t.x=t.x-Math.floor(t.x);break;case Vr:t.x=t.x<0?0:1;break;case Gr:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ur:t.y=t.y-Math.floor(t.y);break;case Vr:t.y=t.y<0?0:1;break;case Gr:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function qo(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Ho.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Wo.DEFAULT_IMAGE=void 0,Wo.DEFAULT_MAPPING=300,Wo.prototype.isTexture=!0;class Zo{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*e+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*e+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*e+a[7]*n+a[11]*i+a[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const a=.01,o=.1,s=t.elements,l=s[0],c=s[4],u=s[8],h=s[1],d=s[5],p=s[9],m=s[2],f=s[6],g=s[10];if(Math.abs(c-h)<a&&Math.abs(u-m)<a&&Math.abs(p-f)<a){if(Math.abs(c+h)<o&&Math.abs(u+m)<o&&Math.abs(p+f)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,s=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+m)/4,x=(p+f)/4;return t>s&&t>v?t<a?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=y/n,r=_/n):s>v?s<a?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(s),n=y/i,r=x/i):v<a?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=_/r,i=x/r),this.set(n,i,r,e),this}let v=Math.sqrt((f-p)*(f-p)+(u-m)*(u-m)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(f-p)/v,this.y=(u-m)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Zo.prototype.isVector4=!0;class $o extends To{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new Zo(0,0,t,e),this.scissorTest=!1,this.viewport=new Zo(0,0,t,e),this.texture=new Wo(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:qr,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}$o.prototype.isWebGLRenderTarget=!0,class extends $o{constructor(t,e,n){super(t,e);const i=this.texture;this.texture=[];for(let t=0;t<n;t++)this.texture[t]=i.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class Yo extends $o{constructor(t,e,n={}){super(t,e,n),this.samples=4,this.ignoreDepthForMultisampleCopy=void 0===n.ignoreDepth||n.ignoreDepth,this.useRenderToTexture=void 0!==n.useRenderToTexture&&n.useRenderToTexture,this.useRenderbuffer=!1===this.useRenderToTexture}copy(t){return super.copy.call(this,t),this.samples=t.samples,this.useRenderToTexture=t.useRenderToTexture,this.useRenderbuffer=t.useRenderbuffer,this}}Yo.prototype.isWebGLMultisampleRenderTarget=!0;class Xo{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,a,o){let s=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[a+0],d=r[a+1],p=r[a+2],m=r[a+3];if(0===o)return t[e+0]=s,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===o)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=m);if(u!==m||s!==h||l!==d||c!==p){let t=1-o;const e=s*h+l*d+c*p+u*m,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),a=Math.atan2(r,e*n);t=Math.sin(t*a)/r,o=Math.sin(o*a)/r}const r=o*n;if(s=s*t+h*r,l=l*t+d*r,c=c*t+p*r,u=u*t+m*r,t===1-o){const t=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=t,l*=t,c*=t,u*=t}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,a){const o=n[i],s=n[i+1],l=n[i+2],c=n[i+3],u=r[a],h=r[a+1],d=r[a+2],p=r[a+3];return t[e]=o*p+c*u+s*d-l*h,t[e+1]=s*p+c*h+l*u-o*d,t[e+2]=l*p+c*d+o*h-s*u,t[e+3]=c*p-o*u-s*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,a=t._order,o=Math.cos,s=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=s(n/2),d=s(i/2),p=s(r/2);switch(a){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],a=e[1],o=e[5],s=e[9],l=e[2],c=e[6],u=e[10],h=n+o+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-s)*t,this._y=(r-l)*t,this._z=(a-i)*t}else if(n>o&&n>u){const t=2*Math.sqrt(1+n-o-u);this._w=(c-s)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(r+l)/t}else if(o>u){const t=2*Math.sqrt(1+o-n-u);this._w=(r-l)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(s+c)/t}else{const t=2*Math.sqrt(1+u-n-o);this._w=(a-i)/t,this._x=(r+l)/t,this._y=(s+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Po(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,a=t._w,o=e._x,s=e._y,l=e._z,c=e._w;return this._x=n*c+a*o+i*l-r*s,this._y=i*c+a*s+r*o-n*l,this._z=r*c+a*l+n*s-i*o,this._w=a*c-n*o-i*s-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,a=this._w;let o=a*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;const s=1-o*o;if(s<=Number.EPSILON){const t=1-e;return this._w=t*a+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(s),c=Math.atan2(l,o),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=a*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Xo.prototype.isQuaternion=!0;class Qo{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ko.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ko.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,a=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*a,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*i-o*n,c=s*n+o*e-r*i,u=s*i+r*n-a*e,h=-r*e-a*n-o*i;return this.x=l*s+h*-r+c*-o-u*-a,this.y=c*s+h*-a+u*-r-l*-o,this.z=u*s+h*-o+l*-a-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Jo.copy(this).projectOnVector(t),this.sub(Jo)}reflect(t){return this.sub(Jo.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Po(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Qo.prototype.isVector3=!0;const Jo=new Qo,Ko=new Xo;class ts{constructor(t=new Qo(1/0,1/0,1/0),e=new Qo(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=t.length;s<l;s+=3){const l=t[s],c=t[s+1],u=t[s+2];l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>a&&(a=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,a,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0;for(let s=0,l=t.count;s<l;s++){const l=t.getX(s),c=t.getY(s),u=t.getZ(s);l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>a&&(a=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,a,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=ns.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),is.copy(e.boundingBox),is.applyMatrix4(t.matrixWorld),this.union(is));const n=t.children;for(let t=0,e=n.length;t<e;t++)this.expandByObject(n[t]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,ns),ns.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(us),hs.subVectors(this.max,us),rs.subVectors(t.a,us),as.subVectors(t.b,us),os.subVectors(t.c,us),ss.subVectors(as,rs),ls.subVectors(os,as),cs.subVectors(rs,os);let e=[0,-ss.z,ss.y,0,-ls.z,ls.y,0,-cs.z,cs.y,ss.z,0,-ss.x,ls.z,0,-ls.x,cs.z,0,-cs.x,-ss.y,ss.x,0,-ls.y,ls.x,0,-cs.y,cs.x,0];return!!ms(e,rs,as,os,hs)&&(e=[1,0,0,0,1,0,0,0,1],!!ms(e,rs,as,os,hs)&&(ds.crossVectors(ss,ls),e=[ds.x,ds.y,ds.z],ms(e,rs,as,os,hs)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return ns.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(ns).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(es[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),es[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),es[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),es[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),es[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),es[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),es[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),es[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(es)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}ts.prototype.isBox3=!0;const es=[new Qo,new Qo,new Qo,new Qo,new Qo,new Qo,new Qo,new Qo],ns=new Qo,is=new ts,rs=new Qo,as=new Qo,os=new Qo,ss=new Qo,ls=new Qo,cs=new Qo,us=new Qo,hs=new Qo,ds=new Qo,ps=new Qo;function ms(t,e,n,i,r){for(let a=0,o=t.length-3;a<=o;a+=3){ps.fromArray(t,a);const o=r.x*Math.abs(ps.x)+r.y*Math.abs(ps.y)+r.z*Math.abs(ps.z),s=e.dot(ps),l=n.dot(ps),c=i.dot(ps);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}const fs=new ts,gs=new Qo,vs=new Qo,ys=new Qo;class _s{constructor(t=new Qo,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):fs.setFromPoints(t).getCenter(n);let i=0;for(let e=0,r=t.length;e<r;e++)i=Math.max(i,n.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){ys.subVectors(t,this.center);const e=ys.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(ys.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return vs.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(gs.copy(t.center).add(vs)),this.expandByPoint(gs.copy(t.center).sub(vs)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const xs=new Qo,bs=new Qo,As=new Qo,ws=new Qo,Cs=new Qo,Es=new Qo,Ss=new Qo;class Ms{constructor(t=new Qo,e=new Qo(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,xs)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=xs.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(xs.copy(this.direction).multiplyScalar(e).add(this.origin),xs.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){bs.copy(t).add(e).multiplyScalar(.5),As.copy(e).sub(t).normalize(),ws.copy(this.origin).sub(bs);const r=.5*t.distanceTo(e),a=-this.direction.dot(As),o=ws.dot(this.direction),s=-ws.dot(As),l=ws.lengthSq(),c=Math.abs(1-a*a);let u,h,d,p;if(c>0)if(u=a*s-o,h=a*o-s,p=r*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+a*h+2*o)+h*(a*u+h+2*s)+l}else h=r,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;else h=-r,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;else h<=-p?(u=Math.max(0,-(-a*r+o)),h=u>0?-r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-s),r),d=h*(h+2*s)+l):(u=Math.max(0,-(a*r+o)),h=u>0?r:Math.min(Math.max(-r,-s),r),d=-u*u+h*(h+2*s)+l);else h=a>0?-r:r,u=Math.max(0,-(a*h+o)),d=-u*u+h*(h+2*s)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(As).multiplyScalar(h).add(bs),d}intersectSphere(t,e){xs.subVectors(t.center,this.origin);const n=xs.dot(this.direction),i=xs.dot(xs)-n*n,r=t.radius*t.radius;if(i>r)return null;const a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,a,o,s;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,a=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,a=(t.min.y-h.y)*c),n>a||r>i?null:((r>n||n!=n)&&(n=r),(a<i||i!=i)&&(i=a),u>=0?(o=(t.min.z-h.z)*u,s=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,s=(t.min.z-h.z)*u),n>s||o>i?null:((o>n||n!=n)&&(n=o),(s<i||i!=i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,xs)}intersectTriangle(t,e,n,i,r){Cs.subVectors(e,t),Es.subVectors(n,t),Ss.crossVectors(Cs,Es);let a,o=this.direction.dot(Ss);if(o>0){if(i)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ws.subVectors(this.origin,t);const s=a*this.direction.dot(Es.crossVectors(ws,Es));if(s<0)return null;const l=a*this.direction.dot(Cs.cross(ws));if(l<0)return null;if(s+l>o)return null;const c=-a*ws.dot(Ss);return c<0?null:this.at(c/o,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ts{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,a,o,s,l,c,u,h,d,p,m,f){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ts).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Is.setFromMatrixColumn(t,0).length(),r=1/Is.setFromMatrixColumn(t,1).length(),a=1/Is.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,r=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=a*c,n=a*u,i=o*c,r=o*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-o*s,e[2]=r-t*l,e[6]=i+n*l,e[10]=a*s}else if("YXZ"===t.order){const t=s*c,n=s*u,i=l*c,r=l*u;e[0]=t+r*o,e[4]=i*o-n,e[8]=a*l,e[1]=a*u,e[5]=a*c,e[9]=-o,e[2]=n*o-i,e[6]=r+t*o,e[10]=a*s}else if("ZXY"===t.order){const t=s*c,n=s*u,i=l*c,r=l*u;e[0]=t-r*o,e[4]=-a*u,e[8]=i+n*o,e[1]=n+i*o,e[5]=a*c,e[9]=r-t*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){const t=a*c,n=a*u,i=o*c,r=o*u;e[0]=s*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=s*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){const t=a*s,n=a*l,i=o*s,r=o*l;e[0]=s*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=a*c,e[9]=-o*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=a*s,n=a*l,i=o*s,r=o*l;e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=a*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=o*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Ls,t,Ds)}lookAt(t,e,n){const i=this.elements;return ks.subVectors(t,e),0===ks.lengthSq()&&(ks.z=1),ks.normalize(),Ps.crossVectors(n,ks),0===Ps.lengthSq()&&(1===Math.abs(n.z)?ks.x+=1e-4:ks.z+=1e-4,ks.normalize(),Ps.crossVectors(n,ks)),Ps.normalize(),Rs.crossVectors(ks,Ps),i[0]=Ps.x,i[4]=Rs.x,i[8]=ks.x,i[1]=Ps.y,i[5]=Rs.y,i[9]=ks.y,i[2]=Ps.z,i[6]=Rs.z,i[10]=ks.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],m=n[6],f=n[10],g=n[14],v=n[3],y=n[7],_=n[11],x=n[15],b=i[0],A=i[4],w=i[8],C=i[12],E=i[1],S=i[5],M=i[9],T=i[13],I=i[2],B=i[6],L=i[10],D=i[14],P=i[3],R=i[7],k=i[11],z=i[15];return r[0]=a*b+o*E+s*I+l*P,r[4]=a*A+o*S+s*B+l*R,r[8]=a*w+o*M+s*L+l*k,r[12]=a*C+o*T+s*D+l*z,r[1]=c*b+u*E+h*I+d*P,r[5]=c*A+u*S+h*B+d*R,r[9]=c*w+u*M+h*L+d*k,r[13]=c*C+u*T+h*D+d*z,r[2]=p*b+m*E+f*I+g*P,r[6]=p*A+m*S+f*B+g*R,r[10]=p*w+m*M+f*L+g*k,r[14]=p*C+m*T+f*D+g*z,r[3]=v*b+y*E+_*I+x*P,r[7]=v*A+y*S+_*B+x*R,r[11]=v*w+y*M+_*L+x*k,r[15]=v*C+y*T+_*D+x*z,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],a=t[1],o=t[5],s=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*s*u-i*l*u-r*o*h+n*l*h+i*o*d-n*s*d)+t[7]*(+e*s*d-e*l*h+r*a*h-i*a*d+i*l*c-r*s*c)+t[11]*(+e*l*u-e*o*d-r*a*u+n*a*d+r*o*c-n*l*c)+t[15]*(-i*o*c-e*s*u+e*o*h+i*a*u-n*a*h+n*s*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],m=t[13],f=t[14],g=t[15],v=u*f*l-m*h*l+m*s*d-o*f*d-u*s*g+o*h*g,y=p*h*l-c*f*l-p*s*d+a*f*d+c*s*g-a*h*g,_=c*m*l-p*u*l+p*o*d-a*m*d-c*o*g+a*u*g,x=p*u*s-c*m*s-p*o*h+a*m*h+c*o*f-a*u*f,b=e*v+n*y+i*_+r*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const A=1/b;return t[0]=v*A,t[1]=(m*h*r-u*f*r-m*i*d+n*f*d+u*i*g-n*h*g)*A,t[2]=(o*f*r-m*s*r+m*i*l-n*f*l-o*i*g+n*s*g)*A,t[3]=(u*s*r-o*h*r-u*i*l+n*h*l+o*i*d-n*s*d)*A,t[4]=y*A,t[5]=(c*f*r-p*h*r+p*i*d-e*f*d-c*i*g+e*h*g)*A,t[6]=(p*s*r-a*f*r-p*i*l+e*f*l+a*i*g-e*s*g)*A,t[7]=(a*h*r-c*s*r+c*i*l-e*h*l-a*i*d+e*s*d)*A,t[8]=_*A,t[9]=(p*u*r-c*m*r-p*n*d+e*m*d+c*n*g-e*u*g)*A,t[10]=(a*m*r-p*o*r+p*n*l-e*m*l-a*n*g+e*o*g)*A,t[11]=(c*o*r-a*u*r-c*n*l+e*u*l+a*n*d-e*o*d)*A,t[12]=x*A,t[13]=(c*m*i-p*u*i+p*n*h-e*m*h-c*n*f+e*u*f)*A,t[14]=(p*o*i-a*m*i-p*n*s+e*m*s+a*n*f-e*o*f)*A,t[15]=(a*u*i-c*o*i+c*n*s-e*u*s-a*n*h+e*o*h)*A,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,a=t.x,o=t.y,s=t.z,l=r*a,c=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,c*o+n,c*s-i*a,0,l*s-i*o,c*s+i*a,r*s*s+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,a){return this.set(1,n,r,0,t,1,a,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,l=r+r,c=a+a,u=o+o,h=r*l,d=r*c,p=r*u,m=a*c,f=a*u,g=o*u,v=s*l,y=s*c,_=s*u,x=n.x,b=n.y,A=n.z;return i[0]=(1-(m+g))*x,i[1]=(d+_)*x,i[2]=(p-y)*x,i[3]=0,i[4]=(d-_)*b,i[5]=(1-(h+g))*b,i[6]=(f+v)*b,i[7]=0,i[8]=(p+y)*A,i[9]=(f-v)*A,i[10]=(1-(h+m))*A,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=Is.set(i[0],i[1],i[2]).length();const a=Is.set(i[4],i[5],i[6]).length(),o=Is.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Bs.copy(this);const s=1/r,l=1/a,c=1/o;return Bs.elements[0]*=s,Bs.elements[1]*=s,Bs.elements[2]*=s,Bs.elements[4]*=l,Bs.elements[5]*=l,Bs.elements[6]*=l,Bs.elements[8]*=c,Bs.elements[9]*=c,Bs.elements[10]*=c,e.setFromRotationMatrix(Bs),n.x=r,n.y=a,n.z=o,this}makePerspective(t,e,n,i,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,s=2*r/(e-t),l=2*r/(n-i),c=(e+t)/(e-t),u=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,i,r,a){const o=this.elements,s=1/(e-t),l=1/(n-i),c=1/(a-r),u=(e+t)*s,h=(n+i)*l,d=(a+r)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let t=0;t<16;t++)if(e[t]!==n[t])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}Ts.prototype.isMatrix4=!0;const Is=new Qo,Bs=new Ts,Ls=new Qo(0,0,0),Ds=new Qo(1,1,1),Ps=new Qo,Rs=new Qo,ks=new Qo,zs=new Ts,Fs=new Xo;class Os{constructor(t=0,e=0,n=0,i=Os.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],a=i[4],o=i[8],s=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Po(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Po(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Po(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-Po(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Po(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Po(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return zs.makeRotationFromQuaternion(t),this.setFromRotationMatrix(zs,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Fs.setFromEuler(this),this.setFromQuaternion(Fs,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new Qo(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Os.prototype.isEuler=!0,Os.DefaultOrder="XYZ",Os.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Ns{constructor(){this.mask=1}set(t){this.mask=1<<t>>>0}enable(t){this.mask|=1<<t}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t}disable(t){this.mask&=~(1<<t)}disableAll(){this.mask=0}test(t){return!!(this.mask&t.mask)}isEnabled(t){return!!(this.mask&1<<t)}}let Us=0;const Vs=new Qo,Gs=new Xo,Hs=new Ts,js=new Qo,Ws=new Qo,qs=new Qo,Zs=new Xo,$s=new Qo(1,0,0),Ys=new Qo(0,1,0),Xs=new Qo(0,0,1),Qs={type:"added"},Js={type:"removed"};class Ks extends To{constructor(){super(),Object.defineProperty(this,"id",{value:Us++}),this.uuid=Do(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ks.DefaultUp.clone();const t=new Qo,e=new Os,n=new Xo,i=new Qo(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ts},normalMatrix:{value:new Oo}}),this.matrix=new Ts,this.matrixWorld=new Ts,this.matrixAutoUpdate=Ks.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ns,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Gs.setFromAxisAngle(t,e),this.quaternion.multiply(Gs),this}rotateOnWorldAxis(t,e){return Gs.setFromAxisAngle(t,e),this.quaternion.premultiply(Gs),this}rotateX(t){return this.rotateOnAxis($s,t)}rotateY(t){return this.rotateOnAxis(Ys,t)}rotateZ(t){return this.rotateOnAxis(Xs,t)}translateOnAxis(t,e){return Vs.copy(t).applyQuaternion(this.quaternion),this.position.add(Vs.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis($s,t)}translateY(t){return this.translateOnAxis(Ys,t)}translateZ(t){return this.translateOnAxis(Xs,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Hs.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?js.copy(t):js.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ws.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Hs.lookAt(Ws,js,this.up):Hs.lookAt(js,Ws,this.up),this.quaternion.setFromRotationMatrix(Hs),i&&(Hs.extractRotation(i.matrixWorld),Gs.setFromRotationMatrix(Hs),this.quaternion.premultiply(Gs.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Qs)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Js)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(Js)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Hs.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Hs.multiply(t.parent.matrixWorld)),t.applyMatrix4(Hs),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ws,t,qs),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ws,Zs,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=a(t.geometries),i=a(t.materials),r=a(t.textures),o=a(t.images),s=a(t.shapes),l=a(t.skeletons),c=a(t.animations);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),s.length>0&&(n.shapes=s),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=i,n;function a(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const n=t.children[e];this.add(n.clone())}return this}}Ks.DefaultUp=new Qo(0,1,0),Ks.DefaultMatrixAutoUpdate=!0,Ks.prototype.isObject3D=!0;const tl=new Qo,el=new Qo,nl=new Qo,il=new Qo,rl=new Qo,al=new Qo,ol=new Qo,sl=new Qo,ll=new Qo,cl=new Qo;class ul{constructor(t=new Qo,e=new Qo,n=new Qo){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),tl.subVectors(t,e),i.cross(tl);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){tl.subVectors(i,e),el.subVectors(n,e),nl.subVectors(t,e);const a=tl.dot(tl),o=tl.dot(el),s=tl.dot(nl),l=el.dot(el),c=el.dot(nl),u=a*l-o*o;if(0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*s-o*c)*h,p=(a*c-o*s)*h;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,il),il.x>=0&&il.y>=0&&il.x+il.y<=1}static getUV(t,e,n,i,r,a,o,s){return this.getBarycoord(t,e,n,i,il),s.set(0,0),s.addScaledVector(r,il.x),s.addScaledVector(a,il.y),s.addScaledVector(o,il.z),s}static isFrontFacing(t,e,n,i){return tl.subVectors(n,e),el.subVectors(t,e),tl.cross(el).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return tl.subVectors(this.c,this.b),el.subVectors(this.a,this.b),.5*tl.cross(el).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ul.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return ul.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return ul.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return ul.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ul.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let a,o;rl.subVectors(i,n),al.subVectors(r,n),sl.subVectors(t,n);const s=rl.dot(sl),l=al.dot(sl);if(s<=0&&l<=0)return e.copy(n);ll.subVectors(t,i);const c=rl.dot(ll),u=al.dot(ll);if(c>=0&&u<=c)return e.copy(i);const h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return a=s/(s-c),e.copy(n).addScaledVector(rl,a);cl.subVectors(t,r);const d=rl.dot(cl),p=al.dot(cl);if(p>=0&&d<=p)return e.copy(r);const m=d*l-s*p;if(m<=0&&l>=0&&p<=0)return o=l/(l-p),e.copy(n).addScaledVector(al,o);const f=c*p-d*u;if(f<=0&&u-c>=0&&d-p>=0)return ol.subVectors(r,i),o=(u-c)/(u-c+(d-p)),e.copy(i).addScaledVector(ol,o);const g=1/(f+m+h);return a=m*g,o=h*g,e.copy(n).addScaledVector(rl,a).addScaledVector(al,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let hl=0;class dl extends To{constructor(){super(),Object.defineProperty(this,"id",{value:hl++}),this.uuid=Do(),this.name="",this.type="Material",this.fog=!0,this.blending=Xi,this.side=qi,this.vertexColors=!1,this.opacity=1,this.format=ca,this.transparent=!1,this.blendSrc=ur,this.blendDst=hr,this.blendEquation=er,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=xr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Co,this.stencilZFail=Co,this.stencilZPass=Co,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Xi&&(n.blending=this.blending),this.side!==qi&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.format!==ca&&(n.format=this.format),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.format=t.format,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}dl.prototype.isMaterial=!0;const pl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ml={h:0,s:0,l:0},fl={h:0,s:0,l:0};function gl(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function vl(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function yl(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class _l{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=function(t,e){return(t%e+e)%e}(t,1),e=Po(e,0,1),n=Po(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=gl(r,i,t+1/3),this.g=gl(r,i,t),this.b=gl(r,i,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=n[1],r=n[2];switch(i){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const n=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,i,r)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=pl[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=vl(t.r),this.g=vl(t.g),this.b=vl(t.b),this}copyLinearToSRGB(t){return this.r=yl(t.r),this.g=yl(t.g),this.b=yl(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),a=Math.min(e,n,i);let o,s;const l=(a+r)/2;if(a===r)o=0,s=0;else{const t=r-a;switch(s=l<=.5?t/(r+a):t/(2-r-a),r){case e:o=(n-i)/t+(n<i?6:0);break;case n:o=(i-e)/t+2;break;case i:o=(e-n)/t+4}o/=6}return t.h=o,t.s=s,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(ml),ml.h+=t,ml.s+=e,ml.l+=n,this.setHSL(ml.h,ml.s,ml.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(ml),t.getHSL(fl);const n=Ro(ml.h,fl.h,e),i=Ro(ml.s,fl.s,e),r=Ro(ml.l,fl.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}_l.NAMES=pl,_l.prototype.isColor=!0,_l.prototype.r=1,_l.prototype.g=1,_l.prototype.b=1;class xl extends dl{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new _l(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Er,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}xl.prototype.isMeshBasicMaterial=!0;const bl=new Qo,Al=new Fo;class wl{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Eo,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new _l),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new Fo),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new Qo),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new Zo),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Al.fromBufferAttribute(this,e),Al.applyMatrix3(t),this.setXY(e,Al.x,Al.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)bl.fromBufferAttribute(this,e),bl.applyMatrix3(t),this.setXYZ(e,bl.x,bl.y,bl.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)bl.x=this.getX(e),bl.y=this.getY(e),bl.z=this.getZ(e),bl.applyMatrix4(t),this.setXYZ(e,bl.x,bl.y,bl.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)bl.x=this.getX(e),bl.y=this.getY(e),bl.z=this.getZ(e),bl.applyNormalMatrix(t),this.setXYZ(e,bl.x,bl.y,bl.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)bl.x=this.getX(e),bl.y=this.getY(e),bl.z=this.getZ(e),bl.transformDirection(t),this.setXYZ(e,bl.x,bl.y,bl.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Eo&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}wl.prototype.isBufferAttribute=!0;class Cl extends wl{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class El extends wl{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends wl{constructor(t,e,n){super(new Uint16Array(t),e,n)}}).prototype.isFloat16BufferAttribute=!0;class Sl extends wl{constructor(t,e,n){super(new Float32Array(t),e,n)}}let Ml=0;const Tl=new Ts,Il=new Ks,Bl=new Qo,Ll=new ts,Dl=new ts,Pl=new Qo;class Rl extends To{constructor(){super(),Object.defineProperty(this,"id",{value:Ml++}),this.uuid=Do(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(No(t)>65535?El:Cl)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Oo).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Tl.makeRotationFromQuaternion(t),this.applyMatrix4(Tl),this}rotateX(t){return Tl.makeRotationX(t),this.applyMatrix4(Tl),this}rotateY(t){return Tl.makeRotationY(t),this.applyMatrix4(Tl),this}rotateZ(t){return Tl.makeRotationZ(t),this.applyMatrix4(Tl),this}translate(t,e,n){return Tl.makeTranslation(t,e,n),this.applyMatrix4(Tl),this}scale(t,e,n){return Tl.makeScale(t,e,n),this.applyMatrix4(Tl),this}lookAt(t){return Il.lookAt(t),Il.updateMatrix(),this.applyMatrix4(Il.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Bl).negate(),this.translate(Bl.x,Bl.y,Bl.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Sl(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ts);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Qo(-1/0,-1/0,-1/0),new Qo(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Ll.setFromBufferAttribute(n),this.morphTargetsRelative?(Pl.addVectors(this.boundingBox.min,Ll.min),this.boundingBox.expandByPoint(Pl),Pl.addVectors(this.boundingBox.max,Ll.max),this.boundingBox.expandByPoint(Pl)):(this.boundingBox.expandByPoint(Ll.min),this.boundingBox.expandByPoint(Ll.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new _s);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Qo,1/0);if(t){const n=this.boundingSphere.center;if(Ll.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Dl.setFromBufferAttribute(n),this.morphTargetsRelative?(Pl.addVectors(Ll.min,Dl.min),Ll.expandByPoint(Pl),Pl.addVectors(Ll.max,Dl.max),Ll.expandByPoint(Pl)):(Ll.expandByPoint(Dl.min),Ll.expandByPoint(Dl.max))}Ll.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)Pl.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(Pl));if(e)for(let r=0,a=e.length;r<a;r++){const a=e[r],o=this.morphTargetsRelative;for(let e=0,r=a.count;e<r;e++)Pl.fromBufferAttribute(a,e),o&&(Bl.fromBufferAttribute(t,e),Pl.add(Bl)),i=Math.max(i,n.distanceToSquared(Pl))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,i=e.position.array,r=e.normal.array,a=e.uv.array,o=i.length/3;void 0===e.tangent&&this.setAttribute("tangent",new wl(new Float32Array(4*o),4));const s=e.tangent.array,l=[],c=[];for(let t=0;t<o;t++)l[t]=new Qo,c[t]=new Qo;const u=new Qo,h=new Qo,d=new Qo,p=new Fo,m=new Fo,f=new Fo,g=new Qo,v=new Qo;function y(t,e,n){u.fromArray(i,3*t),h.fromArray(i,3*e),d.fromArray(i,3*n),p.fromArray(a,2*t),m.fromArray(a,2*e),f.fromArray(a,2*n),h.sub(u),d.sub(u),m.sub(p),f.sub(p);const r=1/(m.x*f.y-f.x*m.y);isFinite(r)&&(g.copy(h).multiplyScalar(f.y).addScaledVector(d,-m.y).multiplyScalar(r),v.copy(d).multiplyScalar(m.x).addScaledVector(h,-f.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(v),c[e].add(v),c[n].add(v))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let t=0,e=_.length;t<e;++t){const e=_[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)y(n[t+0],n[t+1],n[t+2])}const x=new Qo,b=new Qo,A=new Qo,w=new Qo;function C(t){A.fromArray(r,3*t),w.copy(A);const e=l[t];x.copy(e),x.sub(A.multiplyScalar(A.dot(e))).normalize(),b.crossVectors(w,e);const n=b.dot(c[t])<0?-1:1;s[4*t]=x.x,s[4*t+1]=x.y,s[4*t+2]=x.z,s[4*t+3]=n}for(let t=0,e=_.length;t<e;++t){const e=_[t],i=e.start;for(let t=i,r=i+e.count;t<r;t+=3)C(n[t+0]),C(n[t+1]),C(n[t+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new wl(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new Qo,r=new Qo,a=new Qo,o=new Qo,s=new Qo,l=new Qo,c=new Qo,u=new Qo;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),m=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),a.fromBufferAttribute(e,m),c.subVectors(a,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),s.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),o.add(c),s.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,s.x,s.y,s.z),n.setXYZ(m,l.x,l.y,l.z)}else for(let t=0,o=e.count;t<o;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),a.fromBufferAttribute(e,t+2),c.subVectors(a,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,a=t.attributes[i],o=a.array,s=a.itemSize*e,l=Math.min(o.length,r.length-s);for(let t=0,e=s;t<l;t++,e++)r[e]=o[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Pl.fromBufferAttribute(t,e),Pl.normalize(),t.setXYZ(e,Pl.x,Pl.y,Pl.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,a=new n.constructor(e.length*i);let o=0,s=0;for(let r=0,l=e.length;r<l;r++){o=t.isInterleavedBufferAttribute?e[r]*t.data.stride+t.offset:e[r]*i;for(let t=0;t<i;t++)a[s++]=n[o++]}return new wl(a,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Rl,n=this.index.array,i=this.attributes;for(const r in i){const a=t(i[r],n);e.setAttribute(r,a)}const r=this.morphAttributes;for(const i in r){const a=[],o=r[i];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],n);a.push(i)}e.morphAttributes[i]=a}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let t=0,n=a.length;t<n;t++){const n=a[t];e.addGroup(n.start,n.count,n.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const e in n){const i=n[e];t.data.attributes[e]=i.toJSON(t.data)}const i={};let r=!1;for(const e in this.morphAttributes){const n=this.morphAttributes[e],a=[];for(let e=0,i=n.length;e<i;e++){const i=n[e];a.push(i.toJSON(t.data))}a.length>0&&(i[e]=a,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const t in i){const n=i[t];this.setAttribute(t,n.clone(e))}const r=t.morphAttributes;for(const t in r){const n=[],i=r[t];for(let t=0,r=i.length;t<r;t++)n.push(i[t].clone(e));this.morphAttributes[t]=n}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let t=0,e=a.length;t<e;t++){const e=a[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const s=t.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Rl.prototype.isBufferGeometry=!0;const kl=new Ts,zl=new Ms,Fl=new _s,Ol=new Qo,Nl=new Qo,Ul=new Qo,Vl=new Qo,Gl=new Qo,Hl=new Qo,jl=new Qo,Wl=new Qo,ql=new Qo,Zl=new Fo,$l=new Fo,Yl=new Fo,Xl=new Qo,Ql=new Qo;class Jl extends Ks{constructor(t=new Rl,e=new xl){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Fl.copy(n.boundingSphere),Fl.applyMatrix4(r),!1===t.ray.intersectsSphere(Fl))return;if(kl.copy(r).invert(),zl.copy(t.ray).applyMatrix4(kl),null!==n.boundingBox&&!1===zl.intersectsBox(n.boundingBox))return;let a;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position,s=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const p=h[n],m=i[p.materialIndex];for(let n=Math.max(p.start,d.start),i=Math.min(r.count,Math.min(p.start+p.count,d.start+d.count));n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);a=Kl(this,m,t,zl,o,s,l,c,u,i,h,d),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=p.materialIndex,e.push(a))}}else for(let n=Math.max(0,d.start),h=Math.min(r.count,d.start+d.count);n<h;n+=3){const h=r.getX(n),d=r.getX(n+1),p=r.getX(n+2);a=Kl(this,i,t,zl,o,s,l,c,u,h,d,p),a&&(a.faceIndex=Math.floor(n/3),e.push(a))}else if(void 0!==o)if(Array.isArray(i))for(let n=0,r=h.length;n<r;n++){const r=h[n],p=i[r.materialIndex];for(let n=Math.max(r.start,d.start),i=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));n<i;n+=3)a=Kl(this,p,t,zl,o,s,l,c,u,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),a.face.materialIndex=r.materialIndex,e.push(a))}else for(let n=Math.max(0,d.start),r=Math.min(o.count,d.start+d.count);n<r;n+=3)a=Kl(this,i,t,zl,o,s,l,c,u,n,n+1,n+2),a&&(a.faceIndex=Math.floor(n/3),e.push(a))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Kl(t,e,n,i,r,a,o,s,l,c,u,h){Ol.fromBufferAttribute(r,c),Nl.fromBufferAttribute(r,u),Ul.fromBufferAttribute(r,h);const d=t.morphTargetInfluences;if(a&&d){jl.set(0,0,0),Wl.set(0,0,0),ql.set(0,0,0);for(let t=0,e=a.length;t<e;t++){const e=d[t],n=a[t];0!==e&&(Vl.fromBufferAttribute(n,c),Gl.fromBufferAttribute(n,u),Hl.fromBufferAttribute(n,h),o?(jl.addScaledVector(Vl,e),Wl.addScaledVector(Gl,e),ql.addScaledVector(Hl,e)):(jl.addScaledVector(Vl.sub(Ol),e),Wl.addScaledVector(Gl.sub(Nl),e),ql.addScaledVector(Hl.sub(Ul),e)))}Ol.add(jl),Nl.add(Wl),Ul.add(ql)}t.isSkinnedMesh&&(t.boneTransform(c,Ol),t.boneTransform(u,Nl),t.boneTransform(h,Ul));const p=function(t,e,n,i,r,a,o,s){let l;if(l=e.side===Zi?i.intersectTriangle(o,a,r,!0,s):i.intersectTriangle(r,a,o,e.side!==$i,s),null===l)return null;Ql.copy(s),Ql.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(Ql);return c<n.near||c>n.far?null:{distance:c,point:Ql.clone(),object:t}}(t,e,n,i,Ol,Nl,Ul,Xl);if(p){s&&(Zl.fromBufferAttribute(s,c),$l.fromBufferAttribute(s,u),Yl.fromBufferAttribute(s,h),p.uv=ul.getUV(Xl,Ol,Nl,Ul,Zl,$l,Yl,new Fo)),l&&(Zl.fromBufferAttribute(l,c),$l.fromBufferAttribute(l,u),Yl.fromBufferAttribute(l,h),p.uv2=ul.getUV(Xl,Ol,Nl,Ul,Zl,$l,Yl,new Fo));const t={a:c,b:u,c:h,normal:new Qo,materialIndex:0};ul.getNormal(Ol,Nl,Ul,t.normal),p.face=t}return p}Jl.prototype.isMesh=!0;class tc extends Rl{constructor(t=1,e=1,n=1,i=1,r=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:a};const o=this;i=Math.floor(i),r=Math.floor(r),a=Math.floor(a);const s=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,i,r,a,p,m,f,g,v){const y=a/f,_=p/g,x=a/2,b=p/2,A=m/2,w=f+1,C=g+1;let E=0,S=0;const M=new Qo;for(let a=0;a<C;a++){const o=a*_-b;for(let s=0;s<w;s++){const h=s*y-x;M[t]=h*i,M[e]=o*r,M[n]=A,l.push(M.x,M.y,M.z),M[t]=0,M[e]=0,M[n]=m>0?1:-1,c.push(M.x,M.y,M.z),u.push(s/f),u.push(1-a/g),E+=1}}for(let t=0;t<g;t++)for(let e=0;e<f;e++){const n=h+e+w*t,i=h+e+w*(t+1),r=h+(e+1)+w*(t+1),a=h+(e+1)+w*t;s.push(n,i,a),s.push(i,r,a),S+=6}o.addGroup(d,S,v),d+=S,h+=E}p("z","y","x",-1,-1,n,e,t,a,r,0),p("z","y","x",1,-1,n,e,-t,a,r,1),p("x","z","y",1,1,t,n,e,i,a,2),p("x","z","y",1,-1,t,n,-e,i,a,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(s),this.setAttribute("position",new Sl(l,3)),this.setAttribute("normal",new Sl(c,3)),this.setAttribute("uv",new Sl(u,2))}static fromJSON(t){return new tc(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function ec(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function nc(t){const e={};for(let n=0;n<t.length;n++){const i=ec(t[n]);for(const t in i)e[t]=i[t]}return e}const ic={clone:ec,merge:nc};class rc extends dl{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ec(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?e.uniforms[n]={type:"t",value:i.toJSON(t).uuid}:i&&i.isColor?e.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?e.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?e.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?e.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?e.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?e.uniforms[n]={type:"m4",value:i.toArray()}:e.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const t in this.extensions)!0===this.extensions[t]&&(n[t]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}rc.prototype.isShaderMaterial=!0;class ac extends Ks{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Ts,this.projectionMatrix=new Ts,this.projectionMatrixInverse=new Ts}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}ac.prototype.isCamera=!0;class oc extends ac{constructor(t=50,e=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Lo*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Bo*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Lo*Math.atan(Math.tan(.5*Bo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Bo*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const a=this.view;if(null!==this.view&&this.view.enabled){const t=a.fullWidth,o=a.fullHeight;r+=a.offsetX*i/t,e-=a.offsetY*n/o,i*=a.width/t,n*=a.height/o}const o=this.filmOffset;0!==o&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}oc.prototype.isPerspectiveCamera=!0;const sc=90;class lc extends Ks{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new oc(sc,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Qo(1,0,0)),this.add(i);const r=new oc(sc,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Qo(-1,0,0)),this.add(r);const a=new oc(sc,1,t,e);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new Qo(0,1,0)),this.add(a);const o=new oc(sc,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Qo(0,-1,0)),this.add(o);const s=new oc(sc,1,t,e);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Qo(0,0,1)),this.add(s);const l=new oc(sc,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Qo(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,a,o,s,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,a),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,s),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c}}class cc extends Wo{constructor(t,e,n,i,r,a,o,s,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:Rr,n,i,r,a,o,s,l,c),this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}cc.prototype.isCubeTexture=!0;class uc extends $o{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),e=e||{},this.texture=new cc(void 0,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:qr,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=ca,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new tc(5,5,5),o=new rc({name:"CubemapFromEquirect",uniforms:ec(n),vertexShader:i,fragmentShader:r,side:Zi,blending:Yi});o.uniforms.tEquirect.value=e;const s=new Jl(a,o),l=e.minFilter;return e.minFilter===$r&&(e.minFilter=qr),new lc(1,10,this).update(t,s),e.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let r=0;r<6;r++)t.setRenderTarget(this,r),t.clear(e,n,i);t.setRenderTarget(r)}}uc.prototype.isWebGLCubeRenderTarget=!0;const hc=new Qo,dc=new Qo,pc=new Oo;class mc{constructor(t=new Qo(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=hc.subVectors(n,e).cross(dc.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(hc),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||pc.getNormalMatrix(t),i=this.coplanarPoint(hc).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}mc.prototype.isPlane=!0;const fc=new _s,gc=new Qo;class vc{constructor(t=new mc,e=new mc,n=new mc,i=new mc,r=new mc,a=new mc){this.planes=[t,e,n,i,r,a]}set(t,e,n,i,r,a){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],m=n[11],f=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(o-i,u-s,m-h,y-f).normalize(),e[1].setComponents(o+i,u+s,m+h,y+f).normalize(),e[2].setComponents(o+r,u+l,m+d,y+g).normalize(),e[3].setComponents(o-r,u-l,m-d,y-g).normalize(),e[4].setComponents(o-a,u-c,m-p,y-v).normalize(),e[5].setComponents(o+a,u+c,m+p,y+v).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),fc.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(fc)}intersectsSprite(t){return fc.center.set(0,0,0),fc.radius=.7071067811865476,fc.applyMatrix4(t.matrixWorld),this.intersectsSphere(fc)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let t=0;t<6;t++)if(e[t].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(gc.x=i.normal.x>0?t.max.x:t.min.x,gc.y=i.normal.y>0?t.max.y:t.min.y,gc.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(gc)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function yc(){let t=null,e=!1,n=null,i=null;function r(e,a){n(e,a),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function _c(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const a=i.get(e);void 0===a?i.set(e,function(e,i){const r=e.array,a=e.usage,o=t.createBuffer();t.bindBuffer(i,o),t.bufferData(i,r,a),e.onUploadCallback();let s=5126;return r instanceof Float32Array?s=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?e.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:r instanceof Int16Array?s=5122:r instanceof Uint32Array?s=5125:r instanceof Int32Array?s=5124:r instanceof Int8Array?s=5120:(r instanceof Uint8Array||r instanceof Uint8ClampedArray)&&(s=5121),{buffer:o,type:s,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):a.version<e.version&&(function(e,i,r){const a=i.array,o=i.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,a):(n?t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(a.buffer,e,r),a.version=e.version)}}}class xc extends Rl{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,a=e/2,o=Math.floor(n),s=Math.floor(i),l=o+1,c=s+1,u=t/o,h=e/s,d=[],p=[],m=[],f=[];for(let t=0;t<c;t++){const e=t*h-a;for(let n=0;n<l;n++){const i=n*u-r;p.push(i,-e,0),m.push(0,0,1),f.push(n/o),f.push(1-t/s)}}for(let t=0;t<s;t++)for(let e=0;e<o;e++){const n=e+l*t,i=e+l*(t+1),r=e+1+l*(t+1),a=e+1+l*t;d.push(n,i,a),d.push(i,r,a)}this.setIndex(d),this.setAttribute("position",new Sl(p,3)),this.setAttribute("normal",new Sl(m,3)),this.setAttribute("uv",new Sl(f,2))}static fromJSON(t){return new xc(t.width,t.height,t.widthSegments,t.heightSegments)}}const bc={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= specularColorMapTexelToLinear( texture2D( specularColorMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= sheenColorMapTexelToLinear( texture2D( sheenColorMap, vUv ) ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {\n\t\t\tfloat texelIndex = float( vertexIndex * stride + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV ).xyz;\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\t#ifndef USE_MORPHNORMALS\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];\n\t\t\t#else\n\t\t\t\tif ( morphTargetInfluences[ i ] > 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];\n\t\t\t#endif\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ac={common:{diffuse:{value:new _l(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Oo},uv2Transform:{value:new Oo},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Fo(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _l(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _l(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Oo}},sprite:{diffuse:{value:new _l(16777215)},opacity:{value:1},center:{value:new Fo(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Oo}}},wc={basic:{uniforms:nc([Ac.common,Ac.specularmap,Ac.envmap,Ac.aomap,Ac.lightmap,Ac.fog]),vertexShader:bc.meshbasic_vert,fragmentShader:bc.meshbasic_frag},lambert:{uniforms:nc([Ac.common,Ac.specularmap,Ac.envmap,Ac.aomap,Ac.lightmap,Ac.emissivemap,Ac.fog,Ac.lights,{emissive:{value:new _l(0)}}]),vertexShader:bc.meshlambert_vert,fragmentShader:bc.meshlambert_frag},phong:{uniforms:nc([Ac.common,Ac.specularmap,Ac.envmap,Ac.aomap,Ac.lightmap,Ac.emissivemap,Ac.bumpmap,Ac.normalmap,Ac.displacementmap,Ac.fog,Ac.lights,{emissive:{value:new _l(0)},specular:{value:new _l(1118481)},shininess:{value:30}}]),vertexShader:bc.meshphong_vert,fragmentShader:bc.meshphong_frag},standard:{uniforms:nc([Ac.common,Ac.envmap,Ac.aomap,Ac.lightmap,Ac.emissivemap,Ac.bumpmap,Ac.normalmap,Ac.displacementmap,Ac.roughnessmap,Ac.metalnessmap,Ac.fog,Ac.lights,{emissive:{value:new _l(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:bc.meshphysical_vert,fragmentShader:bc.meshphysical_frag},toon:{uniforms:nc([Ac.common,Ac.aomap,Ac.lightmap,Ac.emissivemap,Ac.bumpmap,Ac.normalmap,Ac.displacementmap,Ac.gradientmap,Ac.fog,Ac.lights,{emissive:{value:new _l(0)}}]),vertexShader:bc.meshtoon_vert,fragmentShader:bc.meshtoon_frag},matcap:{uniforms:nc([Ac.common,Ac.bumpmap,Ac.normalmap,Ac.displacementmap,Ac.fog,{matcap:{value:null}}]),vertexShader:bc.meshmatcap_vert,fragmentShader:bc.meshmatcap_frag},points:{uniforms:nc([Ac.points,Ac.fog]),vertexShader:bc.points_vert,fragmentShader:bc.points_frag},dashed:{uniforms:nc([Ac.common,Ac.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:bc.linedashed_vert,fragmentShader:bc.linedashed_frag},depth:{uniforms:nc([Ac.common,Ac.displacementmap]),vertexShader:bc.depth_vert,fragmentShader:bc.depth_frag},normal:{uniforms:nc([Ac.common,Ac.bumpmap,Ac.normalmap,Ac.displacementmap,{opacity:{value:1}}]),vertexShader:bc.meshnormal_vert,fragmentShader:bc.meshnormal_frag},sprite:{uniforms:nc([Ac.sprite,Ac.fog]),vertexShader:bc.sprite_vert,fragmentShader:bc.sprite_frag},background:{uniforms:{uvTransform:{value:new Oo},t2D:{value:null}},vertexShader:bc.background_vert,fragmentShader:bc.background_frag},cube:{uniforms:nc([Ac.envmap,{opacity:{value:1}}]),vertexShader:bc.cube_vert,fragmentShader:bc.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:bc.equirect_vert,fragmentShader:bc.equirect_frag},distanceRGBA:{uniforms:nc([Ac.common,Ac.displacementmap,{referencePosition:{value:new Qo},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:bc.distanceRGBA_vert,fragmentShader:bc.distanceRGBA_frag},shadow:{uniforms:nc([Ac.lights,Ac.fog,{color:{value:new _l(0)},opacity:{value:1}}]),vertexShader:bc.shadow_vert,fragmentShader:bc.shadow_frag}};function Cc(t,e,n,i,r){const a=new _l(0);let o,s,l=0,c=null,u=0,h=null;function d(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,r)}return{getClearColor:function(){return a},setClearColor:function(t,e=1){a.set(t),l=e,d(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,d(a,l)},render:function(n,r){let p=!1,m=!0===r.isScene?r.background:null;m&&m.isTexture&&(m=e.get(m));const f=t.xr,g=f.getSession&&f.getSession();g&&"additive"===g.environmentBlendMode&&(m=null),null===m?d(a,l):m&&m.isColor&&(d(m,1),p=!0),(t.autoClear||p)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),m&&(m.isCubeTexture||m.mapping===Or)?(void 0===s&&(s=new Jl(new tc(1,1,1),new rc({name:"BackgroundCubeMaterial",uniforms:ec(wc.cube.uniforms),vertexShader:wc.cube.vertexShader,fragmentShader:wc.cube.fragmentShader,side:Zi,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),s.material.uniforms.envMap.value=m,s.material.uniforms.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1,c===m&&u===m.version&&h===t.toneMapping||(s.material.needsUpdate=!0,c=m,u=m.version,h=t.toneMapping),n.unshift(s,s.geometry,s.material,0,0,null)):m&&m.isTexture&&(void 0===o&&(o=new Jl(new xc(2,2),new rc({name:"BackgroundMaterial",uniforms:ec(wc.background.uniforms),vertexShader:wc.background.vertexShader,fragmentShader:wc.background.fragmentShader,side:qi,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(o)),o.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),o.material.uniforms.uvTransform.value.copy(m.matrix),c===m&&u===m.version&&h===t.toneMapping||(o.material.needsUpdate=!0,c=m,u=m.version,h=t.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function Ec(t,e,n,i){const r=t.getParameter(34921),a=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==a,s={},l=d(null);let c=l;function u(e){return i.isWebGL2?t.bindVertexArray(e):a.bindVertexArrayOES(e)}function h(e){return i.isWebGL2?t.deleteVertexArray(e):a.deleteVertexArrayOES(e)}function d(t){const e=[],n=[],i=[];for(let t=0;t<r;t++)e[t]=0,n[t]=0,i[t]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function m(t){f(t,0)}function f(n,r){const a=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;a[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),s[n]!==r&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),s[n]=r)}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function v(e,n,r,a,o,s){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,a,o,s):t.vertexAttribIPointer(e,n,r,o,s)}function y(){_(),c!==l&&(c=l,u(c.object))}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,y,_){let x=!1;if(o){const e=function(e,n,r){const o=!0===r.wireframe;let l=s[e.id];void 0===l&&(l={},s[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[o];return void 0===u&&(u=d(i.isWebGL2?t.createVertexArray():a.createVertexArrayOES()),c[o]=u),u}(y,h,l);c!==e&&(c=e,u(c.object)),x=function(t,e){const n=c.attributes,i=t.attributes;let r=0;for(const t in i){const e=n[t],a=i[t];if(void 0===e)return!0;if(e.attribute!==a)return!0;if(e.data!==a.data)return!0;r++}return c.attributesNum!==r||c.index!==e}(y,_),x&&function(t,e){const n={},i=t.attributes;let r=0;for(const t in i){const e=i[t],a={};a.attribute=e,e.data&&(a.data=e.data),n[t]=a,r++}c.attributes=n,c.attributesNum=r,c.index=e}(y,_)}else{const t=!0===l.wireframe;c.geometry===y.id&&c.program===h.id&&c.wireframe===t||(c.geometry=y.id,c.program=h.id,c.wireframe=t,x=!0)}!0===r.isInstancedMesh&&(x=!0),null!==_&&n.update(_,34963),x&&(function(r,a,o,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const l=s.attributes,c=o.getAttributes(),u=a.defaultAttributeValues;for(const e in c){const i=c[e];if(i.location>=0){let a=l[e];if(void 0===a&&("instanceMatrix"===e&&r.instanceMatrix&&(a=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(a=r.instanceColor)),void 0!==a){const e=a.normalized,o=a.itemSize,l=n.get(a);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(a.isInterleavedBufferAttribute){const n=a.data,l=n.stride,d=a.offset;if(n&&n.isInstancedInterleavedBuffer){for(let t=0;t<i.locationSize;t++)f(i.location+t,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<i.locationSize;t++)m(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)v(i.location+t,o/i.locationSize,u,e,l*h,(d+o/i.locationSize*t)*h)}else{if(a.isInstancedBufferAttribute){for(let t=0;t<i.locationSize;t++)f(i.location+t,a.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let t=0;t<i.locationSize;t++)m(i.location+t);t.bindBuffer(34962,c);for(let t=0;t<i.locationSize;t++)v(i.location+t,o/i.locationSize,u,e,o*h,o/i.locationSize*t*h)}}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i.location,n);break;case 3:t.vertexAttrib3fv(i.location,n);break;case 4:t.vertexAttrib4fv(i.location,n);break;default:t.vertexAttrib1fv(i.location,n)}}}}g()}(r,l,h,y),null!==_&&t.bindBuffer(34963,n.get(_).buffer))},reset:y,resetDefaultState:_,dispose:function(){y();for(const t in s){const e=s[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0===s[t.id])return;const e=s[t.id];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete s[t.id]},releaseStatesOfProgram:function(t){for(const e in s){const n=s[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)h(i[t].object),delete i[t];delete n[t.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:g}}function Sc(t,e,n,i){const r=i.isWebGL2;let a;this.setMode=function(t){a=t},this.render=function(e,i){t.drawArrays(a,e,i),n.update(i,a,1)},this.renderInstances=function(i,o,s){if(0===s)return;let l,c;if(r)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](a,i,o,s),n.update(o,a,s)}}function Mc(t,e,n){let i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);const l=a||e.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),m=t.getParameter(34921),f=t.getParameter(36347),g=t.getParameter(36348),v=t.getParameter(36349),y=h>0,_=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:f,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:y&&_,maxSamples:a?t.getParameter(36183):0}}function Tc(t){const e=this;let n=null,i=0,r=!1,a=!1;const o=new mc,s=new Oo,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(t,n,i,r){const a=null!==t?t.length:0;let c=null;if(0!==a){if(c=l.value,!0!==r||null===c){const e=i+4*a,r=n.matrixWorldInverse;s.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let e=0,n=i;e!==a;++e,n+=4)o.copy(t[e]).applyMatrix4(r,s),o.normal.toArray(c,n),c[n+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=a,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,a){const o=0!==t.length||e||0!==i||r;return r=e,n=u(t,a,0),i=t.length,o},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1,c()},this.setState=function(e,o,s){const h=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,m=t.get(e);if(!r||null===h||0===h.length||a&&!p)a?u(null):c();else{const t=a?0:i,e=4*t;let r=m.clippingState||null;l.value=r,r=u(h,o,e,s);for(let t=0;t!==e;++t)r[t]=n[t];m.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Ic(t){let e=new WeakMap;function n(t,e){return e===zr?t.mapping=Rr:e===Fr&&(t.mapping=kr),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const a=r.mapping;if(a===zr||a===Fr){if(e.has(r))return n(e.get(r).texture,r.mapping);{const a=r.image;if(a&&a.height>0){const o=t.getRenderTarget(),s=new uc(a.height/2);return s.fromEquirectangularTexture(t,r),e.set(r,s),t.setRenderTarget(o),r.addEventListener("dispose",i),n(s.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}wc.physical={uniforms:nc([wc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Fo(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new _l(0)},sheenColorMap:{value:null},sheenRoughness:{value:0},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Fo},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new _l(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularColor:{value:new _l(1,1,1)},specularColorMap:{value:null}}]),vertexShader:bc.meshphysical_vert,fragmentShader:bc.meshphysical_frag};class Bc extends ac{constructor(t=-1,e=1,n=1,i=-1,r=.1,a=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=a,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,a=n+t,o=i+e,s=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,a=r+t*this.view.width,o-=e*this.view.offsetY,s=o-e*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}Bc.prototype.isOrthographicCamera=!0;class Lc extends rc{constructor(t){super(t),this.type="RawShaderMaterial"}}Lc.prototype.isRawShaderMaterial=!0;const Dc=Math.pow(2,8),Pc=[.125,.215,.35,.446,.526,.582],Rc=5+Pc.length,kc={[mo]:0,[fo]:1,[vo]:2,[yo]:3,[_o]:4,[xo]:5,[go]:6},zc=new Bc,{_lodPlanes:Fc,_sizeLods:Oc,_sigmas:Nc}=Zc(),Uc=new _l;let Vc=null;const Gc=(1+Math.sqrt(5))/2,Hc=1/Gc,jc=[new Qo(1,1,1),new Qo(-1,1,1),new Qo(1,1,-1),new Qo(-1,1,-1),new Qo(0,Gc,Hc),new Qo(0,Gc,-Hc),new Qo(Hc,0,Gc),new Qo(-Hc,0,Gc),new Qo(Gc,Hc,0),new Qo(-Gc,Hc,0)];class Wc{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const e=new Float32Array(20),n=new Qo(0,1,0);return new Lc({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:kc[mo]},outputEncoding:{value:kc[mo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:Yi,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){Vc=this._renderer.getRenderTarget();const r=this._allocateTargets();return this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t){return this._fromTexture(t)}fromCubemap(t){return this._fromTexture(t)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Qc(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Xc(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<Fc.length;t++)Fc[t].dispose()}_cleanup(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Vc),t.scissorTest=!1,Yc(t,0,0,t.width,t.height)}_fromTexture(t){Vc=this._renderer.getRenderTarget();const e=this._allocateTargets(t);return this._textureToCubeUV(t,e),this._applyPMREM(e),this._cleanup(e),e}_allocateTargets(t){const e={magFilter:Hr,minFilter:Hr,generateMipmaps:!1,type:Yr,format:da,encoding:qc(t)?t.encoding:vo,depthBuffer:!1},n=$c(e);return n.depthBuffer=!t,this._pingPongRenderTarget=$c(e),n}_compileMaterial(t){const e=new Jl(Fc[0],t);this._renderer.compile(e,zc)}_sceneToCubeUV(t,e,n,i){const r=new oc(90,1,e,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.outputEncoding,u=s.toneMapping;s.getClearColor(Uc),s.toneMapping=Tr,s.outputEncoding=mo,s.autoClear=!1;const h=new xl({name:"PMREM.Background",side:Zi,depthWrite:!1,depthTest:!1}),d=new Jl(new tc,h);let p=!1;const m=t.background;m?m.isColor&&(h.color.copy(m),t.background=null,p=!0):(h.color.copy(Uc),p=!0);for(let e=0;e<6;e++){const n=e%3;0==n?(r.up.set(0,a[e],0),r.lookAt(o[e],0,0)):1==n?(r.up.set(0,0,a[e]),r.lookAt(0,o[e],0)):(r.up.set(0,a[e],0),r.lookAt(0,0,o[e])),Yc(i,n*Dc,e>2?Dc:0,Dc,Dc),s.setRenderTarget(i),p&&s.render(d,r),s.render(t,r)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=u,s.outputEncoding=c,s.autoClear=l,t.background=m}_setEncoding(t,e){t.value=kc[e.encoding]}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===Rr||t.mapping===kr;i?null==this._cubemapShader&&(this._cubemapShader=Qc()):null==this._equirectShader&&(this._equirectShader=Xc());const r=i?this._cubemapShader:this._equirectShader,a=new Jl(Fc[0],r),o=r.uniforms;o.envMap.value=t,i||o.texelSize.value.set(1/t.image.width,1/t.image.height),this._setEncoding(o.inputEncoding,t),this._setEncoding(o.outputEncoding,e.texture),Yc(e,0,0,3*Dc,2*Dc),n.setRenderTarget(e),n.render(a,zc)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let e=1;e<Rc;e++){const n=Math.sqrt(Nc[e]*Nc[e]-Nc[e-1]*Nc[e-1]),i=jc[(e-1)%jc.length];this._blur(t,e-1,e,n,i)}e.autoClear=n}_blur(t,e,n,i,r){const a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,i,"latitudinal",r),this._halfBlur(a,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,a,o){const s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Jl(Fc[i],l),u=l.uniforms,h=Oc[n]-1,d=isFinite(r)?Math.PI/(2*h):2*Math.PI/39,p=r/d,m=isFinite(r)?1+Math.floor(3*p):20;m>20&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const f=[];let g=0;for(let t=0;t<20;++t){const e=t/p,n=Math.exp(-e*e/2);f.push(n),0==t?g+=n:t<m&&(g+=2*n)}for(let t=0;t<f.length;t++)f[t]=f[t]/g;u.envMap.value=t.texture,u.samples.value=m,u.weights.value=f,u.latitudinal.value="latitudinal"===a,o&&(u.poleAxis.value=o),u.dTheta.value=d,u.mipInt.value=8-n,this._setEncoding(u.inputEncoding,t.texture),this._setEncoding(u.outputEncoding,t.texture);const v=Oc[i];Yc(e,3*Math.max(0,Dc-2*v),(0===i?0:2*Dc)+2*v*(i>4?i-8+4:0),3*v,2*v),s.setRenderTarget(e),s.render(c,zc)}}function qc(t){return void 0!==t&&t.type===Yr&&(t.encoding===mo||t.encoding===fo||t.encoding===go)}function Zc(){const t=[],e=[],n=[];let i=8;for(let r=0;r<Rc;r++){const a=Math.pow(2,i);e.push(a);let o=1/a;r>4?o=Pc[r-8+4-1]:0==r&&(o=0),n.push(o);const s=1/(a-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,d=6,p=3,m=2,f=1,g=new Float32Array(p*d*h),v=new Float32Array(m*d*h),y=new Float32Array(f*d*h);for(let t=0;t<h;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];g.set(i,p*d*t),v.set(u,m*d*t);const r=[t,t,t,t,t,t];y.set(r,f*d*t)}const _=new Rl;_.setAttribute("position",new wl(g,p)),_.setAttribute("uv",new wl(v,m)),_.setAttribute("faceIndex",new wl(y,f)),t.push(_),i>4&&i--}return{_lodPlanes:t,_sizeLods:e,_sigmas:n}}function $c(t){const e=new $o(3*Dc,3*Dc,t);return e.texture.mapping=Or,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Yc(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function Xc(){const t=new Fo(1,1);return new Lc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:t},inputEncoding:{value:kc[mo]},outputEncoding:{value:kc[mo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:Yi,depthTest:!1,depthWrite:!1})}function Qc(){return new Lc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:kc[mo]},outputEncoding:{value:kc[mo]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:Yi,depthTest:!1,depthWrite:!1})}function Jc(t){let e=new WeakMap,n=null;function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){const a=r.mapping,o=a===zr||a===Fr,s=a===Rr||a===kr;if(o||s){if(e.has(r))return e.get(r).texture;{const a=r.image;if(o&&a&&a.height>0||s&&a&&function(t){let e=0;for(let n=0;n<6;n++)void 0!==t[n]&&e++;return 6===e}(a)){const a=t.getRenderTarget();null===n&&(n=new Wc(t));const s=o?n.fromEquirectangular(r):n.fromCubemap(r);return e.set(r,s),t.setRenderTarget(a),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function Kc(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function tu(t,e,n,i){const r={},a=new WeakMap;function o(t){const s=t.target;null!==s.index&&e.remove(s.index);for(const t in s.attributes)e.remove(s.attributes[t]);s.removeEventListener("dispose",o),delete r[s.id];const l=a.get(s);l&&(e.remove(l),a.delete(s)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){const n=[],i=t.index,r=t.attributes.position;let o=0;if(null!==i){const t=i.array;o=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],a=t[e+2];n.push(i,r,r,a,a,i)}}else{const t=r.array;o=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}const s=new(No(n)>65535?El:Cl)(n,1);s.version=o;const l=a.get(t);l&&e.remove(l),a.set(t,s)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",o),r[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const t in n)e.update(n[t],34962);const i=t.morphAttributes;for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t++)e.update(n[t],34962)}},getWireframeAttribute:function(t){const e=a.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return a.get(t)}}}function eu(t,e,n,i){const r=i.isWebGL2;let a,o,s;this.setMode=function(t){a=t},this.setIndex=function(t){o=t.type,s=t.bytesPerElement},this.render=function(e,i){t.drawElements(a,i,o,e*s),n.update(i,a,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(r)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](a,l,o,i*s,c),n.update(l,a,c)}}function nu(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}class iu extends Wo{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}function ru(t,e){return t[0]-e[0]}function au(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ou(t,e){let n=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),t.divideScalar(n)}function su(t,e,n){const i={},r=new Float32Array(8),a=new WeakMap,o=new Qo,s=[];for(let t=0;t<8;t++)s[t]=[t,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===e.isWebGL2){const i=c.morphAttributes.position.length;let r=a.get(c);if(void 0===r||r.count!==i){void 0!==r&&r.texture.dispose();const t=void 0!==c.morphAttributes.normal,n=c.morphAttributes.position,s=c.morphAttributes.normal||[],l=!0===t?2:1;let u=c.attributes.position.count*l,h=1;u>e.maxTextureSize&&(h=Math.ceil(u/e.maxTextureSize),u=e.maxTextureSize);const d=new Float32Array(u*h*4*i),p=new iu(d,u,h,i);p.format=ca,p.type=ea;const m=4*l;for(let e=0;e<i;e++){const i=n[e],r=s[e],a=u*h*4*e;for(let e=0;e<i.count;e++){o.fromBufferAttribute(i,e),!0===i.normalized&&ou(o,i);const n=e*m;d[a+n+0]=o.x,d[a+n+1]=o.y,d[a+n+2]=o.z,d[a+n+3]=0,!0===t&&(o.fromBufferAttribute(r,e),!0===r.normalized&&ou(o,r),d[a+n+4]=o.x,d[a+n+5]=o.y,d[a+n+6]=o.z,d[a+n+7]=0)}}r={count:i,texture:p,size:new Fo(u,h)},a.set(c,r)}let s=0;for(let t=0;t<d.length;t++)s+=d[t];const l=c.morphTargetsRelative?1:1-s;h.getUniforms().setValue(t,"morphTargetBaseInfluence",l),h.getUniforms().setValue(t,"morphTargetInfluences",d),h.getUniforms().setValue(t,"morphTargetsTexture",r.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",r.size)}else{const e=void 0===d?0:d.length;let n=i[c.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];i[c.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=d[t]}n.sort(au);for(let t=0;t<8;t++)t<e&&n[t][1]?(s[t][0]=n[t][0],s[t][1]=n[t][1]):(s[t][0]=Number.MAX_SAFE_INTEGER,s[t][1]=0);s.sort(ru);const a=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=s[t],n=e[0],i=e[1];n!==Number.MAX_SAFE_INTEGER&&i?(a&&c.getAttribute("morphTarget"+t)!==a[n]&&c.setAttribute("morphTarget"+t,a[n]),o&&c.getAttribute("morphNormal"+t)!==o[n]&&c.setAttribute("morphNormal"+t,o[n]),r[t]=i,l+=i):(a&&!0===c.hasAttribute("morphTarget"+t)&&c.deleteAttribute("morphTarget"+t),o&&!0===c.hasAttribute("morphNormal"+t)&&c.deleteAttribute("morphNormal"+t),r[t]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(t,"morphTargetBaseInfluence",u),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function lu(t,e,n,i){let r=new WeakMap;function a(t){const e=t.target;e.removeEventListener("dispose",a),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const o=i.render.frame,s=t.geometry,l=e.get(t,s);return r.get(l)!==o&&(e.update(l),r.set(l,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",a)&&t.addEventListener("dispose",a),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}iu.prototype.isDataTexture2DArray=!0;class cu extends Wo{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=Hr,this.minFilter=Hr,this.wrapR=Vr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}cu.prototype.isDataTexture3D=!0;const uu=new Wo,hu=new iu,du=new cu,pu=new cc,mu=[],fu=[],gu=new Float32Array(16),vu=new Float32Array(9),yu=new Float32Array(4);function _u(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let a=mu[r];if(void 0===a&&(a=new Float32Array(r),mu[r]=a),0!==e){i.toArray(a,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(a,r)}return a}function xu(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function bu(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Au(t,e){let n=fu[e];void 0===n&&(n=new Int32Array(e),fu[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function wu(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Cu(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(xu(n,e))return;t.uniform2fv(this.addr,e),bu(n,e)}}function Eu(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(xu(n,e))return;t.uniform3fv(this.addr,e),bu(n,e)}}function Su(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(xu(n,e))return;t.uniform4fv(this.addr,e),bu(n,e)}}function Mu(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(xu(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),bu(n,e)}else{if(xu(n,i))return;yu.set(i),t.uniformMatrix2fv(this.addr,!1,yu),bu(n,i)}}function Tu(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(xu(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),bu(n,e)}else{if(xu(n,i))return;vu.set(i),t.uniformMatrix3fv(this.addr,!1,vu),bu(n,i)}}function Iu(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(xu(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),bu(n,e)}else{if(xu(n,i))return;gu.set(i),t.uniformMatrix4fv(this.addr,!1,gu),bu(n,i)}}function Bu(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Lu(t,e){const n=this.cache;xu(n,e)||(t.uniform2iv(this.addr,e),bu(n,e))}function Du(t,e){const n=this.cache;xu(n,e)||(t.uniform3iv(this.addr,e),bu(n,e))}function Pu(t,e){const n=this.cache;xu(n,e)||(t.uniform4iv(this.addr,e),bu(n,e))}function Ru(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function ku(t,e){const n=this.cache;xu(n,e)||(t.uniform2uiv(this.addr,e),bu(n,e))}function zu(t,e){const n=this.cache;xu(n,e)||(t.uniform3uiv(this.addr,e),bu(n,e))}function Fu(t,e){const n=this.cache;xu(n,e)||(t.uniform4uiv(this.addr,e),bu(n,e))}function Ou(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||uu,r)}function Nu(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||du,r)}function Uu(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||pu,r)}function Vu(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||hu,r)}function Gu(t,e){t.uniform1fv(this.addr,e)}function Hu(t,e){const n=_u(e,this.size,2);t.uniform2fv(this.addr,n)}function ju(t,e){const n=_u(e,this.size,3);t.uniform3fv(this.addr,n)}function Wu(t,e){const n=_u(e,this.size,4);t.uniform4fv(this.addr,n)}function qu(t,e){const n=_u(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Zu(t,e){const n=_u(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function $u(t,e){const n=_u(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Yu(t,e){t.uniform1iv(this.addr,e)}function Xu(t,e){t.uniform2iv(this.addr,e)}function Qu(t,e){t.uniform3iv(this.addr,e)}function Ju(t,e){t.uniform4iv(this.addr,e)}function Ku(t,e){t.uniform1uiv(this.addr,e)}function th(t,e){t.uniform2uiv(this.addr,e)}function eh(t,e){t.uniform3uiv(this.addr,e)}function nh(t,e){t.uniform4uiv(this.addr,e)}function ih(t,e,n){const i=e.length,r=Au(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTexture2D(e[t]||uu,r[t])}function rh(t,e,n){const i=e.length,r=Au(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture3D(e[t]||du,r[t])}function ah(t,e,n){const i=e.length,r=Au(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.safeSetTextureCube(e[t]||pu,r[t])}function oh(t,e,n){const i=e.length,r=Au(n,i);t.uniform1iv(this.addr,r);for(let t=0;t!==i;++t)n.setTexture2DArray(e[t]||hu,r[t])}function sh(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return wu;case 35664:return Cu;case 35665:return Eu;case 35666:return Su;case 35674:return Mu;case 35675:return Tu;case 35676:return Iu;case 5124:case 35670:return Bu;case 35667:case 35671:return Lu;case 35668:case 35672:return Du;case 35669:case 35673:return Pu;case 5125:return Ru;case 36294:return ku;case 36295:return zu;case 36296:return Fu;case 35678:case 36198:case 36298:case 36306:case 35682:return Ou;case 35679:case 36299:case 36307:return Nu;case 35680:case 36300:case 36308:case 36293:return Uu;case 36289:case 36303:case 36311:case 36292:return Vu}}(e.type)}function lh(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Gu;case 35664:return Hu;case 35665:return ju;case 35666:return Wu;case 35674:return qu;case 35675:return Zu;case 35676:return $u;case 5124:case 35670:return Yu;case 35667:case 35671:return Xu;case 35668:case 35672:return Qu;case 35669:case 35673:return Ju;case 5125:return Ku;case 36294:return th;case 36295:return eh;case 36296:return nh;case 35678:case 36198:case 36298:case 36306:case 35682:return ih;case 35679:case 36299:case 36307:return rh;case 35680:case 36300:case 36308:case 36293:return ah;case 36289:case 36303:case 36311:case 36292:return oh}}(e.type)}function ch(t){this.id=t,this.seq=[],this.map={}}lh.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),bu(e,t)},ch.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,a=i.length;r!==a;++r){const a=i[r];a.setValue(t,e[a.id],n)}};const uh=/(\w+)(\])?(\[|\.)?/g;function hh(t,e){t.seq.push(e),t.map[e.id]=e}function dh(t,e,n){const i=t.name,r=i.length;for(uh.lastIndex=0;;){const a=uh.exec(i),o=uh.lastIndex;let s=a[1];const l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===r){hh(n,void 0===c?new sh(s,t,e):new lh(s,t,e));break}{let t=n.map[s];void 0===t&&(t=new ch(s),hh(n,t)),n=t}}}function ph(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);dh(n,t.getUniformLocation(e,n.name),this)}}function mh(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}ph.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},ph.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},ph.upload=function(t,e,n,i){for(let r=0,a=e.length;r!==a;++r){const a=e[r],o=n[a.id];!1!==o.needsUpdate&&a.setValue(t,o.value,i)}},ph.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n};let fh=0;function gh(t){switch(t){case mo:return["Linear","( value )"];case fo:return["sRGB","( value )"];case vo:return["RGBE","( value )"];case yo:return["RGBM","( value, 7.0 )"];case _o:return["RGBM","( value, 16.0 )"];case xo:return["RGBD","( value, 256.0 )"];case go:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function vh(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":n.toUpperCase()+"\n\n"+r+"\n\n"+function(t){const e=t.split("\n");for(let t=0;t<e.length;t++)e[t]=t+1+": "+e[t];return e.join("\n")}(t.getShaderSource(e))}function yh(t,e){const n=gh(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function _h(t,e){const n=gh(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function xh(t,e){let n;switch(e){case Ir:n="Linear";break;case Br:n="Reinhard";break;case Lr:n="OptimizedCineon";break;case Dr:n="ACESFilmic";break;case Pr:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function bh(t){return""!==t}function Ah(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function wh(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ch=/^[ \t]*#include +<([\w\d./]+)>/gm;function Eh(t){return t.replace(Ch,Sh)}function Sh(t,e){const n=bc[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return Eh(n)}const Mh=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Th=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ih(t){return t.replace(Th,Lh).replace(Mh,Bh)}function Bh(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Lh(0,e,n,i)}function Lh(t,e,n,i){let r="";for(let t=parseInt(e);t<parseInt(n);t++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+t+" ]").replace(/UNROLLED_LOOP_INDEX/g,t);return r}function Dh(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Ph(t,e,n,i){const r=t.getContext(),a=n.defines;let o=n.vertexShader,s=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===Hi?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===ji?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Wi&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Rr:case kr:e="ENVMAP_TYPE_CUBE";break;case Or:case Nr:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case kr:case Nr:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case Er:e="ENVMAP_BLENDING_MULTIPLY";break;case Sr:e="ENVMAP_BLENDING_MIX";break;case Mr:e="ENVMAP_BLENDING_ADD"}return e}(n),d=t.gammaFactor>0?t.gammaFactor:1,p=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bh).join("\n")}(n),m=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(a),f=r.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[m].filter(bh).join("\n"),g.length>0&&(g+="\n"),v=[p,m].filter(bh).join("\n"),v.length>0&&(v+="\n")):(g=[Dh(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargets&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(bh).join("\n"),v=[p,Dh(n),"#define SHADER_NAME "+n.shaderName,m,"#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Tr?"#define TONE_MAPPING":"",n.toneMapping!==Tr?bc.tonemapping_pars_fragment:"",n.toneMapping!==Tr?xh("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.format===la?"#define OPAQUE":"",bc.encodings_pars_fragment,n.map?yh("mapTexelToLinear",n.mapEncoding):"",n.matcap?yh("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?yh("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?yh("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.specularColorMap?yh("specularColorMapTexelToLinear",n.specularColorMapEncoding):"",n.sheenColorMap?yh("sheenColorMapTexelToLinear",n.sheenColorMapEncoding):"",n.lightMap?yh("lightMapTexelToLinear",n.lightMapEncoding):"",_h("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(bh).join("\n")),o=Eh(o),o=Ah(o,n),o=wh(o,n),s=Eh(s),s=Ah(s,n),s=wh(s,n),o=Ih(o),s=Ih(s),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===Mo?"":"out highp vec4 pc_fragColor;",n.glslVersion===Mo?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+v+s,x=mh(r,35633,y+g+o),b=mh(r,35632,_);if(r.attachShader(f,x),r.attachShader(f,b),void 0!==n.index0AttributeName?r.bindAttribLocation(f,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(f,0,"position"),r.linkProgram(f),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(f).trim(),e=r.getShaderInfoLog(x).trim(),n=r.getShaderInfoLog(b).trim();let i=!0,a=!0;if(!1===r.getProgramParameter(f,35714)){i=!1;const e=vh(r,x,"vertex"),n=vh(r,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(f,35715)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+n)}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):""!==e&&""!==n||(a=!1);a&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:v}})}let A,w;return r.deleteShader(x),r.deleteShader(b),this.getUniforms=function(){return void 0===A&&(A=new ph(r,f)),A},this.getAttributes=function(){return void 0===w&&(w=function(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),a=i.name;let o=1;35674===i.type&&(o=2),35675===i.type&&(o=3),35676===i.type&&(o=4),n[a]={type:i.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}(r,f)),w},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(f),this.program=void 0},this.name=n.shaderName,this.id=fh++,this.cacheKey=e,this.usedTimes=1,this.program=f,this.vertexShader=x,this.fragmentShader=b,this}function Rh(t,e,n,i,r,a,o){const s=[],l=r.isWebGL2,c=r.logarithmicDepthBuffer,u=r.floatVertexTextures,h=r.maxVertexUniforms,d=r.vertexTextures;let p=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap",,"roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","morphTargetsCount","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","specularIntensityMap","specularColorMap","specularColorMapEncoding","transmission","transmissionMap","thicknessMap","sheen","sheenColorMap","sheenColorMapEncoding","sheenRoughnessMap"];function g(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=mo,e}return{getParameters:function(a,s,f,v,y){const _=v.fog,x=a.isMeshStandardMaterial?v.environment:null,b=(a.isMeshStandardMaterial?n:e).get(a.envMap||x),A=m[a.type],w=y.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(u)return 1024;{const t=h,n=Math.floor((t-20)/4),i=Math.min(n,e.length);return i<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+i+"."),0):i}}(y):0;let C,E;if(null!==a.precision&&(p=r.getMaxPrecision(a.precision),p!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",p,"instead.")),A){const t=wc[A];C=t.vertexShader,E=t.fragmentShader}else C=a.vertexShader,E=a.fragmentShader;const S=t.getRenderTarget(),M=a.alphaTest>0,T=a.clearcoat>0;return{isWebGL2:l,shaderID:A,shaderName:a.type,vertexShader:C,fragmentShader:E,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:p,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:d,outputEncoding:null!==S?g(S.texture):t.outputEncoding,map:!!a.map,mapEncoding:g(a.map),matcap:!!a.matcap,matcapEncoding:g(a.matcap),envMap:!!b,envMapMode:b&&b.mapping,envMapEncoding:g(b),envMapCubeUV:!!b&&(b.mapping===Or||b.mapping===Nr),lightMap:!!a.lightMap,lightMapEncoding:g(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:g(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===wo,tangentSpaceNormalMap:a.normalMapType===Ao,clearcoat:T,clearcoatMap:T&&!!a.clearcoatMap,clearcoatRoughnessMap:T&&!!a.clearcoatRoughnessMap,clearcoatNormalMap:T&&!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularColorMap:!!a.specularColorMap,specularColorMapEncoding:g(a.specularColorMap),alphaMap:!!a.alphaMap,alphaTest:M,gradientMap:!!a.gradientMap,sheen:a.sheen>0,sheenColorMap:!!a.sheenColorMap,sheenColorMapEncoding:g(a.sheenColorMap),sheenRoughnessMap:!!a.sheenRoughnessMap,transmission:a.transmission>0,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!y.geometry&&!!y.geometry.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.geometry&&!!y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.displacementMap||!!a.transmissionMap||!!a.thicknessMap||!!a.specularIntensityMap||!!a.specularColorMap||!!a.sheenColorMap||a.sheenRoughnessMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmission>0||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularColorMap||a.sheen>0||a.sheenColorMap||a.sheenRoughnessMap||!a.displacementMap),fog:!!_,useFog:a.fog,fogExp2:_&&_.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:c,skinning:!0===y.isSkinnedMesh&&w>0,maxBones:w,useVertexTexture:u,morphTargets:!!y.geometry&&!!y.geometry.morphAttributes.position,morphNormals:!!y.geometry&&!!y.geometry.morphAttributes.normal,morphTargetsCount:y.geometry&&y.geometry.morphAttributes.position?y.geometry.morphAttributes.position.length:0,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,format:a.format,dithering:a.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:a.toneMapped?t.toneMapping:Tr,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===$i,flipSided:a.side===Zi,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:l||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:l||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:l||i.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(Vo(e.fragmentShader)),n.push(Vo(e.vertexShader))),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<f.length;t++)n.push(e[f[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=m[t.type];let n;if(e){const t=wc[e];n=ic.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,e=s.length;t<e;t++){const e=s[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new Ph(t,n,e,a),s.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=s.indexOf(t);s[e]=s[s.length-1],s.pop(),t.destroy()}},programs:s}}function kh(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function zh(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Fh(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Oh(t){const e=[];let n=0;const i=[],r=[],a=[],o={id:-1};function s(i,r,a,s,l,c){let u=e[n];const h=t.get(a);return void 0===u?(u={id:i.id,object:i,geometry:r,material:a,program:h.program||o,groupOrder:s,renderOrder:i.renderOrder,z:l,group:c},e[n]=u):(u.id=i.id,u.object=i,u.geometry=r,u.material=a,u.program=h.program||o,u.groupOrder=s,u.renderOrder=i.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:i,transmissive:r,transparent:a,init:function(){n=0,i.length=0,r.length=0,a.length=0},push:function(t,e,n,o,l,c){const u=s(t,e,n,o,l,c);n.transmission>0?r.push(u):!0===n.transparent?a.push(u):i.push(u)},unshift:function(t,e,n,o,l,c){const u=s(t,e,n,o,l,c);n.transmission>0?r.unshift(u):!0===n.transparent?a.unshift(u):i.unshift(u)},finish:function(){for(let t=n,i=e.length;t<i;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(t,e){i.length>1&&i.sort(t||zh),r.length>1&&r.sort(e||Fh),a.length>1&&a.sort(e||Fh)}}}function Nh(t){let e=new WeakMap;return{get:function(n,i){let r;return!1===e.has(n)?(r=new Oh(t),e.set(n,[r])):i>=e.get(n).length?(r=new Oh(t),e.get(n).push(r)):r=e.get(n)[i],r},dispose:function(){e=new WeakMap}}}function Uh(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Qo,color:new _l};break;case"SpotLight":n={position:new Qo,direction:new Qo,color:new _l,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Qo,color:new _l,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Qo,skyColor:new _l,groundColor:new _l};break;case"RectAreaLight":n={color:new _l,position:new Qo,halfWidth:new Qo,halfHeight:new Qo}}return t[e.id]=n,n}}}let Vh=0;function Gh(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Hh(t,e){const n=new Uh,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fo};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Fo,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let t=0;t<9;t++)r.probe.push(new Qo);const a=new Qo,o=new Ts,s=new Ts;return{setup:function(a,o){let s=0,l=0,c=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let u=0,h=0,d=0,p=0,m=0,f=0,g=0,v=0;a.sort(Gh);const y=!0!==o?Math.PI:1;for(let t=0,e=a.length;t<e;t++){const e=a[t],o=e.color,_=e.intensity,x=e.distance,b=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)s+=o.r*_*y,l+=o.g*_*y,c+=o.b*_*y;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],_);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[u]=n,r.directionalShadowMap[u]=b,r.directionalShadowMatrix[u]=e.shadow.matrix,f++}r.directional[u]=t,u++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(o).multiplyScalar(_*y),t.distance=x,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[d]=n,r.spotShadowMap[d]=b,r.spotShadowMatrix[d]=e.shadow.matrix,v++}r.spot[d]=t,d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(o).multiplyScalar(_),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*y),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[h]=n,r.pointShadowMap[h]=b,r.pointShadowMatrix[h]=e.shadow.matrix,g++}r.point[h]=t,h++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(_*y),t.groundColor.copy(e.groundColor).multiplyScalar(_*y),r.hemi[m]=t,m++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Ac.LTC_FLOAT_1,r.rectAreaLTC2=Ac.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Ac.LTC_HALF_1,r.rectAreaLTC2=Ac.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=s,r.ambient[1]=l,r.ambient[2]=c;const _=r.hash;_.directionalLength===u&&_.pointLength===h&&_.spotLength===d&&_.rectAreaLength===p&&_.hemiLength===m&&_.numDirectionalShadows===f&&_.numPointShadows===g&&_.numSpotShadows===v||(r.directional.length=u,r.spot.length=d,r.rectArea.length=p,r.point.length=h,r.hemi.length=m,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=g,r.spotShadowMatrix.length=v,_.directionalLength=u,_.pointLength=h,_.spotLength=d,_.rectAreaLength=p,_.hemiLength=m,_.numDirectionalShadows=f,_.numPointShadows=g,_.numSpotShadows=v,r.version=Vh++)},setupView:function(t,e){let n=0,i=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let e=0,d=t.length;e<d;e++){const d=t[e];if(d.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(d.matrixWorld),a.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(a),t.direction.transformDirection(h),n++}else if(d.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(d.matrixWorld),a.setFromMatrixPosition(d.target.matrixWorld),t.direction.sub(a),t.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),s.identity(),o.copy(d.matrixWorld),o.premultiply(h),s.extractRotation(o),t.halfWidth.set(.5*d.width,0,0),t.halfHeight.set(0,.5*d.height,0),t.halfWidth.applyMatrix4(s),t.halfHeight.applyMatrix4(s),c++}else if(d.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(d.matrixWorld),t.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(d.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:r}}function jh(t,e){const n=new Hh(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(t){n.setup(i,t)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function Wh(t,e){let n=new WeakMap;return{get:function(i,r=0){let a;return!1===n.has(i)?(a=new jh(t,e),n.set(i,[a])):r>=n.get(i).length?(a=new jh(t,e),n.get(i).push(a)):a=n.get(i)[r],a},dispose:function(){n=new WeakMap}}}class qh extends dl{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}qh.prototype.isMeshDepthMaterial=!0;class Zh extends dl{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Qo,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}Zh.prototype.isMeshDistanceMaterial=!0;const $h="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",Yh="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function Xh(t,e,n){let i=new vc;const r=new Fo,a=new Fo,o=new Zo,s=new qh({depthPacking:bo}),l=new Zh,c={},u=n.maxTextureSize,h={0:Zi,1:qi,2:$i},d=new rc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Fo},radius:{value:4}},vertexShader:$h,fragmentShader:Yh}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const m=new Rl;m.setAttribute("position",new wl(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const f=new Jl(m,d),g=this;function v(n,i){const r=e.update(f);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,d,f,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,p,f,null)}function y(e,n,i,r,a,o,u){let d=null;const p=!0===r.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(d=void 0!==p?p:!0===r.isPointLight?l:s,t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0){const t=d.uuid,e=i.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let r=n[e];void 0===r&&(r=d.clone(),n[e]=r),d=r}return d.visible=i.visible,d.wireframe=i.wireframe,d.side=u===Wi?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],d.alphaMap=i.alphaMap,d.alphaTest=i.alphaTest,d.clipShadows=i.clipShadows,d.clippingPlanes=i.clippingPlanes,d.clipIntersection=i.clipIntersection,d.displacementMap=i.displacementMap,d.displacementScale=i.displacementScale,d.displacementBias=i.displacementBias,d.wireframeLinewidth=i.wireframeLinewidth,d.linewidth=i.linewidth,!0===r.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(r.matrixWorld),d.nearDistance=a,d.farDistance=o),d}function _(n,r,a,o,s){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===Wi)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const i=e.update(n),r=n.material;if(Array.isArray(r)){const e=i.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=r[c.materialIndex];if(u&&u.visible){const e=y(n,0,u,o,a.near,a.far,s);t.renderBufferDirect(a,null,i,e,n,c)}}}else if(r.visible){const e=y(n,0,r,o,a.near,a.far,s);t.renderBufferDirect(a,null,i,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)_(l[t],r,a,o,s)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Hi,this.render=function(e,n,s){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(Yi),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=e.length;l<c;l++){const c=e[l],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;r.copy(h.mapSize);const p=h.getFrameExtents();if(r.multiply(p),a.copy(h.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(a.x=Math.floor(u/p.x),r.x=a.x*p.x,h.mapSize.x=a.x),r.y>u&&(a.y=Math.floor(u/p.y),r.y=a.y*p.y,h.mapSize.y=a.y)),null===h.map&&!h.isPointLightShadow&&this.type===Wi){const t={minFilter:qr,magFilter:qr,format:ca};h.map=new $o(r.x,r.y,t),h.map.texture.name=c.name+".shadowMap",h.mapPass=new $o(r.x,r.y,t),h.camera.updateProjectionMatrix()}if(null===h.map){const t={minFilter:Hr,magFilter:Hr,format:ca};h.map=new $o(r.x,r.y,t),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const m=h.getViewportCount();for(let t=0;t<m;t++){const e=h.getViewport(t);o.set(a.x*e.x,a.y*e.y,a.x*e.z,a.y*e.w),d.viewport(o),h.updateMatrices(c,t),i=h.getFrustum(),_(n,s,h.camera,c,this.type)}h.isPointLightShadow||this.type!==Wi||v(h,s),h.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function Qh(t,e,n){const i=n.isWebGL2,r=new function(){let e=!1;const n=new Zo;let i=null;const r=new Zo(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,a,o,s){!0===s&&(e*=o,i*=o,a*=o),n.set(e,i,a,o),!1===r.equals(n)&&(t.clearColor(e,i,a,o),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},a=new function(){let e=!1,n=null,i=null,r=null;return{setTest:function(t){t?z(2929):F(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case vr:t.depthFunc(512);break;case yr:t.depthFunc(519);break;case _r:t.depthFunc(513);break;case xr:t.depthFunc(515);break;case br:t.depthFunc(514);break;case Ar:t.depthFunc(518);break;case wr:t.depthFunc(516);break;case Cr:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},o=new function(){let e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(t){e||(t?z(2960):F(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,o){i===e&&r===n&&a===o||(t.stencilFunc(e,n,o),i=e,r=n,a=o)},setOp:function(e,n,i){o===e&&s===n&&l===i||(t.stencilOp(e,n,i),o=e,s=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,c=null}}};let s={},l={},c=null,u=!1,h=null,d=null,p=null,m=null,f=null,g=null,v=null,y=!1,_=null,x=null,b=null,A=null,w=null;const C=t.getParameter(35661);let E=!1,S=0;const M=t.getParameter(7938);-1!==M.indexOf("WebGL")?(S=parseFloat(/^WebGL (\d)/.exec(M)[1]),E=S>=1):-1!==M.indexOf("OpenGL ES")&&(S=parseFloat(/^OpenGL ES (\d)/.exec(M)[1]),E=S>=2);let T=null,I={};const B=t.getParameter(3088),L=t.getParameter(2978),D=(new Zo).fromArray(B),P=(new Zo).fromArray(L);function R(e,n,i){const r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let e=0;e<i;e++)t.texImage2D(n+e,0,6408,1,1,0,6408,5121,r);return a}const k={};function z(e){!0!==s[e]&&(t.enable(e),s[e]=!0)}function F(e){!1!==s[e]&&(t.disable(e),s[e]=!1)}k[3553]=R(3553,3553,1),k[34067]=R(34067,34069,6),r.setClear(0,0,0,1),a.setClear(1),o.setClear(0),z(2929),a.setFunc(xr),V(!1),G(Vi),z(2884),U(Yi);const O={[er]:32774,[nr]:32778,[ir]:32779};if(i)O[rr]=32775,O[ar]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(O[rr]=t.MIN_EXT,O[ar]=t.MAX_EXT)}const N={[or]:0,[sr]:1,[lr]:768,[ur]:770,[gr]:776,[mr]:774,[dr]:772,[cr]:769,[hr]:771,[fr]:775,[pr]:773};function U(e,n,i,r,a,o,s,l){if(e!==Yi){if(!1===u&&(z(3042),u=!0),e===tr)a=a||n,o=o||i,s=s||r,n===d&&a===f||(t.blendEquationSeparate(O[n],O[a]),d=n,f=a),i===p&&r===m&&o===g&&s===v||(t.blendFuncSeparate(N[i],N[r],N[o],N[s]),p=i,m=r,g=o,v=s),h=e,y=null;else if(e!==h||l!==y){if(d===er&&f===er||(t.blendEquation(32774),d=er,f=er),l)switch(e){case Xi:t.blendFuncSeparate(1,771,1,771);break;case Qi:t.blendFunc(1,1);break;case Ji:t.blendFuncSeparate(0,0,769,771);break;case Ki:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case Xi:t.blendFuncSeparate(770,771,1,771);break;case Qi:t.blendFunc(770,1);break;case Ji:t.blendFunc(0,769);break;case Ki:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}p=null,m=null,g=null,v=null,h=e,y=l}}else!0===u&&(F(3042),u=!1)}function V(e){_!==e&&(e?t.frontFace(2304):t.frontFace(2305),_=e)}function G(e){e!==Ui?(z(2884),e!==x&&(e===Vi?t.cullFace(1029):e===Gi?t.cullFace(1028):t.cullFace(1032))):F(2884),x=e}function H(e,n,i){e?(z(32823),A===n&&w===i||(t.polygonOffset(n,i),A=n,w=i)):F(32823)}function j(e){void 0===e&&(e=33984+C-1),T!==e&&(t.activeTexture(e),T=e)}return{buffers:{color:r,depth:a,stencil:o},enable:z,disable:F,bindFramebuffer:function(e,n){return l[e]!==n&&(t.bindFramebuffer(e,n),l[e]=n,i&&(36009===e&&(l[36160]=n),36160===e&&(l[36009]=n)),!0)},useProgram:function(e){return c!==e&&(t.useProgram(e),c=e,!0)},setBlending:U,setMaterial:function(t,e){t.side===$i?F(2884):z(2884);let n=t.side===Zi;e&&(n=!n),V(n),t.blending===Xi&&!1===t.transparent?U(Yi):U(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),r.setMask(t.colorWrite);const i=t.stencilWrite;o.setTest(i),i&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),H(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?z(32926):F(32926)},setFlipSided:V,setCullFace:G,setLineWidth:function(e){e!==b&&(E&&t.lineWidth(e),b=e)},setPolygonOffset:H,setScissorTest:function(t){t?z(3089):F(3089)},activeTexture:j,bindTexture:function(e,n){null===T&&j();let i=I[T];void 0===i&&(i={type:void 0,texture:void 0},I[T]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||k[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=I[T];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===D.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===P.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),P.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),s={},T=null,I={},l={},c=null,u=!1,h=null,d=null,p=null,m=null,f=null,g=null,v=null,y=!1,_=null,x=null,b=null,A=null,w=null,D.set(0,0,t.canvas.width,t.canvas.height),P.set(0,0,t.canvas.width,t.canvas.height),r.reset(),a.reset(),o.reset()}}}function Jh(t,e,n,i,r,a,o){const s=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):void 0,p=new WeakMap;let m,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(t){}function g(t,e){return f?new OffscreenCanvas(t,e):Uo("canvas")}function v(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?zo:Math.floor,a=i(r*t.width),o=i(r*t.height);void 0===m&&(m=g(a,o));const s=n?g(a,o):m;return s.width=a,s.height=o,s.getContext("2d").drawImage(t,0,0,a,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+a+"x"+o+")."),s}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return ko(t.width)&&ko(t.height)}function _(t,e){return t.generateMipmaps&&e&&t.minFilter!==Hr&&t.minFilter!==qr}function x(e){t.generateMipmap(e)}function b(n,i,r){if(!1===s)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let a=i;return 6403===i&&(5126===r&&(a=33326),5131===r&&(a=33325),5121===r&&(a=33321)),6407===i&&(5126===r&&(a=34837),5131===r&&(a=34843),5121===r&&(a=32849)),6408===i&&(5126===r&&(a=34836),5131===r&&(a=34842),5121===r&&(a=32856)),33325!==a&&33326!==a&&34842!==a&&34836!==a||e.get("EXT_color_buffer_float"),a}function A(t){return t===Hr||t===jr||t===Wr?9728:9729}function w(e){const n=e.target;n.removeEventListener("dispose",w),function(e){const n=i.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),i.remove(e))}(n),n.isVideoTexture&&p.delete(n),o.memory.textures--}function C(e){const n=e.target;n.removeEventListener("dispose",C),function(e){const n=e.texture,r=i.get(e),a=i.get(n);if(e){if(void 0!==a.__webglTexture&&(t.deleteTexture(a.__webglTexture),o.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),o.memory.textures--),i.remove(n[e])}i.remove(n),i.remove(e)}}(n)}let E=0;function S(t,e){const r=i.get(t);if(t.isVideoTexture&&function(t){const e=o.render.frame;p.get(t)!==e&&(p.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void D(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function M(e,r){const o=i.get(e);e.version>0&&o.__version!==e.version?function(e,i,r){if(6!==i.image.length)return;L(e,i),n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const o=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),l=i.image[0]&&i.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=o||l?l?i.image[t].image:i.image[t]:v(i.image[t],!1,!0,c);const h=y(u[0])||s,d=a.convert(i.format),p=a.convert(i.type),m=b(i.internalFormat,d,p,i.encoding);let f;if(B(34067,i,h),o)for(let t=0;t<6;t++){f=u[t].mipmaps;for(let e=0;e<f.length;e++){const r=f[e];i.format!==ca&&i.format!==la?null!==d?n.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+t,e,m,r.width,r.height,0,d,p,r.data)}}else{f=i.mipmaps;for(let t=0;t<6;t++)if(l){n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,d,p,u[t].data);for(let e=0;e<f.length;e++){const i=f[e].image[t].image;n.texImage2D(34069+t,e+1,m,i.width,i.height,0,d,p,i.data)}}else{n.texImage2D(34069+t,0,m,d,p,u[t]);for(let e=0;e<f.length;e++){const i=f[e];n.texImage2D(34069+t,e+1,m,d,p,i.image[t])}}}_(i,h)&&x(34067),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}(o,e,r):(n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture))}const T={[Ur]:10497,[Vr]:33071,[Gr]:33648},I={[Hr]:9728,[jr]:9984,[Wr]:9986,[qr]:9729,[Zr]:9985,[$r]:9987};function B(n,a,o){if(o?(t.texParameteri(n,10242,T[a.wrapS]),t.texParameteri(n,10243,T[a.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,T[a.wrapR]),t.texParameteri(n,10240,I[a.magFilter]),t.texParameteri(n,10241,I[a.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),a.wrapS===Vr&&a.wrapT===Vr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,A(a.magFilter)),t.texParameteri(n,10241,A(a.minFilter)),a.minFilter!==Hr&&a.minFilter!==qr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(a.type===ea&&!1===e.has("OES_texture_float_linear"))return;if(!1===s&&a.type===na&&!1===e.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(t.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function L(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),o.memory.textures++)}function D(e,i,r){let o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),L(e,i),n.activeTexture(33984+r),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const l=function(t){return!s&&(t.wrapS!==Vr||t.wrapT!==Vr||t.minFilter!==Hr&&t.minFilter!==qr)}(i)&&!1===y(i.image),c=v(i.image,l,!1,u),h=y(c)||s,d=a.convert(i.format);let p,m=a.convert(i.type),f=b(i.internalFormat,d,m,i.encoding);B(o,i,h);const g=i.mipmaps;if(i.isDepthTexture)f=6402,s?f=i.type===ea?36012:i.type===ta?33190:i.type===oa?35056:33189:i.type===ea&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===pa&&6402===f&&i.type!==Jr&&i.type!==ta&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Jr,m=a.convert(i.type)),i.format===ma&&6402===f&&(f=34041,i.type!==oa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=oa,m=a.convert(i.type))),n.texImage2D(3553,0,f,c.width,c.height,0,d,m,null);else if(i.isDataTexture)if(g.length>0&&h){for(let t=0,e=g.length;t<e;t++)p=g[t],n.texImage2D(3553,t,f,p.width,p.height,0,d,m,p.data);i.generateMipmaps=!1}else n.texImage2D(3553,0,f,c.width,c.height,0,d,m,c.data);else if(i.isCompressedTexture)for(let t=0,e=g.length;t<e;t++)p=g[t],i.format!==ca&&i.format!==la?null!==d?n.compressedTexImage2D(3553,t,f,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,t,f,p.width,p.height,0,d,m,p.data);else if(i.isDataTexture2DArray)n.texImage3D(35866,0,f,c.width,c.height,c.depth,0,d,m,c.data);else if(i.isDataTexture3D)n.texImage3D(32879,0,f,c.width,c.height,c.depth,0,d,m,c.data);else{const t=function(t,e,n){return!0===_(t,n)?Math.log2(Math.max(e.width,e.height))+1:t.mipmaps.length>0?t.mipmaps.length:1}(i,c,h),r=s&&!0!==i.isVideoTexture,a=void 0===e.__version;if(g.length>0&&h){r&&a&&n.texStorage2D(3553,t,f,g[0].width,g[0].height);for(let t=0,e=g.length;t<e;t++)p=g[t],r?n.texSubImage2D(3553,t,0,0,d,m,p):n.texImage2D(3553,t,f,d,m,p);i.generateMipmaps=!1}else r?(a&&n.texStorage2D(3553,t,f,c.width,c.height),n.texSubImage2D(3553,0,0,0,d,m,c)):n.texImage2D(3553,0,f,d,m,c)}_(i,h)&&x(o),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function P(e,r,o,s,l){const c=a.convert(o.format),u=a.convert(o.type),h=b(o.internalFormat,c,u,o.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,h,r.width,r.height,0,c,u,null)),n.bindFramebuffer(36160,e),r.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,s,l,i.get(o).__webglTexture,0,z(r)):t.framebufferTexture2D(36160,s,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function R(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i||n.useRenderToTexture){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===ea?r=36012:e.type===ta&&(r=33190));const i=z(n);n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,i,r,n.width,n.height):t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){const r=z(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,r,35056,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,r,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,r=a.convert(e.format),o=a.convert(e.type),s=b(e.internalFormat,r,o,e.encoding),l=z(n);i&&n.useRenderbuffer?t.renderbufferStorageMultisample(36161,l,s,n.width,n.height):n.useRenderToTexture?d.renderbufferStorageMultisampleEXT(36161,l,s,n.width,n.height):t.renderbufferStorage(36161,s,n.width,n.height)}t.bindRenderbuffer(36161,null)}function k(e){const r=i.get(e),a=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),S(r.depthTexture,0);const a=i.get(r.depthTexture).__webglTexture,o=z(r);if(r.depthTexture.format===pa)r.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,o):t.framebufferTexture2D(36160,36096,3553,a,0);else{if(r.depthTexture.format!==ma)throw new Error("Unknown depthTexture format");r.useRenderToTexture?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,o):t.framebufferTexture2D(36160,33306,3553,a,0)}}(r.__webglFramebuffer,e)}else if(a){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),R(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),R(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function z(t){return s&&(t.useRenderbuffer||t.useRenderToTexture)?Math.min(h,t.samples):0}let F=!1,O=!1;this.allocateTextureUnit=function(){const t=E;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),E+=1,t},this.resetTextureUnits=function(){E=0},this.setTexture2D=S,this.setTexture2DArray=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?D(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?D(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=M,this.rebindTextures=function(t,e,n){const r=i.get(t);void 0!==e&&P(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&k(t)},this.setupRenderTarget=function(e){const l=e.texture,c=i.get(e),u=i.get(l);e.addEventListener("dispose",C),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=l.isDataTexture3D||l.isDataTexture2DArray,m=y(e)||s;if(!s||l.format!==la||l.type!==ea&&l.type!==na||(l.format=ca,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(e.useRenderbuffer)if(s){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=a.convert(l.format),r=a.convert(l.type),o=b(l.internalFormat,i,r,l.encoding),s=z(e);t.renderbufferStorageMultisample(36161,s,o,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),R(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),B(34067,l,m);for(let t=0;t<6;t++)P(c.__webglFramebuffer[t],e,l,36064,34069+t);_(l,m)&&x(34067),n.unbindTexture()}else if(d){const t=e.texture;for(let r=0,a=t.length;r<a;r++){const a=t[r],o=i.get(a);n.bindTexture(3553,o.__webglTexture),B(3553,a,m),P(c.__webglFramebuffer,e,a,36064+r,3553),_(a,m)&&x(3553)}n.unbindTexture()}else{let t=3553;p&&(s?t=l.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),B(t,l,m),P(c.__webglFramebuffer,e,l,36064,t),_(l,m)&&x(t),n.unbindTexture()}e.depthBuffer&&k(e)},this.updateRenderTargetMipmap=function(t){const e=y(t)||s,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let a=0,o=r.length;a<o;a++){const o=r[a];if(_(o,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=i.get(o).__webglTexture;n.bindTexture(e,r),x(e),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(e.useRenderbuffer)if(s){const r=e.width,a=e.height;let o=16384;const s=[36064],l=e.stencilBuffer?33306:36096;e.depthBuffer&&s.push(l),e.ignoreDepthForMultisampleCopy||(e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024));const c=i.get(e);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),e.ignoreDepthForMultisampleCopy&&(t.invalidateFramebuffer(36008,[l]),t.invalidateFramebuffer(36009,[l])),t.blitFramebuffer(0,0,r,a,0,0,r,a,o,9728),t.invalidateFramebuffer(36008,s),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.setupDepthRenderbuffer=k,this.setupFrameBufferTexture=P,this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),t=t.texture),S(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===O&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),O=!0),t=t.texture),M(t,e)}}function Kh(t,e,n){const i=n.isWebGL2;return{convert:function(t){let n;if(t===Yr)return 5121;if(t===ia)return 32819;if(t===ra)return 32820;if(t===aa)return 33635;if(t===Xr)return 5120;if(t===Qr)return 5122;if(t===Jr)return 5123;if(t===Kr)return 5124;if(t===ta)return 5125;if(t===ea)return 5126;if(t===na)return i?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(t===sa)return 6406;if(t===la)return 6407;if(t===ca)return 6408;if(t===ua)return 6409;if(t===ha)return 6410;if(t===pa)return 6402;if(t===ma)return 34041;if(t===fa)return 6403;if(t===ga)return 36244;if(t===va)return 33319;if(t===ya)return 33320;if(t===_a)return 36248;if(t===xa)return 36249;if(t===ba||t===Aa||t===wa||t===Ca){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(t===ba)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===Aa)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===wa)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===Ca)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(t===Ea||t===Sa||t===Ma||t===Ta){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(t===Ea)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===Sa)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===Ma)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===Ta)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(t===Ia)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((t===Ba||t===La)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(t===Ba)return n.COMPRESSED_RGB8_ETC2;if(t===La)return n.COMPRESSED_RGBA8_ETC2_EAC}return t===Da||t===Pa||t===Ra||t===ka||t===za||t===Fa||t===Oa||t===Na||t===Ua||t===Va||t===Ga||t===Ha||t===ja||t===Wa||t===Za||t===$a||t===Ya||t===Xa||t===Qa||t===Ja||t===Ka||t===to||t===eo||t===no||t===io||t===ro||t===ao||t===oo?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):t===qa?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):t===oa?i?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class td extends oc{constructor(t=[]){super(),this.cameras=t}}td.prototype.isArrayCamera=!0;class ed extends Ks{constructor(){super(),this.type="Group"}}ed.prototype.isGroup=!0;const nd={type:"move"};class id{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ed,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ed,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Qo,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Qo),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ed,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Qo,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Qo),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,a=null;const o=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==o&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(nd))),l&&t.hand){a=!0;for(const i of t.hand.values()){const t=e.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const t=new ed;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[i.jointName]=t,l.add(t)}const r=l.joints[i.jointName];null!==t&&(r.matrix.fromArray(t.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.jointRadius=t.radius),r.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],o=i.position.distanceTo(r.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==a),this}}class rd extends Wo{constructor(t,e,n,i,r,a,o,s,l,c){if((c=void 0!==c?c:pa)!==pa&&c!==ma)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===pa&&(n=Jr),void 0===n&&c===ma&&(n=oa),super(null,i,r,a,o,s,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:Hr,this.minFilter=void 0!==s?s:Hr,this.flipY=!1,this.generateMipmaps=!1}}rd.prototype.isDepthTexture=!0;class ad extends To{constructor(t,e){super();const n=this;let i=null,r=1,a=null,o="local-floor";const s=t.extensions.has("WEBGL_multisampled_render_to_texture");let l=null,c=null,u=null,h=null,d=!1,p=null;const m=e.getContextAttributes();let f=null,g=null;const v=[],y=new Map,_=new oc;_.layers.enable(1),_.viewport=new Zo;const x=new oc;x.layers.enable(2),x.viewport=new Zo;const b=[_,x],A=new td;A.layers.enable(1),A.layers.enable(2);let w=null,C=null;function E(t){const e=y.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function S(){y.forEach((function(t,e){t.disconnect(e)})),y.clear(),w=null,C=null,t.setRenderTarget(f),h=null,u=null,c=null,i=null,g=null,D.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function M(t){const e=i.inputSources;for(let t=0;t<v.length;t++)y.set(e[t],v[t]);for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=y.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),y.delete(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e],i=y.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=v[t];return void 0===e&&(e=new id,v[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=v[t];return void 0===e&&(e=new id,v[t]=e),e.getGripSpace()},this.getHand=function(t){let e=v[t];return void 0===e&&(e=new id,v[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){r=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){o=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return a},this.getBaseLayer=function(){return null!==u?u:h},this.getBinding=function(){return c},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(l){if(i=l,null!==i){if(f=t.getRenderTarget(),i.addEventListener("select",E),i.addEventListener("selectstart",E),i.addEventListener("selectend",E),i.addEventListener("squeeze",E),i.addEventListener("squeezestart",E),i.addEventListener("squeezeend",E),i.addEventListener("end",S),i.addEventListener("inputsourceschange",M),!0!==m.xrCompatible&&await e.makeXRCompatible(),void 0===i.renderState.layers||!1===t.capabilities.isWebGL2){const t={antialias:void 0!==i.renderState.layers||m.antialias,alpha:m.alpha,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:r};h=new XRWebGLLayer(i,e,t),i.updateRenderState({baseLayer:h}),g=new $o(h.framebufferWidth,h.framebufferHeight)}else{d=m.antialias;let t=null,n=null,a=null;m.depth&&(a=m.stencil?35056:33189,t=m.stencil?ma:pa,n=m.stencil?oa:Jr);const o={colorFormat:m.alpha||d?32856:32849,depthFormat:a,scaleFactor:r};c=new XRWebGLBinding(i,e),u=c.createProjectionLayer(o),i.updateRenderState({layers:[u]}),g=d?new Yo(u.textureWidth,u.textureHeight,{format:ca,type:Yr,depthTexture:new rd(u.textureWidth,u.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,t),stencilBuffer:m.stencil,ignoreDepth:u.ignoreDepthValues,useRenderToTexture:s}):new $o(u.textureWidth,u.textureHeight,{format:m.alpha?ca:la,type:Yr,depthTexture:new rd(u.textureWidth,u.textureHeight,n,void 0,void 0,void 0,void 0,void 0,void 0,t),stencilBuffer:m.stencil,ignoreDepth:u.ignoreDepthValues})}this.setFoveation(0),a=await i.requestReferenceSpace(o),D.setContext(i),D.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const T=new Qo,I=new Qo;function B(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===i)return;A.near=x.near=_.near=t.near,A.far=x.far=_.far=t.far,w===A.near&&C===A.far||(i.updateRenderState({depthNear:A.near,depthFar:A.far}),w=A.near,C=A.far);const e=t.parent,n=A.cameras;B(A,e);for(let t=0;t<n.length;t++)B(n[t],e);A.matrixWorld.decompose(A.position,A.quaternion,A.scale),t.position.copy(A.position),t.quaternion.copy(A.quaternion),t.scale.copy(A.scale),t.matrix.copy(A.matrix),t.matrixWorld.copy(A.matrixWorld);const r=t.children;for(let t=0,e=r.length;t<e;t++)r[t].updateMatrixWorld(!0);2===n.length?function(t,e,n){T.setFromMatrixPosition(e.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const i=T.distanceTo(I),r=e.projectionMatrix.elements,a=n.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(a[8]+1)/a[0],d=o*u,p=o*h,m=i/(-u+h),f=m*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(f),t.translateZ(m),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+m,v=s+m,y=d-f,_=p+(i-f),x=l*s/v*g,b=c*s/v*g;t.projectionMatrix.makePerspective(y,_,x,b,g,v)}(A,_,x):A.projectionMatrix.copy(_.projectionMatrix)},this.getCamera=function(){return A},this.getFoveation=function(){return null!==u?u.fixedFoveation:null!==h?h.fixedFoveation:void 0},this.setFoveation=function(t){null!==u&&(u.fixedFoveation=t),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=t)};let L=null;const D=new yc;D.setAnimationLoop((function(e,n){if(l=n.getViewerPose(a),p=n,null!==l){const e=l.views;null!==h&&(t.setRenderTargetFramebuffer(g,h.framebuffer),t.setRenderTarget(g));let n=!1;e.length!==A.cameras.length&&(A.cameras.length=0,n=!0);for(let i=0;i<e.length;i++){const r=e[i];let a=null;if(null!==h)a=h.getViewport(r);else{const e=c.getViewSubImage(u,r);a=e.viewport,0===i&&(t.setRenderTargetTextures(g,e.colorTexture,u.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(g))}const o=b[i];o.matrix.fromArray(r.transform.matrix),o.projectionMatrix.fromArray(r.projectionMatrix),o.viewport.set(a.x,a.y,a.width,a.height),0===i&&A.matrix.copy(o.matrix),!0===n&&A.cameras.push(o)}}const r=i.inputSources;for(let t=0;t<v.length;t++){const e=v[t],i=r[t];e.update(i,n,a)}L&&L(e,n),p=null})),this.setAnimationLoop=function(t){L=t},this.dispose=function(){}}}function od(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);const i=t.get(n).envMap;let r,a;i&&(e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap?r=n.clearcoatRoughnessMap:n.specularIntensityMap?r=n.specularIntensityMap:n.specularColorMap?r=n.specularColorMap:n.transmissionMap?r=n.transmissionMap:n.thicknessMap?r=n.thicknessMap:n.sheenColorMap?r=n.sheenColorMap:n.sheenRoughnessMap&&(r=n.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),e.uv2Transform.value.copy(a.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,n.side===Zi&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),n.side===Zi&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,a,o){i.isMeshBasicMaterial?e(t,i):i.isMeshLambertMaterial?(e(t,i),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,i)):i.isMeshToonMaterial?(e(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Zi&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Zi&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshPhongMaterial?(e(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Zi&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Zi&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshStandardMaterial?(e(t,i),i.isMeshPhysicalMaterial?function(t,e,i){n(t,e),t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap)),e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,e.side===Zi&&t.clearcoatNormalScale.value.negate())),e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)),t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,i,o):n(t,i)):i.isMeshMatcapMaterial?(e(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Zi&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Zi&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDepthMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDistanceMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?(e(t,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,e.side===Zi&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),e.side===Zi&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){let r;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,a):i.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.alphaTest>0&&(t.alphaTest.value=e.alphaTest),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function sd(t={}){const e=void 0!==t.canvas?t.canvas:function(){const t=Uo("canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],m=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=mo,this.physicallyCorrectLights=!1,this.toneMapping=Tr,this.toneMappingExposure=1;const f=this;let g=!1,v=0,y=0,_=null,x=-1,b=null;const A=new Zo,w=new Zo;let C=null,E=e.width,S=e.height,M=1,T=null,I=null;const B=new Zo(0,0,E,S),L=new Zo(0,0,E,S);let D=!1;const P=[],R=new vc;let k=!1,z=!1,F=null;const O=new Ts,N=new Qo,U={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function V(){return null===_?M:1}let G,H,j,W,q,Z,$,Y,X,Q,J,K,tt,et,nt,it,rt,at,ot,st,lt,ct,ut,ht=n;function dt(t,n){for(let i=0;i<t.length;i++){const r=t[i],a=e.getContext(r,n);if(null!==a)return a}return null}try{const t={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Ni}`),e.addEventListener("webglcontextlost",ft,!1),e.addEventListener("webglcontextrestored",gt,!1),null===ht){const e=["webgl2","webgl","experimental-webgl"];if(!0===f.isWebGL1Renderer&&e.shift(),ht=dt(e,t),null===ht)throw dt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ht.getShaderPrecisionFormat&&(ht.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){throw console.error("THREE.WebGLRenderer: "+t.message),t}function pt(){G=new Kc(ht),H=new Mc(ht,G,t),G.init(H),ct=new Kh(ht,G,H),j=new Qh(ht,G,H),P[0]=1029,W=new nu(ht),q=new kh,Z=new Jh(ht,G,j,q,H,ct,W),$=new Ic(f),Y=new Jc(f),X=new _c(ht,H),ut=new Ec(ht,G,X,H),Q=new tu(ht,X,W,ut),J=new lu(ht,Q,X,W),ot=new su(ht,H,Z),it=new Tc(q),K=new Rh(f,$,Y,G,H,ut,it),tt=new od(q),et=new Nh(q),nt=new Wh(G,H),at=new Cc(f,$,j,J,s),rt=new Xh(f,J,H),st=new Sc(ht,G,W,H),lt=new eu(ht,G,W,H),W.programs=K.programs,f.capabilities=H,f.extensions=G,f.properties=q,f.renderLists=et,f.shadowMap=rt,f.state=j,f.info=W}pt();const mt=new ad(f,ht);function ft(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function gt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=W.autoReset,e=rt.enabled,n=rt.autoUpdate,i=rt.needsUpdate,r=rt.type;pt(),W.autoReset=t,rt.enabled=e,rt.autoUpdate=n,rt.needsUpdate=i,rt.type=r}function vt(t){const e=t.target;e.removeEventListener("dispose",vt),function(t){(function(t){const e=q.get(t).programs;void 0!==e&&e.forEach((function(t){K.releaseProgram(t)}))})(t),q.remove(t)}(e)}this.xr=mt,this.getContext=function(){return ht},this.getContextAttributes=function(){return ht.getContextAttributes()},this.forceContextLoss=function(){const t=G.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=G.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return M},this.setPixelRatio=function(t){void 0!==t&&(M=t,this.setSize(E,S,!1))},this.getSize=function(t){return t.set(E,S)},this.setSize=function(t,n,i){mt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=t,S=n,e.width=Math.floor(t*M),e.height=Math.floor(n*M),!1!==i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(E*M,S*M).floor()},this.setDrawingBufferSize=function(t,n,i){E=t,S=n,M=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(A)},this.getViewport=function(t){return t.copy(B)},this.setViewport=function(t,e,n,i){t.isVector4?B.set(t.x,t.y,t.z,t.w):B.set(t,e,n,i),j.viewport(A.copy(B).multiplyScalar(M).floor())},this.getScissor=function(t){return t.copy(L)},this.setScissor=function(t,e,n,i){t.isVector4?L.set(t.x,t.y,t.z,t.w):L.set(t,e,n,i),j.scissor(w.copy(L).multiplyScalar(M).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(t){j.setScissorTest(D=t)},this.setOpaqueSort=function(t){T=t},this.setTransparentSort=function(t){I=t},this.getClearColor=function(t){return t.copy(at.getClearColor())},this.setClearColor=function(){at.setClearColor.apply(at,arguments)},this.getClearAlpha=function(){return at.getClearAlpha()},this.setClearAlpha=function(){at.setClearAlpha.apply(at,arguments)},this.clear=function(t,e,n){let i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),ht.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ft,!1),e.removeEventListener("webglcontextrestored",gt,!1),et.dispose(),nt.dispose(),q.dispose(),$.dispose(),Y.dispose(),J.dispose(),ut.dispose(),mt.dispose(),mt.removeEventListener("sessionstart",_t),mt.removeEventListener("sessionend",xt),F&&(F.dispose(),F=null),bt.stop()},this.renderBufferDirect=function(t,e,n,i,r,a){null===e&&(e=U);const o=r.isMesh&&r.matrixWorld.determinant()<0,s=function(t,e,n,i,r){!0!==e.isScene&&(e=U),Z.resetTextureUnits();const a=e.fog,o=i.isMeshStandardMaterial?e.environment:null,s=null===_?f.outputEncoding:_.texture.encoding,l=(i.isMeshStandardMaterial?Y:$).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!i.normalMap&&!!n.attributes.tangent,h=!!n.morphAttributes.position,p=!!n.morphAttributes.normal,m=n.morphAttributes.position?n.morphAttributes.position.length:0,g=q.get(i),v=d.state.lights;if(!0===k&&(!0===z||t!==b)){const e=t===b&&i.id===x;it.setState(i,t,e)}let y=!1;i.version===g.__version?g.needsLights&&g.lightsStateVersion!==v.state.version||g.outputEncoding!==s||r.isInstancedMesh&&!1===g.instancing?y=!0:r.isInstancedMesh||!0!==g.instancing?r.isSkinnedMesh&&!1===g.skinning?y=!0:r.isSkinnedMesh||!0!==g.skinning?g.envMap!==l||i.fog&&g.fog!==a?y=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===it.numPlanes&&g.numIntersection===it.numIntersection?(g.vertexAlphas!==c||g.vertexTangents!==u||g.morphTargets!==h||g.morphNormals!==p||!0===H.isWebGL2&&g.morphTargetsCount!==m)&&(y=!0):y=!0:y=!0:y=!0:(y=!0,g.__version=i.version);let A=g.currentProgram;!0===y&&(A=St(i,e,r));let w=!1,C=!1,E=!1;const T=A.getUniforms(),I=g.uniforms;if(j.useProgram(A.program)&&(w=!0,C=!0,E=!0),i.id!==x&&(x=i.id,C=!0),w||b!==t){if(T.setValue(ht,"projectionMatrix",t.projectionMatrix),H.logarithmicDepthBuffer&&T.setValue(ht,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),b!==t&&(b=t,C=!0,E=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const e=T.map.cameraPosition;void 0!==e&&e.setValue(ht,N.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&T.setValue(ht,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&T.setValue(ht,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){T.setOptional(ht,r,"bindMatrix"),T.setOptional(ht,r,"bindMatrixInverse");const t=r.skeleton;t&&(H.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),T.setValue(ht,"boneTexture",t.boneTexture,Z),T.setValue(ht,"boneTextureSize",t.boneTextureSize)):T.setOptional(ht,t,"boneMatrices"))}var B,L;return!n||void 0===n.morphAttributes.position&&void 0===n.morphAttributes.normal||ot.update(r,n,i,A),(C||g.receiveShadow!==r.receiveShadow)&&(g.receiveShadow=r.receiveShadow,T.setValue(ht,"receiveShadow",r.receiveShadow)),C&&(T.setValue(ht,"toneMappingExposure",f.toneMappingExposure),g.needsLights&&(L=E,(B=I).ambientLightColor.needsUpdate=L,B.lightProbe.needsUpdate=L,B.directionalLights.needsUpdate=L,B.directionalLightShadows.needsUpdate=L,B.pointLights.needsUpdate=L,B.pointLightShadows.needsUpdate=L,B.spotLights.needsUpdate=L,B.spotLightShadows.needsUpdate=L,B.rectAreaLights.needsUpdate=L,B.hemisphereLights.needsUpdate=L),a&&i.fog&&tt.refreshFogUniforms(I,a),tt.refreshMaterialUniforms(I,i,M,S,F),ph.upload(ht,g.uniformsList,I,Z)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ph.upload(ht,g.uniformsList,I,Z),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&T.setValue(ht,"center",r.center),T.setValue(ht,"modelViewMatrix",r.modelViewMatrix),T.setValue(ht,"normalMatrix",r.normalMatrix),T.setValue(ht,"modelMatrix",r.matrixWorld),A}(t,e,n,i,r);j.setMaterial(i,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=Q.getWireframeAttribute(n),h=2),ut.setup(r,i,s,n,l);let p=st;null!==l&&(u=X.get(l),p=lt,p.setIndex(u));const m=null!==l?l.count:c.count,g=n.drawRange.start*h,v=n.drawRange.count*h,y=null!==a?a.start*h:0,A=null!==a?a.count*h:1/0,w=Math.max(g,y),C=Math.min(m,g+v,y+A)-1,E=Math.max(0,C-w+1);if(0!==E){if(r.isMesh)!0===i.wireframe?(j.setLineWidth(i.wireframeLinewidth*V()),p.setMode(1)):p.setMode(4);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),j.setLineWidth(t*V()),r.isLineSegments?p.setMode(1):r.isLineLoop?p.setMode(2):p.setMode(3)}else r.isPoints?p.setMode(0):r.isSprite&&p.setMode(4);if(r.isInstancedMesh)p.renderInstances(w,E,r.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);p.renderInstances(w,E,t)}else p.render(w,E)}},this.compile=function(t,e){d=nt.get(t),d.init(),m.push(d),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(f.physicallyCorrectLights),t.traverse((function(e){const n=e.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++)St(n[i],t,e);else St(n,t,e)})),m.pop(),d=null};let yt=null;function _t(){bt.stop()}function xt(){bt.start()}const bt=new yc;function At(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||R.intersectsSprite(t)){i&&N.setFromMatrixPosition(t.matrixWorld).applyMatrix4(O);const e=J.update(t),r=t.material;r.visible&&h.push(t,e,r,n,N.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==W.render.frame&&(t.skeleton.update(),t.skeleton.frame=W.render.frame),!t.frustumCulled||R.intersectsObject(t))){i&&N.setFromMatrixPosition(t.matrixWorld).applyMatrix4(O);const e=J.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let a=0,o=i.length;a<o;a++){const o=i[a],s=r[o.materialIndex];s&&s.visible&&h.push(t,e,s,n,N.z,o)}}else r.visible&&h.push(t,e,r,n,N.z,null)}const r=t.children;for(let t=0,a=r.length;t<a;t++)At(r[t],e,n,i)}function wt(t,e,n,i){const r=t.opaque,a=t.transmissive,s=t.transparent;d.setupLightsView(n),a.length>0&&function(t,e,n){if(null===F){const t=!0===o&&!0===H.isWebGL2;F=new(t?Yo:$o)(1024,1024,{generateMipmaps:!0,type:null!==ct.convert(na)?na:Yr,minFilter:$r,magFilter:Hr,wrapS:Vr,wrapT:Vr,useRenderToTexture:G.has("WEBGL_multisampled_render_to_texture")})}const i=f.getRenderTarget();f.setRenderTarget(F),f.clear();const r=f.toneMapping;f.toneMapping=Tr,Ct(t,e,n),f.toneMapping=r,Z.updateMultisampleRenderTarget(F),Z.updateRenderTargetMipmap(F),f.setRenderTarget(i)}(r,e,n),i&&j.viewport(A.copy(i)),r.length>0&&Ct(r,e,n),a.length>0&&Ct(a,e,n),s.length>0&&Ct(s,e,n)}function Ct(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,a=t.length;r<a;r++){const a=t[r],o=a.object,s=a.geometry,l=null===i?a.material:i,c=a.group;o.layers.test(n.layers)&&Et(o,e,n,s,l,c)}}function Et(t,e,n,i,r,a){t.onBeforeRender(f,e,n,i,r,a),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(f,e,n,i,t,a),!0===r.transparent&&r.side===$i?(r.side=Zi,r.needsUpdate=!0,f.renderBufferDirect(n,e,i,r,t,a),r.side=qi,r.needsUpdate=!0,f.renderBufferDirect(n,e,i,r,t,a),r.side=$i):f.renderBufferDirect(n,e,i,r,t,a),t.onAfterRender(f,e,n,i,r,a)}function St(t,e,n){!0!==e.isScene&&(e=U);const i=q.get(t),r=d.state.lights,a=d.state.shadowsArray,o=r.state.version,s=K.getParameters(t,r.state,a,e,n),l=K.getProgramCacheKey(s);let c=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?Y:$).get(t.envMap||i.environment),void 0===c&&(t.addEventListener("dispose",vt),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return Mt(t,s),u}else s.uniforms=K.getUniforms(t),t.onBuild(n,s,f),t.onBeforeCompile(s,f),u=K.acquireProgram(s,l),c.set(l,u),i.uniforms=s.uniforms;const h=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(h.clippingPlanes=it.uniform),Mt(t,s),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=r.state.ambient,h.lightProbe.value=r.state.probe,h.directionalLights.value=r.state.directional,h.directionalLightShadows.value=r.state.directionalShadow,h.spotLights.value=r.state.spot,h.spotLightShadows.value=r.state.spotShadow,h.rectAreaLights.value=r.state.rectArea,h.ltc_1.value=r.state.rectAreaLTC1,h.ltc_2.value=r.state.rectAreaLTC2,h.pointLights.value=r.state.point,h.pointLightShadows.value=r.state.pointShadow,h.hemisphereLights.value=r.state.hemi,h.directionalShadowMap.value=r.state.directionalShadowMap,h.directionalShadowMatrix.value=r.state.directionalShadowMatrix,h.spotShadowMap.value=r.state.spotShadowMap,h.spotShadowMatrix.value=r.state.spotShadowMatrix,h.pointShadowMap.value=r.state.pointShadowMap,h.pointShadowMatrix.value=r.state.pointShadowMatrix);const p=u.getUniforms(),m=ph.seqWithValue(p.seq,h);return i.currentProgram=u,i.uniformsList=m,u}function Mt(t,e){const n=q.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents}bt.setAnimationLoop((function(t){yt&&yt(t)})),"undefined"!=typeof window&&bt.setContext(window),this.setAnimationLoop=function(t){yt=t,mt.setAnimationLoop(t),null===t?bt.stop():bt.start()},mt.addEventListener("sessionstart",_t),mt.addEventListener("sessionend",xt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===mt.enabled&&!0===mt.isPresenting&&(!0===mt.cameraAutoUpdate&&mt.updateCamera(e),e=mt.getCamera()),!0===t.isScene&&t.onBeforeRender(f,t,e,_),d=nt.get(t,m.length),d.init(),m.push(d),O.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),R.setFromProjectionMatrix(O),z=this.localClippingEnabled,k=it.init(this.clippingPlanes,z,e),h=et.get(t,p.length),h.init(),p.push(h),At(t,e,0,f.sortObjects),h.finish(),!0===f.sortObjects&&h.sort(T,I),!0===k&&it.beginShadows();const n=d.state.shadowsArray;if(rt.render(n,t,e),!0===k&&it.endShadows(),!0===this.info.autoReset&&this.info.reset(),at.render(h,t),d.setupLights(f.physicallyCorrectLights),e.isArrayCamera){const n=e.cameras;for(let e=0,i=n.length;e<i;e++){const i=n[e];wt(h,t,i,i.viewport)}}else wt(h,t,e);null!==_&&(Z.updateMultisampleRenderTarget(_),Z.updateRenderTargetMipmap(_)),!0===t.isScene&&t.onAfterRender(f,t,e),j.buffers.depth.setTest(!0),j.buffers.depth.setMask(!0),j.buffers.color.setMask(!0),j.setPolygonOffset(!1),ut.resetDefaultState(),x=-1,b=null,m.pop(),d=m.length>0?m[m.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(t,e,n){q.get(t.texture).__webglTexture=e,q.get(t.depthTexture).__webglTexture=n;const i=q.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||t.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),t.useRenderToTexture=!1,t.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(t,e){const n=q.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){_=t,v=e,y=n;let i=!0;if(t){const e=q.get(t);void 0!==e.__useDefaultFramebuffer?(j.bindFramebuffer(36160,null),i=!1):void 0===e.__webglFramebuffer?Z.setupRenderTarget(t):e.__hasExternalTextures&&Z.rebindTextures(t,q.get(t.texture).__webglTexture,q.get(t.depthTexture).__webglTexture)}let r=null,a=!1,o=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(o=!0);const i=q.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=i[e],a=!0):r=t.useRenderbuffer?q.get(t).__webglMultisampledFramebuffer:i,A.copy(t.viewport),w.copy(t.scissor),C=t.scissorTest}else A.copy(B).multiplyScalar(M).floor(),w.copy(L).multiplyScalar(M).floor(),C=D;if(j.bindFramebuffer(36160,r)&&H.drawBuffers&&i){let e=!1;if(t)if(t.isWebGLMultipleRenderTargets){const n=t.texture;if(P.length!==n.length||36064!==P[0]){for(let t=0,e=n.length;t<e;t++)P[t]=36064+t;P.length=n.length,e=!0}}else 1===P.length&&36064===P[0]||(P[0]=36064,P.length=1,e=!0);else 1===P.length&&1029===P[0]||(P[0]=1029,P.length=1,e=!0);e&&(H.isWebGL2?ht.drawBuffers(P):G.get("WEBGL_draw_buffers").drawBuffersWEBGL(P))}if(j.viewport(A),j.scissor(w),j.setScissorTest(C),a){const i=q.get(t.texture);ht.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}else if(o){const i=q.get(t.texture),r=e||0;ht.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,r)}x=-1},this.readRenderTargetPixels=function(t,e,n,i,r,a,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let s=q.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){j.bindFramebuffer(36160,s);try{const o=t.texture,s=o.format,l=o.type;if(s!==ca&&ct.convert(s)!==ht.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===na&&(G.has("EXT_color_buffer_half_float")||H.isWebGL2&&G.has("EXT_color_buffer_float"));if(!(l===Yr||ct.convert(l)===ht.getParameter(35738)||l===ea&&(H.isWebGL2||G.has("OES_texture_float")||G.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ht.checkFramebufferStatus(36160)?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&ht.readPixels(e,n,i,r,ct.convert(s),ct.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const t=null!==_?q.get(_).__webglFramebuffer:null;j.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),a=Math.floor(e.image.height*i);let o=ct.convert(e.format);H.isWebGL2&&(6407===o&&(o=32849),6408===o&&(o=32856)),Z.setTexture2D(e,0),ht.copyTexImage2D(3553,n,o,t.x,t.y,r,a,0),j.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,a=e.image.height,o=ct.convert(n.format),s=ct.convert(n.type);Z.setTexture2D(n,0),ht.pixelStorei(37440,n.flipY),ht.pixelStorei(37441,n.premultiplyAlpha),ht.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?ht.texSubImage2D(3553,i,t.x,t.y,r,a,o,s,e.image.data):e.isCompressedTexture?ht.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):ht.texSubImage2D(3553,i,t.x,t.y,o,s,e.image),0===i&&n.generateMipmaps&&ht.generateMipmap(3553),j.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(f.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const a=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,s=t.max.z-t.min.z+1,l=ct.convert(i.format),c=ct.convert(i.type);let u;if(i.isDataTexture3D)Z.setTexture3D(i,0),u=32879;else{if(!i.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(i,0),u=35866}ht.pixelStorei(37440,i.flipY),ht.pixelStorei(37441,i.premultiplyAlpha),ht.pixelStorei(3317,i.unpackAlignment);const h=ht.getParameter(3314),d=ht.getParameter(32878),p=ht.getParameter(3316),m=ht.getParameter(3315),g=ht.getParameter(32877),v=n.isCompressedTexture?n.mipmaps[0]:n.image;ht.pixelStorei(3314,v.width),ht.pixelStorei(32878,v.height),ht.pixelStorei(3316,t.min.x),ht.pixelStorei(3315,t.min.y),ht.pixelStorei(32877,t.min.z),n.isDataTexture||n.isDataTexture3D?ht.texSubImage3D(u,r,e.x,e.y,e.z,a,o,s,l,c,v.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ht.compressedTexSubImage3D(u,r,e.x,e.y,e.z,a,o,s,l,v.data)):ht.texSubImage3D(u,r,e.x,e.y,e.z,a,o,s,l,c,v),ht.pixelStorei(3314,h),ht.pixelStorei(32878,d),ht.pixelStorei(3316,p),ht.pixelStorei(3315,m),ht.pixelStorei(32877,g),0===r&&i.generateMipmaps&&ht.generateMipmap(u),j.unbindTexture()},this.initTexture=function(t){Z.setTexture2D(t,0),j.unbindTexture()},this.resetState=function(){v=0,y=0,_=null,j.reset(),ut.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}sd.prototype.isWebGLRenderer=!0,class extends sd{}.prototype.isWebGL1Renderer=!0;class ld{constructor(t,e=25e-5){this.name="",this.color=new _l(t),this.density=e}clone(){return new ld(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}ld.prototype.isFogExp2=!0;class cd{constructor(t,e=1,n=1e3){this.name="",this.color=new _l(t),this.near=e,this.far=n}clone(){return new cd(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}cd.prototype.isFog=!0;class ud extends Ks{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}ud.prototype.isScene=!0;class hd{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Eo,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Do()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Do()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Do()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}hd.prototype.isInterleavedBuffer=!0;const dd=new Qo;class pd{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)dd.x=this.getX(e),dd.y=this.getY(e),dd.z=this.getZ(e),dd.applyMatrix4(t),this.setXYZ(e,dd.x,dd.y,dd.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)dd.x=this.getX(e),dd.y=this.getY(e),dd.z=this.getZ(e),dd.applyNormalMatrix(t),this.setXYZ(e,dd.x,dd.y,dd.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)dd.x=this.getX(e),dd.y=this.getY(e),dd.z=this.getZ(e),dd.transformDirection(t),this.setXYZ(e,dd.x,dd.y,dd.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new wl(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new pd(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}pd.prototype.isInterleavedBufferAttribute=!0;class md extends dl{constructor(t){super(),this.type="SpriteMaterial",this.color=new _l(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let fd;md.prototype.isSpriteMaterial=!0;const gd=new Qo,vd=new Qo,yd=new Qo,_d=new Fo,xd=new Fo,bd=new Ts,Ad=new Qo,wd=new Qo,Cd=new Qo,Ed=new Fo,Sd=new Fo,Md=new Fo;function Td(t,e,n,i,r,a){_d.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(xd.x=a*_d.x-r*_d.y,xd.y=r*_d.x+a*_d.y):xd.copy(_d),t.copy(e),t.x+=xd.x,t.y+=xd.y,t.applyMatrix4(bd)}(class extends Ks{constructor(t){if(super(),this.type="Sprite",void 0===fd){fd=new Rl;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new hd(t,5);fd.setIndex([0,1,2,0,2,3]),fd.setAttribute("position",new pd(e,3,0,!1)),fd.setAttribute("uv",new pd(e,2,3,!1))}this.geometry=fd,this.material=void 0!==t?t:new md,this.center=new Fo(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vd.setFromMatrixScale(this.matrixWorld),bd.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),yd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&vd.multiplyScalar(-yd.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const a=this.center;Td(Ad.set(-.5,-.5,0),yd,a,vd,i,r),Td(wd.set(.5,-.5,0),yd,a,vd,i,r),Td(Cd.set(.5,.5,0),yd,a,vd,i,r),Ed.set(0,0),Sd.set(1,0),Md.set(1,1);let o=t.ray.intersectTriangle(Ad,wd,Cd,!1,gd);if(null===o&&(Td(wd.set(-.5,.5,0),yd,a,vd,i,r),Sd.set(0,1),o=t.ray.intersectTriangle(Ad,Cd,wd,!1,gd),null===o))return;const s=t.ray.origin.distanceTo(gd);s<t.near||s>t.far||e.push({distance:s,point:gd.clone(),uv:ul.getUV(gd,Ad,wd,Cd,Ed,Sd,Md,new Fo),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}).prototype.isSprite=!0;const Id=new Qo,Bd=new Zo,Ld=new Zo,Dd=new Qo,Pd=new Ts;class Rd extends Jl{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ts,this.bindMatrixInverse=new Ts}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new Zo,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,i=this.geometry;Bd.fromBufferAttribute(i.attributes.skinIndex,t),Ld.fromBufferAttribute(i.attributes.skinWeight,t),Id.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let t=0;t<4;t++){const i=Ld.getComponent(t);if(0!==i){const r=Bd.getComponent(t);Pd.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),e.addScaledVector(Dd.copy(Id).applyMatrix4(Pd),i)}}return e.applyMatrix4(this.bindMatrixInverse)}}Rd.prototype.isSkinnedMesh=!0;(class extends Ks{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;class kd extends Wo{constructor(t=null,e=1,n=1,i,r,a,o,s,l=Hr,c=Hr,u,h){super(null,a,o,s,l,c,i,r,u,h),this.image={data:t,width:e,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}kd.prototype.isDataTexture=!0;class zd extends wl{constructor(t,e,n,i=1){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}zd.prototype.isInstancedBufferAttribute=!0;const Fd=new Ts,Od=new Ts,Nd=[],Ud=new Jl;(class extends Jl{constructor(t,e,n){super(t,e),this.instanceMatrix=new zd(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,i=this.count;if(Ud.geometry=this.geometry,Ud.material=this.material,void 0!==Ud.material)for(let r=0;r<i;r++){this.getMatrixAt(r,Fd),Od.multiplyMatrices(n,Fd),Ud.matrixWorld=Od,Ud.raycast(t,Nd);for(let t=0,n=Nd.length;t<n;t++){const n=Nd[t];n.instanceId=r,n.object=this,e.push(n)}Nd.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new zd(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class Vd extends dl{constructor(t){super(),this.type="LineBasicMaterial",this.color=new _l(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}}Vd.prototype.isLineBasicMaterial=!0;const Gd=new Qo,Hd=new Qo,jd=new Ts,Wd=new Ms,qd=new _s;class Zd extends Ks{constructor(t=new Rl,e=new Vd){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)Gd.fromBufferAttribute(e,t-1),Hd.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=Gd.distanceTo(Hd);t.setAttribute("lineDistance",new Sl(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qd.copy(n.boundingSphere),qd.applyMatrix4(i),qd.radius+=r,!1===t.ray.intersectsSphere(qd))return;jd.copy(i).invert(),Wd.copy(t.ray).applyMatrix4(jd);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new Qo,c=new Qo,u=new Qo,h=new Qo,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position;if(null!==i)for(let n=Math.max(0,a.start),o=Math.min(i.count,a.start+a.count)-1;n<o;n+=d){const a=i.getX(n),o=i.getX(n+1);if(l.fromBufferAttribute(r,a),c.fromBufferAttribute(r,o),Wd.distanceSqToSegment(l,c,h,u)>s)continue;h.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(h);d<t.near||d>t.far||e.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,a.start),i=Math.min(r.count,a.start+a.count)-1;n<i;n+=d){if(l.fromBufferAttribute(r,n),c.fromBufferAttribute(r,n+1),Wd.distanceSqToSegment(l,c,h,u)>s)continue;h.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(h);i<t.near||i>t.far||e.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Zd.prototype.isLine=!0;const $d=new Qo,Yd=new Qo;class Xd extends Zd{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)$d.fromBufferAttribute(e,t),Yd.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+$d.distanceTo(Yd);t.setAttribute("lineDistance",new Sl(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Xd.prototype.isLineSegments=!0;(class extends Zd{constructor(t,e){super(t,e),this.type="LineLoop"}}).prototype.isLineLoop=!0;class Qd extends dl{constructor(t){super(),this.type="PointsMaterial",this.color=new _l(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}}Qd.prototype.isPointsMaterial=!0;const Jd=new Ts,Kd=new Ms,tp=new _s,ep=new Qo;function np(t,e,n,i,r,a,o){const s=Kd.distanceSqToPoint(t);if(s<n){const n=new Qo;Kd.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:n,index:e,face:null,object:o})}}(class extends Ks{constructor(t=new Rl,e=new Qd){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),tp.copy(n.boundingSphere),tp.applyMatrix4(i),tp.radius+=r,!1===t.ray.intersectsSphere(tp))return;Jd.copy(i).invert(),Kd.copy(t.ray).applyMatrix4(Jd);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position;if(null!==r)for(let n=Math.max(0,a.start),l=Math.min(r.count,a.start+a.count);n<l;n++){const a=r.getX(n);ep.fromBufferAttribute(o,a),np(ep,a,s,i,t,e,this)}else for(let n=Math.max(0,a.start),r=Math.min(o.count,a.start+a.count);n<r;n++)ep.fromBufferAttribute(o,n),np(ep,n,s,i,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class extends Wo{constructor(t,e,n,i,r,a,o,s,l){super(t,e,n,i,r,a,o,s,l),this.format=void 0!==o?o:la,this.minFilter=void 0!==a?a:qr,this.magFilter=void 0!==r?r:qr,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback((function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;!1=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0;(class extends Wo{constructor(t,e,n,i,r,a,o,s,l,c,u,h){super(null,a,o,s,l,c,i,r,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class extends Wo{constructor(t,e,n,i,r,a,o,s,l){super(t,e,n,i,r,a,o,s,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,new Qo,new Qo,new Qo,new ul;class ip{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let a=1;a<=t;a++)n=this.getPoint(a/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let a;a=e||t*n[r-1];let o,s=0,l=r-1;for(;s<=l;)if(i=Math.floor(s+(l-s)/2),o=n[i]-a,o<0)s=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===a)return i/(r-1);const c=n[i];return(i+(a-c)/(n[i+1]-c))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const a=this.getPoint(i),o=this.getPoint(r),s=e||(a.isVector2?new Fo:new Qo);return s.copy(o).sub(a).normalize(),s}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new Qo,i=[],r=[],a=[],o=new Qo,s=new Ts;for(let e=0;e<=t;e++){const n=e/t;i[e]=this.getTangentAt(n,new Qo)}r[0]=new Qo,a[0]=new Qo;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),a[0].crossVectors(i[0],r[0]);for(let e=1;e<=t;e++){if(r[e]=r[e-1].clone(),a[e]=a[e-1].clone(),o.crossVectors(i[e-1],i[e]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(Po(i[e-1].dot(i[e]),-1,1));r[e].applyMatrix4(s.makeRotationAxis(o,t))}a[e].crossVectors(i[e],r[e])}if(!0===e){let e=Math.acos(Po(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(s.makeRotationAxis(i[n],e*n)),a[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class rp extends ip{constructor(t=0,e=0,n=1,i=1,r=0,a=2*Math.PI,o=!1,s=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}getPoint(t,e){const n=e||new Fo,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const a=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=a?0:i),!0!==this.aClockwise||a||(r===i?r=-i:r-=i);const o=this.aStartAngle+t*r;let s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=s-this.aX,i=l-this.aY;s=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(s,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}rp.prototype.isEllipseCurve=!0;class ap extends rp{constructor(t,e,n,i,r,a){super(t,e,n,n,i,r,a),this.type="ArcCurve"}}function op(){let t=0,e=0,n=0,i=0;function r(r,a,o,s){t=r,e=o,n=-3*r+3*a-2*o-s,i=2*r-2*a+o+s}return{initCatmullRom:function(t,e,n,i,a){r(e,n,a*(n-t),a*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,a,o,s){let l=(e-t)/a-(n-t)/(a+o)+(n-e)/o,c=(n-e)/o-(i-e)/(o+s)+(i-n)/s;l*=o,c*=o,r(e,n,l,c)},calc:function(r){const a=r*r;return t+e*r+n*a+i*(a*r)}}}ap.prototype.isArcCurve=!0;const sp=new Qo,lp=new op,cp=new op,up=new op;class hp extends ip{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new Qo){const n=e,i=this.points,r=i.length,a=(r-(this.closed?0:1))*t;let o,s,l=Math.floor(a),c=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?o=i[(l-1)%r]:(sp.subVectors(i[0],i[1]).add(i[0]),o=sp);const u=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?s=i[(l+2)%r]:(sp.subVectors(i[r-1],i[r-2]).add(i[r-1]),s=sp),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(s),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),lp.initNonuniformCatmullRom(o.x,u.x,h.x,s.x,e,n,i),cp.initNonuniformCatmullRom(o.y,u.y,h.y,s.y,e,n,i),up.initNonuniformCatmullRom(o.z,u.z,h.z,s.z,e,n,i)}else"catmullrom"===this.curveType&&(lp.initCatmullRom(o.x,u.x,h.x,s.x,this.tension),cp.initCatmullRom(o.y,u.y,h.y,s.y,this.tension),up.initCatmullRom(o.z,u.z,h.z,s.z,this.tension));return n.set(lp.calc(c),cp.calc(c),up.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Qo).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function dp(t,e,n,i,r){const a=.5*(i-e),o=.5*(r-n),s=t*t;return(2*n-2*i+a+o)*(t*s)+(-3*n+3*i-2*a-o)*s+a*t+n}function pp(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function mp(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}hp.prototype.isCatmullRomCurve3=!0;class fp extends ip{constructor(t=new Fo,e=new Fo,n=new Fo,i=new Fo){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Fo){const n=e,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(mp(t,i.x,r.x,a.x,o.x),mp(t,i.y,r.y,a.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}fp.prototype.isCubicBezierCurve=!0;class gp extends ip{constructor(t=new Qo,e=new Qo,n=new Qo,i=new Qo){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Qo){const n=e,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(mp(t,i.x,r.x,a.x,o.x),mp(t,i.y,r.y,a.y,o.y),mp(t,i.z,r.z,a.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}gp.prototype.isCubicBezierCurve3=!0;class vp extends ip{constructor(t=new Fo,e=new Fo){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Fo){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new Fo;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}vp.prototype.isLineCurve=!0;class yp extends ip{constructor(t=new Fo,e=new Fo,n=new Fo){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Fo){const n=e,i=this.v0,r=this.v1,a=this.v2;return n.set(pp(t,i.x,r.x,a.x),pp(t,i.y,r.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}yp.prototype.isQuadraticBezierCurve=!0;class _p extends ip{constructor(t=new Qo,e=new Qo,n=new Qo){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Qo){const n=e,i=this.v0,r=this.v1,a=this.v2;return n.set(pp(t,i.x,r.x,a.x),pp(t,i.y,r.y,a.y),pp(t,i.z,r.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}_p.prototype.isQuadraticBezierCurve3=!0;class xp extends ip{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Fo){const n=e,i=this.points,r=(i.length-1)*t,a=Math.floor(r),o=r-a,s=i[0===a?a:a-1],l=i[a],c=i[a>i.length-2?i.length-1:a+1],u=i[a>i.length-3?i.length-1:a+2];return n.set(dp(o,s.x,l.x,c.x,u.x),dp(o,s.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Fo).fromArray(n))}return this}}xp.prototype.isSplineCurve=!0;var bp=Object.freeze({__proto__:null,ArcCurve:ap,CatmullRomCurve3:hp,CubicBezierCurve:fp,CubicBezierCurve3:gp,EllipseCurve:rp,LineCurve:vp,LineCurve3:class extends ip{constructor(t=new Qo,e=new Qo){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new Qo){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:yp,QuadraticBezierCurve3:_p,SplineCurve:xp});class Ap extends ip{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new vp(e,t))}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const t=i[r]-n,a=this.curves[r],o=a.getLength(),s=0===o?0:1-t/o;return a.getPointAt(s,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const a=r[i],o=a&&a.isEllipseCurve?2*t:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o);for(let t=0;t<s.length;t++){const i=s[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new bp[n.type]).fromJSON(n))}return this}}class wp extends Ap{constructor(t){super(),this.type="Path",this.currentPoint=new Fo,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new vp(this.currentPoint.clone(),new Fo(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new yp(this.currentPoint.clone(),new Fo(t,e),new Fo(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,a){const o=new fp(this.currentPoint.clone(),new Fo(t,e),new Fo(n,i),new Fo(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new xp(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,a){const o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,n,i,r,a),this}absarc(t,e,n,i,r,a){return this.absellipse(t,e,n,n,i,r,a),this}ellipse(t,e,n,i,r,a,o,s){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,a,o,s),this}absellipse(t,e,n,i,r,a,o,s){const l=new rp(t,e,n,i,r,a,o,s);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Cp extends wp{constructor(t){super(t),this.uuid=Do(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new wp).fromJSON(n))}return this}}function Ep(t,e,n,i,r){let a,o;if(r===function(t,e,n,i){let r=0;for(let a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}(t,e,n,i)>0)for(a=e;a<n;a+=i)o=qp(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=qp(a,t[a],t[a+1],o);return o&&Up(o,o.next)&&(Zp(o),o=o.next),o}function Sp(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!Up(i,i.next)&&0!==Np(i.prev,i,i.next))i=i.next;else{if(Zp(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function Mp(t,e,n,i,r,a,o){if(!t)return;!o&&a&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=kp(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,a,o,s,l,c=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<c&&(s++,i=i.nextZ,i);e++);for(l=c;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,c*=2}while(o>1)}(r)}(t,i,r,a);let s,l,c=t;for(;t.prev!==t.next;)if(s=t.prev,l=t.next,a?Ip(t,i,r,a):Tp(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),Zp(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?Mp(t=Bp(Sp(t),e,n),e,n,i,r,a,2):2===o&&Lp(t,e,n,i,r,a):Mp(Sp(t),e,n,i,r,a,1);break}}function Tp(t){const e=t.prev,n=t,i=t.next;if(Np(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(Fp(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Np(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ip(t,e,n,i){const r=t.prev,a=t,o=t.next;if(Np(r,a,o)>=0)return!1;const s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,c=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,u=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=kp(s,l,e,n,i),d=kp(c,u,e,n,i);let p=t.prevZ,m=t.nextZ;for(;p&&p.z>=h&&m&&m.z<=d;){if(p!==t.prev&&p!==t.next&&Fp(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Np(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==t.prev&&m!==t.next&&Fp(r.x,r.y,a.x,a.y,o.x,o.y,m.x,m.y)&&Np(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&Fp(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Np(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=d;){if(m!==t.prev&&m!==t.next&&Fp(r.x,r.y,a.x,a.y,o.x,o.y,m.x,m.y)&&Np(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function Bp(t,e,n){let i=t;do{const r=i.prev,a=i.next.next;!Up(r,a)&&Vp(r,i,i.next,a)&&jp(r,a)&&jp(a,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(a.i/n),Zp(i),Zp(i.next),i=t=a),i=i.next}while(i!==t);return Sp(i)}function Lp(t,e,n,i,r,a){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&Op(o,t)){let s=Wp(o,t);return o=Sp(o,o.next),s=Sp(s,s.next),Mp(o,e,n,i,r,a),void Mp(s,e,n,i,r,a)}t=t.next}o=o.next}while(o!==t)}function Dp(t,e){return t.x-e.x}function Pp(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let a,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>o){if(o=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(i===o)return a;const s=a,l=a.x,c=a.y;let u,h=1/0;n=a;do{i>=n.x&&n.x>=l&&i!==n.x&&Fp(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),jp(n,t)&&(u<h||u===h&&(n.x>a.x||n.x===a.x&&Rp(a,n)))&&(a=n,h=u)),n=n.next}while(n!==s);return a}(t,e),e){const n=Wp(e,t);Sp(e,e.next),Sp(n,n.next)}}function Rp(t,e){return Np(t.prev,t,e.prev)<0&&Np(e.next,t,t.next)<0}function kp(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function zp(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Fp(t,e,n,i,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function Op(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Vp(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Np(t.prev,t,e.prev)||Np(t,e.prev,e))||Up(t,e)&&Np(t.prev,t,t.next)>0&&Np(e.prev,e,e.next)>0)}function Np(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Up(t,e){return t.x===e.x&&t.y===e.y}function Vp(t,e,n,i){const r=Hp(Np(t,e,n)),a=Hp(Np(t,e,i)),o=Hp(Np(n,i,t)),s=Hp(Np(n,i,e));return r!==a&&o!==s||!(0!==r||!Gp(t,n,e))||!(0!==a||!Gp(t,i,e))||!(0!==o||!Gp(n,t,i))||!(0!==s||!Gp(n,e,i))}function Gp(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Hp(t){return t>0?1:t<0?-1:0}function jp(t,e){return Np(t.prev,t,t.next)<0?Np(t,e,t.next)>=0&&Np(t,t.prev,e)>=0:Np(t,e,t.prev)<0||Np(t,t.next,e)<0}function Wp(t,e){const n=new $p(t.i,t.x,t.y),i=new $p(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function qp(t,e,n,i){const r=new $p(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Zp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function $p(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Yp{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return Yp.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];Xp(t),Qp(n,t);let a=t.length;e.forEach(Xp);for(let t=0;t<e.length;t++)i.push(a),a+=e[t].length,Qp(n,e[t]);const o=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let a=Ep(t,0,r,n,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,c,u,h,d,p;if(i&&(a=function(t,e,n,i){const r=[];let a,o,s,l,c;for(a=0,o=e.length;a<o;a++)s=e[a]*i,l=a<o-1?e[a+1]*i:t.length,c=Ep(t,s,l,i,!1),c===c.next&&(c.steiner=!0),r.push(zp(c));for(r.sort(Dp),a=0;a<r.length;a++)Pp(r[a],n),n=Sp(n,n.next);return n}(t,e,a,n)),t.length>80*n){s=c=t[0],l=u=t[1];for(let e=n;e<r;e+=n)h=t[e],d=t[e+1],h<s&&(s=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-s,u-l),p=0!==p?1/p:0}return Mp(a,o,n,s,l,p),o}(n,i);for(let t=0;t<o.length;t+=3)r.push(o.slice(t,t+3));return r}}function Xp(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Qp(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Jp extends Rl{constructor(t=new Cp([new Fo(.5,.5),new Fo(-.5,.5),new Fo(-.5,-.5),new Fo(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let e=0,n=t.length;e<n;e++)a(t[e]);function a(t){const a=[],o=void 0!==e.curveSegments?e.curveSegments:12,s=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:1,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:.2,h=void 0!==e.bevelSize?e.bevelSize:u-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const m=e.extrudePath,f=void 0!==e.UVGenerator?e.UVGenerator:Kp;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,v,y,_,x,b=!1;m&&(g=m.getSpacedPoints(s),b=!0,c=!1,v=m.computeFrenetFrames(s,!1),y=new Qo,_=new Qo,x=new Qo),c||(p=0,u=0,h=0,d=0);const A=t.extractPoints(o);let w=A.shape;const C=A.holes;if(!Yp.isClockWise(w)){w=w.reverse();for(let t=0,e=C.length;t<e;t++){const e=C[t];Yp.isClockWise(e)&&(C[t]=e.reverse())}}const E=Yp.triangulateShape(w,C),S=w;for(let t=0,e=C.length;t<e;t++){const e=C[t];w=w.concat(e)}function M(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const T=w.length,I=E.length;function B(t,e,n){let i,r,a;const o=t.x-e.x,s=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=o*o+s*s,h=o*c-s*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-s/h,m=e.y+o/h,f=((n.x-c/d-p)*c-(n.y+l/d-m)*l)/(o*c-s*l);i=p+o*f-t.x,r=m+s*f-t.y;const g=i*i+r*r;if(g<=2)return new Fo(i,r);a=Math.sqrt(g/2)}else{let t=!1;o>Number.EPSILON?l>Number.EPSILON&&(t=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(s)===Math.sign(c)&&(t=!0),t?(i=-s,r=o,a=Math.sqrt(u)):(i=o,r=s,a=Math.sqrt(u/2))}return new Fo(i/a,r/a)}const L=[];for(let t=0,e=S.length,n=e-1,i=t+1;t<e;t++,n++,i++)n===e&&(n=0),i===e&&(i=0),L[t]=B(S[t],S[n],S[i]);const D=[];let P,R=L.concat();for(let t=0,e=C.length;t<e;t++){const e=C[t];P=[];for(let t=0,n=e.length,i=n-1,r=t+1;t<n;t++,i++,r++)i===n&&(i=0),r===n&&(r=0),P[t]=B(e[t],e[i],e[r]);D.push(P),R=R.concat(P)}for(let t=0;t<p;t++){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=S.length;t<e;t++){const e=M(S[t],L[t],i);F(e.x,e.y,-n)}for(let t=0,e=C.length;t<e;t++){const e=C[t];P=D[t];for(let t=0,r=e.length;t<r;t++){const r=M(e[t],P[t],i);F(r.x,r.y,-n)}}}const k=h+d;for(let t=0;t<T;t++){const e=c?M(w[t],R[t],k):w[t];b?(_.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),x.copy(g[0]).add(_).add(y),F(x.x,x.y,x.z)):F(e.x,e.y,0)}for(let t=1;t<=s;t++)for(let e=0;e<T;e++){const n=c?M(w[e],R[e],k):w[e];b?(_.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),x.copy(g[t]).add(_).add(y),F(x.x,x.y,x.z)):F(n.x,n.y,l/s*t)}for(let t=p-1;t>=0;t--){const e=t/p,n=u*Math.cos(e*Math.PI/2),i=h*Math.sin(e*Math.PI/2)+d;for(let t=0,e=S.length;t<e;t++){const e=M(S[t],L[t],i);F(e.x,e.y,l+n)}for(let t=0,e=C.length;t<e;t++){const e=C[t];P=D[t];for(let t=0,r=e.length;t<r;t++){const r=M(e[t],P[t],i);b?F(r.x,r.y+g[s-1].y,g[s-1].x+n):F(r.x,r.y,l+n)}}}function z(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=s+2*p;t<n;t++){const n=T*t,a=T*(t+1);N(e+i+n,e+r+n,e+r+a,e+i+a)}}}function F(t,e,n){a.push(t),a.push(e),a.push(n)}function O(t,e,r){U(t),U(e),U(r);const a=i.length/3,o=f.generateTopUV(n,i,a-3,a-2,a-1);V(o[0]),V(o[1]),V(o[2])}function N(t,e,r,a){U(t),U(e),U(a),U(e),U(r),U(a);const o=i.length/3,s=f.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);V(s[0]),V(s[1]),V(s[3]),V(s[1]),V(s[2]),V(s[3])}function U(t){i.push(a[3*t+0]),i.push(a[3*t+1]),i.push(a[3*t+2])}function V(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(c){let t=0,e=T*t;for(let t=0;t<I;t++){const n=E[t];O(n[2]+e,n[1]+e,n[0]+e)}t=s+2*p,e=T*t;for(let t=0;t<I;t++){const n=E[t];O(n[0]+e,n[1]+e,n[2]+e)}}else{for(let t=0;t<I;t++){const e=E[t];O(e[2],e[1],e[0])}for(let t=0;t<I;t++){const e=E[t];O(e[0]+T*s,e[1]+T*s,e[2]+T*s)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;z(S,e),e+=S.length;for(let t=0,n=C.length;t<n;t++){const n=C[t];z(n,e),e+=n.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new Sl(i,3)),this.setAttribute("uv",new Sl(r,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let e=0,i=t.length;e<i;e++){const i=t[e];n.shapes.push(i.uuid)}else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new bp[i.type]).fromJSON(i)),new Jp(n,t.options)}}const Kp={generateTopUV:function(t,e,n,i,r){const a=e[3*n],o=e[3*n+1],s=e[3*i],l=e[3*i+1],c=e[3*r],u=e[3*r+1];return[new Fo(a,o),new Fo(s,l),new Fo(c,u)]},generateSideWallUV:function(t,e,n,i,r,a){const o=e[3*n],s=e[3*n+1],l=e[3*n+2],c=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],p=e[3*r+1],m=e[3*r+2],f=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-u)<Math.abs(o-c)?[new Fo(o,1-l),new Fo(c,1-h),new Fo(d,1-m),new Fo(f,1-v)]:[new Fo(s,1-l),new Fo(u,1-h),new Fo(p,1-m),new Fo(g,1-v)]}};class tm extends Rl{constructor(t=new Cp([new Fo(0,.5),new Fo(-.5,-.5),new Fo(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],a=[];let o=0,s=0;if(!1===Array.isArray(t))l(t);else for(let e=0;e<t.length;e++)l(t[e]),this.addGroup(o,s,e),o+=s,s=0;function l(t){const o=i.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===Yp.isClockWise(c)&&(c=c.reverse());for(let t=0,e=u.length;t<e;t++){const e=u[t];!0===Yp.isClockWise(e)&&(u[t]=e.reverse())}const h=Yp.triangulateShape(c,u);for(let t=0,e=u.length;t<e;t++){const e=u[t];c=c.concat(e)}for(let t=0,e=c.length;t<e;t++){const e=c[t];i.push(e.x,e.y,0),r.push(0,0,1),a.push(e.x,e.y)}for(let t=0,e=h.length;t<e;t++){const e=h[t],i=e[0]+o,r=e[1]+o,a=e[2]+o;n.push(i,r,a),s+=3}}this.setIndex(n),this.setAttribute("position",new Sl(i,3)),this.setAttribute("normal",new Sl(r,3)),this.setAttribute("uv",new Sl(a,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++){const r=e[t.shapes[i]];n.push(r)}return new tm(n,t.curveSegments)}}(class extends dl{constructor(t){super(),this.type="ShadowMaterial",this.color=new _l(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}).prototype.isShadowMaterial=!0;class em extends dl{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new _l(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _l(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ao,this.normalScale=new Fo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}em.prototype.isMeshStandardMaterial=!0;(class extends em{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Fo(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Po(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.sheenColor=new _l(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new _l(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new _l(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}).prototype.isMeshPhysicalMaterial=!0;(class extends dl{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new _l(16777215),this.specular=new _l(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _l(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ao,this.normalScale=new Fo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Er,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}}).prototype.isMeshPhongMaterial=!0;(class extends dl{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new _l(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _l(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ao,this.normalScale=new Fo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}).prototype.isMeshToonMaterial=!0;(class extends dl{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ao,this.normalScale=new Fo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}).prototype.isMeshNormalMaterial=!0;(class extends dl{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new _l(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _l(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Er,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}}).prototype.isMeshLambertMaterial=!0;(class extends dl{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new _l(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ao,this.normalScale=new Fo(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this}}).prototype.isMeshMatcapMaterial=!0;(class extends Vd{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}).prototype.isLineDashedMaterial=!0;const nm={arraySlice:function(t,e,n){return nm.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let t=0;t!==e;++t)n[t]=t;return n.sort((function(e,n){return t[e]-t[n]})),n},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let a=0,o=0;o!==i;++a){const i=n[a]*e;for(let n=0;n!==e;++n)r[o++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,a=t[0];for(;void 0!==a&&void 0===a[i];)a=t[r++];if(void 0===a)return;let o=a[i];if(void 0!==o)if(Array.isArray(o))do{o=a[i],void 0!==o&&(e.push(a.time),n.push.apply(n,o)),a=t[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{o=a[i],void 0!==o&&(e.push(a.time),o.toArray(n,n.length)),a=t[r++]}while(void 0!==a);else do{o=a[i],void 0!==o&&(e.push(a.time),n.push(o)),a=t[r++]}while(void 0!==a)},subclip:function(t,e,n,i,r=30){const a=t.clone();a.name=e;const o=[];for(let t=0;t<a.tracks.length;++t){const e=a.tracks[t],s=e.getValueSize(),l=[],c=[];for(let t=0;t<e.times.length;++t){const a=e.times[t]*r;if(!(a<n||a>=i)){l.push(e.times[t]);for(let n=0;n<s;++n)c.push(e.values[t*s+n])}}0!==l.length&&(e.times=nm.convertArray(l,e.times.constructor),e.values=nm.convertArray(c,e.values.constructor),o.push(e))}a.tracks=o;let s=1/0;for(let t=0;t<a.tracks.length;++t)s>a.tracks[t].times[0]&&(s=a.tracks[t].times[0]);for(let t=0;t<a.tracks.length;++t)a.tracks[t].shift(-1*s);return a.resetDuration(),a},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,a=e/i;for(let e=0;e<r;++e){const i=n.tracks[e],r=i.ValueTypeName;if("bool"===r||"string"===r)continue;const o=t.tracks.find((function(t){return t.name===i.name&&t.ValueTypeName===r}));if(void 0===o)continue;let s=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=l/3);let c=0;const u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=i.times.length-1;let d;if(a<=i.times[0]){const t=s,e=l-s;d=nm.arraySlice(i.values,t,e)}else if(a>=i.times[h]){const t=h*l+s,e=t+l-s;d=nm.arraySlice(i.values,t,e)}else{const t=i.createInterpolant(),e=s,n=l-s;t.evaluate(a),d=nm.arraySlice(t.resultBuffer,e,n)}"quaternion"===r&&(new Xo).fromArray(d).normalize().conjugate().toArray(d);const p=o.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===r)Xo.multiplyQuaternionsFlat(o.values,e,d,0,o.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)o.values[e+n]-=d[n]}}}return t.blendMode=2501,t}};class im{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let a;n:{i:if(!(t<i)){for(let a=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===a)break;if(r=i,i=e[++n],t<i)break e}a=e.length;break n}if(t>=r)break t;{const o=e[1];t<o&&(n=2,r=o);for(let a=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===a)break;if(i=r,r=e[--n-1],t>=r)break e}a=n,n=0}}for(;n<a;){const i=n+a>>>1;t<e[i]?a=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let t=0;t!==i;++t)e[t]=n[r+t];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}im.prototype.beforeStart_=im.prototype.copySampleValue_,im.prototype.afterEnd_=im.prototype.copySampleValue_;class rm extends im{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:uo,endingEnd:uo}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,a=t+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case ho:r=t,o=2*e-n;break;case po:r=i.length-2,o=e+i[r]-i[r+1];break;default:r=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case ho:a=t,s=2*n-e;break;case po:a=1,s=n+i[1]-i[0];break;default:a=t-1,s=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-n),this._offsetPrev=r*c,this._offsetNext=a*c}interpolate_(t,e,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),m=p*p,f=m*p,g=-h*f+2*h*m-h*p,v=(1+h)*f+(-1.5-2*h)*m+(-.5+h)*p+1,y=(-1-d)*f+(1.5+d)*m+.5*p,_=d*f-d*m;for(let t=0;t!==o;++t)r[t]=g*a[c+t]+v*a[l+t]+y*a[s+t]+_*a[u+t];return r}}class am extends im{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,c=(n-e)/(i-e),u=1-c;for(let t=0;t!==o;++t)r[t]=a[l+t]*u+a[s+t]*c;return r}}class om extends im{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class sm{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=nm.convertArray(e,this.TimeBufferType),this.values=nm.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:nm.convertArray(t.times,Array),values:nm.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new om(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new am(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new rm(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case so:e=this.InterpolantFactoryMethodDiscrete;break;case lo:e=this.InterpolantFactoryMethodLinear;break;case co:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return so;case this.InterpolantFactoryMethodLinear:return lo;case this.InterpolantFactoryMethodSmooth:return co}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,a=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==r||a!==i){r>=a&&(a=Math.max(a,1),r=a-1);const t=this.getValueSize();this.times=nm.arraySlice(n,r,a),this.values=nm.arraySlice(this.values,r*t,a*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let a=null;for(let e=0;e!==r;e++){const i=n[e];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,i),t=!1;break}if(null!==a&&a>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,i,a),t=!1;break}a=i}if(void 0!==i&&nm.isTypedArray(i))for(let e=0,n=i.length;e!==n;++e){const n=i[e];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,n),t=!1;break}}return t}optimize(){const t=nm.arraySlice(this.times),e=nm.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===co,r=t.length-1;let a=1;for(let o=1;o<r;++o){let r=!1;const s=t[o];if(s!==t[o+1]&&(1!==o||s!==t[0]))if(i)r=!0;else{const t=o*n,i=t-n,a=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[i+o]||n!==e[a+o]){r=!0;break}}}if(r){if(o!==a){t[a]=t[o];const i=o*n,r=a*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++a}}if(r>0){t[a]=t[r];for(let t=r*n,i=a*n,o=0;o!==n;++o)e[i+o]=e[t+o];++a}return a!==t.length?(this.times=nm.arraySlice(t,0,a),this.values=nm.arraySlice(e,0,a*n)):(this.times=t,this.values=e),this}clone(){const t=nm.arraySlice(this.times,0),e=nm.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}sm.prototype.TimeBufferType=Float32Array,sm.prototype.ValueBufferType=Float32Array,sm.prototype.DefaultInterpolation=lo;class lm extends sm{}lm.prototype.ValueTypeName="bool",lm.prototype.ValueBufferType=Array,lm.prototype.DefaultInterpolation=so,lm.prototype.InterpolantFactoryMethodLinear=void 0,lm.prototype.InterpolantFactoryMethodSmooth=void 0;class cm extends sm{}cm.prototype.ValueTypeName="color";class um extends sm{}um.prototype.ValueTypeName="number";class hm extends im{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-e)/(i-e);let l=t*o;for(let t=l+o;l!==t;l+=4)Xo.slerpFlat(r,0,a,l-o,a,l,s);return r}}class dm extends sm{InterpolantFactoryMethodLinear(t){return new hm(this.times,this.values,this.getValueSize(),t)}}dm.prototype.ValueTypeName="quaternion",dm.prototype.DefaultInterpolation=lo,dm.prototype.InterpolantFactoryMethodSmooth=void 0;class pm extends sm{}pm.prototype.ValueTypeName="string",pm.prototype.ValueBufferType=Array,pm.prototype.DefaultInterpolation=so,pm.prototype.InterpolantFactoryMethodLinear=void 0,pm.prototype.InterpolantFactoryMethodSmooth=void 0;class mm extends sm{}mm.prototype.ValueTypeName="vector";class fm{constructor(t,e=-1,n,i=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=Do(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let t=0,r=n.length;t!==r;++t)e.push(gm(n[t]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let t=0,i=n.length;t!==i;++t)e.push(sm.toJSON(n[t]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,a=[];for(let t=0;t<r;t++){let o=[],s=[];o.push((t+r-1)%r,t,(t+1)%r),s.push(0,1,0);const l=nm.getKeyframeOrder(o);o=nm.sortedArray(o,1,l),s=nm.sortedArray(s,1,l),i||0!==o[0]||(o.push(r),s.push(s[0])),a.push(new um(".morphTargetInfluences["+e[t].name+"]",o,s).scale(1/n))}return new this(t,-1,a)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let t=0;t<n.length;t++)if(n[t].name===e)return n[t];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let e=0,n=t.length;e<n;e++){const n=t[e],a=n.name.match(r);if(a&&a.length>1){const t=a[1];let e=i[t];e||(i[t]=e=[]),e.push(n)}}const a=[];for(const t in i)a.push(this.CreateFromMorphTargetSequence(t,i[t],e,n));return a}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,i,r){if(0!==n.length){const a=[],o=[];nm.flattenJSON(n,a,o,i),0!==a.length&&r.push(new t(e,a,o))}},i=[],r=t.name||"default",a=t.fps||30,o=t.blendMode;let s=t.length||-1;const l=t.hierarchy||[];for(let t=0;t<l.length;t++){const r=l[t].keys;if(r&&0!==r.length)if(r[0].morphTargets){const t={};let e;for(e=0;e<r.length;e++)if(r[e].morphTargets)for(let n=0;n<r[e].morphTargets.length;n++)t[r[e].morphTargets[n]]=-1;for(const n in t){const t=[],a=[];for(let i=0;i!==r[e].morphTargets.length;++i){const i=r[e];t.push(i.time),a.push(i.morphTarget===n?1:0)}i.push(new um(".morphTargetInfluence["+n+"]",t,a))}s=t.length*(a||1)}else{const a=".bones["+e[t].name+"]";n(mm,a+".position",r,"pos",i),n(dm,a+".quaternion",r,"rot",i),n(mm,a+".scale",r,"scl",i)}}return 0===i.length?null:new this(r,s,i,o)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function gm(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return um;case"vector":case"vector2":case"vector3":case"vector4":return mm;case"color":return cm;case"quaternion":return dm;case"bool":case"boolean":return lm;case"string":return pm}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];nm.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const vm={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};const ym=new class{constructor(t,e,n){const i=this;let r,a=!1,o=0,s=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===a&&void 0!==i.onStart&&i.onStart(t,o,s),a=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}};class _m{constructor(t){this.manager=void 0!==t?t:ym,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const xm={};class bm extends _m{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=vm.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout((()=>{e&&e(r),this.manager.itemEnd(t)}),0),r;if(void 0!==xm[t])return void xm[t].push({onLoad:e,onProgress:n,onError:i});xm[t]=[],xm[t].push({onLoad:e,onProgress:n,onError:i});const a=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(a).then((e=>{if(200===e.status||0===e.status){0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");const n=xm[t],i=e.body.getReader(),r=e.headers.get("Content-Length"),a=r?parseInt(r):0,o=0!==a;let s=0;return new ReadableStream({start(t){!function e(){i.read().then((({done:i,value:r})=>{if(i)t.close();else{s+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}}))}()}})}throw Error(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`)})).then((t=>{const e=new Response(t);switch(this.responseType){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((t=>(new DOMParser).parseFromString(t,this.mimeType)));case"json":return e.json();default:return e.text()}})).then((e=>{vm.add(t,e);const n=xm[t];delete xm[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}this.manager.itemEnd(t)})).catch((e=>{const n=xm[t];delete xm[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t),this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Am extends _m{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,a=vm.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;const o=Uo("img");function s(){c(),vm.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){c(),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}class wm extends _m{constructor(t){super(t)}load(t,e,n,i){const r=new cc,a=new Am(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(n){a.load(t[n],(function(t){r.images[n]=t,o++,6===o&&(r.needsUpdate=!0,e&&e(r))}),void 0,i)}for(let e=0;e<t.length;++e)s(e);return r}}class Cm extends _m{constructor(t){super(t)}load(t,e,n,i){const r=new Wo,a=new Am(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}class Em extends Ks{constructor(t,e=1){super(),this.type="Light",this.color=new _l(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}Em.prototype.isLight=!0;(class extends Em{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(Ks.DefaultUp),this.updateMatrix(),this.groundColor=new _l(e)}copy(t){return Em.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}).prototype.isHemisphereLight=!0;const Sm=new Ts,Mm=new Qo,Tm=new Qo;class Im{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Fo(512,512),this.map=null,this.mapPass=null,this.matrix=new Ts,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new vc,this._frameExtents=new Fo(1,1),this._viewportCount=1,this._viewports=[new Zo(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;Mm.setFromMatrixPosition(t.matrixWorld),e.position.copy(Mm),Tm.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Tm),e.updateMatrixWorld(),Sm.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sm),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Bm extends Im{constructor(){super(new oc(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*Lo*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}Bm.prototype.isSpotLightShadow=!0;(class extends Em{constructor(t,e,n=0,i=Math.PI/3,r=0,a=1){super(t,e),this.type="SpotLight",this.position.copy(Ks.DefaultUp),this.updateMatrix(),this.target=new Ks,this.distance=n,this.angle=i,this.penumbra=r,this.decay=a,this.shadow=new Bm}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}).prototype.isSpotLight=!0;const Lm=new Ts,Dm=new Qo,Pm=new Qo;class Rm extends Im{constructor(){super(new oc(90,1,.5,500)),this._frameExtents=new Fo(4,2),this._viewportCount=6,this._viewports=[new Zo(2,1,1,1),new Zo(0,1,1,1),new Zo(3,1,1,1),new Zo(1,1,1,1),new Zo(3,0,1,1),new Zo(1,0,1,1)],this._cubeDirections=[new Qo(1,0,0),new Qo(-1,0,0),new Qo(0,0,1),new Qo(0,0,-1),new Qo(0,1,0),new Qo(0,-1,0)],this._cubeUps=[new Qo(0,1,0),new Qo(0,1,0),new Qo(0,1,0),new Qo(0,1,0),new Qo(0,0,1),new Qo(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Dm.setFromMatrixPosition(t.matrixWorld),n.position.copy(Dm),Pm.copy(n.position),Pm.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Pm),n.updateMatrixWorld(),i.makeTranslation(-Dm.x,-Dm.y,-Dm.z),Lm.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Lm)}}Rm.prototype.isPointLightShadow=!0;(class extends Em{constructor(t,e,n=0,i=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Rm}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}).prototype.isPointLight=!0;class km extends Im{constructor(){super(new Bc(-5,5,5,-5,.5,500))}}km.prototype.isDirectionalLightShadow=!0;(class extends Em{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(Ks.DefaultUp),this.updateMatrix(),this.target=new Ks,this.shadow=new km}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class extends Em{constructor(t,e){super(t,e),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class extends Em{constructor(t,e,n=10,i=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}).prototype.isRectAreaLight=!0;class zm{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Qo)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.282095),e.addScaledVector(a[1],.488603*i),e.addScaledVector(a[2],.488603*r),e.addScaledVector(a[3],.488603*n),e.addScaledVector(a[4],n*i*1.092548),e.addScaledVector(a[5],i*r*1.092548),e.addScaledVector(a[6],.315392*(3*r*r-1)),e.addScaledVector(a[7],n*r*1.092548),e.addScaledVector(a[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,a=this.coefficients;return e.copy(a[0]).multiplyScalar(.886227),e.addScaledVector(a[1],1.023328*i),e.addScaledVector(a[2],1.023328*r),e.addScaledVector(a[3],1.023328*n),e.addScaledVector(a[4],.858086*n*i),e.addScaledVector(a[5],.858086*i*r),e.addScaledVector(a[6],.743125*r*r-.247708),e.addScaledVector(a[7],.858086*n*r),e.addScaledVector(a[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}zm.prototype.isSphericalHarmonics3=!0;class Fm extends Em{constructor(t=new zm,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Fm.prototype.isLightProbe=!0;class Om{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}static resolveURL(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}let Nm;(class extends Rl{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}).prototype.isInstancedBufferGeometry=!0,class extends _m{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,a=vm.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){vm.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}.prototype.isImageBitmapLoader=!0;class Um extends _m{constructor(t){super(t)}load(t,e,n,i){const r=this,a=new bm(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){try{const t=n.slice(0);(void 0===Nm&&(Nm=new(window.AudioContext||window.webkitAudioContext)),Nm).decodeAudioData(t,(function(t){e(t)}))}catch(e){i?i(e):console.error(e),r.manager.itemError(t)}}),n,i)}}(class extends Fm{constructor(t,e,n=1){super(void 0,n);const i=(new _l).set(t),r=(new _l).set(e),a=new Qo(i.r,i.g,i.b),o=new Qo(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends Fm{constructor(t,e=1){super(void 0,e);const n=(new _l).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class Vm{constructor(t,e,n){let i,r,a;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let a=this.cumulativeWeight;if(0===a){for(let t=0;t!==i;++t)n[r+t]=n[t];a=e}else{a+=e;const t=e/a;this._mixBufferRegion(n,r,0,t,i)}this.cumulativeWeight=a}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const t=e*this._origIndex;this._mixBufferRegion(n,i,t,1-r,e)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let t=e,r=e+e;t!==r;++t)if(n[t]!==n[t+e]){o.setValue(n,i);break}}saveOriginalState(){const t=this.binding,e=this.buffer,n=this.valueSize,i=n*this._origIndex;t.getValue(e,i);for(let t=n,r=i;t!==r;++t)e[t]=e[i+t%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=3*this.valueSize;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let i=0;i!==r;++i)t[e+i]=t[n+i]}_slerp(t,e,n,i){Xo.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const a=this._workIndex*r;Xo.multiplyQuaternionsFlat(t,a,t,e,t,n),Xo.slerpFlat(t,e,t,e,t,a,i)}_lerp(t,e,n,i,r){const a=1-i;for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]*a+t[n+o]*i}}_lerpAdditive(t,e,n,i,r){for(let a=0;a!==r;++a){const r=e+a;t[r]=t[r]+t[n+a]*i}}}const Gm="\\[\\]\\.:\\/",Hm=new RegExp("["+Gm+"]","g"),jm="[^"+Gm+"]",Wm="[^"+Gm.replace("\\.","")+"]",qm=/((?:WC+[\/:])*)/.source.replace("WC",jm),Zm=/(WCOD+)?/.source.replace("WCOD",Wm),$m=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",jm),Ym=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",jm),Xm=new RegExp("^"+qm+Zm+$m+Ym+"$"),Qm=["material","materials","bones"];class Jm{constructor(t,e,n){this.path=e,this.parsedPath=n||Jm.parseTrackName(e),this.node=Jm.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Jm.Composite(t,e,n):new Jm(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Hm,"")}static parseTrackName(t){const e=Xm.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==Qm.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const a=n(r.children);if(a)return a}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=Jm.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const a=t[i];if(void 0===a){const n=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",t)}let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Jm.Composite=class{constructor(t,e,n){const i=n||Jm.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Jm.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Jm.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Jm.prototype.GetterByBindingType=[Jm.prototype._getValue_direct,Jm.prototype._getValue_array,Jm.prototype._getValue_arrayElement,Jm.prototype._getValue_toArray],Jm.prototype.SetterByBindingTypeAndVersioning=[[Jm.prototype._setValue_direct,Jm.prototype._setValue_direct_setNeedsUpdate,Jm.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Jm.prototype._setValue_array,Jm.prototype._setValue_array_setNeedsUpdate,Jm.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Jm.prototype._setValue_arrayElement,Jm.prototype._setValue_arrayElement_setNeedsUpdate,Jm.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Jm.prototype._setValue_fromArray,Jm.prototype._setValue_fromArray_setNeedsUpdate,Jm.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Km{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,a=r.length,o=new Array(a),s={endingStart:uo,endingEnd:uo};for(let t=0;t!==a;++t){const e=r[t].createInterpolant(null);o[t]=e,e.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=i/n,a=n/i;t.warp(1,r,e),this.warp(a,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const s=o.parameterPositions,l=o.sampleValues;return s[0]=r,s[1]=r+n,l[0]=t/a,l[1]=e/a,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const a=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;if(2501===this.blendMode)for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(a),e[n].accumulateAdditive(o);else for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(a),e[n].accumulate(i,o)}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const a=2202===n;if(0===t)return-1===r||!a||1&~r?i:e-i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(a&&!(1&~r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=ho,i.endingEnd=ho):(i.endingStart=t?this.zeroSlopeAtStart?ho:uo:po,i.endingEnd=e?this.zeroSlopeAtEnd?ho:uo:po)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let a=this._weightInterpolant;null===a&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=n,this}}(class extends To{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,a=t._propertyBindings,o=t._interpolants,s=n.uuid,l=this._bindingsByRootAndName;let c=l[s];void 0===c&&(c={},l[s]=c);for(let t=0;t!==r;++t){const r=i[t],l=r.name;let u=c[l];if(void 0!==u)a[t]=u;else{if(u=a[t],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,s,l));continue}const i=e&&e._propertyBindings[t].binding.parsedPath;u=new Vm(Jm.create(n,l,i),r.ValueTypeName,r.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,l),a[t]=u}o[t].resultBuffer=u.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{const e=a.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),a.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let a=i[e];void 0===a&&(a={},i[e]=a),a[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[i],s=e[e.length-1],l=t._cacheIndex;s._cacheIndex=l,e[l]=s,e.pop(),delete o[r],0===Object.keys(o).length&&delete a[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new am(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let a="string"==typeof t?fm.findByName(i,t):t;const o=null!==a?a.uuid:t,s=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==a?a.blendMode:2500),void 0!==s){const t=s.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const c=new Km(this,a,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"==typeof t?fm.findByName(n,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){t*=this.timeScale;const e=this._actions,n=this._nActiveActions,i=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1;for(let o=0;o!==n;++o)e[o]._update(i,t,r,a);const o=this._bindings,s=this._nActiveBindings;for(let t=0;t!==s;++t)o[t].apply(a);return this}setTime(t){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,a=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,a._cacheIndex=r,e[r]=a,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const t in n){const i=n[t].actionByRoot[e];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const t in i){const e=i[t];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class tf{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new tf(void 0===this.value.clone?this.value:this.value.clone())}}(class extends hd{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;const ef=new Fo;class nf{constructor(t=new Fo(1/0,1/0),e=new Fo(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=ef.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return ef.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}nf.prototype.isBox2=!0;const rf=new Qo,af=new Ts,of=new Ts;function sf(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,sf(t.children[n]));return e}const lf=new Float32Array(1);new Int32Array(lf.buffer),ip.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(ip.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},wp.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},class extends Xd{constructor(t=10,e=10,n=4473924,i=8947848){n=new _l(n),i=new _l(i);const r=e/2,a=t/e,o=t/2,s=[],l=[];for(let t=0,c=0,u=-o;t<=e;t++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);const e=t===r?n:i;e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3,e.toArray(l,c),c+=3}const c=new Rl;c.setAttribute("position",new Sl(s,3)),c.setAttribute("color",new Sl(l,3)),super(c,new Vd({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends Xd{constructor(t){const e=sf(t),n=new Rl,i=[],r=[],a=new _l(0,0,1),o=new _l(0,1,0);for(let t=0;t<e.length;t++){const n=e[t];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new Sl(i,3)),n.setAttribute("color",new Sl(r,3)),super(n,new Vd({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");of.copy(this.root.matrixWorld).invert();for(let t=0,n=0;t<e.length;t++){const r=e[t];r.parent&&r.parent.isBone&&(af.multiplyMatrices(of,r.matrixWorld),rf.setFromMatrixPosition(af),i.setXYZ(n,rf.x,rf.y,rf.z),af.multiplyMatrices(of,r.parent.matrixWorld),rf.setFromMatrixPosition(af),i.setXYZ(n+1,rf.x,rf.y,rf.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},_m.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Om.extractUrlBase(t)},_m.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},nf.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},nf.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},nf.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},nf.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},ts.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ts.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ts.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},ts.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},ts.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},_s.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},vc.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Oo.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Oo.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Oo.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Oo.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Oo.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Oo.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Ts.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},Ts.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Ts.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Qo).setFromMatrixColumn(this,3)},Ts.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},Ts.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Ts.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ts.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ts.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Ts.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},Ts.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ts.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Ts.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Ts.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Ts.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Ts.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Ts.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},Ts.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Ts.prototype.makeFrustum=function(t,e,n,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,a)},Ts.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},mc.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Xo.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Xo.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ms.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Ms.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},Ms.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},ul.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ul.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},ul.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},ul.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},ul.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},ul.barycoordFromPoint=function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ul.getBarycoord(t,e,n,i,r)},ul.normal=function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ul.getNormal(t,e,n,i)},Cp.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},Cp.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Jp(this,t)},Cp.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new tm(this,t)},Fo.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Fo.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Fo.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Qo.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Qo.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Qo.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},Qo.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},Qo.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},Qo.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},Qo.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Qo.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Qo.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Zo.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Zo.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ks.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},Ks.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ks.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},Ks.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ks.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Ks.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Jl.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Jl.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Rd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},oc.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Em.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(wl.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===So},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(So)}}}),wl.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?So:Eo),this},wl.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},wl.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Rl.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},Rl.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new wl(arguments[1],arguments[2])))},Rl.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},Rl.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Rl.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Rl.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},Rl.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(Rl.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),hd.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?So:Eo),this},hd.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Jp.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Jp.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Jp.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},ud.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},tf.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(dl.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new _l}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(rc.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),sd.prototype.clearTarget=function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},sd.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},sd.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},sd.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},sd.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},sd.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},sd.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},sd.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},sd.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},sd.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},sd.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},sd.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},sd.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},sd.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},sd.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},sd.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},sd.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},sd.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},sd.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},sd.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},sd.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},sd.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},sd.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},sd.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},sd.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(sd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?fo:mo}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Xh.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties($o.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),class extends Ks{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Um).load(t,(function(t){e.setBuffer(t)})),this},lc.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},lc.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)},Ho.crossOrigin=void 0,Ho.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new Cm;r.setCrossOrigin(this.crossOrigin);const a=r.load(t,n,void 0,i);return e&&(a.mapping=e),a},Ho.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new wm;r.setCrossOrigin(this.crossOrigin);const a=r.load(t,n,void 0,i);return e&&(a.mapping=e),a},Ho.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ho.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ni}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ni);const cf=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return ai(void 0!==n,15),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return ai(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){ai(!(t in this.entries_),16);const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};var uf,hf,df,pf,mf,ff,gf,vf,yf,_f,xf,bf,Af,wf,Cf,Ef,Sf,Mf,Tf,If,Bf,Lf,Df=Object.defineProperty,Pf=(t,e,n)=>(((t,e,n)=>{e in t?Df(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n})(t,"symbol"!=typeof e?e+"":e,n),n),Rf=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},kf=(t,e,n)=>(Rf(t,e,"read from private field"),n?n.call(t):e.get(t)),zf=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Ff=(t,e,n,i)=>(Rf(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),Of=(t,e,n,i)=>({set _(i){Ff(t,e,i,n)},get _(){return kf(t,e,i)}}),Nf=(t,e,n)=>(Rf(t,e,"access private method"),n);class Uf extends Map{constructor(t={}){if(super(),zf(this,gf),zf(this,yf),zf(this,xf),zf(this,Af),zf(this,Cf),zf(this,Sf),zf(this,Tf),zf(this,Bf),zf(this,uf,0),zf(this,hf,new Map),zf(this,df,new Map),zf(this,pf,void 0),zf(this,mf,void 0),zf(this,ff,void 0),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof t.maxAge&&0===t.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");Ff(this,pf,t.maxSize),Ff(this,mf,t.maxAge||Number.POSITIVE_INFINITY),Ff(this,ff,t.onEviction)}get __oldCache(){return kf(this,df)}get(t){if(kf(this,hf).has(t)){const e=kf(this,hf).get(t);return Nf(this,Af,wf).call(this,t,e)}if(kf(this,df).has(t)){const e=kf(this,df).get(t);if(!1===Nf(this,yf,_f).call(this,t,e))return Nf(this,Tf,If).call(this,t,e),e.value}}set(t,e,{maxAge:n=kf(this,mf)}={}){const i="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return kf(this,hf).has(t)?kf(this,hf).set(t,{value:e,expiry:i}):Nf(this,Sf,Mf).call(this,t,{value:e,expiry:i}),this}has(t){return kf(this,hf).has(t)?!Nf(this,yf,_f).call(this,t,kf(this,hf).get(t)):!!kf(this,df).has(t)&&!Nf(this,yf,_f).call(this,t,kf(this,df).get(t))}peek(t){return kf(this,hf).has(t)?Nf(this,Cf,Ef).call(this,t,kf(this,hf)):kf(this,df).has(t)?Nf(this,Cf,Ef).call(this,t,kf(this,df)):void 0}delete(t){const e=kf(this,hf).delete(t);return e&&Of(this,uf)._--,kf(this,df).delete(t)||e}clear(){kf(this,hf).clear(),kf(this,df).clear(),Ff(this,uf,0)}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...Nf(this,Bf,Lf).call(this)],n=e.length-t;n<0?(Ff(this,hf,new Map(e)),Ff(this,df,new Map),Ff(this,uf,e.length)):(n>0&&Nf(this,gf,vf).call(this,e.slice(0,n)),Ff(this,df,new Map(e.slice(n))),Ff(this,hf,new Map),Ff(this,uf,0)),Ff(this,pf,t)}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of kf(this,hf)){const[e,n]=t;!1===Nf(this,yf,_f).call(this,e,n)&&(yield[e,n.value])}for(const t of kf(this,df)){const[e,n]=t;kf(this,hf).has(e)||!1===Nf(this,yf,_f).call(this,e,n)&&(yield[e,n.value])}}*entriesDescending(){let t=[...kf(this,hf)];for(let e=t.length-1;e>=0;--e){const n=t[e],[i,r]=n;!1===Nf(this,yf,_f).call(this,i,r)&&(yield[i,r.value])}t=[...kf(this,df)];for(let e=t.length-1;e>=0;--e){const n=t[e],[i,r]=n;kf(this,hf).has(i)||!1===Nf(this,yf,_f).call(this,i,r)&&(yield[i,r.value])}}*entriesAscending(){for(const[t,e]of Nf(this,Bf,Lf).call(this))yield[t,e.value]}get size(){if(!kf(this,uf))return kf(this,df).size;let t=0;for(const e of kf(this,df).keys())kf(this,hf).has(e)||t++;return Math.min(kf(this,uf)+t,kf(this,pf))}get maxSize(){return kf(this,pf)}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[n,i]of this.entriesAscending())t.call(e,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}uf=new WeakMap,hf=new WeakMap,df=new WeakMap,pf=new WeakMap,mf=new WeakMap,ff=new WeakMap,gf=new WeakSet,vf=function(t){if("function"==typeof kf(this,ff))for(const[e,n]of t)kf(this,ff).call(this,e,n.value)},yf=new WeakSet,_f=function(t,e){return"number"==typeof e.expiry&&e.expiry<=Date.now()&&("function"==typeof kf(this,ff)&&kf(this,ff).call(this,t,e.value),this.delete(t))},xf=new WeakSet,bf=function(t,e){if(!1===Nf(this,yf,_f).call(this,t,e))return e.value},Af=new WeakSet,wf=function(t,e){return e.expiry?Nf(this,xf,bf).call(this,t,e):e.value},Cf=new WeakSet,Ef=function(t,e){const n=e.get(t);return Nf(this,Af,wf).call(this,t,n)},Sf=new WeakSet,Mf=function(t,e){kf(this,hf).set(t,e),Of(this,uf)._++,kf(this,uf)>=kf(this,pf)&&(Ff(this,uf,0),Nf(this,gf,vf).call(this,kf(this,df)),Ff(this,df,kf(this,hf)),Ff(this,hf,new Map))},Tf=new WeakSet,If=function(t,e){kf(this,df).delete(t),Nf(this,Sf,Mf).call(this,t,e)},Bf=new WeakSet,Lf=function*(){for(const t of kf(this,df)){const[e,n]=t;kf(this,hf).has(e)||!1===Nf(this,yf,_f).call(this,e,n)&&(yield t)}for(const t of kf(this,hf)){const[e,n]=t;!1===Nf(this,yf,_f).call(this,e,n)&&(yield t)}};let Vf=null,Gf=null;function Hf(t){return`vec4(${(t[0]/255).toFixed(3)},${(t[1]/255).toFixed(3)},${(t[2]/255).toFixed(3)},${((t[3]??255)/255).toFixed(3)})`}function jf(t){return 180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360))/360}function Wf(t,e){return[t/360,jf(e)]}const qf=2*Math.PI*6378137;function Zf(t,e){return Wf(t,e).map((t=>t*qf))}const $f=new Uf({maxSize:200});function Yf(t,e=50){if(t.length<=e)return t;const n=function(t){return t.filter(((e,n)=>0===n||n%2||n===t.length-1))}(t);return Yf(n,e)}function Xf(t,e,n={inputName:"v",outputName:"c"}){const i=Yf(t);let r="";for(let t=0;t<i.length;t++){const a=i[t];0===t&&(r+=`vec4 ${n.outputName}=${Hf(a.color)};\n`);const o=a.value,s=Hf(a.color);if(e&&t+1<i.length){const e=i[t+1].value,a=Hf(i[t+1].color),l=0===parseFloat((o-e).toFixed(7))?"0.":`(${n.inputName} - ${o.toFixed(7)}) / (${(e-o).toFixed(7)})`;r+=`${t>0?" else ":""} if(${n.inputName}>=${o.toFixed(7)}&&${n.inputName}<${e.toFixed(7)}) { ${n.outputName}=mix(${s},${a}, ${l} ); }\n`}else r+=`if(${n.inputName}>=${o.toFixed(7)})${n.outputName}=${s};\n`}return r}class Qf{constructor(t,e){this.code=t,this.decode=e,this.decode.min=this.decode.min??0,this.decode.max=this.decode.max??1}codeValue(t){return(t-this.decode.min)/(this.decode.max-this.decode.min)}decodeValue(t){return this.decode.min+t*(this.decode.max-this.decode.min)}decodeChannel(t){if(this.decode.channel.length>1){const e=this.decodeValue(t[this.decode.channel[0]]),n=this.decodeValue(t[this.decode.channel[1]]);return[e,n,Math.sqrt(e*e+n*n)]}return this.decodeValue(t[this.decode.channel])}getBlendCode(t){return`vec4 ${t}(vec4 d,vec4 data){${this.code+"d.rgb=(d.rgb*d.a*(1.-c.a)+c.rgb*c.a)/(d.a*(1.-c.a)+c.a);d.a=d.a+c.a*(1.-d.a);"}return d;}`}getCode(t){return`vec4 ${t}(vec4 data){${this.code}return c;}`}}class Jf extends Qf{constructor(t){const e=t.decode,n=t.stops||[{value:e.min,color:[0,0,0,0]},{value:e.max,color:[255,255,255,255]}],i=t.smooth??!0,r=t.opacity??1;let a=function({channel:t="r",min:e=0,max:n=1}){let i=`${e.toFixed(7)}+data.${t}*${(n-e).toFixed(7)}`;return t.length>1&&(i=`length(${i})`),`float v=${i};`}(e);a+=Xf(n,i),a+=`c.a*=${r.toFixed(3)};`,super(a,e)}}class Kf{constructor(){Pf(this,"allInstances",[]),Pf(this,"availableInstances",[])}add(t,e=!1){return this.allInstances.push(t),e&&this.availableInstances.push(t),t}isEmpty(){return 0===this.availableInstances.length}pop(){if(this.isEmpty())throw new Error("No more instances available ini the pool.");return this.availableInstances.pop()}init(){this.availableInstances=this.allInstances.slice()}reset(){this.availableInstances=[],this.allInstances=[]}}var tg="precision highp float;precision highp int;precision highp sampler2D;uniform vec2 direction;uniform int kernelSize;uniform sampler2D imgToBlur;in vec2 vUv;out vec4 fragColor;vec4 blur5(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){vec4 color=vec4(0.0);vec2 off1=vec2(1.3333333333333333)*direction;color+=texture(image,uv)*0.29411764705882354;color+=texture(image,uv+(off1/resolution))*0.35294117647058826;color+=texture(image,uv-(off1/resolution))*0.35294117647058826;return color;}vec4 blur9(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){vec4 color=vec4(0.0);vec2 off1=vec2(1.3846153846)*direction;vec2 off2=vec2(3.2307692308)*direction;color+=texture(image,uv)*0.2270270270;color+=texture(image,uv+(off1/resolution))*0.3162162162;color+=texture(image,uv-(off1/resolution))*0.3162162162;color+=texture(image,uv+(off2/resolution))*0.0702702703;color+=texture(image,uv-(off2/resolution))*0.0702702703;return color;}vec4 blur13(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){vec4 color=vec4(0.0);vec2 off1=vec2(1.411764705882353)*direction;vec2 off2=vec2(3.2941176470588234)*direction;vec2 off3=vec2(5.176470588235294)*direction;color+=texture(image,uv)*0.1964825501511404;color+=texture(image,uv+(off1/resolution))*0.2969069646728344;color+=texture(image,uv-(off1/resolution))*0.2969069646728344;color+=texture(image,uv+(off2/resolution))*0.09447039785044732;color+=texture(image,uv-(off2/resolution))*0.09447039785044732;color+=texture(image,uv+(off3/resolution))*0.010381362401148057;color+=texture(image,uv-(off3/resolution))*0.010381362401148057;return color;}vec4 blur19(sampler2D image,vec2 uv,vec2 resolution,vec2 direction){vec4 color=vec4(0.0);vec2 off1=vec2(1.434782608695652)*direction;vec2 off2=vec2(3.347826086956522)*direction;vec2 off3=vec2(5.260869565217392)*direction;vec2 off4=vec2(7.173913043478261)*direction;color+=texture(image,uv)*0.16818993967466953;color+=texture(image,uv+(off1/resolution))*0.2727695816518679;color+=texture(image,uv-(off1/resolution))*0.2727695816518679;color+=texture(image,uv+(off2/resolution))*0.11690124927937194;color+=texture(image,uv-(off2/resolution))*0.11690124927937194;color+=texture(image,uv+(off3/resolution))*0.024067904263400105;color+=texture(image,uv-(off3/resolution))*0.024067904263400105;color+=texture(image,uv+(off4/resolution))*0.0021112196722280793;color+=texture(image,uv-(off4/resolution))*0.0021112196722280793;return color;}void main(){vec4 color=vec4(1.,0,0,1.);vec2 textureResolution=vec2(textureSize(imgToBlur,0));if(kernelSize==5){color=blur5(imgToBlur,vUv,textureResolution,direction);}else if(kernelSize==9){color=blur9(imgToBlur,vUv,textureResolution,direction);}else if(kernelSize==13){color=blur13(imgToBlur,vUv,textureResolution,direction);}else if(kernelSize==19){color=blur19(imgToBlur,vUv,textureResolution,direction);}fragColor=color;}";let eg=null;class ng{constructor(t,e,n=function(){return eg||(eg=new sd({alpha:!0,premultipliedAlpha:!1})),eg}()){Pf(this,"renderer"),Pf(this,"camera",new Bc(-1,1,1,-1,0,1)),Pf(this,"scene",new ud),Pf(this,"renderTarget"),Pf(this,"material",new Lc({glslVersion:Mo,vertexShader:"precision highp float;precision highp int;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;in vec3 position;in vec2 uv;out vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragmentShader:"precision highp float;precision highp int;precision highp sampler2D;in vec2 vUv;out vec4 fragColor;void main(){fragColor=vec4(1.,0.,0.,1.);}",depthWrite:!1,transparent:!0})),Pf(this,"size"),this.size=new Fo(t,e),this.renderTarget=new $o(t,e,{minFilter:qr,magFilter:qr,format:ca}),this.camera.matrixAutoUpdate=!1,this.renderer=n,this.renderer.setPixelRatio(1),this.renderer.autoClear=!1;const i=new Jl(new xc(2,2),this.material);this.scene.add(i)}getOutputTexture(t=!1){return t?new kd(this.getPixelData(),this.size.x,this.size.y,ca):this.renderTarget.texture}setSize(t,e){t===this.size.x&&e===this.size.y||(this.size.x=t,this.size.y=e,this.renderTarget=new $o(t,e,{minFilter:qr,magFilter:qr,format:ca}),this.renderer.setRenderTarget(this.renderTarget))}setVertexShader(t){this.material.vertexShader=t.trim(),this.material.needsUpdate=!0}setFragmentShader(t){this.material.fragmentShader=t.trim(),this.material.needsUpdate=!0}setUniform(t,e){this.material.uniforms[t]={value:e}}setDefine(t,e){this.material.fragmentShader=this.material.fragmentShader.replace(new RegExp(t,"g"),e.toString()),this.material.vertexShader=this.material.vertexShader.replace(new RegExp(t,"g"),e.toString()),this.material.needsUpdate=!0}getPixelData(){const t=this.size,e=new Uint8Array(t.x*t.y*4);return this.renderer.readRenderTargetPixels(this.renderTarget,0,0,t.x,t.y,e),e}getSize(){return this.size.clone()}process(){return this.material.needsUpdate=!0,this.renderer.setRenderTarget(this.renderTarget),this.renderer.clear(),this.renderer.render(this.scene,this.camera),this.renderTarget.texture}debugAsPNG(){const t=this.getSize(),e=this.getPixelData(),n=document.createElement("canvas");n.width=t.x,n.height=t.y;const i=n.getContext("2d");if(!i)return;const r=i.getImageData(0,0,n.width,n.height);r.data.set(e),i.putImageData(r,0,0);const a=window.open();a&&a.document.write(`<iframe src="${n.toDataURL("image/png")}" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>`)}dispose(){this.renderTarget.texture.dispose(),this.renderTarget.dispose()}}const ig="api.maptiler.com",rg={maptilerApiHost:ig,endpoint:`https://${ig}/weather/latest.json`,tileSourceUrlSchema:`https://${ig}/tiles/{tileset_id}/{zxy}.{format}`};Object.freeze(rg);class ag{constructor(t,e){Pf(this,"loader",new Cm),Pf(this,"lru",new cf(32)),Pf(this,"apiKey",""),Pf(this,"sessionId",""),this.url=t,this.onTileLoad=e}setMaptilerParams(t,e){this.apiKey=t,this.sessionId=e}urlPatternToUrl(t){let e;try{e=new URL(this.url.replace("{zxy}",t))}catch{e=new URL(this.url.replace("{zxy}",t),document.baseURI)}return e.host===rg.maptilerApiHost&&(this.apiKey&&!e.searchParams.has("key")&&e.searchParams.append("key",this.apiKey),this.sessionId&&!e.searchParams.has("mtsid")&&e.searchParams.append("mtsid",this.sessionId)),e.href}getTile(t,e){if(t.split("/").map((t=>parseInt(t))).some((t=>t<0)))return null;if(this.lru.containsKey(t))return this.lru.get(t);if(e){const e=this.createTile(t);return this.lru.set(t,e),e}return null}createTile(t){const e=this.urlPatternToUrl(t),n={ready:!1,texture:null,zxy:t};return n.texture=this.loader.load(e,(()=>{n.ready=!0,null!=this.onTileLoad&&this.onTileLoad(n,e,null)}),void 0,(t=>{null!=this.onTileLoad&&this.onTileLoad(n,e,t)})),n.texture.minFilter=qr,n.texture.needsUpdate=!0,n}disposeTile(t){t.texture&&t.texture.dispose()}expireCache(t){for(;this.lru.canExpireCache()&&!(this.lru.peekLast().zxy in t);)this.disposeTile(this.lru.pop())}dispose(){this.lru.forEach((t=>{this.disposeTile(t)})),this.lru.clear()}}class og extends lt.EventEmitter{constructor(){super(),Pf(this,"frames",[]),Pf(this,"time",0),Pf(this,"animationSpeed",0),Pf(this,"lastTickTime",0)}addFrame(t,e){const n=this.findSmallerFrameIndex(t);if(n<0)this.frames.unshift({time:t,data:e});else{if(this.frames[n].time==t)throw new Error("Frame with this time already exists");this.frames.splice(n+1,0,{time:t,data:e})}this.clampAnimation()}removeFrame(t){const e=this.frames.filter((e=>e.time==t));return this.frames=this.frames.filter((e=>e.time!=t)),this.clampAnimation(),e}forEachFrame(t){this.frames.forEach((e=>t(e)))}getAnimationStart(){return this.frames.length?this.frames[0].time:1/0}getAnimationStartDate(){return new Date(1e3*this.getAnimationStart())}getAnimationEnd(){return this.frames.length?this.frames[this.frames.length-1].time:-1/0}getAnimationEndDate(){return new Date(1e3*this.getAnimationEnd())}getAnimationTime(){return this.time}getAnimationTimeDate(){return new Date(1e3*this.getAnimationTime())}setAnimationTime(t){this.time=t,this.clampAnimation(),this.emit("animationTimeSet",{time:this.time})}clampAnimation(){this.time=Math.max(this.getAnimationStart(),Math.min(this.getAnimationEnd(),this.time))}animateByFactor(t){this.animate(t)}animate(t){t>0&&0===this.animationSpeed?this.emit("playAnimation",{time:this.time}):0===t&&this.animationSpeed>0&&this.emit("pauseAnimation",{time:this.time}),this.animationSpeed=t,0!=this.animationSpeed&&(this.lastTickTime=performance.now())}getAnimationSpeed(){return this.animationSpeed}isPlaying(){return this.animationSpeed>0}animationTick(){const t=performance.now();if(this.animationSpeed>0&&this.lastTickTime){const e=t-this.lastTickTime;this.time+=this.animationSpeed*(e/1e3);const n=this.getAnimationStart(),i=this.getAnimationEnd();this.time=n+(this.time-n)%(i-n),isNaN(this.time)&&(this.time=n),this.emit("tick",{time:this.time})}this.lastTickTime=t}findSmallerFrameIndex(t){for(let e=this.frames.length-1;e>=0;--e)if(this.frames[e].time<=t)return e;return-1}getCurrentFrames(){if(0==this.frames.length)return{frameA:null,frameB:null,mix:0};let t=this.findSmallerFrameIndex(this.time);t<0&&(t=0);const e=this.frames[t],n=this.frames[Math.min(this.frames.length-1,t+1)],i=n.time-e.time;return{frameA:e,frameB:n,mix:0==i?0:(this.time-e.time)/i}}getNextFrame(t,e){const n=this.frames.findIndex((e=>e===t));return n<0?null:e<0?n>0?this.frames[n-1]:null:n<this.frames.length-1?this.frames[n+1]:null}}const sg={latest:null};class lg{static async fetchLatest(t,e){const n=`${rg.endpoint}?key=${t}&mtsid=${e}`,i=await fetch(n,{cache:"no-store"});sg.latest=await i.json()}static getDataForWeatherVariableID(t){if(!sg.latest)return null;const e=sg.latest.variables.filter((e=>e.metadata.weather_variable.variable_id===t));return e.length?e[0]:null}static hasData(){return!!sg.latest}static getTemperatureData(){return lg.getDataForWeatherVariableID("temperature-2m:gfs")}static getPressureData(){return lg.getDataForWeatherVariableID("pressure-msl:gfs")}static getPrecipitationData(){return lg.getDataForWeatherVariableID("precipitation-1h:gfs")}static getCloudCoverData(){return lg.getDataForWeatherVariableID("cloud_cover-total:gfs")}static getFrozenPrecipitationData(){return lg.getDataForWeatherVariableID("frozen_precipitation-1h:gfs")}static getRadarData(){return lg.getDataForWeatherVariableID("radar-composite:gfs")}static getWindData(){return lg.getDataForWeatherVariableID("wind-10m:gfs")}static getSourcesAndTimestamps(t,e,n){return t.keyframes.map((i=>({source:`${rg.tileSourceUrlSchema.replace("{tileset_id}",i.id).replace("{format}",t.tile_format)}?key=${e}&mtsid=${n}`,timestamp:+new Date(i.timestamp)/1e3})))}}class cg extends og{constructor(t,e,n=null,i=null){super(),Pf(this,"id"),Pf(this,"type","custom"),Pf(this,"renderingMode","3d"),Pf(this,"camera",new ac),Pf(this,"scene",new ud),Pf(this,"slippyTiles",[]),Pf(this,"map",null),Pf(this,"renderer",null),Pf(this,"material"),Pf(this,"geometry",new xc(1,1)),Pf(this,"flusher"),Pf(this,"tilegrid"),Pf(this,"extent",null),Pf(this,"repaintOnPausedAnimation",!0),Pf(this,"materialPool",new Kf),Pf(this,"bluringNodePasses",[]),Pf(this,"tileThreeContainer",new Ks),Pf(this,"extentScale",1),Pf(this,"extentChangedThreshold",.75),Pf(this,"lastExtent",[0,0,0,0]),Pf(this,"timeInterpolation",!0),Pf(this,"isReady",!1),Pf(this,"defaultTexture",new kd(new Uint8Array([128,128,128,255]),1,1,ca)),Pf(this,"onMoveEndListener"),Pf(this,"onResizeListener"),Pf(this,"onMoveListener"),Pf(this,"coloringFragments",null),Pf(this,"multiChannelColoringFragment"),Pf(this,"loadLowerZoomLevels"),Pf(this,"getMapOrThrow",(()=>{if(null==this.map)throw new Error("Accessing map on detached layer");return this.map})),Pf(this,"getRendererOrThrow",(()=>{if(null==this.renderer)throw new Error("Accessing renderer on detached layer");return this.renderer})),this.defaultTexture.needsUpdate=!0,this.id=t,e&&this.init(e,n,i)}init(t,e=null,n=null){this.loadLowerZoomLevels=t.loadLowerZoomLevels??!0,this.coloringFragments=e,this.multiChannelColoringFragment=n,this.repaintOnPausedAnimation=t.repaintOnPausedAnimation??!0,this.onMoveEndListener=this.onMoveEnd.bind(this),this.onResizeListener=this.onResize.bind(this),this.onMoveListener=this.onMove.bind(this),this.tilegrid=function(t){const e=t||{},n=e.extent||(r="EPSG:3857","string"==typeof r?Ii[a=r]||Ii[a.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:r||null).getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Oi(n,e.maxZoom,e.tileSize,e.maxResolution)};var r,a;return new fi(i)}({minZoom:t.minZoom??0,maxZoom:t.maxZoom??4}),t.bounds&&(this.extent=Zf(t.bounds[0],t.bounds[1]).concat(Zf(t.bounds[2],t.bounds[3])));let i="";if(this.coloringFragments){const t=this.coloringFragments.map(((t,e)=>t.getBlendCode(`_cf_${e}`)));let e="fragColor";for(let t=0;t<this.coloringFragments.length;t++)e=`_cf_${t}(${e},inter)`;e=`fragColor=${e};`,i="precision highp float;precision highp sampler2D;COLORING_FRAGMENT_DEFSout vec4 fragColor;uniform float opacity;uniform float zoom;uniform float time;uniform sampler2D tex0;uniform sampler2D tex1;uniform float tilePixelSize;uniform sampler2D texN0;uniform sampler2D texN1;uniform bool availableN;uniform sampler2D texE0;uniform sampler2D texE1;uniform bool availableE;uniform sampler2D texS0;uniform sampler2D texS1;uniform bool availableS;uniform sampler2D texW0;uniform sampler2D texW1;uniform bool availableW;uniform float maxSmoothingDistance;uniform float smoothingDistanceDecayFactor;uniform bool localSmoothing;uniform float zoomDelta;in vec2 tex0coord;in vec2 tex1coord;float PI=3.141592;const int halfNbSmoothingBins=int(ceil(float(NB_SMOOTHING_BINS))/2.);void textPositionToInternalTexPosition(vec2 uv,out vec2 newUv,out int texturePositionIndex){if(uv.x>=0.&&uv.x<=1.){if(uv.y>=0.&&uv.y<=1.){newUv=uv;texturePositionIndex=0;}else if(uv.y<0.&&availableS){newUv=vec2(uv.x,1.+uv.y);texturePositionIndex=5;}else if(uv.y>1.&&availableN){newUv=vec2(uv.x,1.-uv.y);texturePositionIndex=1;}else{newUv=uv;texturePositionIndex=0;}}else if(uv.x<0.){if(uv.y>=0.&&uv.y<=1.&&availableW){newUv=vec2(1.+uv.x,uv.y);texturePositionIndex=7;}else{newUv=uv;texturePositionIndex=0;}}else if(uv.x>1.){if(uv.y>=0.&&uv.y<=1.&&availableE){newUv=vec2(uv.x-1.,uv.y);texturePositionIndex=3;}else{newUv=uv;texturePositionIndex=0;}}}vec4 getTextureColorByIndex(int textureTimeIndex,int texturePositionIndex,vec2 uv){if(textureTimeIndex==0){if(texturePositionIndex==0){return texture(tex0,uv);}else if(texturePositionIndex==1){return texture(texN0,uv);}else if(texturePositionIndex==3){return texture(texE0,uv);}else if(texturePositionIndex==5){return texture(texS0,uv);}else if(texturePositionIndex==7){return texture(texW0,uv);}}else if(textureTimeIndex==1){if(texturePositionIndex==0){return texture(tex1,uv);}else if(texturePositionIndex==1){return texture(texN1,uv);}else if(texturePositionIndex==3){return texture(texE1,uv);}else if(texturePositionIndex==5){return texture(texS1,uv);}else if(texturePositionIndex==7){return texture(texW1,uv);}}else{return vec4(1.,0.,0.,1.);}}vec4 getColor(int textureTimeIndex,vec2 uv){int texturePositionIndex=0;vec2 localUV=vec2(0.,0.);textPositionToInternalTexPosition(uv,localUV,texturePositionIndex);return getTextureColorByIndex(textureTimeIndex,texturePositionIndex,localUV);}vec4 circularSampleSmoothing(int textureTimeIndex,vec2 uv,float resolution,float distance,out bool isTransparant){vec4 colorRGBA=getColor(textureTimeIndex,uv);int weightCenter=3;vec4 color=colorRGBA*float(weightCenter);isTransparant=colorRGBA.a<1.;float angularStep=2.*PI/float(halfNbSmoothingBins);for(int i=0;i<halfNbSmoothingBins;i++){float angle=angularStep*float(i);vec2 offset=vec2(cos(angle),sin(angle))*distance*0.5;vec2 pos=uv+offset/resolution;vec4 c=getColor(textureTimeIndex,pos);color+=c;isTransparant=isTransparant||c.a<1.;angle=angularStep/2.+angularStep*float(i);offset=vec2(cos(angle),sin(angle))*distance;pos=uv+offset/resolution;c=getColor(textureTimeIndex,pos);color+=c;isTransparant=isTransparant||c.a<1.;}return color/float(2*halfNbSmoothingBins+weightCenter);}void main(){float scaledSamplingDistance=(maxSmoothingDistance*smoothingDistanceDecayFactor/(smoothingDistanceDecayFactor+zoom))*max(1.,2.-zoomDelta);bool isTransparant0=false;bool isTransparant1=false;vec4 tex0Color;vec4 tex1Color;if(localSmoothing&&halfNbSmoothingBins!=0){tex0Color=circularSampleSmoothing(0,tex0coord,tilePixelSize,scaledSamplingDistance,isTransparant0);tex1Color=circularSampleSmoothing(1,tex1coord,tilePixelSize,scaledSamplingDistance,isTransparant1);}else{tex0Color=texture(tex0,tex0coord);tex1Color=texture(tex1,tex1coord);}vec4 inter=mix(tex0Color,tex1Color,time);if(inter.a<1.0&&!RENDER_TRANSPARENT)discard;COLORING_FRAGMENT_CALLSfragColor.a*=opacity;}".replace("COLORING_FRAGMENT_DEFS",t.join("\n")).replace("COLORING_FRAGMENT_CALLS",e)}else n&&(i=n.getCode());const r=(t.nbSmoothingBins??16).toFixed(0);this.timeInterpolation=t.timeInterpolation??!0,this.material=new Lc({glslVersion:Mo,uniforms:{opacity:{value:1},time:{value:0},zoom:{value:0},tex0xy:{value:[0,0]},tex1xy:{value:[0,0]},tex0size:{value:1},tex1size:{value:1},tilePixelSize:{value:1},categorySmoothTransition:{value:t.categorySmoothTransition??!1},timeInterpolation:{value:this.timeInterpolation},tex0:{value:null},tex1:{value:null},zoomDelta:{value:0},localSmoothing:{value:t.localSmoothing??!1},maxSmoothingDistance:{value:t.maxSmoothingDistance??12},smoothingDistanceDecayFactor:{value:t.smoothingDistanceDecayFactor??10},texN0:{value:this.defaultTexture},texN1:{value:this.defaultTexture},availableN:{value:!1},texE0:{value:this.defaultTexture},texE1:{value:this.defaultTexture},availableE:{value:!1},texS0:{value:this.defaultTexture},texS1:{value:this.defaultTexture},availableS:{value:!1},texW0:{value:this.defaultTexture},texW1:{value:this.defaultTexture},availableW:{value:!1}},vertexShader:"precision highp float;precision highp sampler2D;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;in vec3 position;in vec2 uv;uniform vec2 tex0xy;uniform vec2 tex1xy;uniform float tex0size;uniform float tex1size;out vec2 tex0coord;out vec2 tex1coord;void main(){tex0coord=tex0xy+uv*tex0size;tex1coord=tex1xy+uv*tex1size;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}",fragmentShader:i,depthTest:!1,depthWrite:!1,transparent:!0,defines:{RENDER_TRANSPARENT:t.renderTransparentArea?"true":"false",NB_SMOOTHING_BINS:r}}),this.flusher=new Jl(new xc(1,1),new xl({colorWrite:!1,depthWrite:!1})),this.flusher.frustumCulled=!1,this.scene.add(this.flusher),this.scene.add(this.tileThreeContainer),this.updateSlippyTileGrid(8,8),this.on("playAnimation",(()=>{this.forceRepaint()})),this.on("animationTimeSet",(()=>{this.forceRepaint()})),this.isReady=!0}updateSlippyTileGrid(t,e){this.tileThreeContainer.clear(),this.slippyTiles.length=0;for(let n=0;n<t;n++){this.slippyTiles[n]=[];for(let t=0;t<e;t++){const e=new Jl(this.geometry);e.frustumCulled=!1,this.slippyTiles[n][t]=e,this.tileThreeContainer.add(e)}}}validateSource(t){let e;try{e=new URL(t)}catch{e=new URL(t,document.baseURI)}if(e.host!==rg.maptilerApiHost)throw new Error("\n\nMapTiler Weather library can only source data from MapTiler Cloud.\nPlease use our MapTiler Plus library for self hosting: https://www.maptiler.com/weather/\nor host your data with our generous free plan at MapTiler Cloud: https://cloud.maptiler.com\n")}addSource(t,e,n=null){this.validateSource(e);const i=new ag(e,((t,e,i)=>{n&&n(t,e,i),this.forceRepaint()}));if(this.map){const t=this.map.getSdkConfig().apiKey,e=this.map.getMaptilerSessionId();i.setMaptilerParams(t,e)}super.addFrame(t,i)}removeSource(t){super.removeFrame(t).forEach((t=>{t.data.dispose()})),this.forceRepaint()}getVisibleExtent(t){if(!this.isReady)return null;const e=this.getMapOrThrow().getBounds();let n=Zf(e.getWest(),e.getSouth()).concat(Zf(e.getEast(),e.getNorth()));return this.extent&&(n=Xn(this.extent,n)),t&&function(t,e){const n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}(n,t),n}getWantedTiles(t){if(!this.isReady)return{};t=Math.ceil(t);const e={},n=this.getVisibleExtent();if(!n)throw new Error("The extent is null");const i=this.tilegrid.getMinZoom(),r=this.tilegrid.getMaxZoom(),a=Math.min(r,Math.max(i,t-1)),o=Math.min(r,Math.max(i,t));for(let t=a;t<=o;++t){const i=Math.pow(2,t),r=this.tilegrid.getTileRangeForExtentAndZ(n,t);for(let n=r.minX;n<=r.maxX;++n)for(let a=r.minY;a<=r.maxY;++a)a<0||a>=i||(e[`${t}/${n}/${a}`]=!0)}return e}setOpacity(t){this.isReady&&(this.material.uniforms.opacity.value=t,this.forceRepaint())}onAdd(t,e){this.map=t,this.map.on("moveend",this.onMoveEndListener),this.map.on("resize",this.onResizeListener),this.map.on("move",this.onMoveListener);const n=this.map.getSdkConfig().apiKey,i=this.map.getMaptilerSessionId();this.forEachFrame((t=>{t.data.setMaptilerParams(n,i)})),lg.hasData()||lg.fetchLatest(n,i),this.renderer=new sd({canvas:t.getCanvas(),context:e,depth:!1,stencil:!1,antialias:!0}),this.renderer.autoClear=!1,this.renderer.sortObjects=!1,this.renderer.debug.checkShaderErrors=!0,this.renderer.compile(this.scene,this.camera),this.onResize(),this.refresh();const r=this.getVisibleExtent(this.extentScale);if(!r)throw new Error("The last extent is null");this.lastExtent=r,this.forceRepaint()}onMove(){if(!this.isReady)return;const t=this.getVisibleExtent(this.extentScale);if(!t)throw new Error("New extent is null");const e=$n([Math.min(t[0],this.lastExtent[0]),Math.min(t[1],this.lastExtent[1]),Math.max(t[2],this.lastExtent[2]),Math.max(t[3],this.lastExtent[3])]);$n(Xn(this.lastExtent,t))/e<=this.extentChangedThreshold&&(this.lastExtent=t,this.emit("extentChanged"))}refresh(){}onRemove(t,e){this.isReady&&(null!=this.map&&(this.map.off("moveend",this.onMoveEndListener),this.map.off("resize",this.onResizeListener),this.map.off("move",this.onMoveListener),this.map=null),null!=this.renderer&&(this.renderer.dispose(),this.renderer=null),this.forEachFrame((t=>{t.data.dispose()})),this.disposeObjects())}disposeObjects(){this.isReady&&(this.geometry.dispose(),this.material.dispose(),this.flusher.geometry.dispose(),this.flusher.material.dispose(),this.bluringNodePasses.forEach((t=>t.dispose())))}onResize(){if(!this.isReady)return;const t=this.getMapOrThrow().getCanvas(),e=t.width,n=t.height;this.getRendererOrThrow().setViewport(0,0,e,n),this.updateSlippyTileGrid(Math.ceil(e/512)+2,Math.ceil(n/512)+2)}onMoveEnd(){}getTilePlacement(t,e,n,i,r,a){if(!this.isReady)return null;const o=`${n}/${i}/${r}`,s=t.getTile(o,e);if(!s||!s.ready)return this.loadLowerZoomLevels&&n>this.tilegrid.getMinZoom()?this.getTilePlacement(t,e,n-1,Math.floor(i/2),Math.floor(r/2),a||{z:n,x:i,y:r}):null;const l={tile:s,xy:[0,0],size:1};if(void 0!==a){const t=Math.pow(2,a.z-n);l.size/=t,l.xy[0]=a.x%t/t,l.xy[1]=(Math.pow(2,a.z)-a.y-1)%t/t}return l}updateSlippyTiles(){var t;if(!this.isReady)return;const{frameA:e,frameB:n,mix:i}=this.getCurrentFrames();if(!e||!n)return void(this.scene.visible=!1);this.scene.visible=!0;const r=e.data,a=n.data,o=this.getMapOrThrow().getZoom(),s=this.getWantedTiles(o),l={},c=this.tilegrid.getMinZoom(),u=this.tilegrid.getMaxZoom(),h=Math.min(u,Math.max(c,Math.floor(o))),d=Math.pow(2,h),p=1/d,m=this.getMapOrThrow().getCenter(),f=this.tilegrid.getTileCoordForCoordAndZ(Zf(m.lng,m.lat),h),g=o-h,v=this.slippyTiles.length;this.materialPool.init();const y=new globalThis.Map;for(let n=0;n<v;n++){const c=this.slippyTiles[0].length;for(let u=0;u<c;u++){const m=this.slippyTiles[n][u],_=f[1]+n-Math.floor(v/2),x=f[2]+u-Math.floor(c/2);if(x<0||x>=d||!s[`${h}/${_}/${x}`]){m.visible=!1;continue}m.visible=!0;const b=(_%d+d)%d;l[`${h}/${b}/${x}`]=!0;const A=d-x-1;m.scale.x=p,m.scale.y=p,m.position.x=p*(_+.5),m.position.y=p*(A+.5)-1;let w=this.getTilePlacement(r,!0,h,b,x),C=this.getTilePlacement(a,!0,h,b,x);if(w&&!C&&(C=w),!w&&C&&(w=C),!w||!C){let t=e;for(;!w&&(t=this.getNextFrame(t,-1),t);)w=C=this.getTilePlacement(t.data,!1,h,b,x);if(!w||!C){m.visible=!1;continue}}const E=this.materialPool.isEmpty()?this.materialPool.add(this.material.clone()):this.materialPool.pop();E.uniforms.localSmoothing.value=this.material.uniforms.localSmoothing.value,E.uniforms.maxSmoothingDistance.value=this.material.uniforms.maxSmoothingDistance.value,E.uniforms.smoothingDistanceDecayFactor.value=this.material.uniforms.smoothingDistanceDecayFactor.value,E.uniforms.timeInterpolation.value=this.material.uniforms.timeInterpolation.value,E.uniforms.categorySmoothTransition.value=this.material.uniforms.categorySmoothTransition.value,E.uniforms.opacity.value=this.material.uniforms.opacity.value,E.uniforms.tex0.value=w.tile.texture,E.uniforms.tex0xy.value=w.xy,E.uniforms.tex0size.value=w.size,E.uniforms.tex1.value=C.tile.texture,E.uniforms.tex1xy.value=C.xy,E.uniforms.tex1size.value=C.size,E.uniforms.tilePixelSize.value=null==(t=w.tile.texture)?void 0:t.image.width,E.uniforms.time.value=i,E.uniforms.zoomDelta.value=g,m.material=E,E.uniforms.zoom.value=o,y.set(`${n} ${u}`,{material:E,tileA:w,tileB:C,x:n,y:u,z:h})}}this.material.uniforms.localSmoothing.value&&y.forEach((t=>{const e=t.x,n=t.y,i=t.material,r=`${e} ${n-1}`,a=`${e+1} ${n}`,o=`${e} ${n+1}`,s=`${e-1} ${n}`;let l=y.get(r);l&&l.tileA.tile.ready&&l.tileB.tile.ready?(i.uniforms.texN0.value=l.tileA.tile.texture,i.uniforms.texN1.value=l.tileB.tile.texture,i.uniforms.availableN.value=!0):(i.uniforms.texN0.value=null,i.uniforms.texN1.value=null,i.uniforms.availableN.value=!1),l=y.get(a),l&&l.tileA.tile.ready&&l.tileB.tile.ready?(i.uniforms.texE0.value=l.tileA.tile.texture,i.uniforms.texE1.value=l.tileB.tile.texture,i.uniforms.availableE.value=!0):(i.uniforms.texE0.value=null,i.uniforms.texE1.value=null,i.uniforms.availableE.value=!1),l=y.get(o),l&&l.tileA.tile.ready&&l.tileB.tile.ready?(i.uniforms.texS0.value=l.tileA.tile.texture,i.uniforms.texS1.value=l.tileB.tile.texture,i.uniforms.availableS.value=!0):(i.uniforms.texS0.value=null,i.uniforms.texS1.value=null,i.uniforms.availableS.value=!1),l=y.get(s),l&&l.tileA.tile.ready&&l.tileB.tile.ready?(i.uniforms.texW0.value=l.tileA.tile.texture,i.uniforms.texW1.value=l.tileB.tile.texture,i.uniforms.availableW.value=!0):(i.uniforms.texW0.value=null,i.uniforms.texW1.value=null,i.uniforms.availableW.value=!1)})),setTimeout((()=>{r.expireCache(l),a.expireCache(l);const t=this.getNextFrame(n,1);t&&t.data&&Object.keys(l).forEach((e=>{t.data.getTile(e,!0)}))}),0)}prerender(t,e){if(!this.isReady)return;this.animationTick();const n=(new Ts).fromArray(e),i=(new Ts).makeTranslation(0,0,0).scale(new Qo(1,-1,1));this.camera.projectionMatrix=n.multiply(i),this.updateSlippyTiles(),this.prerenderInternal()}prerenderInternal(){}render(t,e){if(!this.isReady)return;const n=this.getRendererOrThrow();n.state.reset(),this.renderInternal(),n.render(this.scene,this.camera),(this.getAnimationSpeed()>0||this.repaintOnPausedAnimation)&&this.forceRepaint()}renderInternal(){}pickFrame(t,e,n){var i;if(!this.isReady)return null;const r=Wf(t,e);if(!this.map)return null;const a=Math.min(~~(null==(i=this.map)?void 0:i.getZoom()),this.tilegrid.getMaxZoom()),o=Math.pow(2,a),s=(.5+r[0])%1*o,l=(1-(r[1]+.5))*o,c=this.getTilePlacement(n,!0,a,Math.floor(s),Math.floor(l));if(null==c||null==c.tile.texture)return null;if(this.coloringFragments){const t=function(t,e,n){let i;if($f.has(t))i=$f.get(t);else{const e=document.createElement("canvas");if(i=e.getContext("2d",{willReadFrequently:!0}),!i)throw new Error("Unable to get canvas context");$f.set(t,i),e.width=t.width,e.height=t.height,i.drawImage(t,0,0,t.width,t.height)}if(!i)throw new Error("Unable to get canvas context");const r=Math.floor(e*t.width),a=Math.floor(n*t.height),o=i.getImageData(r,a,1,1).data;return{r:o[0]/255,g:o[1]/255,b:o[2]/255,a:o[3]/255}}(c.tile.texture.image,c.xy[0]+c.size*(s%1),1-c.xy[1]-c.size+c.size*(l%1));return this.coloringFragments.map((e=>e.decodeChannel(t))).flat()}if(this.multiChannelColoringFragment){const t=function(t,e,n){const i=Math.floor(e*t.width),r=Math.floor(n*t.height),a=((!Vf||!Gf)&&(Vf=document.createElement("canvas"),Gf=Vf.getContext("webgl2")),Gf);if(null==a)throw new Error("Failed to obtain WebGL2 context");a.activeTexture(a.TEXTURE0);const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);const s=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,s),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,o,0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,t),a.drawBuffers([a.COLOR_ATTACHMENT0]);const l=new Uint8Array(4);return a.readPixels(i,r,1,1,a.RGBA,a.UNSIGNED_BYTE,l),a.deleteTexture(o),a.deleteFramebuffer(s),{r:l[0]/255,g:l[1]/255,b:l[2]/255,a:l[3]/255}}(c.tile.texture.image,c.xy[0]+c.size*(s%1),1-c.xy[1]-c.size+c.size*(l%1));return this.multiChannelColoringFragment.decodeChannel(t)}return null}pick(t,e){if(!this.isReady)return null;const{frameA:n,frameB:i,mix:r}=this.getCurrentFrames();if(!n||!i)return null;const a=this.pickFrame(t,e,n.data),o=this.pickFrame(t,e,i.data);return a?o?this.coloringFragments?a.map(((t,e)=>{const n=o[e];return Array.isArray(t)&&Array.isArray(n)?t.map(((t,e)=>{const i=n[e];return t*(1-r)+i*r})):t*(1-r)+n*r})).flat():this.multiChannelColoringFragment?this.timeInterpolation?[a[0]*(1-r)+o[0]*r,r<.5?a[1]:o[1]]:[r<.5?a[0]:o[0],r<.5?a[1]:o[1]]:null:a:o}forceRepaint(){try{this.getMapOrThrow().triggerRepaint()}catch{}}computeCurrentMixedImage({zxy:t="0/0/0",blurKernel:e=0,outputSize:n=-1,channel:i="r"}){var r,a,o,s;if(!this.isReady)return null;const l=this.getCurrentFrames(),c=l.mix,u=null==(a=null==(r=l.frameA)?void 0:r.data.getTile(t,!1))?void 0:a.texture,h=null==(s=null==(o=l.frameB)?void 0:o.data.getTile(t,!1))?void 0:s.texture,d=n<0?parseInt(null==u?void 0:u.image.width):n,p=n<0?parseInt(null==u?void 0:u.image.height):n;this.bluringNodePasses.length||this.bluringNodePasses.push(new ng(d,p),new ng(d,p),new ng(d,p));const m=this.bluringNodePasses[0],f=this.bluringNodePasses[1],g=this.bluringNodePasses[2];if(m.setSize(d,p),f.setSize(d,p),f.setSize(d,p),m.setFragmentShader("precision highp float;precision highp int;precision highp sampler2D;uniform sampler2D imageA;uniform sampler2D imageB;uniform float mixValue;in vec2 vUv;out vec4 fragColor;void main(){fragColor=mix(texture(imageA,vUv),texture(imageB,vUv),mixValue);}"),m.setDefine("CHANNEL",i),m.setUniform("imageA",u),m.setUniform("imageB",h),m.setUniform("mixValue",c),m.process(),0===e){const t=m.getPixelData();return{data:t,channels:t.length/(d*p),width:d,height:p}}if(![5,9,13,19].includes(e))throw new Error(`The kernel bluring kernel size ${e} is not available.`);f.setUniform("direction",new Fo(1,0)),f.setUniform("kernelSize",e),f.setUniform("imgToBlur",m.getOutputTexture()),f.setFragmentShader(tg),f.process(),g.setUniform("direction",new Fo(0,1)),g.setUniform("kernelSize",e),g.setUniform("imgToBlur",f.getOutputTexture()),g.setFragmentShader(tg),g.process();const v=g.getPixelData();return this.bluringNodePasses.forEach((t=>{t.dispose()})),{data:v,channels:v.length/(d*p),width:d,height:p}}setTimeInterpolation(t){this.isReady&&(this.material.uniforms.timeInterpolation.value=t)}setCategorySmoothTransition(t){this.isReady&&(this.material.uniforms.categorySmoothTransition.value=t,this.forceRepaint())}setLocalSmoothing(t){this.material.uniforms.localSmoothing.value=t,this.forceRepaint()}setMaxSmoothingDistance(t){this.material.uniforms.maxSmoothingDistance.value=t,this.forceRepaint()}setSmoothingDistanceDecayFactor(t){this.material.uniforms.smoothingDistanceDecayFactor.value=t,this.forceRepaint()}getRepaintOnPausedAnimation(){return this.repaintOnPausedAnimation}setRepaintOnPausedAnimation(t){this.repaintOnPausedAnimation=t,this.forceRepaint()}}const ug=class t extends Array{constructor(t={}){super(),Pf(this,"min",0),Pf(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(e){return new t({stops:e.map((t=>({value:t[0],color:t[1]})))})}setStops(t,e={clone:!0}){const n=e.clone?this.clone():this;n.length=0;let i=1/0,r=-1/0;for(let e=0;e<t.length;e+=1)i=Math.min(i,t[e].value),r=Math.max(r,t[e].value),n.push({value:t[e].value,color:t[e].color.slice()});return n.sort(((t,e)=>t.value<e.value?-1:1)),this.min=i,this.max=r,n}scale(e,n,i={clone:!0}){const r=i.clone,a=this[0].value,o=this.at(-1).value-a,s=n-e,l=[];for(let t=0;t<this.length;t+=1){const n=(this[t].value-a)/o*s+e;r?l.push({value:n,color:this[t].color.slice()}):this[t].value=n}return r?new t({stops:l}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new t({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let e=0;e<this.length;e+=1)t.push(this[e]);return t}reverse(t={clone:!0}){const e=t.clone?this.clone():this;for(let t=0;t<~~(e.length/2);t+=1){const n=e[t].color;e[t].color=e.at(-(t+1)).color,e.at(-(t+1)).color=n}return e}getBounds(){return{min:this.min,max:this.max}}getColor(t,e={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let n=0;n<this.length-1;n+=1){if(t>this[n+1].value)continue;const i=this[n].color;if(!e.smooth)return i.slice();const r=this[n].value,a=this[n+1].value,o=this[n+1].color,s=(a-t)/(a-r);return i.map(((t,e)=>Math.round(t*s+o[e]*(1-s))))}return[0,0,0]}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const e=document.createElement("canvas");e.width=t.horizontal?t.size:1,e.height=t.horizontal?1:t.size;const n=e.getContext("2d");if(!n)throw new Error("Canvs context is missing");const i=n.getImageData(0,0,e.width,e.height),r=i.data,a=t.size,o=this[0].value,s=(this.at(-1).value-o)/a;for(let e=0;e<a;e+=1){const n=this.getColor(o+e*s,{smooth:t.smooth});r[4*e]=n[0],r[4*e+1]=n[1],r[4*e+2]=n[2],r[4*e+3]=n.length>3?n[3]:255}return n.putImageData(i,0,0),e}};Pf(ug,"builtin",{NULL:new ug({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),JET:new ug({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new ug({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new ug({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new ug({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new ug({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new ug({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new ug({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new ug({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new ug({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new ug({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new ug({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new ug({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new ug({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new ug({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new ug({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new ug({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new ug({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new ug({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new ug({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new ug({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new ug({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new ug({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new ug({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new ug({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new ug({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new ug({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new ug({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new ug({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new ug({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new ug({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new ug({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new ug({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new ug({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new ug({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new ug({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new ug({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new ug({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new ug({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new ug({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new ug({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new ug({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new ug({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new ug({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new ug({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new ug({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new ug({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new ug({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]}),TERRAIN:new ug({stops:[{value:-10001,color:[0,20,60]},{value:-5e3,color:[0,10,30]},{value:-1e3,color:[0,30,80]},{value:-100,color:[0,38,115]},{value:0,color:[122,200,255]},{value:10,color:[51,102,0]},{value:500,color:[129,195,31]},{value:800,color:[255,255,204]},{value:1200,color:[244,189,69]},{value:2e3,color:[132,75,0]},{value:3e3,color:[102,51,12]},{value:8e3,color:[255,255,255]}]}),PRESSURE:new ug({stops:[{value:900,color:[0,0,100,250]},{value:950,color:[0,0,255,250]},{value:980,color:[0,0,255,120]},{value:1e3,color:[255,255,255,0]},{value:1020,color:[255,0,0,120]},{value:1080,color:[255,0,0,250]}]}),PRESSURE_2:new ug({stops:[{value:900,color:[8,16,48,255]},{value:950,color:[0,32,96,255]},{value:976,color:[0,52,146,255]},{value:986,color:[0,90,148,255]},{value:995,color:[0,117,146,255]},{value:1002,color:[26,140,147,255]},{value:1007,color:[103,162,155,255]},{value:1011,color:[155,183,172,255]},{value:1013,color:[182,182,182,255]},{value:1015,color:[176,174,152,255]},{value:1019,color:[167,147,107,255]},{value:1024,color:[163,116,67,255]},{value:1030,color:[159,81,44,255]},{value:1038,color:[142,47,57,255]},{value:1046,color:[111,24,64,255]},{value:1080,color:[48,8,24,255]}]}),PRESSURE_3:new ug({stops:[{value:900,color:[40,46,117,255]},{value:950,color:[40,51,121,255]},{value:976,color:[42,63,125,255]},{value:986,color:[55,97,141,255]},{value:995,color:[69,115,150,255]},{value:1002,color:[87,144,168,255]},{value:1007,color:[125,184,194,255]},{value:1011,color:[195,226,226,255]},{value:1013,color:[245,220,196,255]},{value:1015,color:[232,191,160,255]},{value:1019,color:[219,154,125,255]},{value:1024,color:[210,115,98,255]},{value:1030,color:[194,72,67,255]},{value:1038,color:[199,61,60,255]},{value:1046,color:[177,50,54,255]},{value:1080,color:[159,42,48,255]}]}),PRESSURE_4:new ug({stops:[{value:900,color:[40,46,117,255]},{value:950,color:[40,51,121,255]},{value:976,color:[42,63,125,255]},{value:986,color:[55,97,141,255]},{value:995,color:[69,115,150,255]},{value:1002,color:[87,144,168,255]},{value:1007,color:[125,184,194,255]},{value:1012.5,color:[226,226,226,255]},{value:1013.5,color:[226,226,226,255]},{value:1015,color:[232,191,160,255]},{value:1019,color:[219,154,125,255]},{value:1024,color:[210,115,98,255]},{value:1030,color:[194,72,67,255]},{value:1038,color:[199,61,60,255]},{value:1046,color:[177,50,54,255]},{value:1080,color:[159,42,48,255]}]}),TEMPERATURE_2:new ug({stops:[{value:-70.15,color:[115,70,105,255]},{value:-55.15,color:[202,172,195,255]},{value:-40.15,color:[162,70,145,255]},{value:-25.15,color:[143,89,169,255]},{value:-15.15,color:[157,219,217,255]},{value:-8.15,color:[106,191,181,255]},{value:-4.15,color:[100,166,189,255]},{value:0,color:[93,133,198,255]},{value:.85,color:[68,125,99,255]},{value:9.85,color:[128,147,24,255]},{value:20.85,color:[243,183,4,255]},{value:29.85,color:[232,83,25,255]},{value:46.85,color:[71,14,0,255]}]}),TEMPERATURE_3:new ug({stops:[{value:-65,color:[3,78,77,255]},{value:-55,color:[4,98,96,255]},{value:-40,color:[5,122,120,255]},{value:-30,color:[6,152,149,255]},{value:-20,color:[8,201,198,255]},{value:-15,color:[20,245,241,255]},{value:-10,color:[108,237,249,255]},{value:-5,color:[133,205,250,255]},{value:0,color:[186,227,252,255]},{value:5,color:[238,221,145,255]},{value:10,color:[232,183,105,255]},{value:15,color:[232,137,69,255]},{value:20,color:[231,107,24,255]},{value:25,color:[236,84,19,255]},{value:30,color:[236,44,19,255]},{value:40,color:[123,23,10,255]},{value:55,color:[91,11,0,255]}]}),PRECIPITATION:new ug({stops:[{value:0,color:[111,111,111,0]},{value:.6,color:[60,116,160,180]},{value:6,color:[59,161,161,255]},{value:8,color:[59,161,61,255]},{value:10,color:[130,161,59,255]},{value:15,color:[161,161,59,255]},{value:20,color:[161,59,59,255]},{value:31,color:[161,59,161,255]},{value:50,color:[168,168,168,255]}]}),PRECIPITATION_2:new ug({stops:[{value:0,color:[255,255,255,0]},{value:.1,color:[171,218,252,255]},{value:1,color:[98,186,249,255]},{value:2,color:[87,160,240,255]},{value:4,color:[112,128,250,255]},{value:6,color:[128,102,245,255]},{value:8,color:[152,102,245,255]},{value:10,color:[154,87,172,255]},{value:15,color:[228,88,126,255]},{value:20,color:[247,135,95,255]},{value:30,color:[249,206,64,255]},{value:50,color:[250,248,168,52]}]}),RADAR:new ug({stops:[{value:0,color:[7,235,236,0]},{value:4,color:[7,235,236,80]},{value:5,color:[7,235,236,255]},{value:10,color:[0,159,246,255]},{value:15,color:[0,0,247,255]},{value:20,color:[3,255,0,255]},{value:25,color:[0,200,2,255]},{value:30,color:[1,144,0,255]},{value:35,color:[255,255,0,255]},{value:40,color:[231,192,0,255]},{value:45,color:[255,145,3,255]},{value:50,color:[255,0,0,255]},{value:55,color:[215,0,0,255]},{value:60,color:[192,0,0,255]},{value:65,color:[255,0,255,255]},{value:70,color:[155,85,200,255]},{value:75,color:[235,235,235,255]}]}),RADAR_CLOUD:new ug({stops:[{value:4,color:[134,134,176,0]},{value:7,color:[134,134,176,30]},{value:10,color:[134,134,176,60]},{value:20,color:[110,110,145,80]},{value:35,color:[77,77,105,140]},{value:45,color:[58,58,87,180]},{value:60,color:[26,26,51,220]}]}),PRESSURE_CIVIDIS:new ug({stops:[{value:900,color:[0,32,77,255]},{value:950,color:[0,37,82,255]},{value:976,color:[15,56,110,255]},{value:986,color:[49,68,107,255]},{value:995,color:[70,80,107,255]},{value:1002,color:[87,92,109,255]},{value:1007,color:[102,105,112,255]},{value:1011,color:[117,117,117,255]},{value:1013,color:[132,130,121,255]},{value:1015,color:[149,143,120,255]},{value:1019,color:[166,157,117,255]},{value:1024,color:[184,171,112,255]},{value:1030,color:[203,186,105,255]},{value:1038,color:[221,201,95,255]},{value:1046,color:[250,229,65,255]},{value:1080,color:[255,234,70,255]}]}),RADAR_ROCKET:new ug({stops:[{value:0,color:[250,235,221,0]},{value:.1,color:[250,235,221,255]},{value:10,color:[246,180,142,255]},{value:20,color:[243,118,81,255]},{value:30,color:[225,51,66,255]},{value:40,color:[174,23,89,255]},{value:50,color:[112,31,87,255]},{value:60,color:[54,25,62,255]},{value:75,color:[3,5,26,255]}]}),WIND_ROCKET:new ug({stops:[{value:0,color:[250,235,221,255]},{value:1,color:[246,187,151,255]},{value:3,color:[244,135,94,255]},{value:5,color:[236,75,62,255]},{value:10,color:[203,27,79,255]},{value:15,color:[150,28,91,255]},{value:20,color:[97,31,83,255]},{value:25,color:[48,23,58,255]},{value:30,color:[3,5,26,255]}]}),MAKO_PRECIPITATION:new ug({stops:[{value:0,color:[255,255,255,0]},{value:.1,color:[222,245,229,255]},{value:1,color:[168,225,188,255]},{value:2,color:[96,206,172,255]},{value:4,color:[61,180,173,255]},{value:6,color:[52,151,169,255]},{value:8,color:[53,123,162,255]},{value:10,color:[57,93,156,255]},{value:15,color:[65,64,129,255]},{value:20,color:[56,42,84,255]},{value:30,color:[38,23,42,255]},{value:50,color:[11,4,5,255]}]}),TEMPERATURE_TURBO:new ug({stops:[{value:-65,color:[48,18,59,255]},{value:-55,color:[64,64,162,255]},{value:-40,color:[70,107,227,255]},{value:-30,color:[66,147,255,255]},{value:-20,color:[40,187,236,255]},{value:-15,color:[24,220,195,255]},{value:-10,color:[49,242,153,255]},{value:-5,color:[107,254,100,255]},{value:0,color:[162,252,60,255]},{value:5,color:[204,237,52,255]},{value:10,color:[237,208,58,255]},{value:15,color:[253,173,53,255]},{value:20,color:[231,107,24,255]},{value:25,color:[236,82,15,255]},{value:30,color:[210,49,5,255]},{value:40,color:[172,23,1,255]},{value:55,color:[122,4,3,255]}]})});let hg=ug;hg.builtin.VIRIDIS;class dg extends cg{constructor(t={}){super(t.id||"MapTiler Precipitation",null,null,null),Pf(this,"constructorOptions"),Pf(this,"isSourceReady",!1),Pf(this,"colorRamp"),this.constructorOptions=t}async onAdd(t,e){const n=t.getSdkConfig().apiKey,i=t.getMaptilerSessionId();lg.hasData()||await lg.fetchLatest(n,i);const r=lg.getPrecipitationData();if(!r)throw new Error("The latest weather data is not avaialble");this.colorRamp=this.constructorOptions.colorramp??hg.builtin.PRECIPITATION,this.init({minZoom:r.metadata.minzoom,maxZoom:r.metadata.maxzoom,repaintOnPausedAnimation:!1},[new Jf({decode:{channel:r.metadata.weather_variable.decoding.channels.toLowerCase(),min:r.metadata.weather_variable.decoding.min,max:r.metadata.weather_variable.decoding.max},stops:this.colorRamp,smooth:this.constructorOptions.smooth??!0,opacity:this.constructorOptions.opacity??1})]),super.onAdd(t,e),lg.getSourcesAndTimestamps(r,n,i).forEach((t=>{this.addSource(t.timestamp,t.source)}));const a=+new Date/1e3;a>=this.getAnimationStart()&&a<=this.getAnimationEnd()&&this.setAnimationTime(a),this.isSourceReady=!0,this.emit("sourceReady",{map:t,layer:this})}getIsSourceReady(){return this.isSourceReady}pickAt(t,e){const n=super.pick(t,e);return n?{value:n[0],valueImperial:n[0]/2.54}:null}getColorRamp(){return this.colorRamp}onSourceReadyAsync(){return new Promise((t=>{if(this.isSourceReady)return t();this.once("sourceReady",(()=>{t()}))}))}}const pg=n.p+"sunny.3552b4cdde3661dc4216.gif",mg=n.p+"cloudy.c10034ae142776b0c2c5.gif",fg=n.p+"very-cloudy.ca89820e07b2edbf0c0d.gif",gg=n.p+"fog.7cffcbd22f7991db3cf3.gif",vg=n.p+"light-rain.15aee547462712d4b55b.gif",yg=n.p+"rain.0153b33eac60db9f769e.gif",_g=n.p+"heavy-rain.745ab8a9d5767e9ffd01.gif",xg=n.p+"light-snow.ca61990222ca2105d330.gif",bg=n.p+"snow.fd7a8274f657b74bca7b.gif",Ag=n.p+"night-clear.727913866cdf1ffa4c28.gif",wg=n.p+"night-cloudy.be57229a6eb1e18f8e29.gif",Cg=n.p+"night-very-cloudy.ff0a8f8cf1f16493d2cc.gif",Eg=n.p+"night-fog.8cf887948a3e4e962fb2.gif",Sg=n.p+"night-light-rain.2621171c877a7e48f872.gif",Mg=n.p+"night-rain.fd3128313302b7d4497d.gif",Tg=n.p+"night-heavy-rain.346289b0a7be61914006.gif",Ig=n.p+"night-thunderstorm.969adb0baf3ce5aa7c36.gif",Bg=n.p+"night-light-snow.7770da8f633210535249.gif",Lg=n.p+"night-snow.0640db5e4709f1b13978.gif",Dg=n.p+"night-heavy-snow.23c35169a97600487eba.gif",Pg=n.p+"heavy-snow.2fd1ca229f7e16ac5e72.gif",Rg=n.p+"thunderstorm.3475ed70ea18a97aaf45.gif",kg=n.p+"sunset.29ec1603d90ec5522a21.svg",zg=n.p+"sunrise.2cf835287069ccf43d06.svg",Fg=JSON.parse('{"0":{"day":{"description":"Sunny","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/575900edccbc7def167f7874c02aeb0b.png","background":"sunny"},"night":{"description":"Clear","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/1200cde3569cf69bd80e1ddabc0f15cd.png","background":"clear"}},"1":{"day":{"description":"Mostly Sunny","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/575900edccbc7def167f7874c02aeb0b.png","background":"sunny"},"night":{"description":"Mostly Clear","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/1200cde3569cf69bd80e1ddabc0f15cd.png","background":"clear"}},"2":{"day":{"description":"Cloudy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/67aaf9dbe30989c25cbde6c6ec099213.png","background":"cloudy"},"night":{"description":"Cloudy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/17cc1a8a95028b89ba6988ee47eeab29.png","background":"cloudy"}},"3":{"day":{"description":"Very Cloudy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/67aaf9dbe30989c25cbde6c6ec099213.png","background":"very-cloudy"},"night":{"description":"Very Cloudy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/17cc1a8a95028b89ba6988ee47eeab29.png","background":"very-cloudy"}},"45":{"day":{"description":"Foggy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d35bb25d12281cd9ee5ce78a98cd2aa7.png","background":"fog"},"night":{"description":"Foggy","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d35bb25d12281cd9ee5ce78a98cd2aa7.png","background":"fog"}},"48":{"day":{"description":"Rime Fog","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d35bb25d12281cd9ee5ce78a98cd2aa7.png","background":"fog"},"night":{"description":"Rime Fog","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d35bb25d12281cd9ee5ce78a98cd2aa7.png","background":"fog"}},"51":{"day":{"description":"Light Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"light-rain"},"night":{"description":"Light Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"light-rain"}},"53":{"day":{"description":"Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"rain"},"night":{"description":"Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"rain"}},"55":{"day":{"description":"Heavy Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"heavy-rain"},"night":{"description":"Heavy Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"heavy-rain"}},"56":{"day":{"description":"Light Freezing Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"light-rain"},"night":{"description":"Light Freezing Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"light-rain"}},"57":{"day":{"description":"Freezing Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"rain"},"night":{"description":"Freezing Drizzle","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"rain"}},"61":{"day":{"description":"Light Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"light-rain"},"night":{"description":"Light Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/d4b6596291c114305b64056bd92ccee3.png","background":"light-rain"}},"63":{"day":{"description":"Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/4417bf88c7bbcd8e24fb78ee6479b362.png","background":"rain"},"night":{"description":"Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/4417bf88c7bbcd8e24fb78ee6479b362.png","background":"rain"}},"65":{"day":{"description":"Heavy Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/451d37e6cea3af4a568110863a1adcf7.png","background":"heavy-rain"},"night":{"description":"Heavy Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/451d37e6cea3af4a568110863a1adcf7.png","background":"heavy-rain"}},"66":{"day":{"description":"Light Freezing Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"light-rain"},"night":{"description":"Light Freezing Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"light-rain"}},"67":{"day":{"description":"Freezing Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"rain"},"night":{"description":"Freezing Rain","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"rain"}},"71":{"day":{"description":"Light Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"light-snow"},"night":{"description":"Light Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"light-snow"}},"73":{"day":{"description":"Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"snow"},"night":{"description":"Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"snow"}},"75":{"day":{"description":"Heavy Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/e95fb90fc5a4aac111be78770921beb1.png","background":"heavy-snow"},"night":{"description":"Heavy Snow","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/e95fb90fc5a4aac111be78770921beb1.png","background":"heavy-snow"}},"77":{"day":{"description":"Snow Grains","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/e95fb90fc5a4aac111be78770921beb1.png","background":"snow"},"night":{"description":"Snow Grains","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/e95fb90fc5a4aac111be78770921beb1.png","background":"snow"}},"80":{"day":{"description":"Light Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"light-rain"},"night":{"description":"Light Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/a55fef55bbeb0762a8dd329b4b8ad342.png","background":"light-rain"}},"81":{"day":{"description":"Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/4417bf88c7bbcd8e24fb78ee6479b362.png","background":"rain"},"night":{"description":"Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/4417bf88c7bbcd8e24fb78ee6479b362.png","background":"rain"}},"82":{"day":{"description":"Heavy Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/451d37e6cea3af4a568110863a1adcf7.png","background":"heavy-rain"},"night":{"description":"Heavy Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/451d37e6cea3af4a568110863a1adcf7.png","background":"heavy-rain"}},"85":{"day":{"description":"Light Snow Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"light-snow"},"night":{"description":"Light Snow Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/9189cb49e806d1ebfeed24f33367143c.png","background":"light-snow"}},"86":{"day":{"description":"Snow Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"snow"},"night":{"description":"Snow Showers","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/00171e3b54b97dee8c1a2f6a62272640.png","background":"snow"}},"95":{"day":{"description":"Thunderstorm","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"},"night":{"description":"Thunderstorm","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"}},"96":{"day":{"description":"Light Thunderstorms With Hail","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"},"night":{"description":"Light Thunderstorms With Hail","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"}},"99":{"day":{"description":"Thunderstorm With Hail","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"},"night":{"description":"Thunderstorm With Hail","image":"https://help.apple.com/assets/65E21662495F1A6C8701F50A/65E21663EF8273BE1D0C2734/en_US/efffb1e26f6de5bf5c8adbd872a2933a.png","background":"thunderstorm"}}}'),Og=n.p+"remove.c568caf2b97516e98c2b.svg",Ng="",Ug=(t,e)=>{const n=1===e?"day":"night";return Fg[t][n]},Vg=t=>{const e=Ug(t.current.weatherCode,t.current.isDay);if(0===t.current.isDay)switch(e.background){case"clear":return Ag;case"cloudy":return wg;case"very-cloudy":return Cg;case"fog":return Eg;case"light-rain":return Sg;case"rain":return Mg;case"heavy-rain":return Tg;case"light-snow":return Bg;case"snow":return Lg;case"heavy-snow":return Dg;case"thunderstorm":return Ig;default:return""}else switch(e.background){case"sunny":return pg;case"cloudy":return mg;case"very-cloudy":return fg;case"fog":return gg;case"light-rain":return vg;case"rain":return yg;case"heavy-rain":return _g;case"light-snow":return xg;case"snow":return bg;case"heavy-snow":return Pg;case"thunderstorm":return Rg;default:return"#248DC7"}},Gg=(t,e="")=>{if(e){const n=e,i=Ug(t.current.weatherCode,t.current.isDay),r=Vg(t);n.style.setProperty("--background",`url(${r}) 0 0 repeat`),0===t.current.isDay?(n.style.setProperty("--top-position",`var(--card-bg-top-position-${i.background}-night)`),n.style.setProperty("--left-position",`var(--card-bg-left-position-${i.background}-night)`)):(n.style.setProperty("--top-position",`var(--card-bg-top-position-${i.background}-day)`),n.style.setProperty("--left-position",`var(--card-bg-left-position-${i.background}-day)`))}else{const e=Ug(t.current.weatherCode,t.current.isDay),n=Vg(t),i=document.querySelector("#location");i.style.backgroundImage=`url(${n})`,0===t.current.isDay?(document.querySelector(".direction-text").style.backgroundColor="rgb(0 41 96)",i.style.backgroundPosition=`var(--main-bg-position-${e.background}-night)`):i.style.backgroundPosition=`var(--main-bg-position-${e.background}-day)`}},Hg=async(t,e)=>{const n=await j([t]),i=(await q([n.city],[n.lat],[n.lon],[n.place_id],e))[0];document.querySelectorAll(".card").forEach((t=>{const e=t;0===i.current.isDay?e.style.filter="brightness(1.2)":e.style.filter="brightness(0.95)"})),(t=>{const e=document.querySelector(".location-brief-info"),n=e.querySelector(".city"),i=e.querySelector(".temp-number"),r=e.querySelector(".temp-icon"),a=e.querySelector(".type"),o=e.querySelector(".temp-high"),s=e.querySelector(".temp-low");n.textContent=t.location.city;const l=Math.round(t.current.temperature2m),c=Math.round(t.daily.temperature2mMax[0]),u=Math.round(t.daily.temperature2mMin[0]);i.textContent=`${l}`,r.textContent=`${Ng}`,o.textContent=`H:${c}${Ng}`,s.textContent=`L:${u}${Ng}`;const h=Ug(t.current.weatherCode,t.current.isDay);a.textContent=h.description})(i),Gg(i),(t=>{const e=document.querySelector(".hourly-forecast").querySelector(".card-content");e.textContent="";for(let n=0;n<24;n++){const i=document.createElement("div");i.classList.add("js-hour-item");const r=document.createElement("p");r.classList.add("js-hour-time");const a=0===n?"Now":new Date(t.hourly.time[n]).getHours();r.textContent=a;const o=document.createElement("img");o.classList.add("js-hour-weather-type"),o.setAttribute("alt","Weather type icon"),o.setAttribute("height","24");const s=Ug(t.hourly.weatherCode[n],t.hourly.isDay[n]);o.src=s.image;const l=document.createElement("p");l.classList.add("js-hour-temp");const c=Math.round(t.hourly.temperature2m[n]);l.textContent=`${c}${Ng}`,i.append(r,o,l),e.append(i)}})(i),(t=>{const e=document.querySelector(".daily-forecast").querySelector(".card-content");e.textContent="";const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(let i=7;i<18;i++){const r=document.createElement("hr"),a=document.createElement("div");a.classList.add("js-daily-item");const o=document.createElement("p");o.classList.add("js-day-name");const s=new Date(t.daily.time[i]).getDay();o.textContent=7===i?"Today":n[s];const l=document.createElement("img");l.classList.add("js-daily-weather-type"),l.setAttribute("alt","Weather type icon"),l.setAttribute("height","24");const c=Ug(t.daily.weatherCode[i],1);l.src=c.image;const u=document.createElement("p"),h=document.createElement("p");u.classList.add("js-daily-temp-min"),h.classList.add("js-daily-temp-max");const d=Math.round(t.daily.temperature2mMin[i]);u.textContent=`${d}${Ng}`;const p=Math.round(t.daily.temperature2mMax[i]);h.textContent=`${p}${Ng}`;const m=Z(d,p);a.append(o,l,u,m,h),i<17?e.append(a,r):e.append(a)}})(i),(t=>{!function(t){Rt.apiKey="CsggKz6ldPeRkTfF0cuJ";const e=new un({container:"map",style:"4ec33188-7fc3-45eb-96a1-914ded5e32c9",zoom:5,center:[t.location.longitude,t.location.latitude],navigationControl:!1}),n=new dg;e.on("load",(()=>{e.setPaintProperty("Water","fill-color","rgba(0, 0, 0, 0.4)"),e.addLayer(n,"Water"),n.animateByFactor(3600)}))}(t)})(i),((t,e)=>{const n=document.querySelector(".feels-like").querySelector(".card-content");n.textContent="";const i=Math.round(t.current.apparentTemperature),r=Math.round(t.current.temperature2m),a=document.createElement("div");a.classList.add("js-feels-temp"),a.textContent=`${i}${Ng}`;const o=document.createElement("div");o.classList.add("js-feels-desc");const s=i-r;0===e?Math.abs(s)<=3?o.textContent="Similar to the actual temperature.":s>3?o.textContent="Hotter than the actual temperature.":s>-3&&(o.textContent="Colder than the actual temperature."):Math.abs(s)<=6?o.textContent="Similar to the actual temperature.":s>6?o.textContent="Hotter than the actual temperature.":s>-6&&(o.textContent="Colder than the actual temperature."),n.append(a,o)})(i,e),(t=>{const e=document.querySelector(".uv-index").querySelector(".card-content");e.textContent="";const n=Math.round(t.hourly.uvIndex[0]),i=document.createElement("div");i.classList.add("js-uv-index");const r=document.createElement("p");r.classList.add("js-index"),r.textContent=n;const a=document.createElement("p");a.classList.add("js-scale");const o=document.createElement("div");o.classList.add("js-uv-desc"),n>=0&&n<=2?(a.textContent="Normal",o.textContent="You can safely stay outside."):n>=3&&n<=5?(a.textContent="Moderate",o.textContent="Use sun protection."):n>=6&&n<=7?(a.textContent="High",o.textContent="Use sun protection and seek shade."):n>=8&&n<=10?(a.textContent="Very high",o.textContent="Avoid being outside."):n>=11&&(a.textContent="Extreme",o.textContent="Avoid being outside.");const s=document.createElement("div");s.classList.add("js-uv-bar");const l=document.createElement("div");l.classList.add("js-bar"),l.style.left=n>10?"100%":`${n}0%`,i.append(r,a),s.append(l),e.append(i,s,o)})(i),(async t=>{const e=document.querySelector(".sunrise-sunset"),n=e.querySelector(".card-content");n.textContent="";const i=e.querySelector(".card-title"),r=i.querySelector(".card-title-icon"),a=i.querySelector(".card-title-text"),o=document.createElement("div");o.classList.add("js-sunrise-sunset-main-time");const s=document.createElement("div");s.classList.add("js-sunrise-sunset-next-time");const{latitude:l,longitude:c,timezone:u}=t.location,h=await(async(t,e,n)=>{try{let i=new Date;i.setDate(i.getDate()+1),i=new Date(i.toLocaleString("en",{timeZone:n}));const r=await fetch(`https://api.sunrise-sunset.org/json?lat=${t}&lng=${e}&date=today&tzid=${n}&formatted=0`,{mode:"cors"}),a=await fetch(`https://api.sunrise-sunset.org/json?lat=${t}&lng=${e}&date=${i.getFullYear()}-${i.getMonth()}-${i.getDate()}&tzid=${n}&formatted=0`,{mode:"cors"}),o=await r.json(),s=await a.json();return[o.results,s.results]}catch(t){return t}})(l,c,u),d=h[0].sunrise,p=h[0].sunset,m=G(u,new Date);m.getTime()>G(u,new Date(d)).getTime()&&m.getTime()<G(u,new Date(p)).getTime()?(a.textContent="Sunset",r.src=kg,r.alt="Sunset icon",o.textContent=p.slice(11,16),s.textContent=`Sunrise: ${h[1].sunrise.slice(11,16)}`):m.getTime()>G(u,new Date(d)).getTime()&&m.getTime()>G(u,new Date(p)).getTime()?(a.textContent="Sunrise",r.src=zg,r.alt="Sunrise icon",o.textContent=h[1].sunrise.slice(11,16),s.textContent=`Sunset: ${h[1].sunset.slice(11,16)}`):m.getTime()<G(u,new Date(d)).getTime()&&(a.textContent="Sunrise",r.src=zg,r.alt="Sunrise icon",o.textContent=h[0].sunrise.slice(11,16),s.textContent=`Sunset: ${p.slice(11,16)}`),n.append(o,s)})(i),((t,e)=>{const n=document.querySelector(".wind").querySelector(".card-content"),i=n.querySelector(".wind-type-wind"),r=i.querySelector(".wind-left"),a=i.querySelector(".wind-metric"),o=n.querySelector(".wind-type-gust"),s=o.querySelector(".wind-left"),l=o.querySelector(".wind-metric"),c=n.querySelector(".wind-direction"),u=c.querySelector("p"),h=c.querySelector(".arrow");a.textContent="metric"===e?"KM/H":"MP/H",l.textContent="metric"===e?"KM/H":"MP/H";const d=Math.round(t.current.windDirection10m);h.style.transform=`rotate(${Math.round(d)}deg)`,d>=336||d<=24?u.textContent="N":d>=25&&d<=65?u.textContent="NE":d>=66&&d<=114?u.textContent="E":d>=115&&d<=155?u.textContent="SE":d>=156&&d<=204?u.textContent="S":d>=205&&d<=245?u.textContent="SW":d>=246&&d<=294?u.textContent="W":d>=295&&d<=335&&(u.textContent="NW"),r.textContent="metric"===e?Math.round(t.current.windSpeed10m):Math.round(t.current.windSpeed10m/1.609344),s.textContent="metric"===e?Math.round(t.current.windGusts10m):Math.round(t.current.windGusts10m/1.609344)})(i,e),(t=>{const e=document.querySelector(".gauge-container");e.textContent="";const n=document.createElement("p");var i;n.classList.add("pressure-unit"),n.textContent="hPa",e.append(n),i=Math.round(t.current.pressureMsl),Y()(document.getElementById("gauge3"),{min:975,max:1050,label:t=>`${Math.round(t)}`,value:i,viewBox:"0 0 100 100"})})(i)},jg=async()=>{const t={enableHighAccuracy:!0,maximumAge:3e4,timeout:27e3};return new Promise(((e,n)=>{navigator.geolocation.getCurrentPosition(e,n,t)}))},Wg=async t=>{await(async t=>{const e=document.querySelector(".saved-locations-cards");e.textContent="";const n=await(async t=>{const e=await jg().catch((t=>console.log(t)));if(!e)return;const n=await W(e.coords.latitude,e.coords.longitude);return(await q([n.city],[e.coords.latitude],[e.coords.longitude],[n.place_id],t))[0]})(t);if(!n)return;const i=document.createElement("div");i.classList.add("location-container","current-location"),i.dataset.index="default";const r=document.createElement("div");r.classList.add("location-card"),Gg(n,r);const a=document.createElement("div");a.classList.add("location-card-left");const o=document.createElement("p");o.classList.add("city"),o.textContent="My location";const s=document.createElement("p");s.classList.add("time"),s.textContent=n.location.city;const l=document.createElement("p");l.classList.add("weather");const c=Ug(n.current.weatherCode,n.current.isDay);l.textContent=c.description;const u=document.createElement("div");u.classList.add("location-card-right");const h=document.createElement("p");h.classList.add("current-temp"),h.textContent=`${Math.round(n.current.temperature2m)}${Ng}`;const d=document.createElement("div");d.classList.add("high-min-temp");const p=document.createElement("p");p.classList.add("high-temp"),p.textContent=`L:${Math.round(n.daily.temperature2mMax[0])}`;const m=document.createElement("p");m.classList.add("min-temp"),m.textContent=`L:${Math.round(n.daily.temperature2mMin[0])}`,d.append(p,m),a.append(o,s,l),u.append(h,d),r.append(a,u),i.append(r),e.append(i)})(t),(async t=>{const e=document.querySelector(".saved-locations-cards"),n=await(async t=>{const e=U().get(),n=[],i=[],r=[],a=[],o=[];return e.forEach((t=>{n.push(t.city),i.push(t.latitude),r.push(t.longitude),a.push(t.locationId),o.push(t.timezone)})),await q(n,i,r,a,t)})(t);n.forEach(((t,n)=>{const i=document.createElement("div");i.classList.add("location-container","saved-location"),i.dataset.index=n;const r=document.createElement("div");r.classList.add("location-card"),Gg(t,r);const a=document.createElement("div");a.classList.add("location-card-left");const o=document.createElement("p");o.classList.add("city"),o.textContent=t.location.city;const s=document.createElement("p");s.classList.add("time"),s.textContent=`${(()=>{const e=new Date(t.current.time).getHours();return e<10?`0${e}`:e})()}:${(()=>{const e=new Date(t.current.time).getMinutes();return e<10?`0${e}`:e})()}`;const l=document.createElement("p");l.classList.add("weather");const c=Ug(t.current.weatherCode,t.current.isDay);l.textContent=c.description;const u=document.createElement("div");u.classList.add("location-card-right");const h=document.createElement("p");h.classList.add("current-temp"),h.textContent=`${Math.round(t.current.temperature2m)}${Ng}`;const d=document.createElement("div");d.classList.add("high-min-temp");const p=document.createElement("p");p.classList.add("high-temp"),p.textContent=`L:${Math.round(t.daily.temperature2mMax[0])}`;const m=document.createElement("p");m.classList.add("min-temp"),m.textContent=`L:${Math.round(t.daily.temperature2mMin[0])}`,d.append(p,m),a.append(o,s,l),u.append(h,d),r.append(a,u),i.append(r),e.append(i)}))})(t)},qg=()=>{document.querySelector(".saved-locations-cards").querySelectorAll(".saved-location").forEach((t=>{const e=t,n=e.querySelector(".location-card");if(""===n.style.width?n.style.width="90%":n.style.width="",""===n.style.height?n.style.height="9vh":n.style.height="",""===n.style.borderRadius?n.style.borderRadius="20px":n.style.borderRadius="",""===n.style.padding?n.style.padding="0 5px":n.style.padding="",n.childNodes.forEach((t=>{const e=t;""===e.style.transform?e.style.transform="scale(0.8)":e.style.transform=""})),e.querySelector(".remove-card-btn"))e.querySelector(".remove-card-btn").remove();else{const t=document.createElement("button");t.classList.add("remove-card-btn");const e=document.createElement("img");e.setAttribute("src",`${Og}`),t.append(e),n.insertAdjacentElement("beforebegin",t)}}))},Zg=t=>{if(t.target.closest(".saved-location")){let e=document.querySelector(".saved-locations-cards");const n=t.target.closest(".saved-location").dataset.index;t.target.closest(".remove-card-btn")&&(U().remove(n),e.removeChild(t.target.closest(".saved-location")),e=document.querySelector(".saved-locations-cards"),e.querySelectorAll(".saved-location").forEach(((t,e)=>{t.dataset.index=e})))}else window.removeEventListener("mouseup",Zg),qg()},$g=n.p+"check.eab868935b0703b5a116.svg";function Yg(){const t=document.querySelector("body"),e=document.querySelector(".saved-locations-cards"),n=document.querySelector(".settings-btn"),i=document.querySelector(".settings-menu"),r=t.querySelector("#saved-locations"),a=t.querySelector(".header-buttons"),o=t.querySelector("#saved-locations-btn"),s=t.querySelector("#cancel-btn"),l=t.querySelector("#save-btn"),c=t.querySelector("#location"),u=document.querySelector("gmpx-place-picker");let h,d,p;O("systemType")?h=O("systemType"):(h=0,F("systemType",h)),U(),jg().catch((t=>console.log(t))).then((async t=>{t?(p=await W(t.coords.latitude,t.coords.longitude),Hg(p.name,h)):Hg(U().get()[0].city,h)})),Wg(h);const m=document.querySelector("gmpx-place-picker"),f=document.createElement("style");f.innerHTML=".pac-target-input { border-radius: 10px; border: none; font-size: 1rem; } .pac-target-input:focus { outline: none; } .icon { transform: scale(1.5); color: #757575; }",m.shadowRoot.appendChild(f);const g=()=>{o.classList.toggle("btn-hidden"),s.classList.toggle("btn-hidden"),l.classList.toggle("btn-hidden")},v=async t=>{d=await j(t.target.value.formattedAddress),U().exists(d.place_id)||g(),Hg(t.target.value.formattedAddress,h),c.style.display="",c.classList.toggle("visible"),r.classList.toggle("visible"),r.style.display="none",u.shadowRoot.querySelector("input").value="",u.shadowRoot.querySelector(".clear-button").setAttribute("hidden",""),x()},y=t=>{if(t.target.closest(".location-card")){const e=t.target.closest(".location-container").dataset.index;Hg("default"===e?p.city:U().get()[e].city,h),r.style.display="none",r.classList.toggle("visible"),c.classList.toggle("visible"),c.style.display="",x()}},_=t=>{const e=t.target.closest(".settings-option");i.classList.toggle("hidden-menu"),window.removeEventListener("mouseup",_),t.target.closest(".settings-option")&&(e.classList.contains("edit-list")?0!==U().get().length&&(qg(),window.addEventListener("mouseup",Zg)):e.classList.contains("metric")?1===h&&(h=0,F("systemType",h),Wg(h)):e.classList.contains("imperial")&&0===h&&(h=1,F("systemType",h),console.log("test"),Wg(h)))},x=()=>{u.removeEventListener("gmpx-placechange",v),e.removeEventListener("click",y)};a.addEventListener("click",(t=>{t.target.closest("#saved-locations-btn")||t.target.closest("#cancel-btn")?(c.style.display="none",c.classList.toggle("visible"),r.classList.toggle("visible"),r.style.display="",u.addEventListener("gmpx-placechange",v),e.addEventListener("click",y),t.target.closest("#cancel-btn")&&g()):t.target.closest("#save-btn")&&(U().exists(d.place_id)?console.log("Cant save"):(U().add(d.city,d.lat,d.lon,d.place_id),Hg(d.city,0),Wg(0),g()))})),n.addEventListener("click",(()=>{i.classList.toggle("hidden-menu");const t=i.querySelector(".metric"),e=i.querySelector(".imperial"),n=t.querySelector(".check-icon"),r=e.querySelector(".check-icon");n.src="",r.src="",0===h?n.src=$g:r.src=$g;const a=i.querySelector(".edit-list");0===U().get().length?(a.style.backgroundColor="rgb(53 53 53)",a.style.filter="blur(1px)",a.style.cursor="not-allowed"):(a.style.backgroundColor="",a.style.filter="",a.style.cursor="pointer"),window.addEventListener("mouseup",_)}))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",Yg):Yg()})()})();
//# sourceMappingURL=bundle.7595af22ff4294c1e262.js.map